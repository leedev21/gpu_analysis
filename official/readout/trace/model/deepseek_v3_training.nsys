5779
31530
Args.n_device_per_node: 8
Args.total_steps: 5
Args.iters_per_step: 1
Args.num_layers: -1
Device ID: 35155 [0, 1, 2, 3, 4, 5, 6, 7] ['35155', '35156', '35157', '35158', '35159', '35160', '35161', '35162']
features: 499
args.num_block: 5
Err split_index_num: 99 4
block_start: [0, 1438, 3352, 5186, 7100, 9084, 9097]
block_end: [1438, 3352, 5186, 7100, 9084, 9097, 9570]
block_duration: [1438, 1914, 1834, 1914, 1984, 13, 473]
Err block_duration: [1438, 1914, 1834, 1914, 1984, 13, 473]
split_index_num: 12 0
block_start: [0, 1249, 3163, 5077, 6991, 8905]
block_end: [1249, 3163, 5077, 6991, 8905, 9570]
block_duration: [1249, 1914, 1914, 1914, 1914, 665]
emb_bwd: [3] {}
emb_bwd: [3] {}
check perf: 0 0 0 1245 1245 754325890
check perf: 1 0 1914 3159 1245 749879906
summary_modules: 0 9570 9570
num of kernel_trace: 45572
state.modules: 3
num of timeline: 5705
(0, '0:optim_step <1245, 9570, 8325>-> 7.246s')
     %0 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 2.998ms
       %1 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.396ms
         %2 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.396ms
           %3 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.396ms
             %4 = :aten::arange [[], [], [], [], []] -> 1.152us
               %5 = :aten::arange [[], [], [], [0]] -> 1.152us
             %6 = CCCL:cub::DeviceRadixSort [] -> 194.848us
                 -->kernel: 0:7 %649 =  [] -> 3.456us
                 -->kernel: 0:7 %650 =  [] -> 1.536us
                 -->kernel: 0:7 %651 =  [] -> 7.840us
                 -->kernel: 0:7 %652 =  [] -> 7.424us
                 -->kernel: 0:7 %653 =  [] -> 7.008us
                 -->kernel: 0:7 %654 =  [] -> 6.912us
                 -->kernel: 0:7 %655 =  [] -> 7.136us
                 -->kernel: 0:7 %656 =  [] -> 7.104us
                 -->kernel: 0:7 %657 =  [] -> 6.976us
                 -->kernel: 0:7 %658 =  [] -> 6.784us
             %7 = :aten::zeros [[], [], [], [], []] -> 544.706us
               %8 = :aten::zero_ [[129280, 7168]] -> 544.706us
                 %9 = :aten::fill_ [[129280, 7168], []] -> 544.706us
                 -->kernel: 0:7 %659 =  [] -> 544.706us
             %10 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 17.312us
                 -->kernel: 0:7 %660 =  [] -> 1.440us
                 -->kernel: 0:7 %661 =  [] -> 4.000us
                 -->kernel: 0:7 %662 =  [] -> 1.920us
             %11 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 19.360us
                 -->kernel: 0:7 %663 =  [] -> 1.440us
                 -->kernel: 0:7 %664 =  [] -> 2.944us
                 -->kernel: 0:7 %665 =  [] -> 1.376us
                 -->kernel: 0:7 %666 =  [] -> 2.144us
                 -->kernel: 0:7 %667 =  [] -> 224.673us
                 -->kernel: 0:7 %668 =  [] -> 166.144us
       %12 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.555ms
                 -->kernel: 0:35 %669 =  [] -> 1.555ms
     %13 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.557ms
       %14 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.557ms
                 -->kernel: 0:35 %670 =  [] -> 1.557ms
     %15 = :aten::linalg_vector_norm [[3002413056], [], [], [], []] -> 2.601ms
                 -->kernel: 0:7 %671 =  [] -> 615.745us
                 -->kernel: 0:7 %672 =  [] -> 610.401us
                 -->kernel: 0:7 %673 =  [] -> 607.266us
                 -->kernel: 0:7 %674 =  [] -> 609.217us
     %16 = :aten::isnan [[]] -> 1.664us
       %17 = :aten::ne [[], []] -> 1.664us
                 -->kernel: 0:7 %675 =  [] -> 1.664us
     %18 = :aten::is_nonzero [[]] -> 2.240us
       %19 = :aten::item [[]] -> 2.240us
         %20 = :aten::_local_scalar_dense [[]] -> 2.240us
     %21 = :aten::isinf [[]] -> 39.360us
       %22 = :aten::abs [[]] -> 1.376us
         %23 = :aten::abs [[], [0]] -> 1.376us
                 -->kernel: 0:7 %676 =  [] -> 1.376us
       %24 = :aten::eq [[], []] -> 1.504us
                 -->kernel: 0:7 %677 =  [] -> 1.504us
     %25 = :aten::is_nonzero [[]] -> 2.208us
       %26 = :aten::item [[]] -> 2.208us
         %27 = :aten::_local_scalar_dense [[]] -> 2.208us
     %28 = :aten::mul_ [[3002413056], []] -> 3.543ms
                 -->kernel: 0:7 %678 =  [] -> 864.578us
                 -->kernel: 0:7 %679 =  [] -> 901.506us
                 -->kernel: 0:7 %680 =  [] -> 873.218us
                 -->kernel: 0:7 %681 =  [] -> 868.834us
     %29 = :c10d::reduce_scatter_tensor_coalesced_ [[375301632], [3002413056], [], [], [], []] -> 14.438ms
       %30 = :record_param_comms [[3002413056], [], [], [], [], [], [], [], [], []] -> 14.438ms
         %31 = :nccl:reduce_scatter_tensor_coalesced [[3002413056]] -> 14.438ms
           %32 = NCCL:ncclGroupEnd [] -> 14.438ms
                 -->kernel: 0:7 %682 =  [] -> 14.438ms
     %33 = :aten::linalg_vector_norm [[352321536], [], [], [], []] -> 306.081us
                 -->kernel: 0:7 %683 =  [] -> 291.745us
     %34 = :aten::isnan [[]] -> 1.632us
       %35 = :aten::ne [[], []] -> 1.632us
                 -->kernel: 0:7 %684 =  [] -> 1.632us
     %36 = :aten::is_nonzero [[]] -> 2.240us
       %37 = :aten::item [[]] -> 2.240us
         %38 = :aten::_local_scalar_dense [[]] -> 2.240us
     %39 = :aten::isinf [[]] -> 28.129us
       %40 = :aten::abs [[]] -> 1.505us
         %41 = :aten::abs [[], [0]] -> 1.505us
                 -->kernel: 0:7 %685 =  [] -> 1.505us
       %42 = :aten::eq [[], []] -> 1.472us
                 -->kernel: 0:7 %686 =  [] -> 1.472us
     %43 = :aten::is_nonzero [[]] -> 2.464us
       %44 = :aten::item [[]] -> 2.464us
         %45 = :aten::_local_scalar_dense [[]] -> 2.464us
     %46 = :aten::mul_ [[352321536], []] -> 402.849us
                 -->kernel: 0:7 %687 =  [] -> 402.849us
     %47 = :aten::stack [[32], [32], []] -> 1.856us
       %48 = :aten::cat [[32], [32], []] -> 1.856us
                 -->kernel: 0:7 %688 =  [] -> 1.856us
     %49 = :aten::stack [[32], [32], []] -> 2.304us
       %50 = :aten::cat [[32], [32], []] -> 2.304us
                 -->kernel: 0:7 %689 =  [] -> 2.304us
     %51 = :c10d::allreduce_ [[2, 32], [], [], [], [], []] -> 16.736us
       %52 = :record_param_comms [[2, 32], [], [], [], [], [], [], [], [], []] -> 16.736us
         %53 = :nccl:all_reduce [[2, 32]] -> 16.736us
           %54 = NCCL:ncclAllReduce [] -> 16.736us
                 -->kernel: 0:7 %690 =  [] -> 16.736us
     %55 = :aten::sum [[2, 32], [], [], []] -> 2.656us
                 -->kernel: 0:7 %691 =  [] -> 2.656us
     %56 = :aten::div [[2, 1], []] -> 1.504us
                 -->kernel: 0:7 %692 =  [] -> 1.504us
     %57 = :aten::sub [[2, 1], [2, 32], []] -> 2.272us
                 -->kernel: 0:7 %693 =  [] -> 2.272us
     %58 = :aten::sign [[2, 32]] -> 1.600us
                 -->kernel: 0:7 %694 =  [] -> 1.600us
     %59 = :aten::mul [[2, 32], []] -> 1.280us
                 -->kernel: 0:7 %695 =  [] -> 1.280us
     %60 = :aten::add [[2, 32], [2, 32], []] -> 2.848us
                 -->kernel: 0:7 %696 =  [] -> 2.848us
     %61 = :aten::zero_ [[32]] -> 1.184us
       %62 = :aten::fill_ [[32], []] -> 1.184us
                 -->kernel: 0:7 %697 =  [] -> 1.184us
     %63 = :aten::copy_ [[32], [32], []] -> 1.216us
     %64 = :aten::zero_ [[32]] -> 960.000ns
       %65 = :aten::fill_ [[32], []] -> 960.000ns
                 -->kernel: 0:7 %698 =  [] -> 960.000ns
     %66 = :aten::copy_ [[32], [32], []] -> 1.024us
     %67 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %68 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %69 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %70 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 9.696us
       %71 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 9.696us
         %72 = :nccl:all_reduce [[1]] -> 9.696us
           %73 = NCCL:ncclAllReduce [] -> 9.696us
                 -->kernel: 0:7 %699 =  [] -> 9.696us
     %74 = :aten::item [[1]] -> 2.240us
       %75 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %76 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %77 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %78 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %79 = :aten::zeros [[], [], [], [], []] -> 1.216us
       %80 = :aten::zero_ [[320]] -> 1.216us
         %81 = :aten::fill_ [[320], []] -> 1.216us
                 -->kernel: 0:7 %700 =  [] -> 1.216us
     %82 = :nvte_multi_tensor_l2norm_cuda [] -> 1.386ms
                 -->kernel: 0:7 %701 =  [] -> 35.713us
                 -->kernel: 0:7 %702 =  [] -> 33.632us
                 -->kernel: 0:7 %703 =  [] -> 29.952us
                 -->kernel: 0:7 %704 =  [] -> 30.048us
                 -->kernel: 0:7 %705 =  [] -> 30.016us
                 -->kernel: 0:7 %706 =  [] -> 29.856us
                 -->kernel: 0:7 %707 =  [] -> 30.304us
                 -->kernel: 0:7 %708 =  [] -> 30.176us
                 -->kernel: 0:7 %709 =  [] -> 29.696us
                 -->kernel: 0:7 %710 =  [] -> 29.856us
                 -->kernel: 0:7 %711 =  [] -> 30.144us
                 -->kernel: 0:7 %712 =  [] -> 29.953us
                 -->kernel: 0:7 %713 =  [] -> 29.728us
                 -->kernel: 0:7 %714 =  [] -> 29.824us
                 -->kernel: 0:7 %715 =  [] -> 30.368us
                 -->kernel: 0:7 %716 =  [] -> 30.048us
                 -->kernel: 0:7 %717 =  [] -> 29.888us
                 -->kernel: 0:7 %718 =  [] -> 29.920us
                 -->kernel: 0:7 %719 =  [] -> 30.240us
                 -->kernel: 0:7 %720 =  [] -> 29.664us
                 -->kernel: 0:7 %721 =  [] -> 29.920us
                 -->kernel: 0:7 %722 =  [] -> 30.144us
                 -->kernel: 0:7 %723 =  [] -> 29.952us
                 -->kernel: 0:7 %724 =  [] -> 29.824us
                 -->kernel: 0:7 %725 =  [] -> 29.952us
                 -->kernel: 0:7 %726 =  [] -> 29.920us
                 -->kernel: 0:7 %727 =  [] -> 29.984us
                 -->kernel: 0:7 %728 =  [] -> 30.016us
                 -->kernel: 0:7 %729 =  [] -> 29.632us
                 -->kernel: 0:7 %730 =  [] -> 30.048us
                 -->kernel: 0:7 %731 =  [] -> 29.824us
                 -->kernel: 0:7 %732 =  [] -> 30.272us
                 -->kernel: 0:7 %733 =  [] -> 29.792us
                 -->kernel: 0:7 %734 =  [] -> 30.080us
                 -->kernel: 0:7 %735 =  [] -> 17.217us
                 -->kernel: 0:7 %736 =  [] -> 1.760us
     %83 = :aten::pow [[1], []] -> 1.568us
                 -->kernel: 0:7 %737 =  [] -> 1.568us
     %84 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 64.960us
       %85 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 64.960us
         %86 = :nccl:all_reduce [[1]] -> 64.960us
           %87 = NCCL:ncclAllReduce [] -> 64.960us
                 -->kernel: 0:7 %738 =  [] -> 64.960us
     %88 = :aten::item [[1]] -> 2.208us
       %89 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %90 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %91 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %92 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %93 = :nvte_multi_tensor_scale_cuda [] -> 928.131us
                 -->kernel: 0:7 %739 =  [] -> 35.681us
                 -->kernel: 0:7 %740 =  [] -> 44.096us
                 -->kernel: 0:7 %741 =  [] -> 42.560us
                 -->kernel: 0:7 %742 =  [] -> 43.456us
                 -->kernel: 0:7 %743 =  [] -> 43.072us
                 -->kernel: 0:7 %744 =  [] -> 44.064us
                 -->kernel: 0:7 %745 =  [] -> 42.880us
                 -->kernel: 0:7 %746 =  [] -> 44.288us
                 -->kernel: 0:7 %747 =  [] -> 42.784us
                 -->kernel: 0:7 %748 =  [] -> 44.192us
                 -->kernel: 0:7 %749 =  [] -> 42.976us
                 -->kernel: 0:7 %750 =  [] -> 43.296us
                 -->kernel: 0:7 %751 =  [] -> 43.136us
                 -->kernel: 0:7 %752 =  [] -> 43.200us
                 -->kernel: 0:7 %753 =  [] -> 42.848us
                 -->kernel: 0:7 %754 =  [] -> 42.240us
                 -->kernel: 0:7 %755 =  [] -> 42.944us
                 -->kernel: 0:7 %756 =  [] -> 29.633us
     %94 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %95 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %96 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %97 = :nvte_multi_tensor_scale_cuda [] -> 887.394us
                 -->kernel: 0:7 %757 =  [] -> 42.880us
                 -->kernel: 0:7 %758 =  [] -> 42.624us
                 -->kernel: 0:7 %759 =  [] -> 43.584us
                 -->kernel: 0:7 %760 =  [] -> 43.200us
                 -->kernel: 0:7 %761 =  [] -> 43.969us
                 -->kernel: 0:7 %762 =  [] -> 43.040us
                 -->kernel: 0:7 %763 =  [] -> 43.776us
                 -->kernel: 0:7 %764 =  [] -> 42.880us
                 -->kernel: 0:7 %765 =  [] -> 43.808us
                 -->kernel: 0:7 %766 =  [] -> 42.432us
                 -->kernel: 0:7 %767 =  [] -> 43.616us
                 -->kernel: 0:7 %768 =  [] -> 42.944us
                 -->kernel: 0:7 %769 =  [] -> 44.513us
                 -->kernel: 0:7 %770 =  [] -> 42.752us
                 -->kernel: 0:7 %771 =  [] -> 43.008us
                 -->kernel: 0:7 %772 =  [] -> 44.704us
                 -->kernel: 0:7 %773 =  [] -> 27.584us
     %98 = :Optimizer.step#HybridDeviceOptimizer.step None -> 318.498ms
       %99 = :aten::copy_ [[375301632], [375301632], []] -> 43.653ms
         %100 = :aten::to [[375301632], [], [], [], []] -> 2.227ms
           %101 = :aten::_to_copy [[375301632], [], [], [], [], [], []] -> 2.227ms
             %102 = :aten::copy_ [[375301632], [375301632], []] -> 2.227ms
                 -->kernel: 0:7 %774 =  [] -> 2.227ms
         %103 = :aten::copy_ [[375301632], [375301632], []] -> 41.370ms
       %104 = :Optimizer.step#AdamW.step None -> 72.148ms
         %105 = :aten::copy_ [[375301632], [375301632], []] -> 72.148ms
           %106 = :aten::copy_ [[375301632], [375301632], []] -> 71.433ms
           %107 = :aten::copy_ [[375301632], [375301632], []] -> 604.034us
                 -->kernel: 0:7 %775 =  [] -> 604.034us
     %108 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 341.408ms
       %109 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 341.408ms
         %110 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 341.408ms
           %111 = NCCL:ncclGroupEnd [] -> 341.408ms
                 -->kernel: 0:39 %776 =  [] -> 341.408ms
     %112 = :Optimizer.step#HybridDeviceOptimizer.step None -> 84.160ms
       %113 = :aten::to [[14680064], [], [], [], []] -> 89.504us
         %114 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.504us
           %115 = :aten::copy_ [[14680064], [14680064], []] -> 89.504us
                 -->kernel: 0:7 %777 =  [] -> 89.504us
       %116 = :aten::to [[29360128], [], [], [], []] -> 176.384us
         %117 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.384us
           %118 = :aten::copy_ [[29360128], [29360128], []] -> 176.384us
                 -->kernel: 0:7 %778 =  [] -> 176.384us
       %119 = :aten::to [[29360128], [], [], [], []] -> 176.384us
         %120 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.384us
           %121 = :aten::copy_ [[29360128], [29360128], []] -> 176.384us
                 -->kernel: 0:7 %779 =  [] -> 176.384us
       %122 = :aten::to [[29360128], [], [], [], []] -> 176.032us
         %123 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.032us
           %124 = :aten::copy_ [[29360128], [29360128], []] -> 176.032us
                 -->kernel: 0:7 %780 =  [] -> 176.032us
       %125 = :aten::to [[29360128], [], [], [], []] -> 176.032us
         %126 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.032us
           %127 = :aten::copy_ [[29360128], [29360128], []] -> 176.032us
                 -->kernel: 0:7 %781 =  [] -> 176.032us
       %128 = :aten::to [[14680064], [], [], [], []] -> 89.441us
         %129 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.441us
           %130 = :aten::copy_ [[14680064], [14680064], []] -> 89.441us
                 -->kernel: 0:7 %782 =  [] -> 89.441us
       %131 = :aten::to [[14680064], [], [], [], []] -> 89.440us
         %132 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.440us
           %133 = :aten::copy_ [[14680064], [14680064], []] -> 89.440us
                 -->kernel: 0:7 %783 =  [] -> 89.440us
       %134 = :aten::to [[14680064], [], [], [], []] -> 89.568us
         %135 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.568us
           %136 = :aten::copy_ [[14680064], [14680064], []] -> 89.568us
                 -->kernel: 0:7 %784 =  [] -> 89.568us
       %137 = :aten::to [[14680064], [], [], [], []] -> 89.600us
         %138 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.600us
           %139 = :aten::copy_ [[14680064], [14680064], []] -> 89.600us
                 -->kernel: 0:7 %785 =  [] -> 89.600us
       %140 = :aten::to [[29360128], [], [], [], []] -> 176.096us
         %141 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.096us
           %142 = :aten::copy_ [[29360128], [29360128], []] -> 176.096us
                 -->kernel: 0:7 %786 =  [] -> 176.096us
       %143 = :aten::to [[29360128], [], [], [], []] -> 176.256us
         %144 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.256us
           %145 = :aten::copy_ [[29360128], [29360128], []] -> 176.256us
                 -->kernel: 0:7 %787 =  [] -> 176.256us
       %146 = :aten::to [[29360128], [], [], [], []] -> 176.129us
         %147 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.129us
           %148 = :aten::copy_ [[29360128], [29360128], []] -> 176.129us
                 -->kernel: 0:7 %788 =  [] -> 176.129us
       %149 = :aten::to [[29360128], [], [], [], []] -> 176.512us
         %150 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.512us
           %151 = :aten::copy_ [[29360128], [29360128], []] -> 176.512us
                 -->kernel: 0:7 %789 =  [] -> 176.512us
       %152 = :aten::copy_ [[14680064], [14680064], []] -> 1.993ms
         %153 = :aten::to [[14680064], [], [], [], []] -> 89.441us
           %154 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.441us
             %155 = :aten::copy_ [[14680064], [14680064], []] -> 89.441us
                 -->kernel: 0:7 %790 =  [] -> 89.441us
         %156 = :aten::copy_ [[14680064], [14680064], []] -> 1.844ms
       %157 = :aten::copy_ [[14680064], [14680064], []] -> 1.841ms
         %158 = :aten::to [[14680064], [], [], [], []] -> 88.544us
           %159 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.544us
             %160 = :aten::copy_ [[14680064], [14680064], []] -> 88.544us
                 -->kernel: 0:7 %791 =  [] -> 88.544us
         %161 = :aten::copy_ [[14680064], [14680064], []] -> 1.720ms
       %162 = :aten::copy_ [[14680064], [14680064], []] -> 1.811ms
         %163 = :aten::to [[14680064], [], [], [], []] -> 87.520us
           %164 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 87.520us
             %165 = :aten::copy_ [[14680064], [14680064], []] -> 87.520us
                 -->kernel: 0:7 %792 =  [] -> 87.520us
         %166 = :aten::copy_ [[14680064], [14680064], []] -> 1.691ms
       %167 = :Optimizer.step#FusedAdam.step None -> 3.886ms
         %168 = :nvte_multi_tensor_adam_cuda [] -> 3.098ms
                 -->kernel: 0:7 %793 =  [] -> 201.121us
                 -->kernel: 0:7 %794 =  [] -> 199.872us
                 -->kernel: 0:7 %795 =  [] -> 200.321us
                 -->kernel: 0:7 %796 =  [] -> 198.080us
                 -->kernel: 0:7 %797 =  [] -> 198.657us
                 -->kernel: 0:7 %798 =  [] -> 199.232us
                 -->kernel: 0:7 %799 =  [] -> 200.609us
                 -->kernel: 0:7 %800 =  [] -> 200.032us
                 -->kernel: 0:7 %801 =  [] -> 199.776us
                 -->kernel: 0:7 %802 =  [] -> 209.057us
                 -->kernel: 0:7 %803 =  [] -> 199.136us
                 -->kernel: 0:7 %804 =  [] -> 197.473us
                 -->kernel: 0:7 %805 =  [] -> 198.624us
                 -->kernel: 0:7 %806 =  [] -> 199.713us
                 -->kernel: 0:7 %807 =  [] -> 141.184us
         %169 = :aten::copy_ [[14680064], [14680064], []] -> 27.072us
                 -->kernel: 0:7 %808 =  [] -> 27.072us
         %170 = :aten::copy_ [[29360128], [29360128], []] -> 48.993us
                 -->kernel: 0:7 %809 =  [] -> 48.993us
         %171 = :aten::copy_ [[29360128], [29360128], []] -> 49.536us
                 -->kernel: 0:7 %810 =  [] -> 49.536us
         %172 = :aten::copy_ [[29360128], [29360128], []] -> 49.568us
                 -->kernel: 0:7 %811 =  [] -> 49.568us
         %173 = :aten::copy_ [[29360128], [29360128], []] -> 48.320us
                 -->kernel: 0:7 %812 =  [] -> 48.320us
         %174 = :aten::copy_ [[14680064], [14680064], []] -> 26.464us
                 -->kernel: 0:7 %813 =  [] -> 26.464us
         %175 = :aten::copy_ [[14680064], [14680064], []] -> 24.896us
                 -->kernel: 0:7 %814 =  [] -> 24.896us
         %176 = :aten::copy_ [[14680064], [14680064], []] -> 25.120us
                 -->kernel: 0:7 %815 =  [] -> 25.120us
         %177 = :aten::copy_ [[14680064], [14680064], []] -> 24.896us
                 -->kernel: 0:7 %816 =  [] -> 24.896us
         %178 = :aten::copy_ [[29360128], [29360128], []] -> 48.033us
                 -->kernel: 0:7 %817 =  [] -> 48.033us
         %179 = :aten::copy_ [[29360128], [29360128], []] -> 48.128us
                 -->kernel: 0:7 %818 =  [] -> 48.128us
         %180 = :aten::copy_ [[29360128], [29360128], []] -> 49.408us
                 -->kernel: 0:7 %819 =  [] -> 49.408us
         %181 = :aten::copy_ [[29360128], [29360128], []] -> 48.128us
                 -->kernel: 0:7 %820 =  [] -> 48.128us
       %182 = :Optimizer.step#AdamW.step None -> 8.700ms
         %183 = :aten::copy_ [[14680064], [14680064], []] -> 2.915ms
           %184 = :aten::copy_ [[14680064], [14680064], []] -> 2.839ms
           %185 = :aten::copy_ [[14680064], [14680064], []] -> 24.352us
                 -->kernel: 0:7 %821 =  [] -> 24.352us
         %186 = :aten::copy_ [[14680064], [14680064], []] -> 2.768ms
           %187 = :aten::copy_ [[14680064], [14680064], []] -> 2.733ms
           %188 = :aten::copy_ [[14680064], [14680064], []] -> 24.384us
                 -->kernel: 0:7 %822 =  [] -> 24.384us
         %189 = :aten::copy_ [[14680064], [14680064], []] -> 2.746ms
           %190 = :aten::copy_ [[14680064], [14680064], []] -> 2.714ms
           %191 = :aten::copy_ [[14680064], [14680064], []] -> 24.288us
                 -->kernel: 0:7 %823 =  [] -> 24.288us
     %192 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 53.783ms
       %193 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 53.783ms
         %194 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 53.783ms
           %195 = NCCL:ncclGroupEnd [] -> 53.783ms
                 -->kernel: 0:39 %824 =  [] -> 53.783ms
     %196 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %197 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %198 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %199 = :aten::item [[1]] -> 3.520us
       %200 = :aten::_local_scalar_dense [[1]] -> 3.520us
     %201 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %202 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %203 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %204 = :aten::item [[1]] -> 2.240us
       %205 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %206 = :aten::item [[1]] -> 2.272us
       %207 = :aten::_local_scalar_dense [[1]] -> 2.272us
     %208 = :aten::cat [[1], []] -> 1.632us
     %209 = :aten::mean [[1], []] -> 2.816us
       %210 = :aten::mean [[1], [], [], []] -> 2.816us
                 -->kernel: 0:7 %825 =  [] -> 2.816us
     %211 = :aten::item [[1]] -> 2.816us
       %212 = :aten::_local_scalar_dense [[1]] -> 2.816us
     %213 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %214 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %215 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %216 = :aten::add [[1], [], []] -> 1.536us
                 -->kernel: 0:7 %826 =  [] -> 1.536us
     %217 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %218 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %219 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %220 = :aten::item [[1]] -> 2.240us
       %221 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %222 = :aten::item [[1]] -> 2.240us
       %223 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %224 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 2.025ms
       %225 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 2.025ms
         %226 = :nccl:all_reduce [[2]] -> 2.025ms
           %227 = NCCL:ncclAllReduce [] -> 2.025ms
                 -->kernel: 0:7 %827 =  [] -> 2.025ms
     %228 = :c10d::allreduce_ [[3], [], [], [], [], []] -> 9.312us
       %229 = :record_param_comms [[3], [], [], [], [], [], [], [], [], []] -> 9.312us
         %230 = :nccl:all_reduce [[3]] -> 9.312us
           %231 = NCCL:ncclAllReduce [] -> 9.312us
                 -->kernel: 0:7 %828 =  [] -> 9.312us
     %232 = :aten::mul [[3], []] -> 1.504us
                 -->kernel: 0:7 %829 =  [] -> 1.504us
     %233 = :aten::mul [[2], []] -> 1.184us
                 -->kernel: 0:7 %830 =  [] -> 1.184us
     %234 = :aten::sum [[3], []] -> 2.432us
       %235 = :aten::sum [[3], [], [], []] -> 2.432us
                 -->kernel: 0:7 %831 =  [] -> 2.432us
     %236 = :aten::div [[], []] -> 1.408us
                 -->kernel: 0:7 %832 =  [] -> 1.408us
     %237 = :aten::add_ [[1], [], []] -> 1.376us
                 -->kernel: 0:7 %833 =  [] -> 1.376us
     %238 = :aten::sum [[2], []] -> 2.208us
       %239 = :aten::sum [[2], [], [], []] -> 2.208us
                 -->kernel: 0:7 %834 =  [] -> 2.208us
     %240 = :aten::div [[], []] -> 1.056us
                 -->kernel: 0:7 %835 =  [] -> 1.056us
     %241 = :aten::add_ [[1], [], []] -> 1.376us
                 -->kernel: 0:7 %836 =  [] -> 1.376us
     %242 = :aten::zero_ [[3]] -> 1.184us
       %243 = :aten::fill_ [[3], []] -> 1.184us
                 -->kernel: 0:7 %837 =  [] -> 1.184us
     %244 = :aten::zero_ [[2]] -> 896.000ns
       %245 = :aten::fill_ [[2], []] -> 896.000ns
                 -->kernel: 0:7 %838 =  [] -> 896.000ns
     %246 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 319.169us
       %247 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 319.169us
         %248 = :nccl:all_reduce [[1]] -> 319.169us
           %249 = NCCL:ncclAllReduce [] -> 319.169us
                 -->kernel: 0:7 %839 =  [] -> 319.169us
     %250 = :aten::mul [[1], []] -> 1.280us
                 -->kernel: 0:7 %840 =  [] -> 1.280us
     %251 = :aten::add_ [[1], [], []] -> 1.376us
                 -->kernel: 0:7 %841 =  [] -> 1.376us
     %252 = :aten::zero_ [[1]] -> 928.000ns
       %253 = :aten::fill_ [[1], []] -> 928.000ns
                 -->kernel: 0:7 %842 =  [] -> 928.000ns
     %254 = :c10d::barrier [[1], [], [], [], []] -> 174.785us
       %255 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 174.785us
         %256 = :aten::zeros [[], [], [], [], []] -> 960.000ns
           %257 = :aten::zero_ [[1]] -> 960.000ns
             %258 = :aten::fill_ [[1], []] -> 960.000ns
                 -->kernel: 0:7 %843 =  [] -> 960.000ns
         %259 = :nccl:all_reduce_barrier [[1]] -> 140.129us
           %260 = NCCL:ncclAllReduce [] -> 140.129us
                 -->kernel: 0:7 %844 =  [] -> 140.129us
     %261 = :c10d::barrier [[1], [], [], [], []] -> 37.600us
       %262 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 37.600us
         %263 = :aten::zeros [[], [], [], [], []] -> 1.088us
           %264 = :aten::zero_ [[1]] -> 1.088us
             %265 = :aten::fill_ [[1], []] -> 1.088us
                 -->kernel: 0:7 %845 =  [] -> 1.088us
         %266 = :nccl:all_reduce_barrier [[1]] -> 7.808us
           %267 = NCCL:ncclAllReduce [] -> 7.808us
                 -->kernel: 0:7 %846 =  [] -> 7.808us
     %268 = :aten::item [[1]] -> 2.208us
       %269 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %270 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %271 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %272 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %273 = :aten::item [[1]] -> 2.208us
       %274 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %275 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %276 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %277 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %278 = :aten::item [[1]] -> 2.240us
       %279 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %280 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %281 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %282 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %283 = :aten::item [[1]] -> 2.240us
       %284 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %285 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %286 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %287 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %288 = :aten::zeros [[], [], [], [], []] -> 928.000ns
       %289 = :aten::zero_ [[8, 24]] -> 928.000ns
         %290 = :aten::fill_ [[8, 24], []] -> 928.000ns
                 -->kernel: 0:7 %847 =  [] -> 928.000ns
     %291 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 101.217us
       %292 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 101.217us
         %293 = :nccl:_all_gather_base [[24]] -> 101.217us
           %294 = NCCL:ncclAllGather [] -> 101.217us
                 -->kernel: 0:7 %848 =  [] -> 101.217us
     %295 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %849 =  [] -> 1.760us
     %296 = :aten::index [[8], [8]] -> 61.952us
       %297 = :aten::nonzero [[8]] -> 61.952us
         %298 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %850 =  [] -> 1.312us
         %299 = CCCL:cub::DeviceSelect::Flagged [] -> 15.040us
                 -->kernel: 0:7 %851 =  [] -> 1.024us
                 -->kernel: 0:7 %852 =  [] -> 2.176us
     %300 = :aten::gt [[8], []] -> 1.920us
                 -->kernel: 0:7 %853 =  [] -> 1.920us
     %301 = :aten::index [[8], [8]] -> 44.160us
       %302 = :aten::nonzero [[8]] -> 44.160us
         %303 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %854 =  [] -> 1.248us
         %304 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %855 =  [] -> 960.000ns
                 -->kernel: 0:7 %856 =  [] -> 2.112us
     %305 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %857 =  [] -> 1.728us
     %306 = :aten::index [[8], [8]] -> 47.104us
       %307 = :aten::nonzero [[8]] -> 47.104us
         %308 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %858 =  [] -> 1.248us
         %309 = CCCL:cub::DeviceSelect::Flagged [] -> 14.816us
                 -->kernel: 0:7 %859 =  [] -> 992.000ns
                 -->kernel: 0:7 %860 =  [] -> 2.048us
     %310 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %861 =  [] -> 1.760us
     %311 = :aten::index [[8], [8]] -> 44.416us
       %312 = :aten::nonzero [[8]] -> 44.416us
         %313 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %862 =  [] -> 1.216us
         %314 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %863 =  [] -> 960.000ns
                 -->kernel: 0:7 %864 =  [] -> 2.080us
     %315 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %865 =  [] -> 1.728us
     %316 = :aten::index [[8], [8]] -> 43.232us
       %317 = :aten::nonzero [[8]] -> 43.232us
         %318 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %866 =  [] -> 1.248us
         %319 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %867 =  [] -> 992.000ns
                 -->kernel: 0:7 %868 =  [] -> 2.080us
     %320 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %869 =  [] -> 1.728us
     %321 = :aten::index [[8], [8]] -> 42.624us
       %322 = :aten::nonzero [[8]] -> 42.624us
         %323 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %870 =  [] -> 1.248us
         %324 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %871 =  [] -> 992.000ns
                 -->kernel: 0:7 %872 =  [] -> 2.112us
     %325 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %873 =  [] -> 1.728us
     %326 = :aten::index [[8], [8]] -> 42.336us
       %327 = :aten::nonzero [[8]] -> 42.336us
         %328 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %874 =  [] -> 1.248us
         %329 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %875 =  [] -> 992.000ns
                 -->kernel: 0:7 %876 =  [] -> 2.080us
     %330 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %877 =  [] -> 1.760us
     %331 = :aten::index [[8], [8]] -> 42.528us
       %332 = :aten::nonzero [[8]] -> 42.528us
         %333 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %878 =  [] -> 1.248us
         %334 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %879 =  [] -> 960.000ns
                 -->kernel: 0:7 %880 =  [] -> 2.112us
     %335 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %881 =  [] -> 1.728us
     %336 = :aten::index [[8], [8]] -> 42.144us
       %337 = :aten::nonzero [[8]] -> 42.144us
         %338 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %882 =  [] -> 1.248us
         %339 = CCCL:cub::DeviceSelect::Flagged [] -> 11.680us
                 -->kernel: 0:7 %883 =  [] -> 992.000ns
                 -->kernel: 0:7 %884 =  [] -> 2.080us
     %340 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %885 =  [] -> 1.728us
     %341 = :aten::index [[8], [8]] -> 42.208us
       %342 = :aten::nonzero [[8]] -> 42.208us
         %343 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %886 =  [] -> 1.248us
         %344 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %887 =  [] -> 960.000ns
                 -->kernel: 0:7 %888 =  [] -> 2.112us
     %345 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %889 =  [] -> 1.728us
     %346 = :aten::index [[8], [8]] -> 43.584us
       %347 = :aten::nonzero [[8]] -> 43.584us
         %348 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %890 =  [] -> 1.248us
         %349 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %891 =  [] -> 992.000ns
                 -->kernel: 0:7 %892 =  [] -> 2.048us
     %350 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %893 =  [] -> 1.728us
     %351 = :aten::index [[8], [8]] -> 42.241us
       %352 = :aten::nonzero [[8]] -> 42.241us
         %353 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %894 =  [] -> 1.248us
         %354 = CCCL:cub::DeviceSelect::Flagged [] -> 11.777us
                 -->kernel: 0:7 %895 =  [] -> 960.000ns
                 -->kernel: 0:7 %896 =  [] -> 2.112us
     %355 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %897 =  [] -> 1.728us
     %356 = :aten::index [[8], [8]] -> 42.976us
       %357 = :aten::nonzero [[8]] -> 42.976us
         %358 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %898 =  [] -> 1.248us
         %359 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %899 =  [] -> 992.000ns
                 -->kernel: 0:7 %900 =  [] -> 2.080us
     %360 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %901 =  [] -> 1.728us
     %361 = :aten::index [[8], [8]] -> 42.816us
       %362 = :aten::nonzero [[8]] -> 42.816us
         %363 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %902 =  [] -> 1.248us
         %364 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %903 =  [] -> 960.000ns
                 -->kernel: 0:7 %904 =  [] -> 2.176us
     %365 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %905 =  [] -> 1.792us
     %366 = :aten::index [[8], [8]] -> 43.008us
       %367 = :aten::nonzero [[8]] -> 43.008us
         %368 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %906 =  [] -> 1.312us
         %369 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %907 =  [] -> 1.056us
                 -->kernel: 0:7 %908 =  [] -> 2.112us
     %370 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %909 =  [] -> 1.792us
     %371 = :aten::index [[8], [8]] -> 42.176us
       %372 = :aten::nonzero [[8]] -> 42.176us
         %373 = CCCL:cub::DeviceReduce::Sum [] -> 1.344us
                 -->kernel: 0:7 %910 =  [] -> 1.344us
         %374 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %911 =  [] -> 1.024us
                 -->kernel: 0:7 %912 =  [] -> 2.176us
     %375 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %913 =  [] -> 1.792us
     %376 = :aten::index [[8], [8]] -> 42.720us
       %377 = :aten::nonzero [[8]] -> 42.720us
         %378 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %914 =  [] -> 1.312us
         %379 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %915 =  [] -> 1.056us
                 -->kernel: 0:7 %916 =  [] -> 2.144us
     %380 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %917 =  [] -> 1.792us
     %381 = :aten::index [[8], [8]] -> 42.464us
       %382 = :aten::nonzero [[8]] -> 42.464us
         %383 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %918 =  [] -> 1.312us
         %384 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %919 =  [] -> 1.024us
                 -->kernel: 0:7 %920 =  [] -> 2.176us
     %385 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %921 =  [] -> 1.792us
     %386 = :aten::index [[8], [8]] -> 43.456us
       %387 = :aten::nonzero [[8]] -> 43.456us
         %388 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %922 =  [] -> 1.312us
         %389 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %923 =  [] -> 1.056us
                 -->kernel: 0:7 %924 =  [] -> 2.144us
     %390 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %925 =  [] -> 1.792us
     %391 = :aten::index [[8], [8]] -> 41.856us
       %392 = :aten::nonzero [[8]] -> 41.856us
         %393 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %926 =  [] -> 1.312us
         %394 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %927 =  [] -> 1.056us
                 -->kernel: 0:7 %928 =  [] -> 2.176us
     %395 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %929 =  [] -> 1.760us
     %396 = :aten::index [[8], [8]] -> 43.072us
       %397 = :aten::nonzero [[8]] -> 43.072us
         %398 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %930 =  [] -> 1.312us
         %399 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %931 =  [] -> 1.056us
                 -->kernel: 0:7 %932 =  [] -> 2.176us
     %400 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %933 =  [] -> 1.824us
     %401 = :aten::index [[8], [8]] -> 41.888us
       %402 = :aten::nonzero [[8]] -> 41.888us
         %403 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %934 =  [] -> 1.312us
         %404 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %935 =  [] -> 1.024us
                 -->kernel: 0:7 %936 =  [] -> 2.208us
     %405 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %937 =  [] -> 1.792us
     %406 = :aten::index [[8], [8]] -> 43.008us
       %407 = :aten::nonzero [[8]] -> 43.008us
         %408 = CCCL:cub::DeviceReduce::Sum [] -> 1.344us
                 -->kernel: 0:7 %938 =  [] -> 1.344us
         %409 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %939 =  [] -> 1.088us
                 -->kernel: 0:7 %940 =  [] -> 2.112us
     %410 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %941 =  [] -> 1.824us
     %411 = :aten::index [[8], [8]] -> 42.784us
       %412 = :aten::nonzero [[8]] -> 42.784us
         %413 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %942 =  [] -> 1.312us
         %414 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %943 =  [] -> 1.056us
                 -->kernel: 0:7 %944 =  [] -> 2.176us
     %415 = :aten::zeros [[], [], [], [], []] -> 1.216us
       %416 = :aten::zero_ [[8, 24]] -> 1.216us
         %417 = :aten::fill_ [[8, 24], []] -> 1.216us
                 -->kernel: 0:7 %945 =  [] -> 1.216us
     %418 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.584us
       %419 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.584us
         %420 = :nccl:_all_gather_base [[24]] -> 7.584us
           %421 = NCCL:ncclAllGather [] -> 7.584us
                 -->kernel: 0:7 %946 =  [] -> 7.584us
     %422 = :aten::gt [[8], []] -> 1.632us
                 -->kernel: 0:7 %947 =  [] -> 1.632us
     %423 = :aten::index [[8], [8]] -> 47.328us
       %424 = :aten::nonzero [[8]] -> 47.328us
         %425 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %948 =  [] -> 1.536us
         %426 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %949 =  [] -> 1.376us
                 -->kernel: 0:7 %950 =  [] -> 1.888us
     %427 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %951 =  [] -> 1.440us
     %428 = :aten::index [[8], [8]] -> 45.376us
       %429 = :aten::nonzero [[8]] -> 45.376us
         %430 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %952 =  [] -> 1.536us
         %431 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %953 =  [] -> 1.344us
                 -->kernel: 0:7 %954 =  [] -> 1.888us
     %432 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %955 =  [] -> 1.408us
     %433 = :aten::index [[8], [8]] -> 44.032us
       %434 = :aten::nonzero [[8]] -> 44.032us
         %435 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %956 =  [] -> 1.504us
         %436 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %957 =  [] -> 1.344us
                 -->kernel: 0:7 %958 =  [] -> 1.856us
     %437 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %959 =  [] -> 1.440us
     %438 = :aten::index [[8], [8]] -> 42.752us
       %439 = :aten::nonzero [[8]] -> 42.752us
         %440 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %960 =  [] -> 1.536us
         %441 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %961 =  [] -> 1.312us
                 -->kernel: 0:7 %962 =  [] -> 1.920us
     %442 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %963 =  [] -> 1.440us
     %443 = :aten::index [[8], [8]] -> 43.264us
       %444 = :aten::nonzero [[8]] -> 43.264us
         %445 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %964 =  [] -> 1.504us
         %446 = CCCL:cub::DeviceSelect::Flagged [] -> 12.416us
                 -->kernel: 0:7 %965 =  [] -> 1.376us
                 -->kernel: 0:7 %966 =  [] -> 1.888us
     %447 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %967 =  [] -> 1.408us
     %448 = :aten::index [[8], [8]] -> 44.000us
       %449 = :aten::nonzero [[8]] -> 44.000us
         %450 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %968 =  [] -> 1.504us
         %451 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %969 =  [] -> 1.344us
                 -->kernel: 0:7 %970 =  [] -> 1.920us
     %452 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %971 =  [] -> 1.440us
     %453 = :aten::index [[8], [8]] -> 43.040us
       %454 = :aten::nonzero [[8]] -> 43.040us
         %455 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %972 =  [] -> 1.504us
         %456 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %973 =  [] -> 1.344us
                 -->kernel: 0:7 %974 =  [] -> 1.888us
     %457 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %975 =  [] -> 1.440us
     %458 = :aten::index [[8], [8]] -> 41.792us
       %459 = :aten::nonzero [[8]] -> 41.792us
         %460 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %976 =  [] -> 1.504us
         %461 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %977 =  [] -> 1.344us
                 -->kernel: 0:7 %978 =  [] -> 1.888us
     %462 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %979 =  [] -> 1.440us
     %463 = :aten::index [[8], [8]] -> 42.720us
       %464 = :aten::nonzero [[8]] -> 42.720us
         %465 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %980 =  [] -> 1.504us
         %466 = CCCL:cub::DeviceSelect::Flagged [] -> 12.192us
                 -->kernel: 0:7 %981 =  [] -> 1.376us
                 -->kernel: 0:7 %982 =  [] -> 1.888us
     %467 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %983 =  [] -> 1.408us
     %468 = :aten::index [[8], [8]] -> 42.048us
       %469 = :aten::nonzero [[8]] -> 42.048us
         %470 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %984 =  [] -> 1.504us
         %471 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %985 =  [] -> 1.344us
                 -->kernel: 0:7 %986 =  [] -> 1.888us
     %472 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %987 =  [] -> 1.408us
     %473 = :aten::index [[8], [8]] -> 42.016us
       %474 = :aten::nonzero [[8]] -> 42.016us
         %475 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %988 =  [] -> 1.472us
         %476 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %989 =  [] -> 1.344us
                 -->kernel: 0:7 %990 =  [] -> 1.856us
     %477 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %991 =  [] -> 1.408us
     %478 = :aten::index [[8], [8]] -> 42.048us
       %479 = :aten::nonzero [[8]] -> 42.048us
         %480 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %992 =  [] -> 1.504us
         %481 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %993 =  [] -> 1.312us
                 -->kernel: 0:7 %994 =  [] -> 1.856us
     %482 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %995 =  [] -> 1.408us
     %483 = :aten::index [[8], [8]] -> 42.336us
       %484 = :aten::nonzero [[8]] -> 42.336us
         %485 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %996 =  [] -> 1.472us
         %486 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %997 =  [] -> 1.344us
                 -->kernel: 0:7 %998 =  [] -> 1.856us
     %487 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %999 =  [] -> 1.408us
     %488 = :aten::index [[8], [8]] -> 42.048us
       %489 = :aten::nonzero [[8]] -> 42.048us
         %490 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %1000 =  [] -> 1.536us
         %491 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %1001 =  [] -> 1.312us
                 -->kernel: 0:7 %1002 =  [] -> 1.856us
     %492 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %1003 =  [] -> 1.376us
     %493 = :aten::index [[8], [8]] -> 43.136us
       %494 = :aten::nonzero [[8]] -> 43.136us
         %495 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %1004 =  [] -> 1.472us
         %496 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %1005 =  [] -> 1.344us
                 -->kernel: 0:7 %1006 =  [] -> 1.856us
     %497 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %1007 =  [] -> 1.408us
     %498 = :aten::index [[8], [8]] -> 42.272us
       %499 = :aten::nonzero [[8]] -> 42.272us
         %500 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %1008 =  [] -> 1.536us
         %501 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %1009 =  [] -> 1.344us
                 -->kernel: 0:7 %1010 =  [] -> 1.920us
     %502 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %1011 =  [] -> 1.408us
     %503 = :aten::index [[8], [8]] -> 41.888us
       %504 = :aten::nonzero [[8]] -> 41.888us
         %505 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %1012 =  [] -> 1.504us
         %506 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %1013 =  [] -> 1.376us
                 -->kernel: 0:7 %1014 =  [] -> 1.888us
     %507 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %1015 =  [] -> 1.408us
     %508 = :aten::index [[8], [8]] -> 41.888us
       %509 = :aten::nonzero [[8]] -> 41.888us
         %510 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %1016 =  [] -> 1.504us
         %511 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %1017 =  [] -> 1.312us
                 -->kernel: 0:7 %1018 =  [] -> 1.888us
     %512 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %1019 =  [] -> 1.440us
     %513 = :aten::index [[8], [8]] -> 41.760us
       %514 = :aten::nonzero [[8]] -> 41.760us
         %515 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %1020 =  [] -> 1.504us
         %516 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %1021 =  [] -> 1.376us
                 -->kernel: 0:7 %1022 =  [] -> 1.888us
     %517 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %1023 =  [] -> 1.440us
     %518 = :aten::index [[8], [8]] -> 42.496us
       %519 = :aten::nonzero [[8]] -> 42.496us
         %520 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %1024 =  [] -> 1.504us
         %521 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %1025 =  [] -> 1.312us
                 -->kernel: 0:7 %1026 =  [] -> 1.888us
     %522 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %1027 =  [] -> 1.440us
     %523 = :aten::index [[8], [8]] -> 41.856us
       %524 = :aten::nonzero [[8]] -> 41.856us
         %525 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %1028 =  [] -> 1.504us
         %526 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %1029 =  [] -> 1.376us
                 -->kernel: 0:7 %1030 =  [] -> 1.856us
     %527 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %1031 =  [] -> 1.408us
     %528 = :aten::index [[8], [8]] -> 46.880us
       %529 = :aten::nonzero [[8]] -> 46.880us
         %530 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %1032 =  [] -> 1.504us
         %531 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %1033 =  [] -> 1.344us
                 -->kernel: 0:7 %1034 =  [] -> 1.856us
     %532 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %1035 =  [] -> 1.408us
     %533 = :aten::index [[8], [8]] -> 42.816us
       %534 = :aten::nonzero [[8]] -> 42.816us
         %535 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %1036 =  [] -> 1.472us
         %536 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %1037 =  [] -> 1.344us
                 -->kernel: 0:7 %1038 =  [] -> 1.856us
     %537 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %1039 =  [] -> 1.408us
     %538 = :aten::index [[8], [8]] -> 44.224us
       %539 = :aten::nonzero [[8]] -> 44.224us
         %540 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %1040 =  [] -> 1.504us
         %541 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %1041 =  [] -> 1.312us
                 -->kernel: 0:7 %1042 =  [] -> 1.888us
     %542 = :aten::zeros [[], [], [], [], []] -> 1.024us
       %543 = :aten::zero_ [[8, 24]] -> 1.024us
         %544 = :aten::fill_ [[8, 24], []] -> 1.024us
                 -->kernel: 0:7 %1043 =  [] -> 1.024us
     %545 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.744us
       %546 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.744us
         %547 = :nccl:_all_gather_base [[24]] -> 7.744us
           %548 = NCCL:ncclAllGather [] -> 7.744us
                 -->kernel: 0:7 %1044 =  [] -> 7.744us
     %549 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %1045 =  [] -> 1.824us
     %550 = :aten::index [[8], [8]] -> 47.488us
       %551 = :aten::nonzero [[8]] -> 47.488us
         %552 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1046 =  [] -> 1.312us
         %553 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %1047 =  [] -> 1.024us
                 -->kernel: 0:7 %1048 =  [] -> 2.208us
     %554 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %1049 =  [] -> 1.760us
     %555 = :aten::index [[8], [8]] -> 43.584us
       %556 = :aten::nonzero [[8]] -> 43.584us
         %557 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %1050 =  [] -> 1.280us
         %558 = CCCL:cub::DeviceSelect::Flagged [] -> 12.288us
                 -->kernel: 0:7 %1051 =  [] -> 1.088us
                 -->kernel: 0:7 %1052 =  [] -> 2.112us
     %559 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %1053 =  [] -> 1.792us
     %560 = :aten::index [[8], [8]] -> 43.424us
       %561 = :aten::nonzero [[8]] -> 43.424us
         %562 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %1054 =  [] -> 1.280us
         %563 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %1055 =  [] -> 1.024us
                 -->kernel: 0:7 %1056 =  [] -> 2.176us
     %564 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %1057 =  [] -> 1.760us
     %565 = :aten::index [[8], [8]] -> 46.752us
       %566 = :aten::nonzero [[8]] -> 46.752us
         %567 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1058 =  [] -> 1.312us
         %568 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %1059 =  [] -> 1.056us
                 -->kernel: 0:7 %1060 =  [] -> 2.112us
     %569 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %1061 =  [] -> 1.792us
     %570 = :aten::index [[8], [8]] -> 41.696us
       %571 = :aten::nonzero [[8]] -> 41.696us
         %572 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %1062 =  [] -> 1.280us
         %573 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %1063 =  [] -> 992.000ns
                 -->kernel: 0:7 %1064 =  [] -> 2.144us
     %574 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %1065 =  [] -> 1.792us
     %575 = :aten::index [[8], [8]] -> 42.016us
       %576 = :aten::nonzero [[8]] -> 42.016us
         %577 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1066 =  [] -> 1.312us
         %578 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %1067 =  [] -> 1.056us
                 -->kernel: 0:7 %1068 =  [] -> 2.144us
     %579 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %1069 =  [] -> 1.792us
     %580 = :aten::index [[8], [8]] -> 42.369us
       %581 = :aten::nonzero [[8]] -> 42.369us
         %582 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1070 =  [] -> 1.312us
         %583 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %1071 =  [] -> 1.024us
                 -->kernel: 0:7 %1072 =  [] -> 2.144us
     %584 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %1073 =  [] -> 1.760us
     %585 = :aten::index [[8], [8]] -> 42.880us
       %586 = :aten::nonzero [[8]] -> 42.880us
         %587 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %1074 =  [] -> 1.280us
         %588 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %1075 =  [] -> 1.024us
                 -->kernel: 0:7 %1076 =  [] -> 2.080us
     %589 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %1077 =  [] -> 1.760us
     %590 = :aten::index [[8], [8]] -> 42.240us
       %591 = :aten::nonzero [[8]] -> 42.240us
         %592 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1078 =  [] -> 1.312us
         %593 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %1079 =  [] -> 1.024us
                 -->kernel: 0:7 %1080 =  [] -> 2.176us
     %594 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %1081 =  [] -> 1.760us
     %595 = :aten::index [[8], [8]] -> 42.336us
       %596 = :aten::nonzero [[8]] -> 42.336us
         %597 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1082 =  [] -> 1.312us
         %598 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %1083 =  [] -> 1.056us
                 -->kernel: 0:7 %1084 =  [] -> 2.144us
     %599 = :aten::gt [[8], []] -> 1.856us
                 -->kernel: 0:7 %1085 =  [] -> 1.856us
     %600 = :aten::index [[8], [8]] -> 41.216us
       %601 = :aten::nonzero [[8]] -> 41.216us
         %602 = CCCL:cub::DeviceReduce::Sum [] -> 1.344us
                 -->kernel: 0:7 %1086 =  [] -> 1.344us
         %603 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %1087 =  [] -> 1.056us
                 -->kernel: 0:7 %1088 =  [] -> 2.208us
     %604 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %1089 =  [] -> 1.792us
     %605 = :aten::index [[8], [8]] -> 42.560us
       %606 = :aten::nonzero [[8]] -> 42.560us
         %607 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1090 =  [] -> 1.312us
         %608 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %1091 =  [] -> 1.088us
                 -->kernel: 0:7 %1092 =  [] -> 2.176us
     %609 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %1093 =  [] -> 1.824us
     %610 = :aten::index [[8], [8]] -> 42.208us
       %611 = :aten::nonzero [[8]] -> 42.208us
         %612 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1094 =  [] -> 1.312us
         %613 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %1095 =  [] -> 1.056us
                 -->kernel: 0:7 %1096 =  [] -> 2.208us
     %614 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %1097 =  [] -> 1.792us
     %615 = :aten::index [[8], [8]] -> 41.921us
       %616 = :aten::nonzero [[8]] -> 41.921us
         %617 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1098 =  [] -> 1.312us
         %618 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %1099 =  [] -> 1.056us
                 -->kernel: 0:7 %1100 =  [] -> 2.144us
     %619 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %1101 =  [] -> 1.824us
     %620 = :aten::index [[8], [8]] -> 41.600us
       %621 = :aten::nonzero [[8]] -> 41.600us
         %622 = CCCL:cub::DeviceReduce::Sum [] -> 1.344us
                 -->kernel: 0:7 %1102 =  [] -> 1.344us
         %623 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %1103 =  [] -> 1.056us
                 -->kernel: 0:7 %1104 =  [] -> 2.176us
     %624 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %1105 =  [] -> 1.792us
     %625 = :aten::index [[8], [8]] -> 45.120us
       %626 = :aten::nonzero [[8]] -> 45.120us
         %627 = CCCL:cub::DeviceReduce::Sum [] -> 1.344us
                 -->kernel: 0:7 %1106 =  [] -> 1.344us
         %628 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %1107 =  [] -> 1.088us
                 -->kernel: 0:7 %1108 =  [] -> 2.176us
     %629 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %1109 =  [] -> 1.824us
     %630 = :aten::index [[8], [8]] -> 41.952us
       %631 = :aten::nonzero [[8]] -> 41.952us
         %632 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %1110 =  [] -> 1.216us
         %633 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %1111 =  [] -> 992.000ns
                 -->kernel: 0:7 %1112 =  [] -> 2.112us
     %634 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %1113 =  [] -> 1.696us
     %635 = :aten::index [[8], [8]] -> 42.848us
       %636 = :aten::nonzero [[8]] -> 42.848us
         %637 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %1114 =  [] -> 1.248us
         %638 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %1115 =  [] -> 992.000ns
                 -->kernel: 0:7 %1116 =  [] -> 2.080us
     %639 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %1117 =  [] -> 1.728us
     %640 = :aten::index [[8], [8]] -> 42.304us
       %641 = :aten::nonzero [[8]] -> 42.304us
         %642 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %1118 =  [] -> 1.216us
         %643 = CCCL:cub::DeviceSelect::Flagged [] -> 11.616us
                 -->kernel: 0:7 %1119 =  [] -> 992.000ns
                 -->kernel: 0:7 %1120 =  [] -> 2.112us
     %644 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %1121 =  [] -> 1.728us
     %645 = :aten::index [[8], [8]] -> 41.600us
       %646 = :aten::nonzero [[8]] -> 41.600us
         %647 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %1122 =  [] -> 1.248us
         %648 = CCCL:cub::DeviceSelect::Flagged [] -> 11.584us
                 -->kernel: 0:7 %1123 =  [] -> 992.000ns
                 -->kernel: 0:7 %1124 =  [] -> 2.080us
     %649 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %1125 =  [] -> 1.728us
     %650 = :aten::index [[8], [8]] -> 41.120us
       %651 = :aten::nonzero [[8]] -> 41.120us
         %652 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %1126 =  [] -> 1.216us
         %653 = CCCL:cub::DeviceSelect::Flagged [] -> 11.584us
                 -->kernel: 0:7 %1127 =  [] -> 960.000ns
                 -->kernel: 0:7 %1128 =  [] -> 2.112us
     %654 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %1129 =  [] -> 1.728us
     %655 = :aten::index [[8], [8]] -> 41.920us
       %656 = :aten::nonzero [[8]] -> 41.920us
         %657 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %1130 =  [] -> 1.248us
         %658 = CCCL:cub::DeviceSelect::Flagged [] -> 11.680us
                 -->kernel: 0:7 %1131 =  [] -> 992.000ns
                 -->kernel: 0:7 %1132 =  [] -> 2.048us
     %659 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %1133 =  [] -> 1.760us
     %660 = :aten::index [[8], [8]] -> 40.896us
       %661 = :aten::nonzero [[8]] -> 40.896us
         %662 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %1134 =  [] -> 1.248us
         %663 = CCCL:cub::DeviceSelect::Flagged [] -> 11.520us
                 -->kernel: 0:7 %1135 =  [] -> 960.000ns
                 -->kernel: 0:7 %1136 =  [] -> 2.112us
     %664 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %1137 =  [] -> 1.728us
     %665 = :aten::index [[8], [8]] -> 41.600us
       %666 = :aten::nonzero [[8]] -> 41.600us
         %667 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %1138 =  [] -> 1.216us
         %668 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %1139 =  [] -> 992.000ns
                 -->kernel: 0:7 %1140 =  [] -> 2.048us
     %669 = :aten::zero_ [[3002413056]] -> 1.801ms
       %670 = :aten::fill_ [[3002413056], []] -> 1.801ms
                 -->kernel: 0:7 %1141 =  [] -> 441.409us
                 -->kernel: 0:7 %1142 =  [] -> 441.505us
                 -->kernel: 0:7 %1143 =  [] -> 441.505us
                 -->kernel: 0:7 %1144 =  [] -> 441.473us
     %671 = :aten::zero_ [[352321536]] -> 207.872us
       %672 = :aten::fill_ [[352321536], []] -> 207.872us
                 -->kernel: 0:7 %1145 =  [] -> 207.872us
     %673 = :aten::zeros [[], [], [], [], []] -> 1.088us
       %674 = :aten::zero_ [[]] -> 1.088us
         %675 = :aten::fill_ [[], []] -> 1.088us
                 -->kernel: 0:7 %1146 =  [] -> 1.088us
     %676 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.264us
       %677 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.264us
         %678 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.264us
     %679 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.296us
       %680 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.296us
         %681 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.296us
     %682 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 1.472us
       %683 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 1.472us
         %684 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.472us
     %685 = :aten::to [[1, 1, 4096, 4096], [], [], [], [], [], [], []] -> 293.920us
       %686 = :aten::_to_copy [[1, 1, 4096, 4096], [], [], [], [], [], []] -> 293.920us
         %687 = :aten::copy_ [[1, 1, 4096, 4096], [1, 1, 4096, 4096], []] -> 293.920us
     %688 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.168us
       %689 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.168us
         %690 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.168us
     %691 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 271.424us
       %692 = :aten::index_select [[129280, 7168], [], [4096]] -> 271.424us
                 -->kernel: 0:7 %1147 =  [] -> 271.424us
     %693 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 128.064us
       %694 = :nvte_rmsnorm_fwd [] -> 128.064us
                 -->kernel: 0:7 %1148 =  [] -> 128.064us
     %695 = :TELinear forward [] -> 658.657us
       %696 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 658.657us
         %697 = :nvte_quantize_v2 [] -> 73.088us
           %698 = :quantize_transpose_vector_blockwise [] -> 73.088us
                 -->kernel: 0:7 %1149 =  [] -> 73.088us
         %699 = :nvte_quantize_v2 [] -> 20.352us
           %700 = :quantize_transpose_square_blockwise [] -> 20.352us
                 -->kernel: 0:7 %1150 =  [] -> 20.352us
         %701 = :nvte_cublas_gemm_scaled [] -> 337.345us
                 -->kernel: 0:7 %1151 =  [] -> 328.417us
     %702 = :TELinear forward [] -> 409.441us
       %703 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 409.441us
         %704 = :nvte_quantize_v2 [] -> 72.672us
           %705 = :quantize_transpose_vector_blockwise [] -> 72.672us
                 -->kernel: 0:7 %1152 =  [] -> 72.672us
         %706 = :nvte_quantize_v2 [] -> 11.712us
           %707 = :quantize_transpose_square_blockwise [] -> 11.712us
                 -->kernel: 0:7 %1153 =  [] -> 11.712us
         %708 = :nvte_cublas_gemm_scaled [] -> 203.553us
                 -->kernel: 0:7 %1154 =  [] -> 197.153us
     %709 = :TELayerNormColumnParallelLinear forward [] -> 1.380ms
       %710 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.380ms
         %711 = :nvte_rmsnorm_fwd [] -> 30.400us
                 -->kernel: 0:7 %1155 =  [] -> 30.400us
         %712 = :nvte_quantize_v2 [] -> 16.960us
           %713 = :quantize_transpose_vector_blockwise [] -> 16.960us
                 -->kernel: 0:7 %1156 =  [] -> 16.960us
         %714 = :nvte_quantize_v2 [] -> 58.080us
           %715 = :quantize_transpose_square_blockwise [] -> 58.080us
                 -->kernel: 0:7 %1157 =  [] -> 58.080us
         %716 = :nvte_cublas_gemm_scaled [] -> 1.134ms
                 -->kernel: 0:7 %1158 =  [] -> 1.128ms
     %717 = :TELayerNormColumnParallelLinear forward [] -> 897.186us
       %718 = :aten::contiguous [[4096, 1, 512], []] -> 11.616us
         %719 = :aten::clone [[4096, 1, 512], []] -> 11.616us
           %720 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.616us
                 -->kernel: 0:7 %1159 =  [] -> 11.616us
       %721 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 694.721us
         %722 = :nvte_rmsnorm_fwd [] -> 4.192us
                 -->kernel: 0:7 %1160 =  [] -> 4.192us
         %723 = :nvte_quantize_v2 [] -> 7.680us
           %724 = :quantize_transpose_vector_blockwise [] -> 7.680us
                 -->kernel: 0:7 %1161 =  [] -> 7.680us
         %725 = :nvte_quantize_v2 [] -> 28.032us
           %726 = :quantize_transpose_square_blockwise [] -> 28.032us
                 -->kernel: 0:7 %1162 =  [] -> 28.032us
         %727 = :nvte_cublas_gemm_scaled [] -> 523.681us
                 -->kernel: 0:7 %1163 =  [] -> 517.601us
     %728 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.624us
                 -->kernel: 0:7 %1164 =  [] -> 114.624us
     %729 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 172.704us
                 -->kernel: 0:7 %1165 =  [] -> 172.704us
     %730 = :TEDotProductAttention forward [] -> 22.475ms
       %731 = :aten::arange [[], [], [], [], []] -> 1.184us
         %732 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %1166 =  [] -> 1.184us
       %733 = :aten::arange [[], [], [], [], []] -> 1.312us
         %734 = :aten::arange [[], [], [], [0]] -> 1.312us
                 -->kernel: 0:7 %1167 =  [] -> 1.312us
       %735 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 60.800us
                 -->kernel: 0:7 %1168 =  [] -> 60.800us
       %736 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 39.872us
                 -->kernel: 0:7 %1169 =  [] -> 39.872us
       %737 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.208us
                 -->kernel: 0:7 %1170 =  [] -> 38.208us
       %738 = :aten::le [[1, 1, 4096, 4096], []] -> 28.128us
                 -->kernel: 0:7 %1171 =  [] -> 28.128us
       %739 = :aten::lt [[1, 1, 4096, 4096], []] -> 26.048us
                 -->kernel: 0:7 %1172 =  [] -> 26.048us
       %740 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.240us
                 -->kernel: 0:7 %1173 =  [] -> 14.240us
       %741 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.456us
         %742 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.456us
                 -->kernel: 0:7 %1174 =  [] -> 19.456us
       %743 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.864us
         %744 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.864us
                 -->kernel: 0:7 %1175 =  [] -> 12.864us
       %745 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.432us
         %746 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.432us
                 -->kernel: 0:7 %1176 =  [] -> 18.432us
       %747 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.817ms
                 -->kernel: 0:7 %1177 =  [] -> 5.807ms
       %748 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 10.999ms
         %749 = :nvte_scaled_masked_softmax_forward [] -> 10.999ms
                 -->kernel: 0:7 %1178 =  [] -> 10.999ms
       %750 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.991ms
                 -->kernel: 0:7 %1179 =  [] -> 3.974ms
       %751 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.976us
         %752 = :aten::clone [[4096, 1, 128, 128], []] -> 278.976us
           %753 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.976us
                 -->kernel: 0:7 %1180 =  [] -> 278.976us
     %754 = :TERowParallelLinear forward [] -> 3.847ms
       %755 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.847ms
         %756 = :nvte_quantize_v2 [] -> 97.088us
           %757 = :quantize_transpose_vector_blockwise [] -> 97.088us
                 -->kernel: 0:7 %1181 =  [] -> 97.088us
         %758 = :nvte_quantize_v2 [] -> 169.921us
           %759 = :quantize_transpose_square_blockwise [] -> 169.921us
                 -->kernel: 0:7 %1182 =  [] -> 169.921us
         %760 = :nvte_cublas_gemm_scaled [] -> 3.428ms
                 -->kernel: 0:7 %1183 =  [] -> 3.421ms
     %761 = :Torch-Compiled Region: 1/2 None -> 45.025us
       %762 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 45.025us
         %763 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 45.025us
                 -->kernel: 0:7 %1184 =  [] -> 45.025us
     %764 = :TELayerNormColumnParallelLinear forward [] -> 8.449ms
       %765 = :_LayerNormLinear [[4096, 1, 7168], [7168], [], [36864, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 8.449ms
         %766 = :nvte_rmsnorm_fwd [] -> 126.145us
                 -->kernel: 0:7 %1185 =  [] -> 126.145us
         %767 = :nvte_quantize_v2 [] -> 73.888us
           %768 = :quantize_transpose_vector_blockwise [] -> 73.888us
                 -->kernel: 0:7 %1186 =  [] -> 73.888us
         %769 = :nvte_quantize_v2 [] -> 388.225us
           %770 = :quantize_transpose_square_blockwise [] -> 388.225us
                 -->kernel: 0:7 %1187 =  [] -> 388.225us
         %771 = :nvte_cublas_gemm_scaled [] -> 7.703ms
                 -->kernel: 0:7 %1188 =  [] -> 7.697ms
     %772 = :SwiGLUFunction [[4096, 36864], [], []] -> 129.952us
       %773 = :Torch-Compiled Region: 2/0 None -> 129.952us
         %774 = :triton_poi_fused_mul_silu_0 [[4096, 36864], [4096, 18432], [], []] -> 129.952us
                 -->kernel: 0:7 %1189 =  [] -> 129.952us
     %775 = :TERowParallelLinear forward [] -> 4.374ms
       %776 = :_Linear [[7168, 18432], [4096, 1, 18432], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 4.374ms
         %777 = :nvte_quantize_v2 [] -> 183.520us
           %778 = :quantize_transpose_vector_blockwise [] -> 183.520us
                 -->kernel: 0:7 %1190 =  [] -> 183.520us
         %779 = :nvte_quantize_v2 [] -> 193.633us
           %780 = :quantize_transpose_square_blockwise [] -> 193.633us
                 -->kernel: 0:7 %1191 =  [] -> 193.633us
         %781 = :nvte_cublas_gemm_scaled [] -> 3.854ms
                 -->kernel: 0:7 %1192 =  [] -> 3.847ms
     %782 = :Torch-Compiled Region: 1/2 None -> 44.768us
       %783 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.768us
         %784 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.768us
                 -->kernel: 0:7 %1193 =  [] -> 44.768us
     %785 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.656us
       %786 = :nvte_rmsnorm_fwd [] -> 126.656us
                 -->kernel: 0:7 %1194 =  [] -> 126.656us
     %787 = :TELinear forward [] -> 558.049us
       %788 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 558.049us
         %789 = :nvte_quantize_v2 [] -> 73.920us
           %790 = :quantize_transpose_vector_blockwise [] -> 73.920us
                 -->kernel: 0:7 %1195 =  [] -> 73.920us
         %791 = :nvte_quantize_v2 [] -> 20.928us
           %792 = :quantize_transpose_square_blockwise [] -> 20.928us
                 -->kernel: 0:7 %1196 =  [] -> 20.928us
         %793 = :nvte_cublas_gemm_scaled [] -> 334.464us
                 -->kernel: 0:7 %1197 =  [] -> 328.000us
     %794 = :TELinear forward [] -> 402.465us
       %795 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 402.465us
         %796 = :nvte_quantize_v2 [] -> 72.928us
           %797 = :quantize_transpose_vector_blockwise [] -> 72.928us
                 -->kernel: 0:7 %1198 =  [] -> 72.928us
         %798 = :nvte_quantize_v2 [] -> 11.456us
           %799 = :quantize_transpose_square_blockwise [] -> 11.456us
                 -->kernel: 0:7 %1199 =  [] -> 11.456us
         %800 = :nvte_cublas_gemm_scaled [] -> 203.457us
                 -->kernel: 0:7 %1200 =  [] -> 197.217us
     %801 = :TELayerNormColumnParallelLinear forward [] -> 1.370ms
       %802 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.370ms
         %803 = :nvte_rmsnorm_fwd [] -> 30.688us
                 -->kernel: 0:7 %1201 =  [] -> 30.688us
         %804 = :nvte_quantize_v2 [] -> 16.896us
           %805 = :quantize_transpose_vector_blockwise [] -> 16.896us
                 -->kernel: 0:7 %1202 =  [] -> 16.896us
         %806 = :nvte_quantize_v2 [] -> 57.792us
           %807 = :quantize_transpose_square_blockwise [] -> 57.792us
                 -->kernel: 0:7 %1203 =  [] -> 57.792us
         %808 = :nvte_cublas_gemm_scaled [] -> 1.130ms
                 -->kernel: 0:7 %1204 =  [] -> 1.124ms
     %809 = :TELayerNormColumnParallelLinear forward [] -> 899.298us
       %810 = :aten::contiguous [[4096, 1, 512], []] -> 11.648us
         %811 = :aten::clone [[4096, 1, 512], []] -> 11.648us
           %812 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.648us
                 -->kernel: 0:7 %1205 =  [] -> 11.648us
       %813 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 696.833us
         %814 = :nvte_rmsnorm_fwd [] -> 4.192us
                 -->kernel: 0:7 %1206 =  [] -> 4.192us
         %815 = :nvte_quantize_v2 [] -> 7.648us
           %816 = :quantize_transpose_vector_blockwise [] -> 7.648us
                 -->kernel: 0:7 %1207 =  [] -> 7.648us
         %817 = :nvte_quantize_v2 [] -> 28.672us
           %818 = :quantize_transpose_square_blockwise [] -> 28.672us
                 -->kernel: 0:7 %1208 =  [] -> 28.672us
         %819 = :nvte_cublas_gemm_scaled [] -> 521.697us
                 -->kernel: 0:7 %1209 =  [] -> 515.553us
     %820 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 113.984us
                 -->kernel: 0:7 %1210 =  [] -> 113.984us
     %821 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 172.545us
                 -->kernel: 0:7 %1211 =  [] -> 172.545us
     %822 = :TEDotProductAttention forward [] -> 22.403ms
       %823 = :aten::arange [[], [], [], [], []] -> 1.184us
         %824 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %1212 =  [] -> 1.184us
       %825 = :aten::arange [[], [], [], [], []] -> 1.152us
         %826 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %1213 =  [] -> 1.152us
       %827 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 61.056us
                 -->kernel: 0:7 %1214 =  [] -> 61.056us
       %828 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 38.848us
                 -->kernel: 0:7 %1215 =  [] -> 38.848us
       %829 = :aten::add [[1, 1, 4096, 4096], [], []] -> 39.168us
                 -->kernel: 0:7 %1216 =  [] -> 39.168us
       %830 = :aten::le [[1, 1, 4096, 4096], []] -> 28.288us
                 -->kernel: 0:7 %1217 =  [] -> 28.288us
       %831 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.736us
                 -->kernel: 0:7 %1218 =  [] -> 24.736us
       %832 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.304us
                 -->kernel: 0:7 %1219 =  [] -> 14.304us
       %833 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.104us
         %834 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.104us
                 -->kernel: 0:7 %1220 =  [] -> 19.104us
       %835 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.960us
         %836 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.960us
                 -->kernel: 0:7 %1221 =  [] -> 12.960us
       %837 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.112us
         %838 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.112us
                 -->kernel: 0:7 %1222 =  [] -> 18.112us
       %839 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.813ms
                 -->kernel: 0:7 %1223 =  [] -> 5.805ms
       %840 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.003ms
         %841 = :nvte_scaled_masked_softmax_forward [] -> 11.003ms
                 -->kernel: 0:7 %1224 =  [] -> 11.003ms
       %842 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.981ms
                 -->kernel: 0:7 %1225 =  [] -> 3.969ms
       %843 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.817us
         %844 = :aten::clone [[4096, 1, 128, 128], []] -> 278.817us
           %845 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.817us
                 -->kernel: 0:7 %1226 =  [] -> 278.817us
     %846 = :TERowParallelLinear forward [] -> 3.838ms
       %847 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.838ms
         %848 = :nvte_quantize_v2 [] -> 96.736us
           %849 = :quantize_transpose_vector_blockwise [] -> 96.736us
                 -->kernel: 0:7 %1227 =  [] -> 96.736us
         %850 = :nvte_quantize_v2 [] -> 168.832us
           %851 = :quantize_transpose_square_blockwise [] -> 168.832us
                 -->kernel: 0:7 %1228 =  [] -> 168.832us
         %852 = :nvte_cublas_gemm_scaled [] -> 3.428ms
                 -->kernel: 0:7 %1229 =  [] -> 3.421ms
     %853 = :Torch-Compiled Region: 1/2 None -> 44.064us
       %854 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.064us
         %855 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.064us
                 -->kernel: 0:7 %1230 =  [] -> 44.064us
     %856 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.464us
       %857 = :nvte_rmsnorm_fwd [] -> 126.464us
                 -->kernel: 0:7 %1231 =  [] -> 126.464us
     %858 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 42.880us
       %859 = :nvte_cublas_gemm_scaled [] -> 42.880us
                 -->kernel: 0:7 %1232 =  [] -> 22.208us
                 -->kernel: 0:7 %1233 =  [] -> 2.656us
     %860 = :RandomSTE [[4096, 1, 32]] -> 47.200us
       %861 = :aten::clone [[4096, 1, 32], []] -> 1.568us
         %862 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.568us
       %863 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.672us
                 -->kernel: 0:7 %1234 =  [] -> 4.672us
     %864 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 69.952us
       %865 = :nvte_fused_topk_with_score_function_forward [] -> 69.952us
                 -->kernel: 0:7 %1235 =  [] -> 69.952us
     %866 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 27.200us
       %867 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 27.200us
                 -->kernel: 0:7 %1236 =  [] -> 27.200us
     %868 = :aten::sum [[4096, 32], [], [], []] -> 46.656us
       %869 = :aten::to [[4096, 32], [], [], [], []] -> 4.672us
         %870 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.672us
           %871 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.672us
                 -->kernel: 0:7 %1237 =  [] -> 4.672us
                 -->kernel: 0:7 %1238 =  [] -> 9.824us
     %872 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.288us
       %873 = :nvte_fused_moe_aux_loss_forward [] -> 12.288us
                 -->kernel: 0:7 %1239 =  [] -> 12.288us
     %874 = :aten::div [[], []] -> 1.248us
                 -->kernel: 0:7 %1240 =  [] -> 1.248us
     %875 = :aten::div [[], []] -> 1.184us
                 -->kernel: 0:7 %1241 =  [] -> 1.184us
     %876 = :aten::add_ [[], [], []] -> 1.344us
                 -->kernel: 0:7 %1242 =  [] -> 1.344us
     %877 = :aten::sum [[4096, 32], [], [], []] -> 37.537us
       %878 = :aten::to [[4096, 32], [], [], [], []] -> 4.896us
         %879 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.896us
           %880 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.896us
                 -->kernel: 0:7 %1243 =  [] -> 4.896us
                 -->kernel: 0:7 %1244 =  [] -> 7.713us
     %881 = :aten::add_ [[32], [32], []] -> 4.192us
                 -->kernel: 0:7 %1245 =  [] -> 4.192us
     %882 = :aten::topk [[4096, 32], [], [], [], []] -> 54.880us
                 -->kernel: 0:7 %1246 =  [] -> 14.240us
                 -->kernel: 0:7 %1247 =  [] -> 7.776us
     %883 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 1.274ms
                 -->kernel: 0:26 %1248 =  [] -> 43.520us
                 -->kernel: 0:26 %1249 =  [] -> 372.161us
                 -->kernel: 0:26 %1250 =  [] -> 732.417us
     %884 = :TEColumnParallelLinear forward [] -> 1.141ms
       %885 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.141ms
         %886 = :nvte_quantize_v2 [] -> 45.504us
           %887 = :quantize_transpose_vector_blockwise [] -> 45.504us
                 -->kernel: 0:7 %1251 =  [] -> 45.504us
         %888 = :nvte_quantize_v2 [] -> 45.120us
           %889 = :quantize_transpose_square_blockwise [] -> 45.120us
                 -->kernel: 0:7 %1252 =  [] -> 45.120us
         %890 = :nvte_cublas_gemm_scaled [] -> 916.354us
                 -->kernel: 0:7 %1253 =  [] -> 909.794us
     %891 = :SwiGLUFunction [[4096, 4096], [], []] -> 27.457us
       %892 = :Torch-Compiled Region: 2/1 None -> 27.457us
         %893 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 27.457us
                 -->kernel: 0:7 %1254 =  [] -> 27.457us
     %894 = :TERowParallelLinear forward [] -> 608.193us
       %895 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 608.193us
         %896 = :nvte_quantize_v2 [] -> 23.104us
           %897 = :quantize_transpose_vector_blockwise [] -> 23.104us
                 -->kernel: 0:7 %1255 =  [] -> 23.104us
         %898 = :nvte_quantize_v2 [] -> 24.416us
           %899 = :quantize_transpose_square_blockwise [] -> 24.416us
                 -->kernel: 0:7 %1256 =  [] -> 24.416us
         %900 = :nvte_cublas_gemm_scaled [] -> 444.225us
                 -->kernel: 0:7 %1257 =  [] -> 438.209us
     %901 = :IndicesToMultihot [[15641, 8], [15641, 8], []] -> 11.168us
                 -->kernel: 0:7 %1258 =  [] -> 11.168us
     %902 = :aten::contiguous [[4, 15641], []] -> 3.008us
       %903 = :aten::clone [[4, 15641], []] -> 3.008us
         %904 = :aten::copy_ [[4, 15641], [4, 15641], []] -> 3.008us
                 -->kernel: 0:7 %1259 =  [] -> 3.008us
     %905 = :aten::to [[4, 15641], [], [], [], []] -> 4.960us
       %906 = :aten::_to_copy [[4, 15641], [], [], [], [], [], []] -> 4.960us
         %907 = :aten::copy_ [[4, 15641], [4, 15641], []] -> 4.960us
                 -->kernel: 0:7 %1260 =  [] -> 4.960us
                 -->kernel: 0:7 %1261 =  [] -> 23.104us
     %908 = :_moe_permute_mask_map [[15641, 7168], [15641, 4], [], [15641, 4]] -> 397.697us
                 -->kernel: 0:7 %1262 =  [] -> 2.240us
                 -->kernel: 0:7 %1263 =  [] -> 2.560us
                 -->kernel: 0:7 %1264 =  [] -> 13.152us
                 -->kernel: 0:7 %1265 =  [] -> 199.104us
     %909 = :TEColumnParallelGroupedLinear forward [] -> 8.413ms
       %910 = :_GroupedLinear [[32384, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.413ms
         %911 = :nvte_quantize_v2 [] -> 218.176us
           %912 = :quantize_transpose_vector_blockwise [] -> 218.176us
                 -->kernel: 0:7 %1266 =  [] -> 218.176us
         %913 = :nvte_quantize_v2 [] -> 220.321us
           %914 = :quantize_transpose_vector_blockwise [] -> 220.321us
                 -->kernel: 0:7 %1267 =  [] -> 220.321us
         %915 = :nvte_quantize_v2 [] -> 219.104us
           %916 = :quantize_transpose_vector_blockwise [] -> 219.104us
                 -->kernel: 0:7 %1268 =  [] -> 219.104us
         %917 = :nvte_quantize_v2 [] -> 218.369us
           %918 = :quantize_transpose_vector_blockwise [] -> 218.369us
                 -->kernel: 0:7 %1269 =  [] -> 218.369us
         %919 = :nvte_quantize_v2 [] -> 46.208us
           %920 = :quantize_transpose_square_blockwise [] -> 46.208us
                 -->kernel: 0:7 %1270 =  [] -> 46.208us
         %921 = :nvte_quantize_v2 [] -> 45.632us
           %922 = :quantize_transpose_square_blockwise [] -> 45.632us
                 -->kernel: 0:7 %1271 =  [] -> 45.632us
         %923 = :nvte_quantize_v2 [] -> 46.593us
           %924 = :quantize_transpose_square_blockwise [] -> 46.593us
                 -->kernel: 0:7 %1272 =  [] -> 46.593us
         %925 = :nvte_quantize_v2 [] -> 46.016us
           %926 = :quantize_transpose_square_blockwise [] -> 46.016us
                 -->kernel: 0:7 %1273 =  [] -> 46.016us
         %927 = :nvte_multi_stream_cublas_gemm [] -> 7.045ms
           %928 = :nvte_cublas_gemm [] -> 1.706ms
                 -->kernel: 0:159 %1274 =  [] -> 1.697ms
           %929 = :nvte_cublas_gemm [] -> 1.758ms
                 -->kernel: 0:160 %1275 =  [] -> 1.752ms
           %930 = :nvte_cublas_gemm [] -> 1.756ms
                 -->kernel: 0:161 %1276 =  [] -> 1.752ms
           %931 = :nvte_cublas_gemm [] -> 1.758ms
                 -->kernel: 0:162 %1277 =  [] -> 1.753ms
     %932 = :WeightedSwiGLUFunction [[32384, 4096], [32384, 1], []] -> 119.712us
       %933 = :Torch-Compiled Region: 3/1 None -> 119.712us
         %934 = :triton_poi_fused__to_copy_mul_silu_0 [[32384, 4096], [32384, 1], [32384, 2048], [], []] -> 119.712us
                 -->kernel: 0:7 %1278 =  [] -> 119.712us
     %935 = :TERowParallelGroupedLinear forward [] -> 4.214ms
       %936 = :_GroupedLinear [[32384, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.214ms
         %937 = :nvte_quantize_v2 [] -> 66.209us
           %938 = :quantize_transpose_vector_blockwise [] -> 66.209us
                 -->kernel: 0:7 %1279 =  [] -> 66.209us
         %939 = :nvte_quantize_v2 [] -> 68.800us
           %940 = :quantize_transpose_vector_blockwise [] -> 68.800us
                 -->kernel: 0:7 %1280 =  [] -> 68.800us
         %941 = :nvte_quantize_v2 [] -> 67.520us
           %942 = :quantize_transpose_vector_blockwise [] -> 67.520us
                 -->kernel: 0:7 %1281 =  [] -> 67.520us
         %943 = :nvte_quantize_v2 [] -> 67.904us
           %944 = :quantize_transpose_vector_blockwise [] -> 67.904us
                 -->kernel: 0:7 %1282 =  [] -> 67.904us
         %945 = :nvte_quantize_v2 [] -> 24.416us
           %946 = :quantize_transpose_square_blockwise [] -> 24.416us
                 -->kernel: 0:7 %1283 =  [] -> 24.416us
         %947 = :nvte_quantize_v2 [] -> 24.352us
           %948 = :quantize_transpose_square_blockwise [] -> 24.352us
                 -->kernel: 0:7 %1284 =  [] -> 24.352us
         %949 = :nvte_quantize_v2 [] -> 24.576us
           %950 = :quantize_transpose_square_blockwise [] -> 24.576us
                 -->kernel: 0:7 %1285 =  [] -> 24.576us
         %951 = :nvte_quantize_v2 [] -> 24.672us
           %952 = :quantize_transpose_square_blockwise [] -> 24.672us
                 -->kernel: 0:7 %1286 =  [] -> 24.672us
         %953 = :nvte_multi_stream_cublas_gemm [] -> 3.562ms
           %954 = :nvte_cublas_gemm [] -> 870.562us
                 -->kernel: 0:159 %1287 =  [] -> 863.106us
           %955 = :nvte_cublas_gemm [] -> 877.602us
                 -->kernel: 0:160 %1288 =  [] -> 873.090us
           %956 = :nvte_cublas_gemm [] -> 876.290us
                 -->kernel: 0:161 %1289 =  [] -> 872.674us
           %957 = :nvte_cublas_gemm [] -> 876.514us
                 -->kernel: 0:162 %1290 =  [] -> 873.058us
     %958 = :_moe_unpermute_mask_map [[32384, 7168], [15641, 9], [], []] -> 224.192us
                 -->kernel: 0:7 %1291 =  [] -> 224.192us
     %959 = :FusedCombine [[15641, 7168], [], []] -> 746.082us
                 -->kernel: 0:26 %1292 =  [] -> 13.984us
                 -->kernel: 0:26 %1293 =  [] -> 702.466us
     %960 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.384us
                 -->kernel: 0:7 %1294 =  [] -> 52.384us
     %961 = :Torch-Compiled Region: 1/2 None -> 47.776us
       %962 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 47.776us
         %963 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 47.776us
                 -->kernel: 0:7 %1295 =  [] -> 47.776us
     %964 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 125.984us
       %965 = :nvte_rmsnorm_fwd [] -> 125.984us
                 -->kernel: 0:7 %1296 =  [] -> 125.984us
     %966 = :aten::roll [[1, 4096], [], []] -> 2.208us
                 -->kernel: 0:7 %1297 =  [] -> 2.208us
     %967 = :aten::fill_ [[1], []] -> 1.024us
                 -->kernel: 0:7 %1298 =  [] -> 1.024us
     %968 = :aten::sum [[1, 4096], []] -> 3.264us
       %969 = :aten::sum [[1, 4096], [], [], []] -> 3.264us
                 -->kernel: 0:7 %1299 =  [] -> 3.264us
     %970 = :aten::roll [[1, 4096], [], []] -> 2.304us
                 -->kernel: 0:7 %1300 =  [] -> 2.304us
     %971 = :aten::fill_ [[1], []] -> 1.248us
                 -->kernel: 0:7 %1301 =  [] -> 1.248us
     %972 = :aten::sum [[1, 4096], []] -> 3.008us
       %973 = :aten::sum [[1, 4096], [], [], []] -> 3.008us
                 -->kernel: 0:7 %1302 =  [] -> 3.008us
     %974 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 276.608us
       %975 = :aten::index_select [[129280, 7168], [], [4096]] -> 276.608us
                 -->kernel: 0:7 %1303 =  [] -> 276.608us
     %976 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 128.769us
       %977 = :nvte_rmsnorm_fwd [] -> 128.769us
                 -->kernel: 0:7 %1304 =  [] -> 128.769us
     %978 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.560us
       %979 = :nvte_rmsnorm_fwd [] -> 126.560us
                 -->kernel: 0:7 %1305 =  [] -> 126.560us
     %980 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 163.776us
                 -->kernel: 0:7 %1306 =  [] -> 163.776us
     %981 = :TEColumnParallelLinear forward [] -> 3.445ms
       %982 = :_Linear [[7168, 14336], [4096, 1, 14336], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.445ms
         %983 = :nvte_quantize_v2 [] -> 145.505us
           %984 = :quantize_transpose_vector_blockwise [] -> 145.505us
                 -->kernel: 0:7 %1307 =  [] -> 145.505us
         %985 = :nvte_quantize_v2 [] -> 153.888us
           %986 = :quantize_transpose_square_blockwise [] -> 153.888us
                 -->kernel: 0:7 %1308 =  [] -> 153.888us
         %987 = :nvte_cublas_gemm_scaled [] -> 3.019ms
                 -->kernel: 0:7 %1309 =  [] -> 3.012ms
     %988 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 121.184us
       %989 = :nvte_rmsnorm_fwd [] -> 121.184us
                 -->kernel: 0:7 %1310 =  [] -> 121.184us
     %990 = :TELinear forward [] -> 563.361us
       %991 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 563.361us
         %992 = :nvte_quantize_v2 [] -> 73.280us
           %993 = :quantize_transpose_vector_blockwise [] -> 73.280us
                 -->kernel: 0:7 %1311 =  [] -> 73.280us
         %994 = :nvte_quantize_v2 [] -> 20.032us
           %995 = :quantize_transpose_square_blockwise [] -> 20.032us
                 -->kernel: 0:7 %1312 =  [] -> 20.032us
         %996 = :nvte_cublas_gemm_scaled [] -> 336.897us
                 -->kernel: 0:7 %1313 =  [] -> 329.505us
     %997 = :TELinear forward [] -> 397.664us
       %998 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 397.664us
         %999 = :nvte_quantize_v2 [] -> 73.248us
           %1000 = :quantize_transpose_vector_blockwise [] -> 73.248us
                 -->kernel: 0:7 %1314 =  [] -> 73.248us
         %1001 = :nvte_quantize_v2 [] -> 11.584us
           %1002 = :quantize_transpose_square_blockwise [] -> 11.584us
                 -->kernel: 0:7 %1315 =  [] -> 11.584us
         %1003 = :nvte_cublas_gemm_scaled [] -> 203.424us
                 -->kernel: 0:7 %1316 =  [] -> 197.152us
     %1004 = :TELayerNormColumnParallelLinear forward [] -> 1.377ms
       %1005 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.377ms
         %1006 = :nvte_rmsnorm_fwd [] -> 30.176us
                 -->kernel: 0:7 %1317 =  [] -> 30.176us
         %1007 = :nvte_quantize_v2 [] -> 17.184us
           %1008 = :quantize_transpose_vector_blockwise [] -> 17.184us
                 -->kernel: 0:7 %1318 =  [] -> 17.184us
         %1009 = :nvte_quantize_v2 [] -> 58.913us
           %1010 = :quantize_transpose_square_blockwise [] -> 58.913us
                 -->kernel: 0:7 %1319 =  [] -> 58.913us
         %1011 = :nvte_cublas_gemm_scaled [] -> 1.138ms
                 -->kernel: 0:7 %1320 =  [] -> 1.132ms
     %1012 = :TELayerNormColumnParallelLinear forward [] -> 892.546us
       %1013 = :aten::contiguous [[4096, 1, 512], []] -> 11.584us
         %1014 = :aten::clone [[4096, 1, 512], []] -> 11.584us
           %1015 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.584us
                 -->kernel: 0:7 %1321 =  [] -> 11.584us
       %1016 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 694.466us
         %1017 = :nvte_rmsnorm_fwd [] -> 4.288us
                 -->kernel: 0:7 %1322 =  [] -> 4.288us
         %1018 = :nvte_quantize_v2 [] -> 7.808us
           %1019 = :quantize_transpose_vector_blockwise [] -> 7.808us
                 -->kernel: 0:7 %1323 =  [] -> 7.808us
         %1020 = :nvte_quantize_v2 [] -> 28.544us
           %1021 = :quantize_transpose_square_blockwise [] -> 28.544us
                 -->kernel: 0:7 %1324 =  [] -> 28.544us
         %1022 = :nvte_cublas_gemm_scaled [] -> 525.185us
                 -->kernel: 0:7 %1325 =  [] -> 519.073us
     %1023 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.881us
                 -->kernel: 0:7 %1326 =  [] -> 114.881us
     %1024 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 173.857us
                 -->kernel: 0:7 %1327 =  [] -> 173.857us
     %1025 = :TEDotProductAttention forward [] -> 22.381ms
       %1026 = :aten::arange [[], [], [], [], []] -> 1.184us
         %1027 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %1328 =  [] -> 1.184us
       %1028 = :aten::arange [[], [], [], [], []] -> 1.152us
         %1029 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %1329 =  [] -> 1.152us
       %1030 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 61.697us
                 -->kernel: 0:7 %1330 =  [] -> 61.697us
       %1031 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 38.976us
                 -->kernel: 0:7 %1331 =  [] -> 38.976us
       %1032 = :aten::add [[1, 1, 4096, 4096], [], []] -> 39.264us
                 -->kernel: 0:7 %1332 =  [] -> 39.264us
       %1033 = :aten::le [[1, 1, 4096, 4096], []] -> 28.032us
                 -->kernel: 0:7 %1333 =  [] -> 28.032us
       %1034 = :aten::lt [[1, 1, 4096, 4096], []] -> 25.184us
                 -->kernel: 0:7 %1334 =  [] -> 25.184us
       %1035 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.400us
                 -->kernel: 0:7 %1335 =  [] -> 14.400us
       %1036 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.232us
         %1037 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.232us
                 -->kernel: 0:7 %1336 =  [] -> 19.232us
       %1038 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.992us
         %1039 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.992us
                 -->kernel: 0:7 %1337 =  [] -> 12.992us
       %1040 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.400us
         %1041 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.400us
                 -->kernel: 0:7 %1338 =  [] -> 18.400us
       %1042 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.838ms
                 -->kernel: 0:7 %1339 =  [] -> 5.830ms
       %1043 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.003ms
         %1044 = :nvte_scaled_masked_softmax_forward [] -> 11.003ms
                 -->kernel: 0:7 %1340 =  [] -> 11.003ms
       %1045 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.993ms
                 -->kernel: 0:7 %1341 =  [] -> 3.980ms
       %1046 = :aten::contiguous [[4096, 1, 128, 128], []] -> 279.489us
         %1047 = :aten::clone [[4096, 1, 128, 128], []] -> 279.489us
           %1048 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 279.489us
                 -->kernel: 0:7 %1342 =  [] -> 279.489us
     %1049 = :TERowParallelLinear forward [] -> 3.855ms
       %1050 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.855ms
         %1051 = :nvte_quantize_v2 [] -> 97.217us
           %1052 = :quantize_transpose_vector_blockwise [] -> 97.217us
                 -->kernel: 0:7 %1343 =  [] -> 97.217us
         %1053 = :nvte_quantize_v2 [] -> 171.872us
           %1054 = :quantize_transpose_square_blockwise [] -> 171.872us
                 -->kernel: 0:7 %1344 =  [] -> 171.872us
         %1055 = :nvte_cublas_gemm_scaled [] -> 3.436ms
                 -->kernel: 0:7 %1345 =  [] -> 3.429ms
     %1056 = :Torch-Compiled Region: 1/2 None -> 44.960us
       %1057 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.960us
         %1058 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.960us
                 -->kernel: 0:7 %1346 =  [] -> 44.960us
     %1059 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.689us
       %1060 = :nvte_rmsnorm_fwd [] -> 126.689us
                 -->kernel: 0:7 %1347 =  [] -> 126.689us
     %1061 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 42.176us
       %1062 = :nvte_cublas_gemm_scaled [] -> 42.176us
                 -->kernel: 0:7 %1348 =  [] -> 22.336us
                 -->kernel: 0:7 %1349 =  [] -> 2.592us
     %1063 = :RandomSTE [[4096, 1, 32]] -> 41.088us
       %1064 = :aten::clone [[4096, 1, 32], []] -> 1.600us
         %1065 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.600us
       %1066 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.864us
                 -->kernel: 0:7 %1350 =  [] -> 4.864us
     %1067 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 69.856us
       %1068 = :nvte_fused_topk_with_score_function_forward [] -> 69.856us
                 -->kernel: 0:7 %1351 =  [] -> 69.856us
     %1069 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 27.232us
       %1070 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 27.232us
                 -->kernel: 0:7 %1352 =  [] -> 27.232us
     %1071 = :aten::sum [[4096, 32], [], [], []] -> 45.440us
       %1072 = :aten::to [[4096, 32], [], [], [], []] -> 4.928us
         %1073 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.928us
           %1074 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.928us
                 -->kernel: 0:7 %1353 =  [] -> 4.928us
                 -->kernel: 0:7 %1354 =  [] -> 10.048us
     %1075 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.513us
       %1076 = :nvte_fused_moe_aux_loss_forward [] -> 12.513us
                 -->kernel: 0:7 %1355 =  [] -> 12.513us
     %1077 = :aten::div [[], []] -> 1.600us
                 -->kernel: 0:7 %1356 =  [] -> 1.600us
     %1078 = :aten::div [[], []] -> 1.280us
                 -->kernel: 0:7 %1357 =  [] -> 1.280us
     %1079 = :aten::add_ [[], [], []] -> 1.408us
                 -->kernel: 0:7 %1358 =  [] -> 1.408us
     %1080 = :aten::sum [[4096, 32], [], [], []] -> 37.248us
       %1081 = :aten::to [[4096, 32], [], [], [], []] -> 4.768us
         %1082 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.768us
           %1083 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.768us
                 -->kernel: 0:7 %1359 =  [] -> 4.768us
                 -->kernel: 0:7 %1360 =  [] -> 7.712us
     %1084 = :aten::add_ [[32], [32], []] -> 4.384us
                 -->kernel: 0:7 %1361 =  [] -> 4.384us
     %1085 = :aten::topk [[4096, 32], [], [], [], []] -> 51.200us
                 -->kernel: 0:7 %1362 =  [] -> 13.984us
                 -->kernel: 0:7 %1363 =  [] -> 7.776us
     %1086 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 850.210us
                 -->kernel: 0:26 %1364 =  [] -> 44.064us
                 -->kernel: 0:26 %1365 =  [] -> 12.640us
                 -->kernel: 0:26 %1366 =  [] -> 670.817us
     %1087 = :TEColumnParallelLinear forward [] -> 1.166ms
       %1088 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.166ms
         %1089 = :nvte_quantize_v2 [] -> 46.048us
           %1090 = :quantize_transpose_vector_blockwise [] -> 46.048us
                 -->kernel: 0:7 %1367 =  [] -> 46.048us
         %1091 = :nvte_quantize_v2 [] -> 44.832us
           %1092 = :quantize_transpose_square_blockwise [] -> 44.832us
                 -->kernel: 0:7 %1368 =  [] -> 44.832us
         %1093 = :nvte_cublas_gemm_scaled [] -> 921.954us
                 -->kernel: 0:7 %1369 =  [] -> 915.298us
     %1094 = :SwiGLUFunction [[4096, 4096], [], []] -> 27.552us
       %1095 = :Torch-Compiled Region: 2/1 None -> 27.552us
         %1096 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 27.552us
                 -->kernel: 0:7 %1370 =  [] -> 27.552us
     %1097 = :TERowParallelLinear forward [] -> 610.978us
       %1098 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 610.978us
         %1099 = :nvte_quantize_v2 [] -> 23.264us
           %1100 = :quantize_transpose_vector_blockwise [] -> 23.264us
                 -->kernel: 0:7 %1371 =  [] -> 23.264us
         %1101 = :nvte_quantize_v2 [] -> 24.448us
           %1102 = :quantize_transpose_square_blockwise [] -> 24.448us
                 -->kernel: 0:7 %1372 =  [] -> 24.448us
         %1103 = :nvte_cublas_gemm_scaled [] -> 446.657us
                 -->kernel: 0:7 %1373 =  [] -> 440.641us
     %1104 = :IndicesToMultihot [[15831, 8], [15831, 8], []] -> 11.360us
                 -->kernel: 0:7 %1374 =  [] -> 11.360us
     %1105 = :aten::contiguous [[4, 15831], []] -> 3.008us
       %1106 = :aten::clone [[4, 15831], []] -> 3.008us
         %1107 = :aten::copy_ [[4, 15831], [4, 15831], []] -> 3.008us
                 -->kernel: 0:7 %1375 =  [] -> 3.008us
     %1108 = :aten::to [[4, 15831], [], [], [], []] -> 5.120us
       %1109 = :aten::_to_copy [[4, 15831], [], [], [], [], [], []] -> 5.120us
         %1110 = :aten::copy_ [[4, 15831], [4, 15831], []] -> 5.120us
                 -->kernel: 0:7 %1376 =  [] -> 5.120us
                 -->kernel: 0:7 %1377 =  [] -> 22.784us
     %1111 = :_moe_permute_mask_map [[15831, 7168], [15831, 4], [], [15831, 4]] -> 400.960us
                 -->kernel: 0:7 %1378 =  [] -> 1.984us
                 -->kernel: 0:7 %1379 =  [] -> 2.528us
                 -->kernel: 0:7 %1380 =  [] -> 13.504us
                 -->kernel: 0:7 %1381 =  [] -> 201.792us
     %1112 = :TEColumnParallelGroupedLinear forward [] -> 8.480ms
       %1113 = :_GroupedLinear [[32880, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.480ms
         %1114 = :nvte_quantize_v2 [] -> 224.193us
           %1115 = :quantize_transpose_vector_blockwise [] -> 224.193us
                 -->kernel: 0:7 %1382 =  [] -> 224.193us
         %1116 = :nvte_quantize_v2 [] -> 226.688us
           %1117 = :quantize_transpose_vector_blockwise [] -> 226.688us
                 -->kernel: 0:7 %1383 =  [] -> 226.688us
         %1118 = :nvte_quantize_v2 [] -> 219.873us
           %1119 = :quantize_transpose_vector_blockwise [] -> 219.873us
                 -->kernel: 0:7 %1384 =  [] -> 219.873us
         %1120 = :nvte_quantize_v2 [] -> 216.288us
           %1121 = :quantize_transpose_vector_blockwise [] -> 216.288us
                 -->kernel: 0:7 %1385 =  [] -> 216.288us
         %1122 = :nvte_quantize_v2 [] -> 45.472us
           %1123 = :quantize_transpose_square_blockwise [] -> 45.472us
                 -->kernel: 0:7 %1386 =  [] -> 45.472us
         %1124 = :nvte_quantize_v2 [] -> 45.344us
           %1125 = :quantize_transpose_square_blockwise [] -> 45.344us
                 -->kernel: 0:7 %1387 =  [] -> 45.344us
         %1126 = :nvte_quantize_v2 [] -> 45.984us
           %1127 = :quantize_transpose_square_blockwise [] -> 45.984us
                 -->kernel: 0:7 %1388 =  [] -> 45.984us
         %1128 = :nvte_quantize_v2 [] -> 46.112us
           %1129 = :quantize_transpose_square_blockwise [] -> 46.112us
                 -->kernel: 0:7 %1389 =  [] -> 46.112us
         %1130 = :nvte_multi_stream_cublas_gemm [] -> 7.110ms
           %1131 = :nvte_cublas_gemm [] -> 1.768ms
                 -->kernel: 0:159 %1390 =  [] -> 1.760ms
           %1132 = :nvte_cublas_gemm [] -> 1.817ms
                 -->kernel: 0:160 %1391 =  [] -> 1.812ms
           %1133 = :nvte_cublas_gemm [] -> 1.758ms
                 -->kernel: 0:161 %1392 =  [] -> 1.753ms
           %1134 = :nvte_cublas_gemm [] -> 1.701ms
                 -->kernel: 0:162 %1393 =  [] -> 1.697ms
     %1135 = :WeightedSwiGLUFunction [[32880, 4096], [32880, 1], []] -> 120.768us
       %1136 = :Torch-Compiled Region: 3/1 None -> 120.768us
         %1137 = :triton_poi_fused__to_copy_mul_silu_0 [[32880, 4096], [32880, 1], [32880, 2048], [], []] -> 120.768us
                 -->kernel: 0:7 %1394 =  [] -> 120.768us
     %1138 = :TERowParallelGroupedLinear forward [] -> 4.251ms
       %1139 = :_GroupedLinear [[32880, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.251ms
         %1140 = :nvte_quantize_v2 [] -> 68.096us
           %1141 = :quantize_transpose_vector_blockwise [] -> 68.096us
                 -->kernel: 0:7 %1395 =  [] -> 68.096us
         %1142 = :nvte_quantize_v2 [] -> 69.280us
           %1143 = :quantize_transpose_vector_blockwise [] -> 69.280us
                 -->kernel: 0:7 %1396 =  [] -> 69.280us
         %1144 = :nvte_quantize_v2 [] -> 68.480us
           %1145 = :quantize_transpose_vector_blockwise [] -> 68.480us
                 -->kernel: 0:7 %1397 =  [] -> 68.480us
         %1146 = :nvte_quantize_v2 [] -> 66.688us
           %1147 = :quantize_transpose_vector_blockwise [] -> 66.688us
                 -->kernel: 0:7 %1398 =  [] -> 66.688us
         %1148 = :nvte_quantize_v2 [] -> 23.936us
           %1149 = :quantize_transpose_square_blockwise [] -> 23.936us
                 -->kernel: 0:7 %1399 =  [] -> 23.936us
         %1150 = :nvte_quantize_v2 [] -> 24.896us
           %1151 = :quantize_transpose_square_blockwise [] -> 24.896us
                 -->kernel: 0:7 %1400 =  [] -> 24.896us
         %1152 = :nvte_quantize_v2 [] -> 24.992us
           %1153 = :quantize_transpose_square_blockwise [] -> 24.992us
                 -->kernel: 0:7 %1401 =  [] -> 24.992us
         %1154 = :nvte_quantize_v2 [] -> 24.192us
           %1155 = :quantize_transpose_square_blockwise [] -> 24.192us
                 -->kernel: 0:7 %1402 =  [] -> 24.192us
         %1156 = :nvte_multi_stream_cublas_gemm [] -> 3.601ms
           %1157 = :nvte_cublas_gemm [] -> 893.314us
                 -->kernel: 0:159 %1403 =  [] -> 886.210us
           %1158 = :nvte_cublas_gemm [] -> 903.778us
                 -->kernel: 0:160 %1404 =  [] -> 899.874us
           %1159 = :nvte_cublas_gemm [] -> 877.218us
                 -->kernel: 0:161 %1405 =  [] -> 872.866us
           %1160 = :nvte_cublas_gemm [] -> 865.090us
                 -->kernel: 0:162 %1406 =  [] -> 860.866us
     %1161 = :_moe_unpermute_mask_map [[32880, 7168], [15831, 9], [], []] -> 227.104us
                 -->kernel: 0:7 %1407 =  [] -> 227.104us
     %1162 = :FusedCombine [[15831, 7168], [], []] -> 734.849us
                 -->kernel: 0:26 %1408 =  [] -> 13.920us
                 -->kernel: 0:26 %1409 =  [] -> 694.017us
     %1163 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.224us
                 -->kernel: 0:7 %1410 =  [] -> 52.224us
     %1164 = :Torch-Compiled Region: 1/2 None -> 47.904us
       %1165 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 47.904us
         %1166 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 47.904us
                 -->kernel: 0:7 %1411 =  [] -> 47.904us
     %1167 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.816us
       %1168 = :nvte_rmsnorm_fwd [] -> 126.816us
                 -->kernel: 0:7 %1412 =  [] -> 126.816us
     %1169 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 164.609us
                 -->kernel: 0:7 %1413 =  [] -> 164.609us
     %1170 = :aten::clone [[1, 4096], []] -> 1.568us
       %1171 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.568us
     %1172 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.833ms
       %1173 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.833ms
         %1174 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.833ms
                 -->kernel: 0:7 %1414 =  [] -> 53.823ms
     %1175 = :aten::roll [[1, 4096], [], []] -> 2.240us
                 -->kernel: 0:7 %1415 =  [] -> 2.240us
     %1176 = :aten::fill_ [[1], []] -> 1.280us
                 -->kernel: 0:7 %1416 =  [] -> 1.280us
     %1177 = :aten::sum [[1, 4096], []] -> 3.232us
       %1178 = :aten::sum [[1, 4096], [], [], []] -> 3.232us
                 -->kernel: 0:7 %1417 =  [] -> 3.232us
     %1179 = :aten::roll [[1, 4096], [], []] -> 2.048us
                 -->kernel: 0:7 %1418 =  [] -> 2.048us
     %1180 = :aten::fill_ [[1], []] -> 1.280us
                 -->kernel: 0:7 %1419 =  [] -> 1.280us
     %1181 = :aten::sum [[1, 4096], []] -> 3.488us
       %1182 = :aten::sum [[1, 4096], [], [], []] -> 3.488us
                 -->kernel: 0:7 %1420 =  [] -> 3.488us
     %1183 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.478ms
       %1184 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %1185 = :aten::zero_ [[4096]] -> 1.120us
           %1186 = :aten::fill_ [[4096], []] -> 1.120us
                 -->kernel: 0:7 %1421 =  [] -> 1.120us
       %1187 = :aten::zeros [[], [], [], [], []] -> 1.216us
         %1188 = :aten::zero_ [[12288]] -> 1.216us
           %1189 = :aten::fill_ [[12288], []] -> 1.216us
                 -->kernel: 0:7 %1422 =  [] -> 1.216us
                 -->kernel: 0:7 %1423 =  [] -> 658.658us
                 -->kernel: 0:7 %1424 =  [] -> 601.281us
     %1190 = :aten::mul [[1, 4096], [1, 4096]] -> 1.600us
                 -->kernel: 0:7 %1425 =  [] -> 1.600us
     %1191 = :aten::sum [[1, 4096], []] -> 2.848us
       %1192 = :aten::sum [[1, 4096], [], [], []] -> 2.848us
                 -->kernel: 0:7 %1426 =  [] -> 2.848us
     %1193 = :aten::div [[], []] -> 1.920us
                 -->kernel: 0:7 %1427 =  [] -> 1.920us
     %1194 = :aten::add_ [[], [], []] -> 1.664us
                 -->kernel: 0:7 %1428 =  [] -> 1.664us
     %1195 = :aten::mul [[1, 4096], []] -> 1.280us
                 -->kernel: 0:7 %1429 =  [] -> 1.280us
     %1196 = :aten::div [[1, 4096], []] -> 2.304us
                 -->kernel: 0:7 %1430 =  [] -> 2.304us
     %1197 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.550ms
       %1198 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.550ms
         %1199 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.550ms
                 -->kernel: 0:7 %1431 =  [] -> 53.539ms
     %1200 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.486ms
       %1201 = :aten::zeros [[], [], [], [], []] -> 1.152us
         %1202 = :aten::zero_ [[4096]] -> 1.152us
           %1203 = :aten::fill_ [[4096], []] -> 1.152us
                 -->kernel: 0:7 %1432 =  [] -> 1.152us
       %1204 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %1205 = :aten::zero_ [[12288]] -> 1.120us
           %1206 = :aten::fill_ [[12288], []] -> 1.120us
                 -->kernel: 0:7 %1433 =  [] -> 1.120us
                 -->kernel: 0:7 %1434 =  [] -> 661.793us
                 -->kernel: 0:7 %1435 =  [] -> 599.234us
     %1207 = :aten::mul [[4096], [4096]] -> 1.792us
                 -->kernel: 0:7 %1436 =  [] -> 1.792us
     %1208 = :aten::sum [[4096], []] -> 3.040us
       %1209 = :aten::sum [[4096], [], [], []] -> 3.040us
                 -->kernel: 0:7 %1437 =  [] -> 3.040us
     %1210 = :aten::sum [[4096], []] -> 2.816us
       %1211 = :aten::sum [[4096], [], [], []] -> 2.816us
                 -->kernel: 0:7 %1438 =  [] -> 2.816us
     %1212 = :aten::stack [[], [], []] -> 2.400us
       %1213 = :aten::cat [[1], [1], []] -> 2.400us
                 -->kernel: 0:7 %1439 =  [] -> 2.400us
     %1214 = :aten::isnan [[2]] -> 1.888us
       %1215 = :aten::ne [[2], [2]] -> 1.888us
                 -->kernel: 0:7 %1440 =  [] -> 1.888us
     %1216 = :aten::any [[2]] -> 2.592us
                 -->kernel: 0:7 %1441 =  [] -> 2.592us
     %1217 = :aten::is_nonzero [[]] -> 3.232us
       %1218 = :aten::item [[]] -> 3.232us
         %1219 = :aten::_local_scalar_dense [[]] -> 3.232us
     %1220 = :aten::clone [[], []] -> 1.184us
       %1221 = :aten::copy_ [[], [], []] -> 1.184us
     %1222 = :aten::clone [[], []] -> 1.376us
       %1223 = :aten::copy_ [[], [], []] -> 1.376us
     %1224 = :aten::cat [[1], [1], []] -> 2.112us
                 -->kernel: 0:7 %1442 =  [] -> 2.112us
     %1225 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 336.000us
       %1226 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 336.000us
         %1227 = :nccl:all_reduce [[2]] -> 336.000us
           %1228 = NCCL:ncclAllReduce [] -> 336.000us
                 -->kernel: 0:7 %1443 =  [] -> 336.000us
     %1229 = :aten::div [[2], []] -> 1.152us
                 -->kernel: 0:7 %1444 =  [] -> 1.152us
     %1230 = :aten::div [[], []] -> 1.504us
                 -->kernel: 0:7 %1445 =  [] -> 1.504us
     %1231 = :aten::mul [[], []] -> 1.344us
                 -->kernel: 0:7 %1446 =  [] -> 1.344us
     %1232 = :aten::mul_ [[], []] -> 1.120us
                 -->kernel: 0:7 %1447 =  [] -> 1.120us
     %1233 = :aten::div_ [[], []] -> 1.120us
                 -->kernel: 0:7 %1448 =  [] -> 1.120us
     %1234 = :aten::ones [[], [], [], [], []] -> 1.152us
       %1235 = :aten::fill_ [[1], []] -> 1.152us
                 -->kernel: 0:7 %1449 =  [] -> 1.152us
     %1236 = :aten::mul [[1], [1]] -> 1.632us
                 -->kernel: 0:7 %1450 =  [] -> 1.632us
     %1237 = :aten::div [[1], []] -> 1.152us
                 -->kernel: 0:7 %1451 =  [] -> 1.152us
     %1238 = :aten::copy_ [[1], [1], []] -> 1.024us
     %1239 = :aten::ones [[], [], [], [], []] -> 1.184us
       %1240 = :aten::fill_ [[1], []] -> 1.184us
                 -->kernel: 0:7 %1452 =  [] -> 1.184us
     %1241 = :aten::mul [[1], [1]] -> 1.312us
                 -->kernel: 0:7 %1453 =  [] -> 1.312us
     %1242 = :aten::div [[1], []] -> 1.280us
                 -->kernel: 0:7 %1454 =  [] -> 1.280us
     %1243 = :aten::add_ [[], [], []] -> 1.312us
                 -->kernel: 0:7 %1455 =  [] -> 1.312us
     %1244 = :aten::mul [[1], []] -> 1.344us
                 -->kernel: 0:7 %1456 =  [] -> 1.344us
     %1245 = :aten::ones_like [[1], [], [], [], [], []] -> 1.184us
       %1246 = :aten::fill_ [[1], []] -> 1.184us
                 -->kernel: 0:7 %1457 =  [] -> 1.184us
     %1247 = :autograd::engine::evaluate_function: MulBackward0 None -> 107.041us
       %1248 = :MulBackward0 [[1]] -> 1.408us
         %1249 = :aten::mul [[1], [1]] -> 1.408us
                 -->kernel: 0:7 %1458 =  [] -> 1.408us
       %1250 = :aten::sum [[1], []] -> 2.464us
         %1251 = :aten::sum [[1], [], [], []] -> 2.464us
                 -->kernel: 0:7 %1459 =  [] -> 2.464us
     %1252 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.504us
       %1253 = :DivBackward0 [[]] -> 1.504us
         %1254 = :aten::div [[], []] -> 1.504us
                 -->kernel: 0:7 %1460 =  [] -> 1.504us
     %1255 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.344us
       %1256 = :MulBackward0 [[]] -> 1.344us
         %1257 = :aten::mul [[], []] -> 1.344us
                 -->kernel: 0:7 %1461 =  [] -> 1.344us
     %1258 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.120us
       %1259 = :MulBackward0 [[]] -> 1.120us
         %1260 = :aten::mul [[], []] -> 1.120us
                 -->kernel: 0:7 %1462 =  [] -> 1.120us
     %1261 = :autograd::engine::evaluate_function: SelectBackward0 None -> 59.584us
       %1262 = :SelectBackward0 [[]] -> 59.584us
         %1263 = :aten::select_backward [[], [], [], []] -> 59.584us
           %1264 = :aten::zeros [[], [], [], [], []] -> 992.000ns
             %1265 = :aten::zero_ [[2]] -> 992.000ns
               %1266 = :aten::fill_ [[2], []] -> 992.000ns
                 -->kernel: 0:7 %1463 =  [] -> 992.000ns
           %1267 = :aten::copy_ [[], [], []] -> 1.216us
     %1268 = :autograd::engine::evaluate_function: MulBackward0 None -> 2.048us
       %1269 = :MulBackward0 [[4096]] -> 2.048us
         %1270 = :aten::mul [[4096], [4096]] -> 2.048us
                 -->kernel: 0:7 %1464 =  [] -> 2.048us
     %1271 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 765.250us
       %1272 = :CrossEntropyFunctionBackward [[4096, 1]] -> 765.250us
         %1273 = :aten::to [[], [], [], [], [], []] -> 800.000ns
           %1274 = :aten::_to_copy [[], [], [], [], [], [], []] -> 800.000ns
             %1275 = :aten::copy_ [[], [], []] -> 800.000ns
                 -->kernel: 0:7 %1465 =  [] -> 598.402us
     %1276 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 109.439ms
       %1277 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.439ms
         %1278 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.792ms
           %1279 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.792ms
                 -->kernel: 0:7 %1466 =  [] -> 55.779ms
                 -->kernel: 0:7 %1467 =  [] -> 53.401ms
     %1280 = :autograd::engine::evaluate_function: MTPLossAutoScalerBackward None -> 66.881us
       %1281 = :MTPLossAutoScalerBackward [[4096, 1, 7168]] -> 66.881us
         %1282 = :aten::ones_like [[1, 4096], [], [], [], [], []] -> 1.120us
           %1283 = :aten::fill_ [[1, 4096], []] -> 1.120us
                 -->kernel: 0:7 %1468 =  [] -> 1.120us
         %1284 = :aten::mul [[1, 4096], [1]] -> 2.176us
                 -->kernel: 0:7 %1469 =  [] -> 2.176us
     %1285 = :autograd::engine::evaluate_function: DivBackward0 None -> 2.208us
       %1286 = :DivBackward0 [[1, 4096]] -> 2.208us
         %1287 = :aten::div [[1, 4096], []] -> 2.208us
                 -->kernel: 0:7 %1470 =  [] -> 2.208us
     %1288 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.376us
       %1289 = :MulBackward0 [[1, 4096]] -> 1.376us
         %1290 = :aten::mul [[1, 4096], []] -> 1.376us
                 -->kernel: 0:7 %1471 =  [] -> 1.376us
     %1291 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.792us
       %1292 = :MulBackward0 [[1, 4096]] -> 1.792us
         %1293 = :aten::mul [[1, 4096], [1, 4096]] -> 1.792us
                 -->kernel: 0:7 %1472 =  [] -> 1.792us
     %1294 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 756.322us
       %1295 = :CrossEntropyFunctionBackward [[4096, 1]] -> 756.322us
         %1296 = :aten::to [[], [], [], [], [], []] -> 832.000ns
           %1297 = :aten::_to_copy [[], [], [], [], [], [], []] -> 832.000ns
             %1298 = :aten::copy_ [[], [], []] -> 832.000ns
                 -->kernel: 0:7 %1473 =  [] -> 592.993us
     %1299 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 110.670ms
       %1300 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.179ms
         %1301 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.600ms
           %1302 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.600ms
                 -->kernel: 0:7 %1474 =  [] -> 55.589ms
                 -->kernel: 0:7 %1475 =  [] -> 53.344ms
       %1303 = :aten::add [[129280, 7168], [129280, 7168], []] -> 1.158ms
                 -->kernel: 0:35 %1476 =  [] -> 1.158ms
     %1304 = :autograd::engine::evaluate_function: SplitBackward0 None -> 164.192us
       %1305 = :SplitBackward0 [[4096, 1, 7168], [4096, 1, 7168]] -> 164.192us
         %1306 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 164.192us
                 -->kernel: 0:7 %1477 =  [] -> 164.192us
     %1307 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 206.016us
       %1308 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 206.016us
         %1309 = :nvte_rmsnorm_bwd [] -> 206.016us
                 -->kernel: 0:7 %1478 =  [] -> 166.784us
                 -->kernel: 0:7 %1479 =  [] -> 7.616us
     %1310 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %1311 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %1480 =  [] -> 1.600us
     %1312 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 957.155us
       %1313 = :FusedCombineBackward [[4096, 7168], []] -> 957.155us
                 -->kernel: 0:26 %1481 =  [] -> 117.441us
                 -->kernel: 0:26 %1482 =  [] -> 779.202us
     %1314 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 200.545us
       %1315 = :_moe_unpermute_mask_mapBackward [[15831, 7168]] -> 200.545us
                 -->kernel: 0:7 %1483 =  [] -> 200.545us
     %1316 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.579ms
       %1317 = :_GroupedLinearBackward [[32880, 7168]] -> 8.579ms
         %1318 = :_GroupedLinear_backward [] -> 8.579ms
           %1319 = :nvte_quantize_v2 [] -> 224.097us
             %1320 = :quantize_transpose_vector_blockwise [] -> 224.097us
                 -->kernel: 0:7 %1484 =  [] -> 224.097us
           %1321 = :nvte_quantize_v2 [] -> 225.953us
             %1322 = :quantize_transpose_vector_blockwise [] -> 225.953us
                 -->kernel: 0:7 %1485 =  [] -> 225.953us
           %1323 = :nvte_quantize_v2 [] -> 219.392us
             %1324 = :quantize_transpose_vector_blockwise [] -> 219.392us
                 -->kernel: 0:7 %1486 =  [] -> 219.392us
           %1325 = :nvte_quantize_v2 [] -> 216.065us
             %1326 = :quantize_transpose_vector_blockwise [] -> 216.065us
                 -->kernel: 0:7 %1487 =  [] -> 216.065us
           %1327 = :nvte_multi_stream_cublas_gemm [] -> 3.669ms
             %1328 = :nvte_cublas_gemm [] -> 920.546us
                 -->kernel: 0:159 %1488 =  [] -> 908.802us
             %1329 = :nvte_cublas_gemm [] -> 916.738us
                 -->kernel: 0:160 %1489 =  [] -> 910.562us
             %1330 = :nvte_cublas_gemm [] -> 913.250us
                 -->kernel: 0:161 %1490 =  [] -> 907.106us
             %1331 = :nvte_cublas_gemm [] -> 852.226us
                 -->kernel: 0:162 %1491 =  [] -> 847.681us
           %1332 = :nvte_multi_stream_cublas_gemm [] -> 3.671ms
             %1333 = :nvte_cublas_gemm [] -> 913.698us
                 -->kernel: 0:159 %1492 =  [] -> 905.186us
             %1334 = :nvte_cublas_gemm [] -> 921.762us
                 -->kernel: 0:160 %1493 =  [] -> 918.402us
             %1335 = :nvte_cublas_gemm [] -> 894.978us
                 -->kernel: 0:161 %1494 =  [] -> 891.810us
             %1336 = :nvte_cublas_gemm [] -> 881.762us
                 -->kernel: 0:162 %1495 =  [] -> 877.442us
     %1337 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 598.081us
       %1338 = :WeightedSwiGLUFunctionBackward [[32880, 2048]] -> 598.081us
         %1339 = :Torch-Compiled Region: 4/1 None -> 598.081us
           %1340 = :triton_poi_fused__to_copy_cat_0 [[32880, 2048], [32880, 1], [32880, 4096], [32880, 4096], [], []] -> 403.392us
                 -->kernel: 0:7 %1496 =  [] -> 403.392us
           %1341 = :triton_red_fused__to_copy_mul_silu_sum_1 [[32880, 4096], [32880, 2048], [32880, 1], [], [], [], []] -> 130.592us
                 -->kernel: 0:7 %1497 =  [] -> 130.592us
     %1342 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.821ms
       %1343 = :_GroupedLinearBackward [[32880, 4096]] -> 14.821ms
         %1344 = :_GroupedLinear_backward [] -> 14.821ms
           %1345 = :nvte_quantize_v2 [] -> 128.385us
             %1346 = :quantize_transpose_vector_blockwise [] -> 128.385us
                 -->kernel: 0:7 %1498 =  [] -> 128.385us
           %1347 = :nvte_quantize_v2 [] -> 134.080us
             %1348 = :quantize_transpose_vector_blockwise [] -> 134.080us
                 -->kernel: 0:7 %1499 =  [] -> 134.080us
           %1349 = :nvte_quantize_v2 [] -> 130.880us
             %1350 = :quantize_transpose_vector_blockwise [] -> 130.880us
                 -->kernel: 0:7 %1500 =  [] -> 130.880us
           %1351 = :nvte_quantize_v2 [] -> 127.009us
             %1352 = :quantize_transpose_vector_blockwise [] -> 127.009us
                 -->kernel: 0:7 %1501 =  [] -> 127.009us
           %1353 = :nvte_multi_stream_cublas_gemm [] -> 7.046ms
             %1354 = :nvte_cublas_gemm [] -> 1.759ms
                 -->kernel: 0:159 %1502 =  [] -> 1.752ms
             %1355 = :nvte_cublas_gemm [] -> 1.785ms
                 -->kernel: 0:160 %1503 =  [] -> 1.781ms
             %1356 = :nvte_cublas_gemm [] -> 1.722ms
                 -->kernel: 0:161 %1504 =  [] -> 1.719ms
             %1357 = :nvte_cublas_gemm [] -> 1.712ms
                 -->kernel: 0:162 %1505 =  [] -> 1.705ms
           %1358 = :nvte_multi_stream_cublas_gemm [] -> 6.984ms
             %1359 = :nvte_cublas_gemm [] -> 1.746ms
                 -->kernel: 0:159 %1506 =  [] -> 1.737ms
             %1360 = :nvte_cublas_gemm [] -> 1.769ms
                 -->kernel: 0:160 %1507 =  [] -> 1.765ms
             %1361 = :nvte_cublas_gemm [] -> 1.716ms
                 -->kernel: 0:161 %1508 =  [] -> 1.712ms
             %1362 = :nvte_cublas_gemm [] -> 1.687ms
                 -->kernel: 0:162 %1509 =  [] -> 1.683ms
     %1363 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 391.393us
       %1364 = :_moe_permute_mask_mapBackward [[32880, 7168], [], [32880]] -> 391.393us
         %1365 = :aten::zeros [[], [], [], [], []] -> 1.472us
           %1366 = :aten::zero_ [[15831, 9]] -> 1.472us
             %1367 = :aten::fill_ [[15831, 9], []] -> 1.472us
                 -->kernel: 0:7 %1510 =  [] -> 1.472us
                 -->kernel: 0:7 %1511 =  [] -> 213.632us
     %1368 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 99.713us
       %1369 = :IndicesToMultihotBackward [[], [15831, 4]] -> 99.713us
         %1370 = :aten::zeros [[], [], [], [], []] -> 1.568us
           %1371 = :aten::zero_ [[15831, 4]] -> 1.568us
             %1372 = :aten::fill_ [[15831, 4], []] -> 1.568us
                 -->kernel: 0:7 %1512 =  [] -> 1.568us
                 -->kernel: 0:7 %1513 =  [] -> 11.424us
     %1373 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.184ms
       %1374 = :_LinearBackward [[4096, 1, 7168]] -> 1.184ms
         %1375 = :_Linear_backward [] -> 1.184ms
           %1376 = :nvte_quantize_v2 [] -> 74.016us
             %1377 = :quantize_transpose_vector_blockwise [] -> 74.016us
                 -->kernel: 0:7 %1514 =  [] -> 74.016us
           %1378 = :nvte_cublas_gemm_scaled [] -> 470.113us
                 -->kernel: 0:7 %1515 =  [] -> 459.809us
           %1379 = :nvte_cublas_gemm_scaled [] -> 456.161us
                 -->kernel: 0:7 %1516 =  [] -> 450.433us
     %1380 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 47.392us
       %1381 = :SwiGLUFunctionBackward [[4096, 2048]] -> 47.392us
         %1382 = :Torch-Compiled Region: 5/0 None -> 47.392us
           %1383 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 47.392us
                 -->kernel: 0:7 %1517 =  [] -> 47.392us
     %1384 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.018ms
       %1385 = :_LinearBackward [[4096, 1, 4096]] -> 2.018ms
         %1386 = :_Linear_backward [] -> 2.018ms
           %1387 = :nvte_quantize_v2 [] -> 44.960us
             %1388 = :quantize_transpose_vector_blockwise [] -> 44.960us
                 -->kernel: 0:7 %1518 =  [] -> 44.960us
           %1389 = :nvte_quantize_v2 [] -> 52.672us
             %1390 = :quantize_transpose_vector_blockwise [] -> 52.672us
                 -->kernel: 0:7 %1519 =  [] -> 52.672us
           %1391 = :nvte_cublas_gemm_scaled [] -> 870.402us
                 -->kernel: 0:7 %1520 =  [] -> 864.642us
           %1392 = :nvte_cublas_gemm_scaled [] -> 869.026us
                 -->kernel: 0:7 %1521 =  [] -> 863.841us
     %1393 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 890.338us
       %1394 = :FusedDispatchBackward [[15831, 7168], [], [15831, 8], [], []] -> 890.338us
         %1395 = :aten::zeros [[], [], [], [], []] -> 1.536us
           %1396 = :aten::zero_ [[15831, 8]] -> 1.536us
             %1397 = :aten::fill_ [[15831, 8], []] -> 1.536us
                 -->kernel: 0:7 %1522 =  [] -> 1.536us
                 -->kernel: 0:26 %1523 =  [] -> 13.952us
                 -->kernel: 0:26 %1524 =  [] -> 676.354us
     %1398 = :autograd::engine::evaluate_function: TopkBackward0 None -> 63.008us
       %1399 = :TopkBackward0 [[4096, 8]] -> 63.008us
         %1400 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 63.008us
           %1401 = :aten::zeros [[], [], [], [], []] -> 992.000ns
             %1402 = :aten::zero_ [[4096, 32]] -> 992.000ns
               %1403 = :aten::fill_ [[4096, 32], []] -> 992.000ns
                 -->kernel: 0:7 %1525 =  [] -> 992.000ns
           %1404 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 8.928us
                 -->kernel: 0:7 %1526 =  [] -> 8.928us
     %1405 = :autograd::engine::evaluate_function: ViewBackward0 None -> 53.056us
       %1406 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 53.056us
                 -->kernel: 0:7 %1527 =  [] -> 53.056us
     %1407 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 88.832us
       %1408 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 37.824us
         %1409 = :aten::ones_like [[], [], [], [], [], []] -> 1.024us
           %1410 = :aten::fill_ [[], []] -> 1.024us
                 -->kernel: 0:7 %1528 =  [] -> 1.024us
         %1411 = :aten::mul [[], [1]] -> 1.856us
                 -->kernel: 0:7 %1529 =  [] -> 1.856us
       %1412 = :aten::sum [[1], []] -> 2.880us
         %1413 = :aten::sum [[1], [], [], []] -> 2.880us
                 -->kernel: 0:7 %1530 =  [] -> 2.880us
     %1414 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.248us
       %1415 = :DivBackward0 [[]] -> 1.248us
         %1416 = :aten::div [[], []] -> 1.248us
                 -->kernel: 0:7 %1531 =  [] -> 1.248us
     %1417 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.240us
       %1418 = :FusedAuxLossBackward [[]] -> 2.240us
         %1419 = :nvte_fused_moe_aux_loss_backward [] -> 2.240us
                 -->kernel: 0:7 %1532 =  [] -> 2.240us
     %1420 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 62.977us
       %1421 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 62.977us
         %1422 = :aten::zeros [[], [], [], [], []] -> 1.216us
           %1423 = :aten::zero_ [[4096, 32]] -> 1.216us
             %1424 = :aten::fill_ [[4096, 32], []] -> 1.216us
                 -->kernel: 0:7 %1533 =  [] -> 1.216us
         %1425 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.928us
                 -->kernel: 0:7 %1534 =  [] -> 12.928us
     %1426 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 98.816us
       %1427 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 56.896us
         %1428 = :aten::zeros [[], [], [], [], []] -> 1.184us
           %1429 = :aten::zero_ [[4096, 32]] -> 1.184us
             %1430 = :aten::fill_ [[4096, 32], []] -> 1.184us
                 -->kernel: 0:7 %1535 =  [] -> 1.184us
         %1431 = :nvte_fused_topk_with_score_function_backward [] -> 13.664us
                 -->kernel: 0:7 %1536 =  [] -> 13.664us
       %1432 = :aten::add [[4096, 32], [4096, 32], []] -> 1.632us
                 -->kernel: 0:7 %1537 =  [] -> 1.632us
     %1433 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 802.082us
       %1434 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 703.938us
         %1435 = :aten::to [[32, 7168], [], [], [], []] -> 6.592us
           %1436 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.592us
             %1437 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.592us
                 -->kernel: 0:7 %1538 =  [] -> 6.592us
         %1438 = :nvte_cublas_gemm_scaled [] -> 84.160us
                 -->kernel: 0:7 %1539 =  [] -> 67.840us
         %1439 = :aten::to [[4096, 7168], [], [], [], []] -> 176.480us
           %1440 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 176.480us
             %1441 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 176.480us
                 -->kernel: 0:7 %1540 =  [] -> 176.480us
         %1442 = :nvte_cublas_gemm_scaled [] -> 82.689us
                 -->kernel: 0:7 %1541 =  [] -> 82.689us
         %1443 = :aten::to [[4096, 7168], [], [], [], []] -> 43.680us
           %1444 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.680us
             %1445 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.680us
                 -->kernel: 0:7 %1542 =  [] -> 43.680us
         %1446 = :aten::to [[32, 7168], [], [], [], []] -> 2.144us
           %1447 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.144us
             %1448 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.144us
                 -->kernel: 0:7 %1543 =  [] -> 2.144us
       %1449 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.720us
                 -->kernel: 0:7 %1544 =  [] -> 50.720us
     %1450 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.112us
       %1451 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.112us
                 -->kernel: 0:35 %1545 =  [] -> 2.112us
     %1452 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 319.488us
       %1453 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 196.192us
         %1454 = :nvte_rmsnorm_bwd [] -> 196.192us
                 -->kernel: 0:7 %1546 =  [] -> 166.368us
                 -->kernel: 0:7 %1547 =  [] -> 7.968us
       %1455 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.232us
                 -->kernel: 0:7 %1548 =  [] -> 51.232us
     %1456 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.728us
       %1457 = :aten::add_ [[7168], [7168], []] -> 1.728us
                 -->kernel: 0:35 %1549 =  [] -> 1.728us
     %1458 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.281ms
       %1459 = :_LinearBackward [[4096, 1, 7168]] -> 7.281ms
         %1460 = :_Linear_backward [] -> 7.281ms
           %1461 = :nvte_quantize_v2 [] -> 73.280us
             %1462 = :quantize_transpose_vector_blockwise [] -> 73.280us
                 -->kernel: 0:7 %1550 =  [] -> 73.280us
           %1463 = :nvte_quantize_v2 [] -> 110.752us
             %1464 = :quantize_transpose_vector_blockwise [] -> 110.752us
                 -->kernel: 0:7 %1551 =  [] -> 110.752us
           %1465 = :nvte_cublas_gemm_scaled [] -> 3.442ms
                 -->kernel: 0:7 %1552 =  [] -> 3.436ms
           %1466 = :nvte_cublas_gemm_scaled [] -> 3.439ms
                 -->kernel: 0:7 %1553 =  [] -> 3.433ms
     %1467 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.914ms
       %1468 = :BmmBackward0 [[128, 4096, 128]] -> 7.914ms
         %1469 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.979ms
                 -->kernel: 0:7 %1554 =  [] -> 3.968ms
         %1470 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.881ms
                 -->kernel: 0:7 %1555 =  [] -> 3.873ms
     %1471 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.951ms
       %1472 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.951ms
         %1473 = :nvte_scaled_softmax_backward [] -> 6.951ms
                 -->kernel: 0:7 %1556 =  [] -> 6.951ms
     %1474 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.218ms
       %1475 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.218ms
         %1476 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.948ms
                 -->kernel: 0:7 %1557 =  [] -> 5.938ms
         %1477 = :aten::mul [[128, 4096, 192], []] -> 114.912us
           %1478 = :aten::mul [[128, 4096, 192], []] -> 114.912us
                 -->kernel: 0:7 %1558 =  [] -> 114.912us
         %1479 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.884ms
                 -->kernel: 0:7 %1559 =  [] -> 5.878ms
         %1480 = :aten::mul [[128, 192, 4096], []] -> 115.137us
           %1481 = :aten::mul [[128, 192, 4096], []] -> 115.137us
                 -->kernel: 0:7 %1560 =  [] -> 115.137us
     %1482 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.465ms
       %1483 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.465ms
         %1484 = :aten::contiguous [[4096, 1, 128, 192], []] -> 745.122us
           %1485 = :aten::clone [[4096, 1, 128, 192], []] -> 745.122us
             %1486 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 745.122us
                 -->kernel: 0:7 %1561 =  [] -> 745.122us
         %1487 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.801us
           %1488 = :aten::clone [[4096, 1, 128, 128], []] -> 280.801us
             %1489 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.801us
                 -->kernel: 0:7 %1562 =  [] -> 280.801us
                 -->kernel: 0:7 %1563 =  [] -> 173.057us
     %1490 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 643.777us
       %1491 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 643.777us
         %1492 = :aten::contiguous [[4096, 1, 128, 192], []] -> 422.689us
           %1493 = :aten::clone [[4096, 1, 128, 192], []] -> 422.689us
             %1494 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 422.689us
                 -->kernel: 0:7 %1564 =  [] -> 422.689us
                 -->kernel: 0:7 %1565 =  [] -> 118.592us
     %1495 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.738ms
       %1496 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.738ms
         %1497 = :_LayerNormLinear_backward [] -> 1.738ms
           %1498 = :nvte_quantize_v2 [] -> 323.905us
             %1499 = :quantize_transpose_vector_blockwise [] -> 323.905us
                 -->kernel: 0:7 %1566 =  [] -> 323.905us
           %1500 = :nvte_cublas_gemm_scaled [] -> 566.273us
                 -->kernel: 0:7 %1567 =  [] -> 519.201us
                 -->kernel: 0:7 %1568 =  [] -> 19.168us
           %1501 = :nvte_cublas_gemm_scaled [] -> 527.362us
                 -->kernel: 0:7 %1569 =  [] -> 521.218us
           %1502 = :nvte_rmsnorm_bwd [] -> 21.824us
                 -->kernel: 0:7 %1570 =  [] -> 6.496us
                 -->kernel: 0:7 %1571 =  [] -> 3.072us
     %1503 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.016us
       %1504 = :aten::add_ [[512], [512], []] -> 2.016us
                 -->kernel: 0:35 %1572 =  [] -> 2.016us
     %1505 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.804ms
       %1506 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.804ms
         %1507 = :_LayerNormLinear_backward [] -> 2.804ms
           %1508 = :nvte_quantize_v2 [] -> 243.104us
             %1509 = :quantize_transpose_vector_blockwise [] -> 243.104us
                 -->kernel: 0:7 %1573 =  [] -> 243.104us
           %1510 = :nvte_cublas_gemm_scaled [] -> 1.120ms
                 -->kernel: 0:7 %1574 =  [] -> 1.111ms
           %1511 = :nvte_cublas_gemm_scaled [] -> 1.121ms
                 -->kernel: 0:7 %1575 =  [] -> 1.116ms
           %1512 = :nvte_rmsnorm_bwd [] -> 55.552us
                 -->kernel: 0:7 %1576 =  [] -> 23.328us
                 -->kernel: 0:7 %1577 =  [] -> 20.672us
     %1513 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.048us
       %1514 = :aten::add_ [[1536], [1536], []] -> 2.048us
                 -->kernel: 0:35 %1578 =  [] -> 2.048us
     %1515 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 9.920us
       %1516 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 9.920us
         %1517 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 9.920us
                 -->kernel: 0:7 %1579 =  [] -> 9.920us
     %1518 = :autograd::engine::evaluate_function: _LinearBackward None -> 437.281us
       %1519 = :_LinearBackward [[4096, 1, 576]] -> 437.281us
         %1520 = :_Linear_backward [] -> 437.281us
           %1521 = :nvte_quantize_v2 [] -> 14.496us
             %1522 = :quantize_transpose_vector_blockwise [] -> 14.496us
                 -->kernel: 0:7 %1580 =  [] -> 14.496us
           %1523 = :nvte_cublas_gemm_scaled [] -> 147.776us
                 -->kernel: 0:7 %1581 =  [] -> 140.992us
           %1524 = :nvte_cublas_gemm_scaled [] -> 138.592us
                 -->kernel: 0:7 %1582 =  [] -> 133.280us
     %1525 = :autograd::engine::evaluate_function: _LinearBackward None -> 985.059us
       %1526 = :_LinearBackward [[4096, 1, 1536]] -> 819.970us
         %1527 = :_Linear_backward [] -> 819.970us
           %1528 = :nvte_quantize_v2 [] -> 18.496us
             %1529 = :quantize_transpose_vector_blockwise [] -> 18.496us
                 -->kernel: 0:7 %1583 =  [] -> 18.496us
           %1530 = :nvte_cublas_gemm_scaled [] -> 334.400us
                 -->kernel: 0:7 %1584 =  [] -> 328.448us
           %1531 = :nvte_cublas_gemm_scaled [] -> 342.496us
                 -->kernel: 0:7 %1585 =  [] -> 337.312us
       %1532 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.568us
                 -->kernel: 0:7 %1586 =  [] -> 49.568us
     %1533 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 324.705us
       %1534 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 195.905us
         %1535 = :nvte_rmsnorm_bwd [] -> 195.905us
                 -->kernel: 0:7 %1587 =  [] -> 164.416us
                 -->kernel: 0:7 %1588 =  [] -> 8.064us
       %1536 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.344us
                 -->kernel: 0:7 %1589 =  [] -> 49.344us
     %1537 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.536us
       %1538 = :aten::add_ [[7168], [7168], []] -> 1.536us
                 -->kernel: 0:35 %1590 =  [] -> 1.536us
     %1539 = :autograd::engine::evaluate_function: _LinearBackward None -> 6.205ms
       %1540 = :_LinearBackward [[4096, 1, 7168]] -> 6.205ms
         %1541 = :_Linear_backward [] -> 6.205ms
           %1542 = :nvte_quantize_v2 [] -> 72.545us
             %1543 = :quantize_transpose_vector_blockwise [] -> 72.545us
                 -->kernel: 0:7 %1591 =  [] -> 72.545us
           %1544 = :nvte_cublas_gemm_scaled [] -> 2.986ms
                 -->kernel: 0:7 %1592 =  [] -> 2.980ms
           %1545 = :nvte_cublas_gemm_scaled [] -> 3.001ms
                 -->kernel: 0:7 %1593 =  [] -> 2.995ms
     %1546 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 383.649us
       %1547 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 383.649us
         %1548 = :aten::contiguous [[4096, 1, 7168], []] -> 114.144us
           %1549 = :aten::clone [[4096, 1, 7168], []] -> 114.144us
             %1550 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 114.144us
                 -->kernel: 0:7 %1594 =  [] -> 114.144us
         %1551 = :nvte_rmsnorm_bwd [] -> 192.000us
                 -->kernel: 0:7 %1595 =  [] -> 165.728us
                 -->kernel: 0:7 %1596 =  [] -> 7.776us
     %1552 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.632us
       %1553 = :aten::add_ [[7168], [7168], []] -> 1.632us
                 -->kernel: 0:35 %1597 =  [] -> 1.632us
     %1554 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 373.344us
       %1555 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 373.344us
         %1556 = :aten::contiguous [[4096, 1, 7168], []] -> 115.744us
           %1557 = :aten::clone [[4096, 1, 7168], []] -> 115.744us
             %1558 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 115.744us
                 -->kernel: 0:7 %1598 =  [] -> 115.744us
         %1559 = :nvte_rmsnorm_bwd [] -> 190.912us
                 -->kernel: 0:7 %1599 =  [] -> 167.104us
                 -->kernel: 0:7 %1600 =  [] -> 7.712us
     %1560 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.536us
       %1561 = :aten::add_ [[7168], [7168], []] -> 1.536us
                 -->kernel: 0:35 %1601 =  [] -> 1.536us
     %1562 = :autograd::engine::evaluate_function: MakeViewlessTensorBackward None -> 51.104us
       %1563 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.104us
                 -->kernel: 0:7 %1602 =  [] -> 51.104us
     %1564 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 1.417ms
       %1565 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.417ms
         %1566 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.417ms
           %1567 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.417ms
             %1568 = :aten::arange [[], [], [], [], []] -> 1.184us
               %1569 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %1603 =  [] -> 1.184us
             %1570 = CCCL:cub::DeviceRadixSort [] -> 188.289us
                 -->kernel: 0:7 %1604 =  [] -> 3.584us
                 -->kernel: 0:7 %1605 =  [] -> 1.568us
                 -->kernel: 0:7 %1606 =  [] -> 7.648us
                 -->kernel: 0:7 %1607 =  [] -> 7.424us
                 -->kernel: 0:7 %1608 =  [] -> 7.232us
                 -->kernel: 0:7 %1609 =  [] -> 7.040us
                 -->kernel: 0:7 %1610 =  [] -> 6.880us
                 -->kernel: 0:7 %1611 =  [] -> 7.072us
                 -->kernel: 0:7 %1612 =  [] -> 7.008us
                 -->kernel: 0:7 %1613 =  [] -> 6.784us
             %1571 = :aten::zeros [[], [], [], [], []] -> 544.673us
               %1572 = :aten::zero_ [[129280, 7168]] -> 544.673us
                 %1573 = :aten::fill_ [[129280, 7168], []] -> 544.673us
                 -->kernel: 0:7 %1614 =  [] -> 544.673us
             %1574 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 17.280us
                 -->kernel: 0:7 %1615 =  [] -> 1.472us
                 -->kernel: 0:7 %1616 =  [] -> 4.256us
                 -->kernel: 0:7 %1617 =  [] -> 1.664us
             %1575 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 17.728us
                 -->kernel: 0:7 %1618 =  [] -> 1.184us
                 -->kernel: 0:7 %1619 =  [] -> 3.008us
                 -->kernel: 0:7 %1620 =  [] -> 1.568us
                 -->kernel: 0:7 %1621 =  [] -> 1.728us
                 -->kernel: 0:7 %1622 =  [] -> 239.713us
                 -->kernel: 0:7 %1623 =  [] -> 192.064us
     %1576 = :autograd::engine::evaluate_function: SplitBackward0 None -> 34.368us
       %1577 = :SplitBackward0 [[4096, 1, 7168]] -> 34.368us
         %1578 = :aten::cat [[4096, 1, 7168], []] -> 34.368us
     %1579 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 193.889us
       %1580 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 193.889us
         %1581 = :nvte_rmsnorm_bwd [] -> 193.889us
                 -->kernel: 0:7 %1624 =  [] -> 167.072us
                 -->kernel: 0:7 %1625 =  [] -> 7.777us
     %1582 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %1583 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %1626 =  [] -> 1.600us
     %1584 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 931.395us
       %1585 = :FusedCombineBackward [[4096, 7168], []] -> 931.395us
                 -->kernel: 0:26 %1627 =  [] -> 118.273us
                 -->kernel: 0:26 %1628 =  [] -> 761.314us
     %1586 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 197.825us
       %1587 = :_moe_unpermute_mask_mapBackward [[15641, 7168]] -> 197.825us
                 -->kernel: 0:7 %1629 =  [] -> 197.825us
     %1588 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.420ms
       %1589 = :_GroupedLinearBackward [[32384, 7168]] -> 8.420ms
         %1590 = :_GroupedLinear_backward [] -> 8.420ms
           %1591 = :nvte_quantize_v2 [] -> 216.577us
             %1592 = :quantize_transpose_vector_blockwise [] -> 216.577us
                 -->kernel: 0:7 %1630 =  [] -> 216.577us
           %1593 = :nvte_quantize_v2 [] -> 218.944us
             %1594 = :quantize_transpose_vector_blockwise [] -> 218.944us
                 -->kernel: 0:7 %1631 =  [] -> 218.944us
           %1595 = :nvte_quantize_v2 [] -> 218.017us
             %1596 = :quantize_transpose_vector_blockwise [] -> 218.017us
                 -->kernel: 0:7 %1632 =  [] -> 218.017us
           %1597 = :nvte_quantize_v2 [] -> 217.952us
             %1598 = :quantize_transpose_vector_blockwise [] -> 217.952us
                 -->kernel: 0:7 %1633 =  [] -> 217.952us
           %1599 = :nvte_multi_stream_cublas_gemm [] -> 3.644ms
             %1600 = :nvte_cublas_gemm [] -> 853.217us
                 -->kernel: 0:159 %1634 =  [] -> 843.553us
             %1601 = :nvte_cublas_gemm [] -> 909.346us
                 -->kernel: 0:160 %1635 =  [] -> 904.258us
             %1602 = :nvte_cublas_gemm [] -> 908.866us
                 -->kernel: 0:161 %1636 =  [] -> 904.098us
             %1603 = :nvte_cublas_gemm [] -> 910.370us
                 -->kernel: 0:162 %1637 =  [] -> 904.482us
           %1604 = :nvte_multi_stream_cublas_gemm [] -> 3.613ms
             %1605 = :nvte_cublas_gemm [] -> 881.506us
                 -->kernel: 0:159 %1638 =  [] -> 874.594us
             %1606 = :nvte_cublas_gemm [] -> 892.290us
                 -->kernel: 0:160 %1639 =  [] -> 888.290us
             %1607 = :nvte_cublas_gemm [] -> 891.970us
                 -->kernel: 0:161 %1640 =  [] -> 888.450us
             %1608 = :nvte_cublas_gemm [] -> 891.202us
                 -->kernel: 0:162 %1641 =  [] -> 888.066us
     %1609 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 583.009us
       %1610 = :WeightedSwiGLUFunctionBackward [[32384, 2048]] -> 583.009us
         %1611 = :Torch-Compiled Region: 4/1 None -> 583.009us
           %1612 = :triton_poi_fused__to_copy_cat_0 [[32384, 2048], [32384, 1], [32384, 4096], [32384, 4096], [], []] -> 395.521us
                 -->kernel: 0:7 %1642 =  [] -> 395.521us
           %1613 = :triton_red_fused__to_copy_mul_silu_sum_1 [[32384, 4096], [32384, 2048], [32384, 1], [], [], [], []] -> 128.448us
                 -->kernel: 0:7 %1643 =  [] -> 128.448us
     %1614 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.569ms
       %1615 = :_GroupedLinearBackward [[32384, 4096]] -> 14.569ms
         %1616 = :_GroupedLinear_backward [] -> 14.569ms
           %1617 = :nvte_quantize_v2 [] -> 122.336us
             %1618 = :quantize_transpose_vector_blockwise [] -> 122.336us
                 -->kernel: 0:7 %1644 =  [] -> 122.336us
           %1619 = :nvte_quantize_v2 [] -> 129.376us
             %1620 = :quantize_transpose_vector_blockwise [] -> 129.376us
                 -->kernel: 0:7 %1645 =  [] -> 129.376us
           %1621 = :nvte_quantize_v2 [] -> 128.640us
             %1622 = :quantize_transpose_vector_blockwise [] -> 128.640us
                 -->kernel: 0:7 %1646 =  [] -> 128.640us
           %1623 = :nvte_quantize_v2 [] -> 128.800us
             %1624 = :quantize_transpose_vector_blockwise [] -> 128.800us
                 -->kernel: 0:7 %1647 =  [] -> 128.800us
           %1625 = :nvte_multi_stream_cublas_gemm [] -> 6.920ms
             %1626 = :nvte_cublas_gemm [] -> 1.710ms
                 -->kernel: 0:159 %1648 =  [] -> 1.702ms
             %1627 = :nvte_cublas_gemm [] -> 1.714ms
                 -->kernel: 0:160 %1649 =  [] -> 1.710ms
             %1628 = :nvte_cublas_gemm [] -> 1.713ms
                 -->kernel: 0:161 %1650 =  [] -> 1.709ms
             %1629 = :nvte_cublas_gemm [] -> 1.714ms
                 -->kernel: 0:162 %1651 =  [] -> 1.709ms
           %1630 = :nvte_multi_stream_cublas_gemm [] -> 6.868ms
             %1631 = :nvte_cublas_gemm [] -> 1.683ms
                 -->kernel: 0:159 %1652 =  [] -> 1.676ms
             %1632 = :nvte_cublas_gemm [] -> 1.711ms
                 -->kernel: 0:160 %1653 =  [] -> 1.707ms
             %1633 = :nvte_cublas_gemm [] -> 1.706ms
                 -->kernel: 0:161 %1654 =  [] -> 1.703ms
             %1634 = :nvte_cublas_gemm [] -> 1.708ms
                 -->kernel: 0:162 %1655 =  [] -> 1.704ms
     %1635 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 384.417us
       %1636 = :_moe_permute_mask_mapBackward [[32384, 7168], [], [32384]] -> 384.417us
         %1637 = :aten::zeros [[], [], [], [], []] -> 1.376us
           %1638 = :aten::zero_ [[15641, 9]] -> 1.376us
             %1639 = :aten::fill_ [[15641, 9], []] -> 1.376us
                 -->kernel: 0:7 %1656 =  [] -> 1.376us
                 -->kernel: 0:7 %1657 =  [] -> 210.337us
     %1640 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 98.208us
       %1641 = :IndicesToMultihotBackward [[], [15641, 4]] -> 98.208us
         %1642 = :aten::zeros [[], [], [], [], []] -> 1.408us
           %1643 = :aten::zero_ [[15641, 4]] -> 1.408us
             %1644 = :aten::fill_ [[15641, 4], []] -> 1.408us
                 -->kernel: 0:7 %1658 =  [] -> 1.408us
                 -->kernel: 0:7 %1659 =  [] -> 11.520us
     %1645 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.157ms
       %1646 = :_LinearBackward [[4096, 1, 7168]] -> 1.157ms
         %1647 = :_Linear_backward [] -> 1.157ms
           %1648 = :nvte_quantize_v2 [] -> 73.089us
             %1649 = :quantize_transpose_vector_blockwise [] -> 73.089us
                 -->kernel: 0:7 %1660 =  [] -> 73.089us
           %1650 = :nvte_cublas_gemm_scaled [] -> 464.161us
                 -->kernel: 0:7 %1661 =  [] -> 455.393us
           %1651 = :nvte_cublas_gemm_scaled [] -> 453.633us
                 -->kernel: 0:7 %1662 =  [] -> 447.425us
     %1652 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 46.752us
       %1653 = :SwiGLUFunctionBackward [[4096, 2048]] -> 46.752us
         %1654 = :Torch-Compiled Region: 5/0 None -> 46.752us
           %1655 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 46.752us
                 -->kernel: 0:7 %1663 =  [] -> 46.752us
     %1656 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.007ms
       %1657 = :_LinearBackward [[4096, 1, 4096]] -> 2.007ms
         %1658 = :_Linear_backward [] -> 2.007ms
           %1659 = :nvte_quantize_v2 [] -> 44.096us
             %1660 = :quantize_transpose_vector_blockwise [] -> 44.096us
                 -->kernel: 0:7 %1664 =  [] -> 44.096us
           %1661 = :nvte_quantize_v2 [] -> 52.193us
             %1662 = :quantize_transpose_vector_blockwise [] -> 52.193us
                 -->kernel: 0:7 %1665 =  [] -> 52.193us
           %1663 = :nvte_cublas_gemm_scaled [] -> 862.978us
                 -->kernel: 0:7 %1666 =  [] -> 857.058us
           %1664 = :nvte_cublas_gemm_scaled [] -> 863.266us
                 -->kernel: 0:7 %1667 =  [] -> 857.442us
     %1665 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 854.434us
       %1666 = :FusedDispatchBackward [[15641, 7168], [], [15641, 8], [], []] -> 854.434us
         %1667 = :aten::zeros [[], [], [], [], []] -> 1.376us
           %1668 = :aten::zero_ [[15641, 8]] -> 1.376us
             %1669 = :aten::fill_ [[15641, 8], []] -> 1.376us
                 -->kernel: 0:7 %1668 =  [] -> 1.376us
                 -->kernel: 0:26 %1669 =  [] -> 13.920us
                 -->kernel: 0:26 %1670 =  [] -> 680.001us
     %1670 = :autograd::engine::evaluate_function: TopkBackward0 None -> 57.537us
       %1671 = :TopkBackward0 [[4096, 8]] -> 57.537us
         %1672 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 57.537us
           %1673 = :aten::zeros [[], [], [], [], []] -> 960.000ns
             %1674 = :aten::zero_ [[4096, 32]] -> 960.000ns
               %1675 = :aten::fill_ [[4096, 32], []] -> 960.000ns
                 -->kernel: 0:7 %1671 =  [] -> 960.000ns
           %1676 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 9.088us
                 -->kernel: 0:7 %1672 =  [] -> 9.088us
     %1677 = :autograd::engine::evaluate_function: ViewBackward0 None -> 53.024us
       %1678 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 53.024us
                 -->kernel: 0:7 %1673 =  [] -> 53.024us
     %1679 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 91.104us
       %1680 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 39.776us
         %1681 = :aten::ones_like [[], [], [], [], [], []] -> 1.312us
           %1682 = :aten::fill_ [[], []] -> 1.312us
                 -->kernel: 0:7 %1674 =  [] -> 1.312us
         %1683 = :aten::mul [[], [1]] -> 1.760us
                 -->kernel: 0:7 %1675 =  [] -> 1.760us
       %1684 = :aten::sum [[1], []] -> 2.976us
         %1685 = :aten::sum [[1], [], [], []] -> 2.976us
                 -->kernel: 0:7 %1676 =  [] -> 2.976us
     %1686 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.280us
       %1687 = :DivBackward0 [[]] -> 1.280us
         %1688 = :aten::div [[], []] -> 1.280us
                 -->kernel: 0:7 %1677 =  [] -> 1.280us
     %1689 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.176us
       %1690 = :FusedAuxLossBackward [[]] -> 2.176us
         %1691 = :nvte_fused_moe_aux_loss_backward [] -> 2.176us
                 -->kernel: 0:7 %1678 =  [] -> 2.176us
     %1692 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 62.208us
       %1693 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 62.208us
         %1694 = :aten::zeros [[], [], [], [], []] -> 1.216us
           %1695 = :aten::zero_ [[4096, 32]] -> 1.216us
             %1696 = :aten::fill_ [[4096, 32], []] -> 1.216us
                 -->kernel: 0:7 %1679 =  [] -> 1.216us
         %1697 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.960us
                 -->kernel: 0:7 %1680 =  [] -> 12.960us
     %1698 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 100.544us
       %1699 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 58.144us
         %1700 = :aten::zeros [[], [], [], [], []] -> 1.152us
           %1701 = :aten::zero_ [[4096, 32]] -> 1.152us
             %1702 = :aten::fill_ [[4096, 32], []] -> 1.152us
                 -->kernel: 0:7 %1681 =  [] -> 1.152us
         %1703 = :nvte_fused_topk_with_score_function_backward [] -> 13.728us
                 -->kernel: 0:7 %1682 =  [] -> 13.728us
       %1704 = :aten::add [[4096, 32], [4096, 32], []] -> 1.664us
                 -->kernel: 0:7 %1683 =  [] -> 1.664us
     %1705 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 797.570us
       %1706 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 701.442us
         %1707 = :aten::to [[32, 7168], [], [], [], []] -> 6.528us
           %1708 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.528us
             %1709 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.528us
                 -->kernel: 0:7 %1684 =  [] -> 6.528us
         %1710 = :nvte_cublas_gemm_scaled [] -> 83.584us
                 -->kernel: 0:7 %1685 =  [] -> 67.808us
         %1711 = :aten::to [[4096, 7168], [], [], [], []] -> 176.320us
           %1712 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 176.320us
             %1713 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 176.320us
                 -->kernel: 0:7 %1686 =  [] -> 176.320us
         %1714 = :nvte_cublas_gemm_scaled [] -> 82.080us
                 -->kernel: 0:7 %1687 =  [] -> 82.080us
         %1715 = :aten::to [[4096, 7168], [], [], [], []] -> 43.648us
           %1716 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.648us
             %1717 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.648us
                 -->kernel: 0:7 %1688 =  [] -> 43.648us
         %1718 = :aten::to [[32, 7168], [], [], [], []] -> 2.048us
           %1719 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.048us
             %1720 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.048us
                 -->kernel: 0:7 %1689 =  [] -> 2.048us
       %1721 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.632us
                 -->kernel: 0:7 %1690 =  [] -> 49.632us
     %1722 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.176us
       %1723 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.176us
                 -->kernel: 0:35 %1691 =  [] -> 2.176us
     %1724 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 323.009us
       %1725 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 196.672us
         %1726 = :nvte_rmsnorm_bwd [] -> 196.672us
                 -->kernel: 0:7 %1692 =  [] -> 166.624us
                 -->kernel: 0:7 %1693 =  [] -> 7.840us
       %1727 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.073us
                 -->kernel: 0:7 %1694 =  [] -> 51.073us
     %1728 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %1729 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %1695 =  [] -> 1.600us
     %1730 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.248ms
       %1731 = :_LinearBackward [[4096, 1, 7168]] -> 7.248ms
         %1732 = :_Linear_backward [] -> 7.248ms
           %1733 = :nvte_quantize_v2 [] -> 73.376us
             %1734 = :quantize_transpose_vector_blockwise [] -> 73.376us
                 -->kernel: 0:7 %1696 =  [] -> 73.376us
           %1735 = :nvte_quantize_v2 [] -> 111.297us
             %1736 = :quantize_transpose_vector_blockwise [] -> 111.297us
                 -->kernel: 0:7 %1697 =  [] -> 111.297us
           %1737 = :nvte_cublas_gemm_scaled [] -> 3.427ms
                 -->kernel: 0:7 %1698 =  [] -> 3.421ms
           %1738 = :nvte_cublas_gemm_scaled [] -> 3.429ms
                 -->kernel: 0:7 %1699 =  [] -> 3.418ms
     %1739 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.896ms
       %1740 = :BmmBackward0 [[128, 4096, 128]] -> 7.896ms
         %1741 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.974ms
                 -->kernel: 0:7 %1700 =  [] -> 3.962ms
         %1742 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.867ms
                 -->kernel: 0:7 %1701 =  [] -> 3.859ms
     %1743 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 7.014ms
       %1744 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 7.014ms
         %1745 = :nvte_scaled_softmax_backward [] -> 7.014ms
                 -->kernel: 0:7 %1702 =  [] -> 7.014ms
     %1746 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.184ms
       %1747 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.184ms
         %1748 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.929ms
                 -->kernel: 0:7 %1703 =  [] -> 5.919ms
         %1749 = :aten::mul [[128, 4096, 192], []] -> 114.880us
           %1750 = :aten::mul [[128, 4096, 192], []] -> 114.880us
                 -->kernel: 0:7 %1704 =  [] -> 114.880us
         %1751 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.861ms
                 -->kernel: 0:7 %1705 =  [] -> 5.854ms
         %1752 = :aten::mul [[128, 192, 4096], []] -> 115.168us
           %1753 = :aten::mul [[128, 192, 4096], []] -> 115.168us
                 -->kernel: 0:7 %1706 =  [] -> 115.168us
     %1754 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.472ms
       %1755 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.472ms
         %1756 = :aten::contiguous [[4096, 1, 128, 192], []] -> 743.490us
           %1757 = :aten::clone [[4096, 1, 128, 192], []] -> 743.490us
             %1758 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 743.490us
                 -->kernel: 0:7 %1707 =  [] -> 743.490us
         %1759 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.449us
           %1760 = :aten::clone [[4096, 1, 128, 128], []] -> 280.449us
             %1761 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.449us
                 -->kernel: 0:7 %1708 =  [] -> 280.449us
                 -->kernel: 0:7 %1709 =  [] -> 172.577us
     %1762 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 638.562us
       %1763 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 638.562us
         %1764 = :aten::contiguous [[4096, 1, 128, 192], []] -> 422.497us
           %1765 = :aten::clone [[4096, 1, 128, 192], []] -> 422.497us
             %1766 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 422.497us
                 -->kernel: 0:7 %1710 =  [] -> 422.497us
                 -->kernel: 0:7 %1711 =  [] -> 118.401us
     %1767 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.736ms
       %1768 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.736ms
         %1769 = :_LayerNormLinear_backward [] -> 1.736ms
           %1770 = :nvte_quantize_v2 [] -> 323.905us
             %1771 = :quantize_transpose_vector_blockwise [] -> 323.905us
                 -->kernel: 0:7 %1712 =  [] -> 323.905us
           %1772 = :nvte_cublas_gemm_scaled [] -> 566.497us
                 -->kernel: 0:7 %1713 =  [] -> 518.209us
                 -->kernel: 0:7 %1714 =  [] -> 19.136us
           %1773 = :nvte_cublas_gemm_scaled [] -> 526.465us
                 -->kernel: 0:7 %1715 =  [] -> 521.249us
           %1774 = :nvte_rmsnorm_bwd [] -> 21.344us
                 -->kernel: 0:7 %1716 =  [] -> 6.240us
                 -->kernel: 0:7 %1717 =  [] -> 3.168us
     %1775 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.856us
       %1776 = :aten::add_ [[512], [512], []] -> 1.856us
                 -->kernel: 0:35 %1718 =  [] -> 1.856us
     %1777 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.777ms
       %1778 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.777ms
         %1779 = :_LayerNormLinear_backward [] -> 2.777ms
           %1780 = :nvte_quantize_v2 [] -> 243.392us
             %1781 = :quantize_transpose_vector_blockwise [] -> 243.392us
                 -->kernel: 0:7 %1719 =  [] -> 243.392us
           %1782 = :nvte_cublas_gemm_scaled [] -> 1.116ms
                 -->kernel: 0:7 %1720 =  [] -> 1.107ms
           %1783 = :nvte_cublas_gemm_scaled [] -> 1.119ms
                 -->kernel: 0:7 %1721 =  [] -> 1.113ms
           %1784 = :nvte_rmsnorm_bwd [] -> 55.648us
                 -->kernel: 0:7 %1722 =  [] -> 23.040us
                 -->kernel: 0:7 %1723 =  [] -> 20.576us
     %1785 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.920us
       %1786 = :aten::add_ [[1536], [1536], []] -> 1.920us
                 -->kernel: 0:35 %1724 =  [] -> 1.920us
     %1787 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 9.952us
       %1788 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 9.952us
         %1789 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 9.952us
                 -->kernel: 0:7 %1725 =  [] -> 9.952us
     %1790 = :autograd::engine::evaluate_function: _LinearBackward None -> 433.473us
       %1791 = :_LinearBackward [[4096, 1, 576]] -> 433.473us
         %1792 = :_Linear_backward [] -> 433.473us
           %1793 = :nvte_quantize_v2 [] -> 14.528us
             %1794 = :quantize_transpose_vector_blockwise [] -> 14.528us
                 -->kernel: 0:7 %1726 =  [] -> 14.528us
           %1795 = :nvte_cublas_gemm_scaled [] -> 147.489us
                 -->kernel: 0:7 %1727 =  [] -> 140.865us
           %1796 = :nvte_cublas_gemm_scaled [] -> 139.296us
                 -->kernel: 0:7 %1728 =  [] -> 133.376us
     %1797 = :autograd::engine::evaluate_function: _LinearBackward None -> 983.202us
       %1798 = :_LinearBackward [[4096, 1, 1536]] -> 820.961us
         %1799 = :_Linear_backward [] -> 820.961us
           %1800 = :nvte_quantize_v2 [] -> 18.432us
             %1801 = :quantize_transpose_vector_blockwise [] -> 18.432us
                 -->kernel: 0:7 %1729 =  [] -> 18.432us
           %1802 = :nvte_cublas_gemm_scaled [] -> 335.233us
                 -->kernel: 0:7 %1730 =  [] -> 328.321us
           %1803 = :nvte_cublas_gemm_scaled [] -> 342.912us
                 -->kernel: 0:7 %1731 =  [] -> 337.536us
       %1804 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.728us
                 -->kernel: 0:7 %1732 =  [] -> 49.728us
     %1805 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 319.713us
       %1806 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 195.585us
         %1807 = :nvte_rmsnorm_bwd [] -> 195.585us
                 -->kernel: 0:7 %1733 =  [] -> 164.705us
                 -->kernel: 0:7 %1734 =  [] -> 7.744us
       %1808 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.152us
                 -->kernel: 0:7 %1735 =  [] -> 49.152us
     %1809 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.696us
       %1810 = :aten::add_ [[7168], [7168], []] -> 1.696us
                 -->kernel: 0:35 %1736 =  [] -> 1.696us
     %1811 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.984ms
       %1812 = :_LinearBackward [[4096, 1, 7168]] -> 7.984ms
         %1813 = :_Linear_backward [] -> 7.984ms
           %1814 = :nvte_quantize_v2 [] -> 73.056us
             %1815 = :quantize_transpose_vector_blockwise [] -> 73.056us
                 -->kernel: 0:7 %1737 =  [] -> 73.056us
           %1816 = :nvte_cublas_gemm_scaled [] -> 3.882ms
                 -->kernel: 0:7 %1738 =  [] -> 3.875ms
           %1817 = :nvte_cublas_gemm_scaled [] -> 3.874ms
                 -->kernel: 0:7 %1739 =  [] -> 3.866ms
     %1818 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 845.730us
       %1819 = :SwiGLUFunctionBackward [[4096, 18432]] -> 845.730us
         %1820 = :Torch-Compiled Region: 5/1 None -> 845.730us
           %1821 = :triton_poi_fused_cat_0 [[4096, 18432], [4096, 36864], [4096, 36864], [], [], [], [], []] -> 845.730us
                 -->kernel: 0:7 %1740 =  [] -> 845.730us
     %1822 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 16.439ms
       %1823 = :_LayerNormLinearBackward [[4096, 1, 36864]] -> 16.267ms
         %1824 = :_LayerNormLinear_backward [] -> 16.267ms
           %1825 = :nvte_quantize_v2 [] -> 361.857us
             %1826 = :quantize_transpose_vector_blockwise [] -> 361.857us
                 -->kernel: 0:7 %1741 =  [] -> 361.857us
           %1827 = :nvte_cublas_gemm_scaled [] -> 7.666ms
                 -->kernel: 0:7 %1742 =  [] -> 7.658ms
           %1828 = :nvte_cublas_gemm_scaled [] -> 7.720ms
                 -->kernel: 0:7 %1743 =  [] -> 7.710ms
           %1829 = :nvte_rmsnorm_bwd [] -> 196.544us
                 -->kernel: 0:7 %1744 =  [] -> 165.280us
                 -->kernel: 0:7 %1745 =  [] -> 8.224us
       %1830 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.536us
                 -->kernel: 0:7 %1746 =  [] -> 49.536us
     %1831 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.696us
       %1832 = :aten::add_ [[7168], [7168], []] -> 1.696us
                 -->kernel: 0:35 %1747 =  [] -> 1.696us
     %1833 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.286ms
       %1834 = :_LinearBackward [[4096, 1, 7168]] -> 7.286ms
         %1835 = :_Linear_backward [] -> 7.286ms
           %1836 = :nvte_quantize_v2 [] -> 73.792us
             %1837 = :quantize_transpose_vector_blockwise [] -> 73.792us
                 -->kernel: 0:7 %1748 =  [] -> 73.792us
           %1838 = :nvte_quantize_v2 [] -> 110.272us
             %1839 = :quantize_transpose_vector_blockwise [] -> 110.272us
                 -->kernel: 0:7 %1749 =  [] -> 110.272us
           %1840 = :nvte_cublas_gemm_scaled [] -> 3.441ms
                 -->kernel: 0:7 %1750 =  [] -> 3.434ms
           %1841 = :nvte_cublas_gemm_scaled [] -> 3.443ms
                 -->kernel: 0:7 %1751 =  [] -> 3.437ms
     %1842 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.918ms
       %1843 = :BmmBackward0 [[128, 4096, 128]] -> 7.918ms
         %1844 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.980ms
                 -->kernel: 0:7 %1752 =  [] -> 3.968ms
         %1845 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.883ms
                 -->kernel: 0:7 %1753 =  [] -> 3.874ms
     %1846 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.968ms
       %1847 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.968ms
         %1848 = :nvte_scaled_softmax_backward [] -> 6.968ms
                 -->kernel: 0:7 %1754 =  [] -> 6.968ms
     %1849 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.207ms
       %1850 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.207ms
         %1851 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.949ms
                 -->kernel: 0:7 %1755 =  [] -> 5.938ms
         %1852 = :aten::mul [[128, 4096, 192], []] -> 115.296us
           %1853 = :aten::mul [[128, 4096, 192], []] -> 115.296us
                 -->kernel: 0:7 %1756 =  [] -> 115.296us
         %1854 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.871ms
                 -->kernel: 0:7 %1757 =  [] -> 5.866ms
         %1855 = :aten::mul [[128, 192, 4096], []] -> 115.840us
           %1856 = :aten::mul [[128, 192, 4096], []] -> 115.840us
                 -->kernel: 0:7 %1758 =  [] -> 115.840us
     %1857 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.476ms
       %1858 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.476ms
         %1859 = :aten::contiguous [[4096, 1, 128, 192], []] -> 745.154us
           %1860 = :aten::clone [[4096, 1, 128, 192], []] -> 745.154us
             %1861 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 745.154us
                 -->kernel: 0:7 %1759 =  [] -> 745.154us
         %1862 = :aten::contiguous [[4096, 1, 128, 128], []] -> 281.120us
           %1863 = :aten::clone [[4096, 1, 128, 128], []] -> 281.120us
             %1864 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 281.120us
                 -->kernel: 0:7 %1760 =  [] -> 281.120us
                 -->kernel: 0:7 %1761 =  [] -> 171.648us
     %1865 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 642.754us
       %1866 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 642.754us
         %1867 = :aten::contiguous [[4096, 1, 128, 192], []] -> 424.225us
           %1868 = :aten::clone [[4096, 1, 128, 192], []] -> 424.225us
             %1869 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 424.225us
                 -->kernel: 0:7 %1762 =  [] -> 424.225us
                 -->kernel: 0:7 %1763 =  [] -> 118.976us
     %1870 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.729ms
       %1871 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.729ms
         %1872 = :_LayerNormLinear_backward [] -> 1.729ms
           %1873 = :nvte_quantize_v2 [] -> 323.137us
             %1874 = :quantize_transpose_vector_blockwise [] -> 323.137us
                 -->kernel: 0:7 %1764 =  [] -> 323.137us
           %1875 = :nvte_cublas_gemm_scaled [] -> 567.202us
                 -->kernel: 0:7 %1765 =  [] -> 521.410us
                 -->kernel: 0:7 %1766 =  [] -> 19.328us
           %1876 = :nvte_cublas_gemm_scaled [] -> 529.633us
                 -->kernel: 0:7 %1767 =  [] -> 523.265us
           %1877 = :nvte_rmsnorm_bwd [] -> 20.832us
                 -->kernel: 0:7 %1768 =  [] -> 6.528us
                 -->kernel: 0:7 %1769 =  [] -> 3.168us
     %1878 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.016us
       %1879 = :aten::add_ [[512], [512], []] -> 2.016us
                 -->kernel: 0:35 %1770 =  [] -> 2.016us
     %1880 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.805ms
       %1881 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.805ms
         %1882 = :_LayerNormLinear_backward [] -> 2.805ms
           %1883 = :nvte_quantize_v2 [] -> 243.425us
             %1884 = :quantize_transpose_vector_blockwise [] -> 243.425us
                 -->kernel: 0:7 %1771 =  [] -> 243.425us
           %1885 = :nvte_cublas_gemm_scaled [] -> 1.121ms
                 -->kernel: 0:7 %1772 =  [] -> 1.113ms
           %1886 = :nvte_cublas_gemm_scaled [] -> 1.124ms
                 -->kernel: 0:7 %1773 =  [] -> 1.118ms
           %1887 = :nvte_rmsnorm_bwd [] -> 55.329us
                 -->kernel: 0:7 %1774 =  [] -> 23.137us
                 -->kernel: 0:7 %1775 =  [] -> 20.480us
     %1888 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.016us
       %1889 = :aten::add_ [[1536], [1536], []] -> 2.016us
                 -->kernel: 0:35 %1776 =  [] -> 2.016us
     %1890 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.016us
       %1891 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.016us
         %1892 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.016us
                 -->kernel: 0:7 %1777 =  [] -> 10.016us
     %1893 = :autograd::engine::evaluate_function: _LinearBackward None -> 444.545us
       %1894 = :_LinearBackward [[4096, 1, 576]] -> 444.545us
         %1895 = :_Linear_backward [] -> 444.545us
           %1896 = :nvte_quantize_v2 [] -> 14.369us
             %1897 = :quantize_transpose_vector_blockwise [] -> 14.369us
                 -->kernel: 0:7 %1778 =  [] -> 14.369us
           %1898 = :nvte_cublas_gemm_scaled [] -> 148.768us
                 -->kernel: 0:7 %1779 =  [] -> 141.728us
           %1899 = :nvte_cublas_gemm_scaled [] -> 139.232us
                 -->kernel: 0:7 %1780 =  [] -> 133.952us
     %1900 = :autograd::engine::evaluate_function: _LinearBackward None -> 989.506us
       %1901 = :_LinearBackward [[4096, 1, 1536]] -> 824.002us
         %1902 = :_Linear_backward [] -> 824.002us
           %1903 = :nvte_quantize_v2 [] -> 18.432us
             %1904 = :quantize_transpose_vector_blockwise [] -> 18.432us
                 -->kernel: 0:7 %1781 =  [] -> 18.432us
           %1905 = :nvte_cublas_gemm_scaled [] -> 336.545us
                 -->kernel: 0:7 %1782 =  [] -> 330.113us
           %1906 = :nvte_cublas_gemm_scaled [] -> 342.753us
                 -->kernel: 0:7 %1783 =  [] -> 338.465us
       %1907 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.720us
                 -->kernel: 0:7 %1784 =  [] -> 50.720us
     %1908 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 321.408us
       %1909 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 196.352us
         %1910 = :nvte_rmsnorm_bwd [] -> 196.352us
                 -->kernel: 0:7 %1785 =  [] -> 165.088us
                 -->kernel: 0:7 %1786 =  [] -> 8.128us
       %1911 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.824us
                 -->kernel: 0:7 %1787 =  [] -> 49.824us
     %1912 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %1913 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %1788 =  [] -> 1.600us
     %1914 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 3.034ms
       %1915 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.429ms
         %1916 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.429ms
           %1917 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.429ms
             %1918 = :aten::arange [[], [], [], [], []] -> 1.152us
               %1919 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %1789 =  [] -> 1.152us
             %1920 = CCCL:cub::DeviceRadixSort [] -> 188.192us
                 -->kernel: 0:7 %1790 =  [] -> 3.616us
                 -->kernel: 0:7 %1791 =  [] -> 1.536us
                 -->kernel: 0:7 %1792 =  [] -> 7.872us
                 -->kernel: 0:7 %1793 =  [] -> 7.200us
                 -->kernel: 0:7 %1794 =  [] -> 7.072us
                 -->kernel: 0:7 %1795 =  [] -> 7.232us
                 -->kernel: 0:7 %1796 =  [] -> 7.008us
                 -->kernel: 0:7 %1797 =  [] -> 6.880us
                 -->kernel: 0:7 %1798 =  [] -> 6.848us
                 -->kernel: 0:7 %1799 =  [] -> 7.040us
             %1921 = :aten::zeros [[], [], [], [], []] -> 544.705us
               %1922 = :aten::zero_ [[129280, 7168]] -> 544.705us
                 %1923 = :aten::fill_ [[129280, 7168], []] -> 544.705us
                 -->kernel: 0:7 %1800 =  [] -> 544.705us
             %1924 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 16.608us
                 -->kernel: 0:7 %1801 =  [] -> 1.184us
                 -->kernel: 0:7 %1802 =  [] -> 3.968us
                 -->kernel: 0:7 %1803 =  [] -> 1.792us
             %1925 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 18.528us
                 -->kernel: 0:7 %1804 =  [] -> 1.440us
                 -->kernel: 0:7 %1805 =  [] -> 3.296us
                 -->kernel: 0:7 %1806 =  [] -> 1.376us
                 -->kernel: 0:7 %1807 =  [] -> 1.760us
                 -->kernel: 0:7 %1808 =  [] -> 239.969us
                 -->kernel: 0:7 %1809 =  [] -> 192.096us
       %1926 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.556ms
                 -->kernel: 0:35 %1810 =  [] -> 1.556ms
     %1927 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.557ms
       %1928 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.557ms
                 -->kernel: 0:35 %1811 =  [] -> 1.557ms
     %1929 = :aten::linalg_vector_norm [[3002413056], [], [], [], []] -> 2.546ms
                 -->kernel: 0:7 %1812 =  [] -> 614.978us
                 -->kernel: 0:7 %1813 =  [] -> 609.793us
                 -->kernel: 0:7 %1814 =  [] -> 607.553us
                 -->kernel: 0:7 %1815 =  [] -> 608.162us
     %1930 = :aten::isnan [[]] -> 1.472us
       %1931 = :aten::ne [[], []] -> 1.472us
                 -->kernel: 0:7 %1816 =  [] -> 1.472us
     %1932 = :aten::is_nonzero [[]] -> 2.240us
       %1933 = :aten::item [[]] -> 2.240us
         %1934 = :aten::_local_scalar_dense [[]] -> 2.240us
     %1935 = :aten::isinf [[]] -> 39.328us
       %1936 = :aten::abs [[]] -> 1.408us
         %1937 = :aten::abs [[], [0]] -> 1.408us
                 -->kernel: 0:7 %1817 =  [] -> 1.408us
       %1938 = :aten::eq [[], []] -> 1.504us
                 -->kernel: 0:7 %1818 =  [] -> 1.504us
     %1939 = :aten::is_nonzero [[]] -> 2.208us
       %1940 = :aten::item [[]] -> 2.208us
         %1941 = :aten::_local_scalar_dense [[]] -> 2.208us
     %1942 = :aten::mul_ [[3002413056], []] -> 3.544ms
                 -->kernel: 0:7 %1819 =  [] -> 863.426us
                 -->kernel: 0:7 %1820 =  [] -> 902.082us
                 -->kernel: 0:7 %1821 =  [] -> 871.426us
                 -->kernel: 0:7 %1822 =  [] -> 869.186us
     %1943 = :c10d::reduce_scatter_tensor_coalesced_ [[375301632], [3002413056], [], [], [], []] -> 14.553ms
       %1944 = :record_param_comms [[3002413056], [], [], [], [], [], [], [], [], []] -> 14.553ms
         %1945 = :nccl:reduce_scatter_tensor_coalesced [[3002413056]] -> 14.553ms
           %1946 = NCCL:ncclGroupEnd [] -> 14.553ms
                 -->kernel: 0:7 %1823 =  [] -> 14.553ms
     %1947 = :aten::linalg_vector_norm [[352321536], [], [], [], []] -> 307.328us
                 -->kernel: 0:7 %1824 =  [] -> 292.064us
     %1948 = :aten::isnan [[]] -> 1.600us
       %1949 = :aten::ne [[], []] -> 1.600us
                 -->kernel: 0:7 %1825 =  [] -> 1.600us
     %1950 = :aten::is_nonzero [[]] -> 2.368us
       %1951 = :aten::item [[]] -> 2.368us
         %1952 = :aten::_local_scalar_dense [[]] -> 2.368us
     %1953 = :aten::isinf [[]] -> 25.920us
       %1954 = :aten::abs [[]] -> 1.408us
         %1955 = :aten::abs [[], [0]] -> 1.408us
                 -->kernel: 0:7 %1826 =  [] -> 1.408us
       %1956 = :aten::eq [[], []] -> 1.280us
                 -->kernel: 0:7 %1827 =  [] -> 1.280us
     %1957 = :aten::is_nonzero [[]] -> 2.368us
       %1958 = :aten::item [[]] -> 2.368us
         %1959 = :aten::_local_scalar_dense [[]] -> 2.368us
     %1960 = :aten::mul_ [[352321536], []] -> 404.033us
                 -->kernel: 0:7 %1828 =  [] -> 404.033us
     %1961 = :aten::stack [[32], [32], []] -> 2.336us
       %1962 = :aten::cat [[32], [32], []] -> 2.336us
                 -->kernel: 0:7 %1829 =  [] -> 2.336us
     %1963 = :aten::stack [[32], [32], []] -> 2.272us
       %1964 = :aten::cat [[32], [32], []] -> 2.272us
                 -->kernel: 0:7 %1830 =  [] -> 2.272us
     %1965 = :c10d::allreduce_ [[2, 32], [], [], [], [], []] -> 15.776us
       %1966 = :record_param_comms [[2, 32], [], [], [], [], [], [], [], [], []] -> 15.776us
         %1967 = :nccl:all_reduce [[2, 32]] -> 15.776us
           %1968 = NCCL:ncclAllReduce [] -> 15.776us
                 -->kernel: 0:7 %1831 =  [] -> 15.776us
     %1969 = :aten::sum [[2, 32], [], [], []] -> 2.560us
                 -->kernel: 0:7 %1832 =  [] -> 2.560us
     %1970 = :aten::div [[2, 1], []] -> 1.600us
                 -->kernel: 0:7 %1833 =  [] -> 1.600us
     %1971 = :aten::sub [[2, 1], [2, 32], []] -> 2.048us
                 -->kernel: 0:7 %1834 =  [] -> 2.048us
     %1972 = :aten::sign [[2, 32]] -> 1.376us
                 -->kernel: 0:7 %1835 =  [] -> 1.376us
     %1973 = :aten::mul [[2, 32], []] -> 1.280us
                 -->kernel: 0:7 %1836 =  [] -> 1.280us
     %1974 = :aten::add [[2, 32], [2, 32], []] -> 2.944us
                 -->kernel: 0:7 %1837 =  [] -> 2.944us
     %1975 = :aten::zero_ [[32]] -> 1.184us
       %1976 = :aten::fill_ [[32], []] -> 1.184us
                 -->kernel: 0:7 %1838 =  [] -> 1.184us
     %1977 = :aten::copy_ [[32], [32], []] -> 1.024us
     %1978 = :aten::zero_ [[32]] -> 896.000ns
       %1979 = :aten::fill_ [[32], []] -> 896.000ns
                 -->kernel: 0:7 %1839 =  [] -> 896.000ns
     %1980 = :aten::copy_ [[32], [32], []] -> 1.120us
     %1981 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %1982 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %1983 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %1984 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 9.888us
       %1985 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 9.888us
         %1986 = :nccl:all_reduce [[1]] -> 9.888us
           %1987 = NCCL:ncclAllReduce [] -> 9.888us
                 -->kernel: 0:7 %1840 =  [] -> 9.888us
     %1988 = :aten::item [[1]] -> 2.240us
       %1989 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %1990 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %1991 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %1992 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %1993 = :aten::zeros [[], [], [], [], []] -> 960.000ns
       %1994 = :aten::zero_ [[320]] -> 960.000ns
         %1995 = :aten::fill_ [[320], []] -> 960.000ns
                 -->kernel: 0:7 %1841 =  [] -> 960.000ns
     %1996 = :nvte_multi_tensor_l2norm_cuda [] -> 1.385ms
                 -->kernel: 0:7 %1842 =  [] -> 35.616us
                 -->kernel: 0:7 %1843 =  [] -> 33.760us
                 -->kernel: 0:7 %1844 =  [] -> 29.856us
                 -->kernel: 0:7 %1845 =  [] -> 29.664us
                 -->kernel: 0:7 %1846 =  [] -> 29.888us
                 -->kernel: 0:7 %1847 =  [] -> 29.952us
                 -->kernel: 0:7 %1848 =  [] -> 30.528us
                 -->kernel: 0:7 %1849 =  [] -> 30.240us
                 -->kernel: 0:7 %1850 =  [] -> 30.080us
                 -->kernel: 0:7 %1851 =  [] -> 29.856us
                 -->kernel: 0:7 %1852 =  [] -> 29.984us
                 -->kernel: 0:7 %1853 =  [] -> 30.528us
                 -->kernel: 0:7 %1854 =  [] -> 29.600us
                 -->kernel: 0:7 %1855 =  [] -> 29.984us
                 -->kernel: 0:7 %1856 =  [] -> 30.496us
                 -->kernel: 0:7 %1857 =  [] -> 29.856us
                 -->kernel: 0:7 %1858 =  [] -> 30.336us
                 -->kernel: 0:7 %1859 =  [] -> 29.856us
                 -->kernel: 0:7 %1860 =  [] -> 29.920us
                 -->kernel: 0:7 %1861 =  [] -> 29.569us
                 -->kernel: 0:7 %1862 =  [] -> 29.824us
                 -->kernel: 0:7 %1863 =  [] -> 30.240us
                 -->kernel: 0:7 %1864 =  [] -> 30.080us
                 -->kernel: 0:7 %1865 =  [] -> 29.760us
                 -->kernel: 0:7 %1866 =  [] -> 29.568us
                 -->kernel: 0:7 %1867 =  [] -> 30.112us
                 -->kernel: 0:7 %1868 =  [] -> 29.984us
                 -->kernel: 0:7 %1869 =  [] -> 29.856us
                 -->kernel: 0:7 %1870 =  [] -> 30.048us
                 -->kernel: 0:7 %1871 =  [] -> 30.592us
                 -->kernel: 0:7 %1872 =  [] -> 29.921us
                 -->kernel: 0:7 %1873 =  [] -> 30.112us
                 -->kernel: 0:7 %1874 =  [] -> 30.080us
                 -->kernel: 0:7 %1875 =  [] -> 29.920us
                 -->kernel: 0:7 %1876 =  [] -> 17.216us
                 -->kernel: 0:7 %1877 =  [] -> 1.504us
     %1997 = :aten::pow [[1], []] -> 1.344us
                 -->kernel: 0:7 %1878 =  [] -> 1.344us
     %1998 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 61.824us
       %1999 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 61.824us
         %2000 = :nccl:all_reduce [[1]] -> 61.824us
           %2001 = NCCL:ncclAllReduce [] -> 61.824us
                 -->kernel: 0:7 %1879 =  [] -> 61.824us
     %2002 = :aten::item [[1]] -> 2.240us
       %2003 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %2004 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2005 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2006 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2007 = :nvte_multi_tensor_scale_cuda [] -> 931.202us
                 -->kernel: 0:7 %1880 =  [] -> 35.680us
                 -->kernel: 0:7 %1881 =  [] -> 43.200us
                 -->kernel: 0:7 %1882 =  [] -> 42.976us
                 -->kernel: 0:7 %1883 =  [] -> 43.392us
                 -->kernel: 0:7 %1884 =  [] -> 42.720us
                 -->kernel: 0:7 %1885 =  [] -> 43.584us
                 -->kernel: 0:7 %1886 =  [] -> 43.264us
                 -->kernel: 0:7 %1887 =  [] -> 43.904us
                 -->kernel: 0:7 %1888 =  [] -> 42.944us
                 -->kernel: 0:7 %1889 =  [] -> 43.904us
                 -->kernel: 0:7 %1890 =  [] -> 42.880us
                 -->kernel: 0:7 %1891 =  [] -> 43.744us
                 -->kernel: 0:7 %1892 =  [] -> 42.848us
                 -->kernel: 0:7 %1893 =  [] -> 43.552us
                 -->kernel: 0:7 %1894 =  [] -> 42.785us
                 -->kernel: 0:7 %1895 =  [] -> 42.880us
                 -->kernel: 0:7 %1896 =  [] -> 43.008us
                 -->kernel: 0:7 %1897 =  [] -> 29.088us
     %2008 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2009 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2010 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2011 = :nvte_multi_tensor_scale_cuda [] -> 880.226us
                 -->kernel: 0:7 %1898 =  [] -> 43.008us
                 -->kernel: 0:7 %1899 =  [] -> 43.072us
                 -->kernel: 0:7 %1900 =  [] -> 43.040us
                 -->kernel: 0:7 %1901 =  [] -> 43.168us
                 -->kernel: 0:7 %1902 =  [] -> 43.904us
                 -->kernel: 0:7 %1903 =  [] -> 42.816us
                 -->kernel: 0:7 %1904 =  [] -> 43.648us
                 -->kernel: 0:7 %1905 =  [] -> 42.592us
                 -->kernel: 0:7 %1906 =  [] -> 43.264us
                 -->kernel: 0:7 %1907 =  [] -> 42.785us
                 -->kernel: 0:7 %1908 =  [] -> 44.320us
                 -->kernel: 0:7 %1909 =  [] -> 42.976us
                 -->kernel: 0:7 %1910 =  [] -> 43.840us
                 -->kernel: 0:7 %1911 =  [] -> 42.784us
                 -->kernel: 0:7 %1912 =  [] -> 44.576us
                 -->kernel: 0:7 %1913 =  [] -> 43.296us
                 -->kernel: 0:7 %1914 =  [] -> 28.192us
     %2012 = :Optimizer.step#HybridDeviceOptimizer.step None -> 318.716ms
       %2013 = :aten::copy_ [[375301632], [375301632], []] -> 43.768ms
         %2014 = :aten::to [[375301632], [], [], [], []] -> 2.226ms
           %2015 = :aten::_to_copy [[375301632], [], [], [], [], [], []] -> 2.226ms
             %2016 = :aten::copy_ [[375301632], [375301632], []] -> 2.226ms
                 -->kernel: 0:7 %1915 =  [] -> 2.226ms
         %2017 = :aten::copy_ [[375301632], [375301632], []] -> 41.491ms
       %2018 = :Optimizer.step#AdamW.step None -> 72.260ms
         %2019 = :aten::copy_ [[375301632], [375301632], []] -> 72.260ms
           %2020 = :aten::copy_ [[375301632], [375301632], []] -> 71.539ms
           %2021 = :aten::copy_ [[375301632], [375301632], []] -> 604.257us
                 -->kernel: 0:7 %1916 =  [] -> 604.257us
     %2022 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 340.800ms
       %2023 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 340.800ms
         %2024 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 340.800ms
           %2025 = NCCL:ncclGroupEnd [] -> 340.800ms
                 -->kernel: 0:39 %1917 =  [] -> 340.800ms
     %2026 = :Optimizer.step#HybridDeviceOptimizer.step None -> 84.159ms
       %2027 = :aten::to [[14680064], [], [], [], []] -> 89.089us
         %2028 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.089us
           %2029 = :aten::copy_ [[14680064], [14680064], []] -> 89.089us
                 -->kernel: 0:7 %1918 =  [] -> 89.089us
       %2030 = :aten::to [[29360128], [], [], [], []] -> 176.224us
         %2031 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.224us
           %2032 = :aten::copy_ [[29360128], [29360128], []] -> 176.224us
                 -->kernel: 0:7 %1919 =  [] -> 176.224us
       %2033 = :aten::to [[29360128], [], [], [], []] -> 176.417us
         %2034 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.417us
           %2035 = :aten::copy_ [[29360128], [29360128], []] -> 176.417us
                 -->kernel: 0:7 %1920 =  [] -> 176.417us
       %2036 = :aten::to [[29360128], [], [], [], []] -> 176.000us
         %2037 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.000us
           %2038 = :aten::copy_ [[29360128], [29360128], []] -> 176.000us
                 -->kernel: 0:7 %1921 =  [] -> 176.000us
       %2039 = :aten::to [[29360128], [], [], [], []] -> 176.097us
         %2040 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.097us
           %2041 = :aten::copy_ [[29360128], [29360128], []] -> 176.097us
                 -->kernel: 0:7 %1922 =  [] -> 176.097us
       %2042 = :aten::to [[14680064], [], [], [], []] -> 89.184us
         %2043 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.184us
           %2044 = :aten::copy_ [[14680064], [14680064], []] -> 89.184us
                 -->kernel: 0:7 %1923 =  [] -> 89.184us
       %2045 = :aten::to [[14680064], [], [], [], []] -> 89.568us
         %2046 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.568us
           %2047 = :aten::copy_ [[14680064], [14680064], []] -> 89.568us
                 -->kernel: 0:7 %1924 =  [] -> 89.568us
       %2048 = :aten::to [[14680064], [], [], [], []] -> 89.632us
         %2049 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.632us
           %2050 = :aten::copy_ [[14680064], [14680064], []] -> 89.632us
                 -->kernel: 0:7 %1925 =  [] -> 89.632us
       %2051 = :aten::to [[14680064], [], [], [], []] -> 89.633us
         %2052 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.633us
           %2053 = :aten::copy_ [[14680064], [14680064], []] -> 89.633us
                 -->kernel: 0:7 %1926 =  [] -> 89.633us
       %2054 = :aten::to [[29360128], [], [], [], []] -> 176.256us
         %2055 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.256us
           %2056 = :aten::copy_ [[29360128], [29360128], []] -> 176.256us
                 -->kernel: 0:7 %1927 =  [] -> 176.256us
       %2057 = :aten::to [[29360128], [], [], [], []] -> 176.257us
         %2058 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.257us
           %2059 = :aten::copy_ [[29360128], [29360128], []] -> 176.257us
                 -->kernel: 0:7 %1928 =  [] -> 176.257us
       %2060 = :aten::to [[29360128], [], [], [], []] -> 175.968us
         %2061 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 175.968us
           %2062 = :aten::copy_ [[29360128], [29360128], []] -> 175.968us
                 -->kernel: 0:7 %1929 =  [] -> 175.968us
       %2063 = :aten::to [[29360128], [], [], [], []] -> 175.521us
         %2064 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 175.521us
           %2065 = :aten::copy_ [[29360128], [29360128], []] -> 175.521us
                 -->kernel: 0:7 %1930 =  [] -> 175.521us
       %2066 = :aten::copy_ [[14680064], [14680064], []] -> 2.001ms
         %2067 = :aten::to [[14680064], [], [], [], []] -> 89.152us
           %2068 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.152us
             %2069 = :aten::copy_ [[14680064], [14680064], []] -> 89.152us
                 -->kernel: 0:7 %1931 =  [] -> 89.152us
         %2070 = :aten::copy_ [[14680064], [14680064], []] -> 1.854ms
       %2071 = :aten::copy_ [[14680064], [14680064], []] -> 1.838ms
         %2072 = :aten::to [[14680064], [], [], [], []] -> 88.192us
           %2073 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.192us
             %2074 = :aten::copy_ [[14680064], [14680064], []] -> 88.192us
                 -->kernel: 0:7 %1932 =  [] -> 88.192us
         %2075 = :aten::copy_ [[14680064], [14680064], []] -> 1.717ms
       %2076 = :aten::copy_ [[14680064], [14680064], []] -> 1.795ms
         %2077 = :aten::to [[14680064], [], [], [], []] -> 88.161us
           %2078 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.161us
             %2079 = :aten::copy_ [[14680064], [14680064], []] -> 88.161us
                 -->kernel: 0:7 %1933 =  [] -> 88.161us
         %2080 = :aten::copy_ [[14680064], [14680064], []] -> 1.677ms
       %2081 = :Optimizer.step#FusedAdam.step None -> 3.870ms
         %2082 = :nvte_multi_tensor_adam_cuda [] -> 3.081ms
                 -->kernel: 0:7 %1934 =  [] -> 198.080us
                 -->kernel: 0:7 %1935 =  [] -> 200.097us
                 -->kernel: 0:7 %1936 =  [] -> 199.008us
                 -->kernel: 0:7 %1937 =  [] -> 197.697us
                 -->kernel: 0:7 %1938 =  [] -> 199.520us
                 -->kernel: 0:7 %1939 =  [] -> 198.976us
                 -->kernel: 0:7 %1940 =  [] -> 200.449us
                 -->kernel: 0:7 %1941 =  [] -> 199.488us
                 -->kernel: 0:7 %1942 =  [] -> 197.953us
                 -->kernel: 0:7 %1943 =  [] -> 199.488us
                 -->kernel: 0:7 %1944 =  [] -> 199.457us
                 -->kernel: 0:7 %1945 =  [] -> 199.424us
                 -->kernel: 0:7 %1946 =  [] -> 197.889us
                 -->kernel: 0:7 %1947 =  [] -> 200.032us
                 -->kernel: 0:7 %1948 =  [] -> 140.321us
         %2083 = :aten::copy_ [[14680064], [14680064], []] -> 27.264us
                 -->kernel: 0:7 %1949 =  [] -> 27.264us
         %2084 = :aten::copy_ [[29360128], [29360128], []] -> 50.016us
                 -->kernel: 0:7 %1950 =  [] -> 50.016us
         %2085 = :aten::copy_ [[29360128], [29360128], []] -> 48.064us
                 -->kernel: 0:7 %1951 =  [] -> 48.064us
         %2086 = :aten::copy_ [[29360128], [29360128], []] -> 48.128us
                 -->kernel: 0:7 %1952 =  [] -> 48.128us
         %2087 = :aten::copy_ [[29360128], [29360128], []] -> 49.664us
                 -->kernel: 0:7 %1953 =  [] -> 49.664us
         %2088 = :aten::copy_ [[14680064], [14680064], []] -> 25.249us
                 -->kernel: 0:7 %1954 =  [] -> 25.249us
         %2089 = :aten::copy_ [[14680064], [14680064], []] -> 25.152us
                 -->kernel: 0:7 %1955 =  [] -> 25.152us
         %2090 = :aten::copy_ [[14680064], [14680064], []] -> 25.056us
                 -->kernel: 0:7 %1956 =  [] -> 25.056us
         %2091 = :aten::copy_ [[14680064], [14680064], []] -> 25.056us
                 -->kernel: 0:7 %1957 =  [] -> 25.056us
         %2092 = :aten::copy_ [[29360128], [29360128], []] -> 48.800us
                 -->kernel: 0:7 %1958 =  [] -> 48.800us
         %2093 = :aten::copy_ [[29360128], [29360128], []] -> 49.472us
                 -->kernel: 0:7 %1959 =  [] -> 49.472us
         %2094 = :aten::copy_ [[29360128], [29360128], []] -> 48.096us
                 -->kernel: 0:7 %1960 =  [] -> 48.096us
         %2095 = :aten::copy_ [[29360128], [29360128], []] -> 49.600us
                 -->kernel: 0:7 %1961 =  [] -> 49.600us
       %2096 = :Optimizer.step#AdamW.step None -> 8.744ms
         %2097 = :aten::copy_ [[14680064], [14680064], []] -> 2.927ms
           %2098 = :aten::copy_ [[14680064], [14680064], []] -> 2.849ms
           %2099 = :aten::copy_ [[14680064], [14680064], []] -> 24.576us
                 -->kernel: 0:7 %1962 =  [] -> 24.576us
         %2100 = :aten::copy_ [[14680064], [14680064], []] -> 2.780ms
           %2101 = :aten::copy_ [[14680064], [14680064], []] -> 2.742ms
           %2102 = :aten::copy_ [[14680064], [14680064], []] -> 23.808us
                 -->kernel: 0:7 %1963 =  [] -> 23.808us
         %2103 = :aten::copy_ [[14680064], [14680064], []] -> 2.764ms
           %2104 = :aten::copy_ [[14680064], [14680064], []] -> 2.730ms
           %2105 = :aten::copy_ [[14680064], [14680064], []] -> 24.256us
                 -->kernel: 0:7 %1964 =  [] -> 24.256us
     %2106 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 53.551ms
       %2107 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 53.551ms
         %2108 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 53.551ms
           %2109 = NCCL:ncclGroupEnd [] -> 53.551ms
                 -->kernel: 0:39 %1965 =  [] -> 53.551ms
     %2110 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2111 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2112 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2113 = :aten::item [[1]] -> 3.040us
       %2114 = :aten::_local_scalar_dense [[1]] -> 3.040us
     %2115 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2116 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2117 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2118 = :aten::item [[1]] -> 2.240us
       %2119 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %2120 = :aten::item [[1]] -> 2.240us
       %2121 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %2122 = :aten::cat [[1], []] -> 1.728us
     %2123 = :aten::mean [[1], []] -> 2.528us
       %2124 = :aten::mean [[1], [], [], []] -> 2.528us
                 -->kernel: 0:7 %1966 =  [] -> 2.528us
     %2125 = :aten::item [[1]] -> 2.720us
       %2126 = :aten::_local_scalar_dense [[1]] -> 2.720us
     %2127 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2128 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2129 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2130 = :aten::add [[1], [], []] -> 1.472us
                 -->kernel: 0:7 %1967 =  [] -> 1.472us
     %2131 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %2132 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %2133 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %2134 = :aten::item [[1]] -> 2.240us
       %2135 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %2136 = :aten::item [[1]] -> 2.240us
       %2137 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %2138 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 1.917ms
       %2139 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 1.917ms
         %2140 = :nccl:all_reduce [[2]] -> 1.917ms
           %2141 = NCCL:ncclAllReduce [] -> 1.917ms
                 -->kernel: 0:7 %1968 =  [] -> 1.917ms
     %2142 = :c10d::allreduce_ [[3], [], [], [], [], []] -> 9.344us
       %2143 = :record_param_comms [[3], [], [], [], [], [], [], [], [], []] -> 9.344us
         %2144 = :nccl:all_reduce [[3]] -> 9.344us
           %2145 = NCCL:ncclAllReduce [] -> 9.344us
                 -->kernel: 0:7 %1969 =  [] -> 9.344us
     %2146 = :aten::mul [[3], []] -> 1.312us
                 -->kernel: 0:7 %1970 =  [] -> 1.312us
     %2147 = :aten::mul [[2], []] -> 1.376us
                 -->kernel: 0:7 %1971 =  [] -> 1.376us
     %2148 = :aten::sum [[3], []] -> 3.040us
       %2149 = :aten::sum [[3], [], [], []] -> 3.040us
                 -->kernel: 0:7 %1972 =  [] -> 3.040us
     %2150 = :aten::div [[], []] -> 1.504us
                 -->kernel: 0:7 %1973 =  [] -> 1.504us
     %2151 = :aten::add_ [[1], [], []] -> 1.600us
                 -->kernel: 0:7 %1974 =  [] -> 1.600us
     %2152 = :aten::sum [[2], []] -> 2.144us
       %2153 = :aten::sum [[2], [], [], []] -> 2.144us
                 -->kernel: 0:7 %1975 =  [] -> 2.144us
     %2154 = :aten::div [[], []] -> 1.280us
                 -->kernel: 0:7 %1976 =  [] -> 1.280us
     %2155 = :aten::add_ [[1], [], []] -> 1.472us
                 -->kernel: 0:7 %1977 =  [] -> 1.472us
     %2156 = :aten::zero_ [[3]] -> 992.000ns
       %2157 = :aten::fill_ [[3], []] -> 992.000ns
                 -->kernel: 0:7 %1978 =  [] -> 992.000ns
     %2158 = :aten::zero_ [[2]] -> 960.000ns
       %2159 = :aten::fill_ [[2], []] -> 960.000ns
                 -->kernel: 0:7 %1979 =  [] -> 960.000ns
     %2160 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 304.961us
       %2161 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 304.961us
         %2162 = :nccl:all_reduce [[1]] -> 304.961us
           %2163 = NCCL:ncclAllReduce [] -> 304.961us
                 -->kernel: 0:7 %1980 =  [] -> 304.961us
     %2164 = :aten::mul [[1], []] -> 1.344us
                 -->kernel: 0:7 %1981 =  [] -> 1.344us
     %2165 = :aten::add_ [[1], [], []] -> 1.280us
                 -->kernel: 0:7 %1982 =  [] -> 1.280us
     %2166 = :aten::zero_ [[1]] -> 992.000ns
       %2167 = :aten::fill_ [[1], []] -> 992.000ns
                 -->kernel: 0:7 %1983 =  [] -> 992.000ns
     %2168 = :c10d::barrier [[1], [], [], [], []] -> 139.104us
       %2169 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 139.104us
         %2170 = :aten::zeros [[], [], [], [], []] -> 1.152us
           %2171 = :aten::zero_ [[1]] -> 1.152us
             %2172 = :aten::fill_ [[1], []] -> 1.152us
                 -->kernel: 0:7 %1984 =  [] -> 1.152us
         %2173 = :nccl:all_reduce_barrier [[1]] -> 103.232us
           %2174 = NCCL:ncclAllReduce [] -> 103.232us
                 -->kernel: 0:7 %1985 =  [] -> 103.232us
     %2175 = :c10d::barrier [[1], [], [], [], []] -> 37.696us
       %2176 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 37.696us
         %2177 = :aten::zeros [[], [], [], [], []] -> 992.000ns
           %2178 = :aten::zero_ [[1]] -> 992.000ns
             %2179 = :aten::fill_ [[1], []] -> 992.000ns
                 -->kernel: 0:7 %1986 =  [] -> 992.000ns
         %2180 = :nccl:all_reduce_barrier [[1]] -> 7.552us
           %2181 = NCCL:ncclAllReduce [] -> 7.552us
                 -->kernel: 0:7 %1987 =  [] -> 7.552us
     %2182 = :aten::item [[1]] -> 2.208us
       %2183 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %2184 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2185 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2186 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2187 = :aten::item [[1]] -> 2.208us
       %2188 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %2189 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2190 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2191 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2192 = :aten::item [[1]] -> 2.240us
       %2193 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %2194 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2195 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2196 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2197 = :aten::item [[1]] -> 2.240us
       %2198 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %2199 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2200 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2201 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2202 = :aten::zeros [[], [], [], [], []] -> 1.184us
       %2203 = :aten::zero_ [[8, 24]] -> 1.184us
         %2204 = :aten::fill_ [[8, 24], []] -> 1.184us
                 -->kernel: 0:7 %1988 =  [] -> 1.184us
     %2205 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 65.408us
       %2206 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 65.408us
         %2207 = :nccl:_all_gather_base [[24]] -> 65.408us
           %2208 = NCCL:ncclAllGather [] -> 65.408us
                 -->kernel: 0:7 %1989 =  [] -> 65.408us
     %2209 = :aten::gt [[8], []] -> 1.536us
                 -->kernel: 0:7 %1990 =  [] -> 1.536us
     %2210 = :aten::index [[8], [8]] -> 62.272us
       %2211 = :aten::nonzero [[8]] -> 62.272us
         %2212 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %1991 =  [] -> 1.472us
         %2213 = CCCL:cub::DeviceSelect::Flagged [] -> 15.808us
                 -->kernel: 0:7 %1992 =  [] -> 1.312us
                 -->kernel: 0:7 %1993 =  [] -> 2.240us
     %2214 = :aten::gt [[8], []] -> 1.568us
                 -->kernel: 0:7 %1994 =  [] -> 1.568us
     %2215 = :aten::index [[8], [8]] -> 44.800us
       %2216 = :aten::nonzero [[8]] -> 44.800us
         %2217 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %1995 =  [] -> 1.280us
         %2218 = CCCL:cub::DeviceSelect::Flagged [] -> 12.640us
                 -->kernel: 0:7 %1996 =  [] -> 1.344us
                 -->kernel: 0:7 %1997 =  [] -> 2.112us
     %2219 = :aten::gt [[8], []] -> 1.472us
                 -->kernel: 0:7 %1998 =  [] -> 1.472us
     %2220 = :aten::index [[8], [8]] -> 43.521us
       %2221 = :aten::nonzero [[8]] -> 43.521us
         %2222 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1999 =  [] -> 1.312us
         %2223 = CCCL:cub::DeviceSelect::Flagged [] -> 12.321us
                 -->kernel: 0:7 %2000 =  [] -> 1.312us
                 -->kernel: 0:7 %2001 =  [] -> 2.145us
     %2224 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2002 =  [] -> 1.408us
     %2225 = :aten::index [[8], [8]] -> 43.104us
       %2226 = :aten::nonzero [[8]] -> 43.104us
         %2227 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2003 =  [] -> 1.280us
         %2228 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2004 =  [] -> 1.344us
                 -->kernel: 0:7 %2005 =  [] -> 2.112us
     %2229 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2006 =  [] -> 1.408us
     %2230 = :aten::index [[8], [8]] -> 43.104us
       %2231 = :aten::nonzero [[8]] -> 43.104us
         %2232 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2007 =  [] -> 1.280us
         %2233 = CCCL:cub::DeviceSelect::Flagged [] -> 12.192us
                 -->kernel: 0:7 %2008 =  [] -> 1.312us
                 -->kernel: 0:7 %2009 =  [] -> 2.176us
     %2234 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2010 =  [] -> 1.408us
     %2235 = :aten::index [[8], [8]] -> 43.552us
       %2236 = :aten::nonzero [[8]] -> 43.552us
         %2237 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2011 =  [] -> 1.280us
         %2238 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %2012 =  [] -> 1.376us
                 -->kernel: 0:7 %2013 =  [] -> 2.112us
     %2239 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2014 =  [] -> 1.440us
     %2240 = :aten::index [[8], [8]] -> 42.976us
       %2241 = :aten::nonzero [[8]] -> 42.976us
         %2242 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2015 =  [] -> 1.280us
         %2243 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %2016 =  [] -> 1.312us
                 -->kernel: 0:7 %2017 =  [] -> 2.176us
     %2244 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2018 =  [] -> 1.440us
     %2245 = :aten::index [[8], [8]] -> 44.224us
       %2246 = :aten::nonzero [[8]] -> 44.224us
         %2247 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2019 =  [] -> 1.280us
         %2248 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2020 =  [] -> 1.344us
                 -->kernel: 0:7 %2021 =  [] -> 2.112us
     %2249 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2022 =  [] -> 1.408us
     %2250 = :aten::index [[8], [8]] -> 43.136us
       %2251 = :aten::nonzero [[8]] -> 43.136us
         %2252 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2023 =  [] -> 1.280us
         %2253 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2024 =  [] -> 1.312us
                 -->kernel: 0:7 %2025 =  [] -> 2.144us
     %2254 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2026 =  [] -> 1.408us
     %2255 = :aten::index [[8], [8]] -> 42.432us
       %2256 = :aten::nonzero [[8]] -> 42.432us
         %2257 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2027 =  [] -> 1.280us
         %2258 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %2028 =  [] -> 1.344us
                 -->kernel: 0:7 %2029 =  [] -> 2.112us
     %2259 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2030 =  [] -> 1.440us
     %2260 = :aten::index [[8], [8]] -> 44.128us
       %2261 = :aten::nonzero [[8]] -> 44.128us
         %2262 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2031 =  [] -> 1.280us
         %2263 = CCCL:cub::DeviceSelect::Flagged [] -> 12.384us
                 -->kernel: 0:7 %2032 =  [] -> 1.344us
                 -->kernel: 0:7 %2033 =  [] -> 2.144us
     %2264 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2034 =  [] -> 1.408us
     %2265 = :aten::index [[8], [8]] -> 49.088us
       %2266 = :aten::nonzero [[8]] -> 49.088us
         %2267 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2035 =  [] -> 1.280us
         %2268 = CCCL:cub::DeviceSelect::Flagged [] -> 13.536us
                 -->kernel: 0:7 %2036 =  [] -> 1.344us
                 -->kernel: 0:7 %2037 =  [] -> 2.080us
     %2269 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2038 =  [] -> 1.440us
     %2270 = :aten::index [[8], [8]] -> 44.736us
       %2271 = :aten::nonzero [[8]] -> 44.736us
         %2272 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2039 =  [] -> 1.280us
         %2273 = CCCL:cub::DeviceSelect::Flagged [] -> 12.384us
                 -->kernel: 0:7 %2040 =  [] -> 1.344us
                 -->kernel: 0:7 %2041 =  [] -> 2.144us
     %2274 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2042 =  [] -> 1.440us
     %2275 = :aten::index [[8], [8]] -> 43.104us
       %2276 = :aten::nonzero [[8]] -> 43.104us
         %2277 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2043 =  [] -> 1.312us
         %2278 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %2044 =  [] -> 1.344us
                 -->kernel: 0:7 %2045 =  [] -> 2.144us
     %2279 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2046 =  [] -> 1.440us
     %2280 = :aten::index [[8], [8]] -> 44.448us
       %2281 = :aten::nonzero [[8]] -> 44.448us
         %2282 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2047 =  [] -> 1.312us
         %2283 = CCCL:cub::DeviceSelect::Flagged [] -> 12.512us
                 -->kernel: 0:7 %2048 =  [] -> 1.344us
                 -->kernel: 0:7 %2049 =  [] -> 2.176us
     %2284 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2050 =  [] -> 1.440us
     %2285 = :aten::index [[8], [8]] -> 42.721us
       %2286 = :aten::nonzero [[8]] -> 42.721us
         %2287 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2051 =  [] -> 1.280us
         %2288 = CCCL:cub::DeviceSelect::Flagged [] -> 12.320us
                 -->kernel: 0:7 %2052 =  [] -> 1.344us
                 -->kernel: 0:7 %2053 =  [] -> 2.144us
     %2289 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2054 =  [] -> 1.440us
     %2290 = :aten::index [[8], [8]] -> 43.360us
       %2291 = :aten::nonzero [[8]] -> 43.360us
         %2292 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2055 =  [] -> 1.312us
         %2293 = CCCL:cub::DeviceSelect::Flagged [] -> 12.192us
                 -->kernel: 0:7 %2056 =  [] -> 1.312us
                 -->kernel: 0:7 %2057 =  [] -> 2.144us
     %2294 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2058 =  [] -> 1.408us
     %2295 = :aten::index [[8], [8]] -> 42.336us
       %2296 = :aten::nonzero [[8]] -> 42.336us
         %2297 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2059 =  [] -> 1.280us
         %2298 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2060 =  [] -> 1.376us
                 -->kernel: 0:7 %2061 =  [] -> 2.144us
     %2299 = :aten::gt [[8], []] -> 1.472us
                 -->kernel: 0:7 %2062 =  [] -> 1.472us
     %2300 = :aten::index [[8], [8]] -> 42.880us
       %2301 = :aten::nonzero [[8]] -> 42.880us
         %2302 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2063 =  [] -> 1.312us
         %2303 = CCCL:cub::DeviceSelect::Flagged [] -> 12.384us
                 -->kernel: 0:7 %2064 =  [] -> 1.344us
                 -->kernel: 0:7 %2065 =  [] -> 2.176us
     %2304 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2066 =  [] -> 1.440us
     %2305 = :aten::index [[8], [8]] -> 42.560us
       %2306 = :aten::nonzero [[8]] -> 42.560us
         %2307 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2067 =  [] -> 1.280us
         %2308 = CCCL:cub::DeviceSelect::Flagged [] -> 12.416us
                 -->kernel: 0:7 %2068 =  [] -> 1.376us
                 -->kernel: 0:7 %2069 =  [] -> 2.144us
     %2309 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2070 =  [] -> 1.440us
     %2310 = :aten::index [[8], [8]] -> 43.296us
       %2311 = :aten::nonzero [[8]] -> 43.296us
         %2312 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2071 =  [] -> 1.312us
         %2313 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2072 =  [] -> 1.344us
                 -->kernel: 0:7 %2073 =  [] -> 2.176us
     %2314 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2074 =  [] -> 1.408us
     %2315 = :aten::index [[8], [8]] -> 47.808us
       %2316 = :aten::nonzero [[8]] -> 47.808us
         %2317 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2075 =  [] -> 1.312us
         %2318 = CCCL:cub::DeviceSelect::Flagged [] -> 17.152us
                 -->kernel: 0:7 %2076 =  [] -> 1.376us
                 -->kernel: 0:7 %2077 =  [] -> 2.144us
     %2319 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2078 =  [] -> 1.440us
     %2320 = :aten::index [[8], [8]] -> 43.072us
       %2321 = :aten::nonzero [[8]] -> 43.072us
         %2322 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2079 =  [] -> 1.312us
         %2323 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2080 =  [] -> 1.312us
                 -->kernel: 0:7 %2081 =  [] -> 2.176us
     %2324 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2082 =  [] -> 1.440us
     %2325 = :aten::index [[8], [8]] -> 42.336us
       %2326 = :aten::nonzero [[8]] -> 42.336us
         %2327 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2083 =  [] -> 1.312us
         %2328 = CCCL:cub::DeviceSelect::Flagged [] -> 12.288us
                 -->kernel: 0:7 %2084 =  [] -> 1.376us
                 -->kernel: 0:7 %2085 =  [] -> 2.144us
     %2329 = :aten::zeros [[], [], [], [], []] -> 1.024us
       %2330 = :aten::zero_ [[8, 24]] -> 1.024us
         %2331 = :aten::fill_ [[8, 24], []] -> 1.024us
                 -->kernel: 0:7 %2086 =  [] -> 1.024us
     %2332 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.488us
       %2333 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.488us
         %2334 = :nccl:_all_gather_base [[24]] -> 7.488us
           %2335 = NCCL:ncclAllGather [] -> 7.488us
                 -->kernel: 0:7 %2087 =  [] -> 7.488us
     %2336 = :aten::gt [[8], []] -> 1.984us
                 -->kernel: 0:7 %2088 =  [] -> 1.984us
     %2337 = :aten::index [[8], [8]] -> 49.216us
       %2338 = :aten::nonzero [[8]] -> 49.216us
         %2339 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %2089 =  [] -> 1.536us
         %2340 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2090 =  [] -> 1.088us
                 -->kernel: 0:7 %2091 =  [] -> 1.856us
     %2341 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %2092 =  [] -> 1.792us
     %2342 = :aten::index [[8], [8]] -> 43.840us
       %2343 = :aten::nonzero [[8]] -> 43.840us
         %2344 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %2093 =  [] -> 1.440us
         %2345 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %2094 =  [] -> 1.088us
                 -->kernel: 0:7 %2095 =  [] -> 1.856us
     %2346 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %2096 =  [] -> 1.760us
     %2347 = :aten::index [[8], [8]] -> 43.968us
       %2348 = :aten::nonzero [[8]] -> 43.968us
         %2349 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %2097 =  [] -> 1.504us
         %2350 = CCCL:cub::DeviceSelect::Flagged [] -> 11.616us
                 -->kernel: 0:7 %2098 =  [] -> 1.056us
                 -->kernel: 0:7 %2099 =  [] -> 1.824us
     %2351 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %2100 =  [] -> 1.824us
     %2352 = :aten::index [[8], [8]] -> 47.296us
       %2353 = :aten::nonzero [[8]] -> 47.296us
         %2354 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %2101 =  [] -> 1.440us
         %2355 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %2102 =  [] -> 1.088us
                 -->kernel: 0:7 %2103 =  [] -> 1.856us
     %2356 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %2104 =  [] -> 1.760us
     %2357 = :aten::index [[8], [8]] -> 42.752us
       %2358 = :aten::nonzero [[8]] -> 42.752us
         %2359 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %2105 =  [] -> 1.504us
         %2360 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %2106 =  [] -> 1.056us
                 -->kernel: 0:7 %2107 =  [] -> 1.824us
     %2361 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %2108 =  [] -> 1.792us
     %2362 = :aten::index [[8], [8]] -> 42.464us
       %2363 = :aten::nonzero [[8]] -> 42.464us
         %2364 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %2109 =  [] -> 1.472us
         %2365 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %2110 =  [] -> 1.056us
                 -->kernel: 0:7 %2111 =  [] -> 1.856us
     %2366 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %2112 =  [] -> 1.792us
     %2367 = :aten::index [[8], [8]] -> 42.016us
       %2368 = :aten::nonzero [[8]] -> 42.016us
         %2369 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %2113 =  [] -> 1.472us
         %2370 = CCCL:cub::DeviceSelect::Flagged [] -> 11.456us
                 -->kernel: 0:7 %2114 =  [] -> 1.056us
                 -->kernel: 0:7 %2115 =  [] -> 1.824us
     %2371 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %2116 =  [] -> 1.824us
     %2372 = :aten::index [[8], [8]] -> 41.888us
       %2373 = :aten::nonzero [[8]] -> 41.888us
         %2374 = CCCL:cub::DeviceReduce::Sum [] -> 1.376us
                 -->kernel: 0:7 %2117 =  [] -> 1.376us
         %2375 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %2118 =  [] -> 992.000ns
                 -->kernel: 0:7 %2119 =  [] -> 1.792us
     %2376 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2120 =  [] -> 1.728us
     %2377 = :aten::index [[8], [8]] -> 41.504us
       %2378 = :aten::nonzero [[8]] -> 41.504us
         %2379 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2121 =  [] -> 1.408us
         %2380 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %2122 =  [] -> 992.000ns
                 -->kernel: 0:7 %2123 =  [] -> 1.760us
     %2381 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %2124 =  [] -> 1.760us
     %2382 = :aten::index [[8], [8]] -> 43.521us
       %2383 = :aten::nonzero [[8]] -> 43.521us
         %2384 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2125 =  [] -> 1.408us
         %2385 = CCCL:cub::DeviceSelect::Flagged [] -> 11.616us
                 -->kernel: 0:7 %2126 =  [] -> 992.000ns
                 -->kernel: 0:7 %2127 =  [] -> 1.792us
     %2386 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %2128 =  [] -> 1.696us
     %2387 = :aten::index [[8], [8]] -> 41.536us
       %2388 = :aten::nonzero [[8]] -> 41.536us
         %2389 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2129 =  [] -> 1.408us
         %2390 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %2130 =  [] -> 992.000ns
                 -->kernel: 0:7 %2131 =  [] -> 1.760us
     %2391 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2132 =  [] -> 1.728us
     %2392 = :aten::index [[8], [8]] -> 42.752us
       %2393 = :aten::nonzero [[8]] -> 42.752us
         %2394 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2133 =  [] -> 1.408us
         %2395 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %2134 =  [] -> 992.000ns
                 -->kernel: 0:7 %2135 =  [] -> 1.792us
     %2396 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2136 =  [] -> 1.728us
     %2397 = :aten::index [[8], [8]] -> 41.568us
       %2398 = :aten::nonzero [[8]] -> 41.568us
         %2399 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %2137 =  [] -> 1.440us
         %2400 = CCCL:cub::DeviceSelect::Flagged [] -> 11.328us
                 -->kernel: 0:7 %2138 =  [] -> 992.000ns
                 -->kernel: 0:7 %2139 =  [] -> 1.760us
     %2401 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %2140 =  [] -> 1.760us
     %2402 = :aten::index [[8], [8]] -> 41.728us
       %2403 = :aten::nonzero [[8]] -> 41.728us
         %2404 = CCCL:cub::DeviceReduce::Sum [] -> 1.376us
                 -->kernel: 0:7 %2141 =  [] -> 1.376us
         %2405 = CCCL:cub::DeviceSelect::Flagged [] -> 11.680us
                 -->kernel: 0:7 %2142 =  [] -> 1.024us
                 -->kernel: 0:7 %2143 =  [] -> 1.824us
     %2406 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2144 =  [] -> 1.728us
     %2407 = :aten::index [[8], [8]] -> 42.720us
       %2408 = :aten::nonzero [[8]] -> 42.720us
         %2409 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2145 =  [] -> 1.408us
         %2410 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %2146 =  [] -> 992.000ns
                 -->kernel: 0:7 %2147 =  [] -> 1.760us
     %2411 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2148 =  [] -> 1.728us
     %2412 = :aten::index [[8], [8]] -> 42.720us
       %2413 = :aten::nonzero [[8]] -> 42.720us
         %2414 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2149 =  [] -> 1.408us
         %2415 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %2150 =  [] -> 1.024us
                 -->kernel: 0:7 %2151 =  [] -> 1.792us
     %2416 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2152 =  [] -> 1.728us
     %2417 = :aten::index [[8], [8]] -> 41.984us
       %2418 = :aten::nonzero [[8]] -> 41.984us
         %2419 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2153 =  [] -> 1.408us
         %2420 = CCCL:cub::DeviceSelect::Flagged [] -> 11.264us
                 -->kernel: 0:7 %2154 =  [] -> 992.000ns
                 -->kernel: 0:7 %2155 =  [] -> 1.760us
     %2421 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2156 =  [] -> 1.728us
     %2422 = :aten::index [[8], [8]] -> 41.984us
       %2423 = :aten::nonzero [[8]] -> 41.984us
         %2424 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2157 =  [] -> 1.408us
         %2425 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %2158 =  [] -> 992.000ns
                 -->kernel: 0:7 %2159 =  [] -> 1.792us
     %2426 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2160 =  [] -> 1.728us
     %2427 = :aten::index [[8], [8]] -> 42.464us
       %2428 = :aten::nonzero [[8]] -> 42.464us
         %2429 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %2161 =  [] -> 1.440us
         %2430 = CCCL:cub::DeviceSelect::Flagged [] -> 11.360us
                 -->kernel: 0:7 %2162 =  [] -> 992.000ns
                 -->kernel: 0:7 %2163 =  [] -> 1.760us
     %2431 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %2164 =  [] -> 1.760us
     %2432 = :aten::index [[8], [8]] -> 41.921us
       %2433 = :aten::nonzero [[8]] -> 41.921us
         %2434 = CCCL:cub::DeviceReduce::Sum [] -> 1.376us
                 -->kernel: 0:7 %2165 =  [] -> 1.376us
         %2435 = CCCL:cub::DeviceSelect::Flagged [] -> 11.616us
                 -->kernel: 0:7 %2166 =  [] -> 992.000ns
                 -->kernel: 0:7 %2167 =  [] -> 1.792us
     %2436 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %2168 =  [] -> 1.696us
     %2437 = :aten::index [[8], [8]] -> 42.304us
       %2438 = :aten::nonzero [[8]] -> 42.304us
         %2439 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %2169 =  [] -> 1.440us
         %2440 = CCCL:cub::DeviceSelect::Flagged [] -> 11.424us
                 -->kernel: 0:7 %2170 =  [] -> 992.000ns
                 -->kernel: 0:7 %2171 =  [] -> 1.792us
     %2441 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %2172 =  [] -> 1.760us
     %2442 = :aten::index [[8], [8]] -> 41.760us
       %2443 = :aten::nonzero [[8]] -> 41.760us
         %2444 = CCCL:cub::DeviceReduce::Sum [] -> 1.376us
                 -->kernel: 0:7 %2173 =  [] -> 1.376us
         %2445 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %2174 =  [] -> 992.000ns
                 -->kernel: 0:7 %2175 =  [] -> 1.792us
     %2446 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2176 =  [] -> 1.728us
     %2447 = :aten::index [[8], [8]] -> 41.472us
       %2448 = :aten::nonzero [[8]] -> 41.472us
         %2449 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %2177 =  [] -> 1.440us
         %2450 = CCCL:cub::DeviceSelect::Flagged [] -> 11.520us
                 -->kernel: 0:7 %2178 =  [] -> 992.000ns
                 -->kernel: 0:7 %2179 =  [] -> 1.760us
     %2451 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %2180 =  [] -> 1.760us
     %2452 = :aten::index [[8], [8]] -> 41.696us
       %2453 = :aten::nonzero [[8]] -> 41.696us
         %2454 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2181 =  [] -> 1.408us
         %2455 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %2182 =  [] -> 992.000ns
                 -->kernel: 0:7 %2183 =  [] -> 1.824us
     %2456 = :aten::zeros [[], [], [], [], []] -> 1.120us
       %2457 = :aten::zero_ [[8, 24]] -> 1.120us
         %2458 = :aten::fill_ [[8, 24], []] -> 1.120us
                 -->kernel: 0:7 %2184 =  [] -> 1.120us
     %2459 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.744us
       %2460 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.744us
         %2461 = :nccl:_all_gather_base [[24]] -> 7.744us
           %2462 = NCCL:ncclAllGather [] -> 7.744us
                 -->kernel: 0:7 %2185 =  [] -> 7.744us
     %2463 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2186 =  [] -> 1.376us
     %2464 = :aten::index [[8], [8]] -> 52.481us
       %2465 = :aten::nonzero [[8]] -> 52.481us
         %2466 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2187 =  [] -> 1.216us
         %2467 = CCCL:cub::DeviceSelect::Flagged [] -> 17.857us
                 -->kernel: 0:7 %2188 =  [] -> 1.281us
                 -->kernel: 0:7 %2189 =  [] -> 2.080us
     %2468 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2190 =  [] -> 1.376us
     %2469 = :aten::index [[8], [8]] -> 43.296us
       %2470 = :aten::nonzero [[8]] -> 43.296us
         %2471 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2191 =  [] -> 1.216us
         %2472 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %2192 =  [] -> 1.248us
                 -->kernel: 0:7 %2193 =  [] -> 2.080us
     %2473 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2194 =  [] -> 1.376us
     %2474 = :aten::index [[8], [8]] -> 42.880us
       %2475 = :aten::nonzero [[8]] -> 42.880us
         %2476 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2195 =  [] -> 1.216us
         %2477 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %2196 =  [] -> 1.280us
                 -->kernel: 0:7 %2197 =  [] -> 2.048us
     %2478 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2198 =  [] -> 1.376us
     %2479 = :aten::index [[8], [8]] -> 42.464us
       %2480 = :aten::nonzero [[8]] -> 42.464us
         %2481 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %2199 =  [] -> 1.248us
         %2482 = CCCL:cub::DeviceSelect::Flagged [] -> 12.192us
                 -->kernel: 0:7 %2200 =  [] -> 1.280us
                 -->kernel: 0:7 %2201 =  [] -> 2.080us
     %2483 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2202 =  [] -> 1.344us
     %2484 = :aten::index [[8], [8]] -> 42.784us
       %2485 = :aten::nonzero [[8]] -> 42.784us
         %2486 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2203 =  [] -> 1.216us
         %2487 = CCCL:cub::DeviceSelect::Flagged [] -> 12.352us
                 -->kernel: 0:7 %2204 =  [] -> 1.280us
                 -->kernel: 0:7 %2205 =  [] -> 2.048us
     %2488 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2206 =  [] -> 1.344us
     %2489 = :aten::index [[8], [8]] -> 41.920us
       %2490 = :aten::nonzero [[8]] -> 41.920us
         %2491 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2207 =  [] -> 1.216us
         %2492 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %2208 =  [] -> 1.248us
                 -->kernel: 0:7 %2209 =  [] -> 2.112us
     %2493 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2210 =  [] -> 1.376us
     %2494 = :aten::index [[8], [8]] -> 43.648us
       %2495 = :aten::nonzero [[8]] -> 43.648us
         %2496 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2211 =  [] -> 1.216us
         %2497 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %2212 =  [] -> 1.280us
                 -->kernel: 0:7 %2213 =  [] -> 2.048us
     %2498 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2214 =  [] -> 1.376us
     %2499 = :aten::index [[8], [8]] -> 42.176us
       %2500 = :aten::nonzero [[8]] -> 42.176us
         %2501 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2215 =  [] -> 1.216us
         %2502 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %2216 =  [] -> 1.248us
                 -->kernel: 0:7 %2217 =  [] -> 2.080us
     %2503 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2218 =  [] -> 1.344us
     %2504 = :aten::index [[8], [8]] -> 43.584us
       %2505 = :aten::nonzero [[8]] -> 43.584us
         %2506 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2219 =  [] -> 1.216us
         %2507 = CCCL:cub::DeviceSelect::Flagged [] -> 12.384us
                 -->kernel: 0:7 %2220 =  [] -> 1.280us
                 -->kernel: 0:7 %2221 =  [] -> 2.048us
     %2508 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2222 =  [] -> 1.376us
     %2509 = :aten::index [[8], [8]] -> 42.272us
       %2510 = :aten::nonzero [[8]] -> 42.272us
         %2511 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2223 =  [] -> 1.216us
         %2512 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %2224 =  [] -> 1.248us
                 -->kernel: 0:7 %2225 =  [] -> 2.112us
     %2513 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2226 =  [] -> 1.344us
     %2514 = :aten::index [[8], [8]] -> 42.273us
       %2515 = :aten::nonzero [[8]] -> 42.273us
         %2516 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2227 =  [] -> 1.216us
         %2517 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %2228 =  [] -> 1.280us
                 -->kernel: 0:7 %2229 =  [] -> 2.048us
     %2518 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2230 =  [] -> 1.376us
     %2519 = :aten::index [[8], [8]] -> 47.648us
       %2520 = :aten::nonzero [[8]] -> 47.648us
         %2521 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2231 =  [] -> 1.216us
         %2522 = CCCL:cub::DeviceSelect::Flagged [] -> 12.608us
                 -->kernel: 0:7 %2232 =  [] -> 1.248us
                 -->kernel: 0:7 %2233 =  [] -> 2.112us
     %2523 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2234 =  [] -> 1.376us
     %2524 = :aten::index [[8], [8]] -> 42.848us
       %2525 = :aten::nonzero [[8]] -> 42.848us
         %2526 = CCCL:cub::DeviceReduce::Sum [] -> 1.184us
                 -->kernel: 0:7 %2235 =  [] -> 1.184us
         %2527 = CCCL:cub::DeviceSelect::Flagged [] -> 12.544us
                 -->kernel: 0:7 %2236 =  [] -> 1.280us
                 -->kernel: 0:7 %2237 =  [] -> 2.048us
     %2528 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2238 =  [] -> 1.376us
     %2529 = :aten::index [[8], [8]] -> 42.465us
       %2530 = :aten::nonzero [[8]] -> 42.465us
         %2531 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2239 =  [] -> 1.216us
         %2532 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %2240 =  [] -> 1.280us
                 -->kernel: 0:7 %2241 =  [] -> 2.080us
     %2533 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2242 =  [] -> 1.344us
     %2534 = :aten::index [[8], [8]] -> 43.008us
       %2535 = :aten::nonzero [[8]] -> 43.008us
         %2536 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2243 =  [] -> 1.216us
         %2537 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %2244 =  [] -> 1.280us
                 -->kernel: 0:7 %2245 =  [] -> 2.080us
     %2538 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2246 =  [] -> 1.376us
     %2539 = :aten::index [[8], [8]] -> 47.296us
       %2540 = :aten::nonzero [[8]] -> 47.296us
         %2541 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %2247 =  [] -> 1.248us
         %2542 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %2248 =  [] -> 1.248us
                 -->kernel: 0:7 %2249 =  [] -> 2.080us
     %2543 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2250 =  [] -> 1.344us
     %2544 = :aten::index [[8], [8]] -> 42.880us
       %2545 = :aten::nonzero [[8]] -> 42.880us
         %2546 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2251 =  [] -> 1.216us
         %2547 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %2252 =  [] -> 1.280us
                 -->kernel: 0:7 %2253 =  [] -> 2.048us
     %2548 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2254 =  [] -> 1.376us
     %2549 = :aten::index [[8], [8]] -> 42.720us
       %2550 = :aten::nonzero [[8]] -> 42.720us
         %2551 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2255 =  [] -> 1.216us
         %2552 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %2256 =  [] -> 1.248us
                 -->kernel: 0:7 %2257 =  [] -> 2.080us
     %2553 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2258 =  [] -> 1.344us
     %2554 = :aten::index [[8], [8]] -> 43.360us
       %2555 = :aten::nonzero [[8]] -> 43.360us
         %2556 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %2259 =  [] -> 1.248us
         %2557 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %2260 =  [] -> 1.312us
                 -->kernel: 0:7 %2261 =  [] -> 2.048us
     %2558 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2262 =  [] -> 1.376us
     %2559 = :aten::index [[8], [8]] -> 41.952us
       %2560 = :aten::nonzero [[8]] -> 41.952us
         %2561 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2263 =  [] -> 1.216us
         %2562 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %2264 =  [] -> 1.248us
                 -->kernel: 0:7 %2265 =  [] -> 2.080us
     %2563 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2266 =  [] -> 1.376us
     %2564 = :aten::index [[8], [8]] -> 42.432us
       %2565 = :aten::nonzero [[8]] -> 42.432us
         %2566 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2267 =  [] -> 1.216us
         %2567 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2268 =  [] -> 1.312us
                 -->kernel: 0:7 %2269 =  [] -> 2.048us
     %2568 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2270 =  [] -> 1.376us
     %2569 = :aten::index [[8], [8]] -> 43.072us
       %2570 = :aten::nonzero [[8]] -> 43.072us
         %2571 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %2271 =  [] -> 1.248us
         %2572 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2272 =  [] -> 1.248us
                 -->kernel: 0:7 %2273 =  [] -> 2.080us
     %2573 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2274 =  [] -> 1.344us
     %2574 = :aten::index [[8], [8]] -> 41.856us
       %2575 = :aten::nonzero [[8]] -> 41.856us
         %2576 = CCCL:cub::DeviceReduce::Sum [] -> 1.184us
                 -->kernel: 0:7 %2275 =  [] -> 1.184us
         %2577 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %2276 =  [] -> 1.280us
                 -->kernel: 0:7 %2277 =  [] -> 2.048us
     %2578 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2278 =  [] -> 1.376us
     %2579 = :aten::index [[8], [8]] -> 43.137us
       %2580 = :aten::nonzero [[8]] -> 43.137us
         %2581 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %2279 =  [] -> 1.248us
         %2582 = CCCL:cub::DeviceSelect::Flagged [] -> 12.640us
                 -->kernel: 0:7 %2280 =  [] -> 1.248us
                 -->kernel: 0:7 %2281 =  [] -> 2.080us
     %2583 = :aten::zero_ [[3002413056]] -> 1.802ms
       %2584 = :aten::fill_ [[3002413056], []] -> 1.802ms
                 -->kernel: 0:7 %2282 =  [] -> 441.409us
                 -->kernel: 0:7 %2283 =  [] -> 441.505us
                 -->kernel: 0:7 %2284 =  [] -> 441.665us
                 -->kernel: 0:7 %2285 =  [] -> 441.473us
     %2585 = :aten::zero_ [[352321536]] -> 207.873us
       %2586 = :aten::fill_ [[352321536], []] -> 207.873us
                 -->kernel: 0:7 %2286 =  [] -> 207.873us
     %2587 = :aten::zeros [[], [], [], [], []] -> 1.088us
       %2588 = :aten::zero_ [[]] -> 1.088us
         %2589 = :aten::fill_ [[], []] -> 1.088us
                 -->kernel: 0:7 %2287 =  [] -> 1.088us
     %2590 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.328us
       %2591 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.328us
         %2592 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.328us
     %2593 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 2.848us
       %2594 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 2.848us
         %2595 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 2.848us
     %2596 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 1.472us
       %2597 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 1.472us
         %2598 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.472us
     %2599 = :aten::to [[1, 1, 4096, 4096], [], [], [], [], [], [], []] -> 294.113us
       %2600 = :aten::_to_copy [[1, 1, 4096, 4096], [], [], [], [], [], []] -> 294.113us
         %2601 = :aten::copy_ [[1, 1, 4096, 4096], [1, 1, 4096, 4096], []] -> 294.113us
     %2602 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.264us
       %2603 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.264us
         %2604 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.264us
     %2605 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 270.529us
       %2606 = :aten::index_select [[129280, 7168], [], [4096]] -> 270.529us
                 -->kernel: 0:7 %2288 =  [] -> 270.529us
     %2607 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 127.456us
       %2608 = :nvte_rmsnorm_fwd [] -> 127.456us
                 -->kernel: 0:7 %2289 =  [] -> 127.456us
     %2609 = :TELinear forward [] -> 657.026us
       %2610 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 657.026us
         %2611 = :nvte_quantize_v2 [] -> 73.505us
           %2612 = :quantize_transpose_vector_blockwise [] -> 73.505us
                 -->kernel: 0:7 %2290 =  [] -> 73.505us
         %2613 = :nvte_quantize_v2 [] -> 20.352us
           %2614 = :quantize_transpose_square_blockwise [] -> 20.352us
                 -->kernel: 0:7 %2291 =  [] -> 20.352us
         %2615 = :nvte_cublas_gemm_scaled [] -> 337.185us
                 -->kernel: 0:7 %2292 =  [] -> 327.457us
     %2616 = :TELinear forward [] -> 407.840us
       %2617 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 407.840us
         %2618 = :nvte_quantize_v2 [] -> 72.640us
           %2619 = :quantize_transpose_vector_blockwise [] -> 72.640us
                 -->kernel: 0:7 %2293 =  [] -> 72.640us
         %2620 = :nvte_quantize_v2 [] -> 11.776us
           %2621 = :quantize_transpose_square_blockwise [] -> 11.776us
                 -->kernel: 0:7 %2294 =  [] -> 11.776us
         %2622 = :nvte_cublas_gemm_scaled [] -> 203.136us
                 -->kernel: 0:7 %2295 =  [] -> 196.896us
     %2623 = :TELayerNormColumnParallelLinear forward [] -> 1.381ms
       %2624 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.381ms
         %2625 = :nvte_rmsnorm_fwd [] -> 30.080us
                 -->kernel: 0:7 %2296 =  [] -> 30.080us
         %2626 = :nvte_quantize_v2 [] -> 16.864us
           %2627 = :quantize_transpose_vector_blockwise [] -> 16.864us
                 -->kernel: 0:7 %2297 =  [] -> 16.864us
         %2628 = :nvte_quantize_v2 [] -> 58.112us
           %2629 = :quantize_transpose_square_blockwise [] -> 58.112us
                 -->kernel: 0:7 %2298 =  [] -> 58.112us
         %2630 = :nvte_cublas_gemm_scaled [] -> 1.128ms
                 -->kernel: 0:7 %2299 =  [] -> 1.121ms
     %2631 = :TELayerNormColumnParallelLinear forward [] -> 896.098us
       %2632 = :aten::contiguous [[4096, 1, 512], []] -> 11.584us
         %2633 = :aten::clone [[4096, 1, 512], []] -> 11.584us
           %2634 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.584us
                 -->kernel: 0:7 %2300 =  [] -> 11.584us
       %2635 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 690.658us
         %2636 = :nvte_rmsnorm_fwd [] -> 4.224us
                 -->kernel: 0:7 %2301 =  [] -> 4.224us
         %2637 = :nvte_quantize_v2 [] -> 7.776us
           %2638 = :quantize_transpose_vector_blockwise [] -> 7.776us
                 -->kernel: 0:7 %2302 =  [] -> 7.776us
         %2639 = :nvte_quantize_v2 [] -> 28.640us
           %2640 = :quantize_transpose_square_blockwise [] -> 28.640us
                 -->kernel: 0:7 %2303 =  [] -> 28.640us
         %2641 = :nvte_cublas_gemm_scaled [] -> 521.249us
                 -->kernel: 0:7 %2304 =  [] -> 514.849us
     %2642 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.208us
                 -->kernel: 0:7 %2305 =  [] -> 114.208us
     %2643 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 173.281us
                 -->kernel: 0:7 %2306 =  [] -> 173.281us
     %2644 = :TEDotProductAttention forward [] -> 22.481ms
       %2645 = :aten::arange [[], [], [], [], []] -> 1.152us
         %2646 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %2307 =  [] -> 1.152us
       %2647 = :aten::arange [[], [], [], [], []] -> 1.120us
         %2648 = :aten::arange [[], [], [], [0]] -> 1.120us
                 -->kernel: 0:7 %2308 =  [] -> 1.120us
       %2649 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 61.376us
                 -->kernel: 0:7 %2309 =  [] -> 61.376us
       %2650 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 38.624us
                 -->kernel: 0:7 %2310 =  [] -> 38.624us
       %2651 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.688us
                 -->kernel: 0:7 %2311 =  [] -> 38.688us
       %2652 = :aten::le [[1, 1, 4096, 4096], []] -> 29.536us
                 -->kernel: 0:7 %2312 =  [] -> 29.536us
       %2653 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.352us
                 -->kernel: 0:7 %2313 =  [] -> 24.352us
       %2654 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.336us
                 -->kernel: 0:7 %2314 =  [] -> 14.336us
       %2655 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.816us
         %2656 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.816us
                 -->kernel: 0:7 %2315 =  [] -> 18.816us
       %2657 = :aten::logical_not [[1, 1, 4096, 4096]] -> 13.024us
         %2658 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 13.024us
                 -->kernel: 0:7 %2316 =  [] -> 13.024us
       %2659 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.336us
         %2660 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.336us
                 -->kernel: 0:7 %2317 =  [] -> 18.336us
       %2661 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.809ms
                 -->kernel: 0:7 %2318 =  [] -> 5.801ms
       %2662 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 10.999ms
         %2663 = :nvte_scaled_masked_softmax_forward [] -> 10.999ms
                 -->kernel: 0:7 %2319 =  [] -> 10.999ms
       %2664 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.981ms
                 -->kernel: 0:7 %2320 =  [] -> 3.967ms
       %2665 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.657us
         %2666 = :aten::clone [[4096, 1, 128, 128], []] -> 278.657us
           %2667 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.657us
                 -->kernel: 0:7 %2321 =  [] -> 278.657us
     %2668 = :TERowParallelLinear forward [] -> 3.825ms
       %2669 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.825ms
         %2670 = :nvte_quantize_v2 [] -> 97.312us
           %2671 = :quantize_transpose_vector_blockwise [] -> 97.312us
                 -->kernel: 0:7 %2322 =  [] -> 97.312us
         %2672 = :nvte_quantize_v2 [] -> 169.184us
           %2673 = :quantize_transpose_square_blockwise [] -> 169.184us
                 -->kernel: 0:7 %2323 =  [] -> 169.184us
         %2674 = :nvte_cublas_gemm_scaled [] -> 3.404ms
                 -->kernel: 0:7 %2324 =  [] -> 3.397ms
     %2675 = :Torch-Compiled Region: 1/2 None -> 44.128us
       %2676 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.128us
         %2677 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.128us
                 -->kernel: 0:7 %2325 =  [] -> 44.128us
     %2678 = :TELayerNormColumnParallelLinear forward [] -> 8.426ms
       %2679 = :_LayerNormLinear [[4096, 1, 7168], [7168], [], [36864, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 8.426ms
         %2680 = :nvte_rmsnorm_fwd [] -> 126.752us
                 -->kernel: 0:7 %2326 =  [] -> 126.752us
         %2681 = :nvte_quantize_v2 [] -> 73.793us
           %2682 = :quantize_transpose_vector_blockwise [] -> 73.793us
                 -->kernel: 0:7 %2327 =  [] -> 73.793us
         %2683 = :nvte_quantize_v2 [] -> 388.833us
           %2684 = :quantize_transpose_square_blockwise [] -> 388.833us
                 -->kernel: 0:7 %2328 =  [] -> 388.833us
         %2685 = :nvte_cublas_gemm_scaled [] -> 7.679ms
                 -->kernel: 0:7 %2329 =  [] -> 7.672ms
     %2686 = :SwiGLUFunction [[4096, 36864], [], []] -> 131.776us
       %2687 = :Torch-Compiled Region: 2/0 None -> 131.776us
         %2688 = :triton_poi_fused_mul_silu_0 [[4096, 36864], [4096, 18432], [], []] -> 131.776us
                 -->kernel: 0:7 %2330 =  [] -> 131.776us
     %2689 = :TERowParallelLinear forward [] -> 4.344ms
       %2690 = :_Linear [[7168, 18432], [4096, 1, 18432], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 4.344ms
         %2691 = :nvte_quantize_v2 [] -> 185.056us
           %2692 = :quantize_transpose_vector_blockwise [] -> 185.056us
                 -->kernel: 0:7 %2331 =  [] -> 185.056us
         %2693 = :nvte_quantize_v2 [] -> 193.697us
           %2694 = :quantize_transpose_square_blockwise [] -> 193.697us
                 -->kernel: 0:7 %2332 =  [] -> 193.697us
         %2695 = :nvte_cublas_gemm_scaled [] -> 3.833ms
                 -->kernel: 0:7 %2333 =  [] -> 3.826ms
     %2696 = :Torch-Compiled Region: 1/2 None -> 44.992us
       %2697 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.992us
         %2698 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.992us
                 -->kernel: 0:7 %2334 =  [] -> 44.992us
     %2699 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 125.921us
       %2700 = :nvte_rmsnorm_fwd [] -> 125.921us
                 -->kernel: 0:7 %2335 =  [] -> 125.921us
     %2701 = :TELinear forward [] -> 561.570us
       %2702 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 561.570us
         %2703 = :nvte_quantize_v2 [] -> 73.024us
           %2704 = :quantize_transpose_vector_blockwise [] -> 73.024us
                 -->kernel: 0:7 %2336 =  [] -> 73.024us
         %2705 = :nvte_quantize_v2 [] -> 20.352us
           %2706 = :quantize_transpose_square_blockwise [] -> 20.352us
                 -->kernel: 0:7 %2337 =  [] -> 20.352us
         %2707 = :nvte_cublas_gemm_scaled [] -> 333.377us
                 -->kernel: 0:7 %2338 =  [] -> 327.169us
     %2708 = :TELinear forward [] -> 404.033us
       %2709 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 404.033us
         %2710 = :nvte_quantize_v2 [] -> 73.088us
           %2711 = :quantize_transpose_vector_blockwise [] -> 73.088us
                 -->kernel: 0:7 %2339 =  [] -> 73.088us
         %2712 = :nvte_quantize_v2 [] -> 11.488us
           %2713 = :quantize_transpose_square_blockwise [] -> 11.488us
                 -->kernel: 0:7 %2340 =  [] -> 11.488us
         %2714 = :nvte_cublas_gemm_scaled [] -> 202.784us
                 -->kernel: 0:7 %2341 =  [] -> 196.544us
     %2715 = :TELayerNormColumnParallelLinear forward [] -> 1.364ms
       %2716 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.364ms
         %2717 = :nvte_rmsnorm_fwd [] -> 31.200us
                 -->kernel: 0:7 %2342 =  [] -> 31.200us
         %2718 = :nvte_quantize_v2 [] -> 16.992us
           %2719 = :quantize_transpose_vector_blockwise [] -> 16.992us
                 -->kernel: 0:7 %2343 =  [] -> 16.992us
         %2720 = :nvte_quantize_v2 [] -> 57.824us
           %2721 = :quantize_transpose_square_blockwise [] -> 57.824us
                 -->kernel: 0:7 %2344 =  [] -> 57.824us
         %2722 = :nvte_cublas_gemm_scaled [] -> 1.126ms
                 -->kernel: 0:7 %2345 =  [] -> 1.120ms
     %2723 = :TELayerNormColumnParallelLinear forward [] -> 901.922us
       %2724 = :aten::contiguous [[4096, 1, 512], []] -> 11.840us
         %2725 = :aten::clone [[4096, 1, 512], []] -> 11.840us
           %2726 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.840us
                 -->kernel: 0:7 %2346 =  [] -> 11.840us
       %2727 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 699.361us
         %2728 = :nvte_rmsnorm_fwd [] -> 4.192us
                 -->kernel: 0:7 %2347 =  [] -> 4.192us
         %2729 = :nvte_quantize_v2 [] -> 7.648us
           %2730 = :quantize_transpose_vector_blockwise [] -> 7.648us
                 -->kernel: 0:7 %2348 =  [] -> 7.648us
         %2731 = :nvte_quantize_v2 [] -> 28.480us
           %2732 = :quantize_transpose_square_blockwise [] -> 28.480us
                 -->kernel: 0:7 %2349 =  [] -> 28.480us
         %2733 = :nvte_cublas_gemm_scaled [] -> 520.321us
                 -->kernel: 0:7 %2350 =  [] -> 514.209us
     %2734 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 113.728us
                 -->kernel: 0:7 %2351 =  [] -> 113.728us
     %2735 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 172.960us
                 -->kernel: 0:7 %2352 =  [] -> 172.960us
     %2736 = :TEDotProductAttention forward [] -> 22.402ms
       %2737 = :aten::arange [[], [], [], [], []] -> 1.184us
         %2738 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %2353 =  [] -> 1.184us
       %2739 = :aten::arange [[], [], [], [], []] -> 1.152us
         %2740 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %2354 =  [] -> 1.152us
       %2741 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 60.928us
                 -->kernel: 0:7 %2355 =  [] -> 60.928us
       %2742 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 38.880us
                 -->kernel: 0:7 %2356 =  [] -> 38.880us
       %2743 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.880us
                 -->kernel: 0:7 %2357 =  [] -> 38.880us
       %2744 = :aten::le [[1, 1, 4096, 4096], []] -> 28.128us
                 -->kernel: 0:7 %2358 =  [] -> 28.128us
       %2745 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.864us
                 -->kernel: 0:7 %2359 =  [] -> 24.864us
       %2746 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.208us
                 -->kernel: 0:7 %2360 =  [] -> 14.208us
       %2747 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.752us
         %2748 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.752us
                 -->kernel: 0:7 %2361 =  [] -> 18.752us
       %2749 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.736us
         %2750 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.736us
                 -->kernel: 0:7 %2362 =  [] -> 12.736us
       %2751 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.240us
         %2752 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.240us
                 -->kernel: 0:7 %2363 =  [] -> 18.240us
       %2753 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.800ms
                 -->kernel: 0:7 %2364 =  [] -> 5.792ms
       %2754 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.002ms
         %2755 = :nvte_scaled_masked_softmax_forward [] -> 11.002ms
                 -->kernel: 0:7 %2365 =  [] -> 11.002ms
       %2756 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.979ms
                 -->kernel: 0:7 %2366 =  [] -> 3.966ms
       %2757 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.817us
         %2758 = :aten::clone [[4096, 1, 128, 128], []] -> 278.817us
           %2759 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.817us
                 -->kernel: 0:7 %2367 =  [] -> 278.817us
     %2760 = :TERowParallelLinear forward [] -> 3.830ms
       %2761 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.830ms
         %2762 = :nvte_quantize_v2 [] -> 96.448us
           %2763 = :quantize_transpose_vector_blockwise [] -> 96.448us
                 -->kernel: 0:7 %2368 =  [] -> 96.448us
         %2764 = :nvte_quantize_v2 [] -> 168.033us
           %2765 = :quantize_transpose_square_blockwise [] -> 168.033us
                 -->kernel: 0:7 %2369 =  [] -> 168.033us
         %2766 = :nvte_cublas_gemm_scaled [] -> 3.415ms
                 -->kernel: 0:7 %2370 =  [] -> 3.408ms
     %2767 = :Torch-Compiled Region: 1/2 None -> 44.000us
       %2768 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.000us
         %2769 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.000us
                 -->kernel: 0:7 %2371 =  [] -> 44.000us
     %2770 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.368us
       %2771 = :nvte_rmsnorm_fwd [] -> 126.368us
                 -->kernel: 0:7 %2372 =  [] -> 126.368us
     %2772 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 43.040us
       %2773 = :nvte_cublas_gemm_scaled [] -> 43.040us
                 -->kernel: 0:7 %2373 =  [] -> 22.080us
                 -->kernel: 0:7 %2374 =  [] -> 2.592us
     %2774 = :RandomSTE [[4096, 1, 32]] -> 45.760us
       %2775 = :aten::clone [[4096, 1, 32], []] -> 1.568us
         %2776 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.568us
       %2777 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.704us
                 -->kernel: 0:7 %2375 =  [] -> 4.704us
     %2778 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 70.560us
       %2779 = :nvte_fused_topk_with_score_function_forward [] -> 70.560us
                 -->kernel: 0:7 %2376 =  [] -> 70.560us
     %2780 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 26.976us
       %2781 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 26.976us
                 -->kernel: 0:7 %2377 =  [] -> 26.976us
     %2782 = :aten::sum [[4096, 32], [], [], []] -> 46.944us
       %2783 = :aten::to [[4096, 32], [], [], [], []] -> 4.864us
         %2784 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.864us
           %2785 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.864us
                 -->kernel: 0:7 %2378 =  [] -> 4.864us
                 -->kernel: 0:7 %2379 =  [] -> 9.856us
     %2786 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.128us
       %2787 = :nvte_fused_moe_aux_loss_forward [] -> 12.128us
                 -->kernel: 0:7 %2380 =  [] -> 12.128us
     %2788 = :aten::div [[], []] -> 1.152us
                 -->kernel: 0:7 %2381 =  [] -> 1.152us
     %2789 = :aten::div [[], []] -> 1.216us
                 -->kernel: 0:7 %2382 =  [] -> 1.216us
     %2790 = :aten::add_ [[], [], []] -> 1.536us
                 -->kernel: 0:7 %2383 =  [] -> 1.536us
     %2791 = :aten::sum [[4096, 32], [], [], []] -> 36.576us
       %2792 = :aten::to [[4096, 32], [], [], [], []] -> 4.640us
         %2793 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.640us
           %2794 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.640us
                 -->kernel: 0:7 %2384 =  [] -> 4.640us
                 -->kernel: 0:7 %2385 =  [] -> 7.680us
     %2795 = :aten::add_ [[32], [32], []] -> 4.384us
                 -->kernel: 0:7 %2386 =  [] -> 4.384us
     %2796 = :aten::topk [[4096, 32], [], [], [], []] -> 54.241us
                 -->kernel: 0:7 %2387 =  [] -> 14.176us
                 -->kernel: 0:7 %2388 =  [] -> 7.680us
     %2797 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 1.088ms
                 -->kernel: 0:26 %2389 =  [] -> 44.448us
                 -->kernel: 0:26 %2390 =  [] -> 161.601us
                 -->kernel: 0:26 %2391 =  [] -> 754.561us
     %2798 = :TEColumnParallelLinear forward [] -> 1.140ms
       %2799 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.140ms
         %2800 = :nvte_quantize_v2 [] -> 45.472us
           %2801 = :quantize_transpose_vector_blockwise [] -> 45.472us
                 -->kernel: 0:7 %2392 =  [] -> 45.472us
         %2802 = :nvte_quantize_v2 [] -> 44.512us
           %2803 = :quantize_transpose_square_blockwise [] -> 44.512us
                 -->kernel: 0:7 %2393 =  [] -> 44.512us
         %2804 = :nvte_cublas_gemm_scaled [] -> 916.642us
                 -->kernel: 0:7 %2394 =  [] -> 909.538us
     %2805 = :SwiGLUFunction [[4096, 4096], [], []] -> 27.105us
       %2806 = :Torch-Compiled Region: 2/1 None -> 27.105us
         %2807 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 27.105us
                 -->kernel: 0:7 %2395 =  [] -> 27.105us
     %2808 = :TERowParallelLinear forward [] -> 610.017us
       %2809 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 610.017us
         %2810 = :nvte_quantize_v2 [] -> 22.912us
           %2811 = :quantize_transpose_vector_blockwise [] -> 22.912us
                 -->kernel: 0:7 %2396 =  [] -> 22.912us
         %2812 = :nvte_quantize_v2 [] -> 24.576us
           %2813 = :quantize_transpose_square_blockwise [] -> 24.576us
                 -->kernel: 0:7 %2397 =  [] -> 24.576us
         %2814 = :nvte_cublas_gemm_scaled [] -> 442.945us
                 -->kernel: 0:7 %2398 =  [] -> 437.121us
     %2815 = :IndicesToMultihot [[15753, 8], [15753, 8], []] -> 11.200us
                 -->kernel: 0:7 %2399 =  [] -> 11.200us
     %2816 = :aten::contiguous [[4, 15753], []] -> 2.944us
       %2817 = :aten::clone [[4, 15753], []] -> 2.944us
         %2818 = :aten::copy_ [[4, 15753], [4, 15753], []] -> 2.944us
                 -->kernel: 0:7 %2400 =  [] -> 2.944us
     %2819 = :aten::to [[4, 15753], [], [], [], []] -> 4.896us
       %2820 = :aten::_to_copy [[4, 15753], [], [], [], [], [], []] -> 4.896us
         %2821 = :aten::copy_ [[4, 15753], [4, 15753], []] -> 4.896us
                 -->kernel: 0:7 %2401 =  [] -> 4.896us
                 -->kernel: 0:7 %2402 =  [] -> 23.264us
     %2822 = :_moe_permute_mask_map [[15753, 7168], [15753, 4], [], [15753, 4]] -> 407.649us
                 -->kernel: 0:7 %2403 =  [] -> 2.112us
                 -->kernel: 0:7 %2404 =  [] -> 2.528us
                 -->kernel: 0:7 %2405 =  [] -> 13.280us
                 -->kernel: 0:7 %2406 =  [] -> 201.856us
     %2823 = :TEColumnParallelGroupedLinear forward [] -> 8.468ms
       %2824 = :_GroupedLinear [[32928, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.468ms
         %2825 = :nvte_quantize_v2 [] -> 220.833us
           %2826 = :quantize_transpose_vector_blockwise [] -> 220.833us
                 -->kernel: 0:7 %2407 =  [] -> 220.833us
         %2827 = :nvte_quantize_v2 [] -> 220.000us
           %2828 = :quantize_transpose_vector_blockwise [] -> 220.000us
                 -->kernel: 0:7 %2408 =  [] -> 220.000us
         %2829 = :nvte_quantize_v2 [] -> 223.041us
           %2830 = :quantize_transpose_vector_blockwise [] -> 223.041us
                 -->kernel: 0:7 %2409 =  [] -> 223.041us
         %2831 = :nvte_quantize_v2 [] -> 223.104us
           %2832 = :quantize_transpose_vector_blockwise [] -> 223.104us
                 -->kernel: 0:7 %2410 =  [] -> 223.104us
         %2833 = :nvte_quantize_v2 [] -> 45.600us
           %2834 = :quantize_transpose_square_blockwise [] -> 45.600us
                 -->kernel: 0:7 %2411 =  [] -> 45.600us
         %2835 = :nvte_quantize_v2 [] -> 46.337us
           %2836 = :quantize_transpose_square_blockwise [] -> 46.337us
                 -->kernel: 0:7 %2412 =  [] -> 46.337us
         %2837 = :nvte_quantize_v2 [] -> 46.048us
           %2838 = :quantize_transpose_square_blockwise [] -> 46.048us
                 -->kernel: 0:7 %2413 =  [] -> 46.048us
         %2839 = :nvte_quantize_v2 [] -> 45.472us
           %2840 = :quantize_transpose_square_blockwise [] -> 45.472us
                 -->kernel: 0:7 %2414 =  [] -> 45.472us
         %2841 = :nvte_multi_stream_cublas_gemm [] -> 7.087ms
           %2842 = :nvte_cublas_gemm [] -> 1.756ms
                 -->kernel: 0:159 %2415 =  [] -> 1.747ms
           %2843 = :nvte_cublas_gemm [] -> 1.752ms
                 -->kernel: 0:160 %2416 =  [] -> 1.745ms
           %2844 = :nvte_cublas_gemm [] -> 1.752ms
                 -->kernel: 0:161 %2417 =  [] -> 1.748ms
           %2845 = :nvte_cublas_gemm [] -> 1.753ms
                 -->kernel: 0:162 %2418 =  [] -> 1.747ms
     %2846 = :WeightedSwiGLUFunction [[32928, 4096], [32928, 1], []] -> 120.640us
       %2847 = :Torch-Compiled Region: 3/1 None -> 120.640us
         %2848 = :triton_poi_fused__to_copy_mul_silu_0 [[32928, 4096], [32928, 1], [32928, 2048], [], []] -> 120.640us
                 -->kernel: 0:7 %2419 =  [] -> 120.640us
     %2849 = :TERowParallelGroupedLinear forward [] -> 4.234ms
       %2850 = :_GroupedLinear [[32928, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.234ms
         %2851 = :nvte_quantize_v2 [] -> 68.160us
           %2852 = :quantize_transpose_vector_blockwise [] -> 68.160us
                 -->kernel: 0:7 %2420 =  [] -> 68.160us
         %2853 = :nvte_quantize_v2 [] -> 69.024us
           %2854 = :quantize_transpose_vector_blockwise [] -> 69.024us
                 -->kernel: 0:7 %2421 =  [] -> 69.024us
         %2855 = :nvte_quantize_v2 [] -> 69.569us
           %2856 = :quantize_transpose_vector_blockwise [] -> 69.569us
                 -->kernel: 0:7 %2422 =  [] -> 69.569us
         %2857 = :nvte_quantize_v2 [] -> 69.792us
           %2858 = :quantize_transpose_vector_blockwise [] -> 69.792us
                 -->kernel: 0:7 %2423 =  [] -> 69.792us
         %2859 = :nvte_quantize_v2 [] -> 24.736us
           %2860 = :quantize_transpose_square_blockwise [] -> 24.736us
                 -->kernel: 0:7 %2424 =  [] -> 24.736us
         %2861 = :nvte_quantize_v2 [] -> 24.640us
           %2862 = :quantize_transpose_square_blockwise [] -> 24.640us
                 -->kernel: 0:7 %2425 =  [] -> 24.640us
         %2863 = :nvte_quantize_v2 [] -> 24.864us
           %2864 = :quantize_transpose_square_blockwise [] -> 24.864us
                 -->kernel: 0:7 %2426 =  [] -> 24.864us
         %2865 = :nvte_quantize_v2 [] -> 24.096us
           %2866 = :quantize_transpose_square_blockwise [] -> 24.096us
                 -->kernel: 0:7 %2427 =  [] -> 24.096us
         %2867 = :nvte_multi_stream_cublas_gemm [] -> 3.577ms
           %2868 = :nvte_cublas_gemm [] -> 876.930us
                 -->kernel: 0:159 %2428 =  [] -> 869.378us
           %2869 = :nvte_cublas_gemm [] -> 873.794us
                 -->kernel: 0:160 %2429 =  [] -> 868.738us
           %2870 = :nvte_cublas_gemm [] -> 883.362us
                 -->kernel: 0:161 %2430 =  [] -> 879.938us
           %2871 = :nvte_cublas_gemm [] -> 884.098us
                 -->kernel: 0:162 %2431 =  [] -> 880.066us
     %2872 = :_moe_unpermute_mask_map [[32928, 7168], [15753, 9], [], []] -> 226.401us
                 -->kernel: 0:7 %2432 =  [] -> 226.401us
     %2873 = :FusedCombine [[15753, 7168], [], []] -> 746.754us
                 -->kernel: 0:26 %2433 =  [] -> 13.856us
                 -->kernel: 0:26 %2434 =  [] -> 698.530us
     %2874 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.256us
                 -->kernel: 0:7 %2435 =  [] -> 52.256us
     %2875 = :Torch-Compiled Region: 1/2 None -> 47.296us
       %2876 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 47.296us
         %2877 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 47.296us
                 -->kernel: 0:7 %2436 =  [] -> 47.296us
     %2878 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.177us
       %2879 = :nvte_rmsnorm_fwd [] -> 126.177us
                 -->kernel: 0:7 %2437 =  [] -> 126.177us
     %2880 = :aten::roll [[1, 4096], [], []] -> 2.112us
                 -->kernel: 0:7 %2438 =  [] -> 2.112us
     %2881 = :aten::fill_ [[1], []] -> 1.024us
                 -->kernel: 0:7 %2439 =  [] -> 1.024us
     %2882 = :aten::sum [[1, 4096], []] -> 3.776us
       %2883 = :aten::sum [[1, 4096], [], [], []] -> 3.776us
                 -->kernel: 0:7 %2440 =  [] -> 3.776us
     %2884 = :aten::roll [[1, 4096], [], []] -> 2.112us
                 -->kernel: 0:7 %2441 =  [] -> 2.112us
     %2885 = :aten::fill_ [[1], []] -> 1.088us
                 -->kernel: 0:7 %2442 =  [] -> 1.088us
     %2886 = :aten::sum [[1, 4096], []] -> 3.040us
       %2887 = :aten::sum [[1, 4096], [], [], []] -> 3.040us
                 -->kernel: 0:7 %2443 =  [] -> 3.040us
     %2888 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 272.512us
       %2889 = :aten::index_select [[129280, 7168], [], [4096]] -> 272.512us
                 -->kernel: 0:7 %2444 =  [] -> 272.512us
     %2890 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 127.009us
       %2891 = :nvte_rmsnorm_fwd [] -> 127.009us
                 -->kernel: 0:7 %2445 =  [] -> 127.009us
     %2892 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 127.232us
       %2893 = :nvte_rmsnorm_fwd [] -> 127.232us
                 -->kernel: 0:7 %2446 =  [] -> 127.232us
     %2894 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 161.889us
                 -->kernel: 0:7 %2447 =  [] -> 161.889us
     %2895 = :TEColumnParallelLinear forward [] -> 3.409ms
       %2896 = :_Linear [[7168, 14336], [4096, 1, 14336], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.409ms
         %2897 = :nvte_quantize_v2 [] -> 145.345us
           %2898 = :quantize_transpose_vector_blockwise [] -> 145.345us
                 -->kernel: 0:7 %2448 =  [] -> 145.345us
         %2899 = :nvte_quantize_v2 [] -> 153.184us
           %2900 = :quantize_transpose_square_blockwise [] -> 153.184us
                 -->kernel: 0:7 %2449 =  [] -> 153.184us
         %2901 = :nvte_cublas_gemm_scaled [] -> 2.982ms
                 -->kernel: 0:7 %2450 =  [] -> 2.975ms
     %2902 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 121.312us
       %2903 = :nvte_rmsnorm_fwd [] -> 121.312us
                 -->kernel: 0:7 %2451 =  [] -> 121.312us
     %2904 = :TELinear forward [] -> 549.025us
       %2905 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 549.025us
         %2906 = :nvte_quantize_v2 [] -> 73.632us
           %2907 = :quantize_transpose_vector_blockwise [] -> 73.632us
                 -->kernel: 0:7 %2452 =  [] -> 73.632us
         %2908 = :nvte_quantize_v2 [] -> 20.480us
           %2909 = :quantize_transpose_square_blockwise [] -> 20.480us
                 -->kernel: 0:7 %2453 =  [] -> 20.480us
         %2910 = :nvte_cublas_gemm_scaled [] -> 334.465us
                 -->kernel: 0:7 %2454 =  [] -> 327.585us
     %2911 = :TELinear forward [] -> 399.328us
       %2912 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 399.328us
         %2913 = :nvte_quantize_v2 [] -> 73.440us
           %2914 = :quantize_transpose_vector_blockwise [] -> 73.440us
                 -->kernel: 0:7 %2455 =  [] -> 73.440us
         %2915 = :nvte_quantize_v2 [] -> 11.552us
           %2916 = :quantize_transpose_square_blockwise [] -> 11.552us
                 -->kernel: 0:7 %2456 =  [] -> 11.552us
         %2917 = :nvte_cublas_gemm_scaled [] -> 203.456us
                 -->kernel: 0:7 %2457 =  [] -> 196.896us
     %2918 = :TELayerNormColumnParallelLinear forward [] -> 1.366ms
       %2919 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.366ms
         %2920 = :nvte_rmsnorm_fwd [] -> 30.432us
                 -->kernel: 0:7 %2458 =  [] -> 30.432us
         %2921 = :nvte_quantize_v2 [] -> 16.896us
           %2922 = :quantize_transpose_vector_blockwise [] -> 16.896us
                 -->kernel: 0:7 %2459 =  [] -> 16.896us
         %2923 = :nvte_quantize_v2 [] -> 58.337us
           %2924 = :quantize_transpose_square_blockwise [] -> 58.337us
                 -->kernel: 0:7 %2460 =  [] -> 58.337us
         %2925 = :nvte_cublas_gemm_scaled [] -> 1.130ms
                 -->kernel: 0:7 %2461 =  [] -> 1.123ms
     %2926 = :TELayerNormColumnParallelLinear forward [] -> 882.178us
       %2927 = :aten::contiguous [[4096, 1, 512], []] -> 11.680us
         %2928 = :aten::clone [[4096, 1, 512], []] -> 11.680us
           %2929 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.680us
                 -->kernel: 0:7 %2462 =  [] -> 11.680us
       %2930 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 691.394us
         %2931 = :nvte_rmsnorm_fwd [] -> 4.192us
                 -->kernel: 0:7 %2463 =  [] -> 4.192us
         %2932 = :nvte_quantize_v2 [] -> 7.648us
           %2933 = :quantize_transpose_vector_blockwise [] -> 7.648us
                 -->kernel: 0:7 %2464 =  [] -> 7.648us
         %2934 = :nvte_quantize_v2 [] -> 28.800us
           %2935 = :quantize_transpose_square_blockwise [] -> 28.800us
                 -->kernel: 0:7 %2465 =  [] -> 28.800us
         %2936 = :nvte_cublas_gemm_scaled [] -> 521.601us
                 -->kernel: 0:7 %2466 =  [] -> 515.489us
     %2937 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.081us
                 -->kernel: 0:7 %2467 =  [] -> 114.081us
     %2938 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 171.841us
                 -->kernel: 0:7 %2468 =  [] -> 171.841us
     %2939 = :TEDotProductAttention forward [] -> 22.349ms
       %2940 = :aten::arange [[], [], [], [], []] -> 1.152us
         %2941 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %2469 =  [] -> 1.152us
       %2942 = :aten::arange [[], [], [], [], []] -> 1.152us
         %2943 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %2470 =  [] -> 1.152us
       %2944 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 60.897us
                 -->kernel: 0:7 %2471 =  [] -> 60.897us
       %2945 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 38.624us
                 -->kernel: 0:7 %2472 =  [] -> 38.624us
       %2946 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.176us
                 -->kernel: 0:7 %2473 =  [] -> 38.176us
       %2947 = :aten::le [[1, 1, 4096, 4096], []] -> 29.088us
                 -->kernel: 0:7 %2474 =  [] -> 29.088us
       %2948 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.832us
                 -->kernel: 0:7 %2475 =  [] -> 24.832us
       %2949 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.240us
                 -->kernel: 0:7 %2476 =  [] -> 14.240us
       %2950 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.784us
         %2951 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.784us
                 -->kernel: 0:7 %2477 =  [] -> 18.784us
       %2952 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.896us
         %2953 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.896us
                 -->kernel: 0:7 %2478 =  [] -> 12.896us
       %2954 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.272us
         %2955 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.272us
                 -->kernel: 0:7 %2479 =  [] -> 18.272us
       %2956 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.804ms
                 -->kernel: 0:7 %2480 =  [] -> 5.796ms
       %2957 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.000ms
         %2958 = :nvte_scaled_masked_softmax_forward [] -> 11.000ms
                 -->kernel: 0:7 %2481 =  [] -> 11.000ms
       %2959 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.981ms
                 -->kernel: 0:7 %2482 =  [] -> 3.966ms
       %2960 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.528us
         %2961 = :aten::clone [[4096, 1, 128, 128], []] -> 278.528us
           %2962 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.528us
                 -->kernel: 0:7 %2483 =  [] -> 278.528us
     %2963 = :TERowParallelLinear forward [] -> 3.819ms
       %2964 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.819ms
         %2965 = :nvte_quantize_v2 [] -> 97.344us
           %2966 = :quantize_transpose_vector_blockwise [] -> 97.344us
                 -->kernel: 0:7 %2484 =  [] -> 97.344us
         %2967 = :nvte_quantize_v2 [] -> 169.793us
           %2968 = :quantize_transpose_square_blockwise [] -> 169.793us
                 -->kernel: 0:7 %2485 =  [] -> 169.793us
         %2969 = :nvte_cublas_gemm_scaled [] -> 3.404ms
                 -->kernel: 0:7 %2486 =  [] -> 3.397ms
     %2970 = :Torch-Compiled Region: 1/2 None -> 44.288us
       %2971 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.288us
         %2972 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.288us
                 -->kernel: 0:7 %2487 =  [] -> 44.288us
     %2973 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.816us
       %2974 = :nvte_rmsnorm_fwd [] -> 126.816us
                 -->kernel: 0:7 %2488 =  [] -> 126.816us
     %2975 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 41.920us
       %2976 = :nvte_cublas_gemm_scaled [] -> 41.920us
                 -->kernel: 0:7 %2489 =  [] -> 22.080us
                 -->kernel: 0:7 %2490 =  [] -> 2.624us
     %2977 = :RandomSTE [[4096, 1, 32]] -> 40.320us
       %2978 = :aten::clone [[4096, 1, 32], []] -> 1.568us
         %2979 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.568us
       %2980 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.672us
                 -->kernel: 0:7 %2491 =  [] -> 4.672us
     %2981 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 69.760us
       %2982 = :nvte_fused_topk_with_score_function_forward [] -> 69.760us
                 -->kernel: 0:7 %2492 =  [] -> 69.760us
     %2983 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 27.200us
       %2984 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 27.200us
                 -->kernel: 0:7 %2493 =  [] -> 27.200us
     %2985 = :aten::sum [[4096, 32], [], [], []] -> 45.440us
       %2986 = :aten::to [[4096, 32], [], [], [], []] -> 4.672us
         %2987 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.672us
           %2988 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.672us
                 -->kernel: 0:7 %2494 =  [] -> 4.672us
                 -->kernel: 0:7 %2495 =  [] -> 10.240us
     %2989 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.160us
       %2990 = :nvte_fused_moe_aux_loss_forward [] -> 12.160us
                 -->kernel: 0:7 %2496 =  [] -> 12.160us
     %2991 = :aten::div [[], []] -> 1.056us
                 -->kernel: 0:7 %2497 =  [] -> 1.056us
     %2992 = :aten::div [[], []] -> 1.376us
                 -->kernel: 0:7 %2498 =  [] -> 1.376us
     %2993 = :aten::add_ [[], [], []] -> 1.536us
                 -->kernel: 0:7 %2499 =  [] -> 1.536us
     %2994 = :aten::sum [[4096, 32], [], [], []] -> 34.944us
       %2995 = :aten::to [[4096, 32], [], [], [], []] -> 4.672us
         %2996 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.672us
           %2997 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.672us
                 -->kernel: 0:7 %2500 =  [] -> 4.672us
                 -->kernel: 0:7 %2501 =  [] -> 7.616us
     %2998 = :aten::add_ [[32], [32], []] -> 4.000us
                 -->kernel: 0:7 %2502 =  [] -> 4.000us
     %2999 = :aten::topk [[4096, 32], [], [], [], []] -> 51.104us
                 -->kernel: 0:7 %2503 =  [] -> 14.528us
                 -->kernel: 0:7 %2504 =  [] -> 7.712us
     %3000 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 856.258us
                 -->kernel: 0:26 %2505 =  [] -> 43.552us
                 -->kernel: 0:26 %2506 =  [] -> 12.512us
                 -->kernel: 0:26 %2507 =  [] -> 678.242us
     %3001 = :TEColumnParallelLinear forward [] -> 1.154ms
       %3002 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.154ms
         %3003 = :nvte_quantize_v2 [] -> 45.152us
           %3004 = :quantize_transpose_vector_blockwise [] -> 45.152us
                 -->kernel: 0:7 %2508 =  [] -> 45.152us
         %3005 = :nvte_quantize_v2 [] -> 44.672us
           %3006 = :quantize_transpose_square_blockwise [] -> 44.672us
                 -->kernel: 0:7 %2509 =  [] -> 44.672us
         %3007 = :nvte_cublas_gemm_scaled [] -> 913.890us
                 -->kernel: 0:7 %2510 =  [] -> 906.818us
     %3008 = :SwiGLUFunction [[4096, 4096], [], []] -> 27.105us
       %3009 = :Torch-Compiled Region: 2/1 None -> 27.105us
         %3010 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 27.105us
                 -->kernel: 0:7 %2511 =  [] -> 27.105us
     %3011 = :TERowParallelLinear forward [] -> 601.921us
       %3012 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 601.921us
         %3013 = :nvte_quantize_v2 [] -> 22.912us
           %3014 = :quantize_transpose_vector_blockwise [] -> 22.912us
                 -->kernel: 0:7 %2512 =  [] -> 22.912us
         %3015 = :nvte_quantize_v2 [] -> 24.384us
           %3016 = :quantize_transpose_square_blockwise [] -> 24.384us
                 -->kernel: 0:7 %2513 =  [] -> 24.384us
         %3017 = :nvte_cublas_gemm_scaled [] -> 441.377us
                 -->kernel: 0:7 %2514 =  [] -> 435.201us
     %3018 = :IndicesToMultihot [[15764, 8], [15764, 8], []] -> 11.040us
                 -->kernel: 0:7 %2515 =  [] -> 11.040us
     %3019 = :aten::contiguous [[4, 15764], []] -> 2.912us
       %3020 = :aten::clone [[4, 15764], []] -> 2.912us
         %3021 = :aten::copy_ [[4, 15764], [4, 15764], []] -> 2.912us
                 -->kernel: 0:7 %2516 =  [] -> 2.912us
     %3022 = :aten::to [[4, 15764], [], [], [], []] -> 4.992us
       %3023 = :aten::_to_copy [[4, 15764], [], [], [], [], [], []] -> 4.992us
         %3024 = :aten::copy_ [[4, 15764], [4, 15764], []] -> 4.992us
                 -->kernel: 0:7 %2517 =  [] -> 4.992us
                 -->kernel: 0:7 %2518 =  [] -> 22.112us
     %3025 = :_moe_permute_mask_map [[15764, 7168], [15764, 4], [], [15764, 4]] -> 399.937us
                 -->kernel: 0:7 %2519 =  [] -> 2.464us
                 -->kernel: 0:7 %2520 =  [] -> 2.400us
                 -->kernel: 0:7 %2521 =  [] -> 13.088us
                 -->kernel: 0:7 %2522 =  [] -> 201.408us
     %3026 = :TEColumnParallelGroupedLinear forward [] -> 8.458ms
       %3027 = :_GroupedLinear [[32864, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.458ms
         %3028 = :nvte_quantize_v2 [] -> 222.400us
           %3029 = :quantize_transpose_vector_blockwise [] -> 222.400us
                 -->kernel: 0:7 %2523 =  [] -> 222.400us
         %3030 = :nvte_quantize_v2 [] -> 224.193us
           %3031 = :quantize_transpose_vector_blockwise [] -> 224.193us
                 -->kernel: 0:7 %2524 =  [] -> 224.193us
         %3032 = :nvte_quantize_v2 [] -> 218.689us
           %3033 = :quantize_transpose_vector_blockwise [] -> 218.689us
                 -->kernel: 0:7 %2525 =  [] -> 218.689us
         %3034 = :nvte_quantize_v2 [] -> 221.792us
           %3035 = :quantize_transpose_vector_blockwise [] -> 221.792us
                 -->kernel: 0:7 %2526 =  [] -> 221.792us
         %3036 = :nvte_quantize_v2 [] -> 45.632us
           %3037 = :quantize_transpose_square_blockwise [] -> 45.632us
                 -->kernel: 0:7 %2527 =  [] -> 45.632us
         %3038 = :nvte_quantize_v2 [] -> 45.792us
           %3039 = :quantize_transpose_square_blockwise [] -> 45.792us
                 -->kernel: 0:7 %2528 =  [] -> 45.792us
         %3040 = :nvte_quantize_v2 [] -> 45.537us
           %3041 = :quantize_transpose_square_blockwise [] -> 45.537us
                 -->kernel: 0:7 %2529 =  [] -> 45.537us
         %3042 = :nvte_quantize_v2 [] -> 45.824us
           %3043 = :quantize_transpose_square_blockwise [] -> 45.824us
                 -->kernel: 0:7 %2530 =  [] -> 45.824us
         %3044 = :nvte_multi_stream_cublas_gemm [] -> 7.081ms
           %3045 = :nvte_cublas_gemm [] -> 1.758ms
                 -->kernel: 0:159 %2531 =  [] -> 1.749ms
           %3046 = :nvte_cublas_gemm [] -> 1.753ms
                 -->kernel: 0:160 %2532 =  [] -> 1.748ms
           %3047 = :nvte_cublas_gemm [] -> 1.749ms
                 -->kernel: 0:161 %2533 =  [] -> 1.744ms
           %3048 = :nvte_cublas_gemm [] -> 1.753ms
                 -->kernel: 0:162 %2534 =  [] -> 1.748ms
     %3049 = :WeightedSwiGLUFunction [[32864, 4096], [32864, 1], []] -> 120.000us
       %3050 = :Torch-Compiled Region: 3/1 None -> 120.000us
         %3051 = :triton_poi_fused__to_copy_mul_silu_0 [[32864, 4096], [32864, 1], [32864, 2048], [], []] -> 120.000us
                 -->kernel: 0:7 %2535 =  [] -> 120.000us
     %3052 = :TERowParallelGroupedLinear forward [] -> 4.239ms
       %3053 = :_GroupedLinear [[32864, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.239ms
         %3054 = :nvte_quantize_v2 [] -> 68.576us
           %3055 = :quantize_transpose_vector_blockwise [] -> 68.576us
                 -->kernel: 0:7 %2536 =  [] -> 68.576us
         %3056 = :nvte_quantize_v2 [] -> 69.056us
           %3057 = :quantize_transpose_vector_blockwise [] -> 69.056us
                 -->kernel: 0:7 %2537 =  [] -> 69.056us
         %3058 = :nvte_quantize_v2 [] -> 67.232us
           %3059 = :quantize_transpose_vector_blockwise [] -> 67.232us
                 -->kernel: 0:7 %2538 =  [] -> 67.232us
         %3060 = :nvte_quantize_v2 [] -> 68.737us
           %3061 = :quantize_transpose_vector_blockwise [] -> 68.737us
                 -->kernel: 0:7 %2539 =  [] -> 68.737us
         %3062 = :nvte_quantize_v2 [] -> 25.440us
           %3063 = :quantize_transpose_square_blockwise [] -> 25.440us
                 -->kernel: 0:7 %2540 =  [] -> 25.440us
         %3064 = :nvte_quantize_v2 [] -> 24.256us
           %3065 = :quantize_transpose_square_blockwise [] -> 24.256us
                 -->kernel: 0:7 %2541 =  [] -> 24.256us
         %3066 = :nvte_quantize_v2 [] -> 24.512us
           %3067 = :quantize_transpose_square_blockwise [] -> 24.512us
                 -->kernel: 0:7 %2542 =  [] -> 24.512us
         %3068 = :nvte_quantize_v2 [] -> 24.320us
           %3069 = :quantize_transpose_square_blockwise [] -> 24.320us
                 -->kernel: 0:7 %2543 =  [] -> 24.320us
         %3070 = :nvte_multi_stream_cublas_gemm [] -> 3.588ms
           %3071 = :nvte_cublas_gemm [] -> 889.122us
                 -->kernel: 0:159 %2544 =  [] -> 879.746us
           %3072 = :nvte_cublas_gemm [] -> 883.682us
                 -->kernel: 0:160 %2545 =  [] -> 879.426us
           %3073 = :nvte_cublas_gemm [] -> 870.690us
                 -->kernel: 0:161 %2546 =  [] -> 866.850us
           %3074 = :nvte_cublas_gemm [] -> 883.587us
                 -->kernel: 0:162 %2547 =  [] -> 879.330us
     %3075 = :_moe_unpermute_mask_map [[32864, 7168], [15764, 9], [], []] -> 227.137us
                 -->kernel: 0:7 %2548 =  [] -> 227.137us
     %3076 = :FusedCombine [[15764, 7168], [], []] -> 741.154us
                 -->kernel: 0:26 %2549 =  [] -> 14.016us
                 -->kernel: 0:26 %2550 =  [] -> 700.194us
     %3077 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.320us
                 -->kernel: 0:7 %2551 =  [] -> 52.320us
     %3078 = :Torch-Compiled Region: 1/2 None -> 47.328us
       %3079 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 47.328us
         %3080 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 47.328us
                 -->kernel: 0:7 %2552 =  [] -> 47.328us
     %3081 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.272us
       %3082 = :nvte_rmsnorm_fwd [] -> 126.272us
                 -->kernel: 0:7 %2553 =  [] -> 126.272us
     %3083 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 162.048us
                 -->kernel: 0:7 %2554 =  [] -> 162.048us
     %3084 = :aten::clone [[1, 4096], []] -> 1.536us
       %3085 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.536us
     %3086 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.682ms
       %3087 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.682ms
         %3088 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.682ms
                 -->kernel: 0:7 %2555 =  [] -> 53.672ms
     %3089 = :aten::roll [[1, 4096], [], []] -> 2.176us
                 -->kernel: 0:7 %2556 =  [] -> 2.176us
     %3090 = :aten::fill_ [[1], []] -> 1.120us
                 -->kernel: 0:7 %2557 =  [] -> 1.120us
     %3091 = :aten::sum [[1, 4096], []] -> 3.232us
       %3092 = :aten::sum [[1, 4096], [], [], []] -> 3.232us
                 -->kernel: 0:7 %2558 =  [] -> 3.232us
     %3093 = :aten::roll [[1, 4096], [], []] -> 2.112us
                 -->kernel: 0:7 %2559 =  [] -> 2.112us
     %3094 = :aten::fill_ [[1], []] -> 1.312us
                 -->kernel: 0:7 %2560 =  [] -> 1.312us
     %3095 = :aten::sum [[1, 4096], []] -> 3.072us
       %3096 = :aten::sum [[1, 4096], [], [], []] -> 3.072us
                 -->kernel: 0:7 %2561 =  [] -> 3.072us
     %3097 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.483ms
       %3098 = :aten::zeros [[], [], [], [], []] -> 1.152us
         %3099 = :aten::zero_ [[4096]] -> 1.152us
           %3100 = :aten::fill_ [[4096], []] -> 1.152us
                 -->kernel: 0:7 %2562 =  [] -> 1.152us
       %3101 = :aten::zeros [[], [], [], [], []] -> 1.344us
         %3102 = :aten::zero_ [[12288]] -> 1.344us
           %3103 = :aten::fill_ [[12288], []] -> 1.344us
                 -->kernel: 0:7 %2563 =  [] -> 1.344us
                 -->kernel: 0:7 %2564 =  [] -> 659.010us
                 -->kernel: 0:7 %2565 =  [] -> 601.025us
     %3104 = :aten::mul [[1, 4096], [1, 4096]] -> 1.664us
                 -->kernel: 0:7 %2566 =  [] -> 1.664us
     %3105 = :aten::sum [[1, 4096], []] -> 3.296us
       %3106 = :aten::sum [[1, 4096], [], [], []] -> 3.296us
                 -->kernel: 0:7 %2567 =  [] -> 3.296us
     %3107 = :aten::div [[], []] -> 2.080us
                 -->kernel: 0:7 %2568 =  [] -> 2.080us
     %3108 = :aten::add_ [[], [], []] -> 1.760us
                 -->kernel: 0:7 %2569 =  [] -> 1.760us
     %3109 = :aten::mul [[1, 4096], []] -> 1.280us
                 -->kernel: 0:7 %2570 =  [] -> 1.280us
     %3110 = :aten::div [[1, 4096], []] -> 2.432us
                 -->kernel: 0:7 %2571 =  [] -> 2.432us
     %3111 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.691ms
       %3112 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.691ms
         %3113 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.691ms
                 -->kernel: 0:7 %2572 =  [] -> 53.680ms
     %3114 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.483ms
       %3115 = :aten::zeros [[], [], [], [], []] -> 1.184us
         %3116 = :aten::zero_ [[4096]] -> 1.184us
           %3117 = :aten::fill_ [[4096], []] -> 1.184us
                 -->kernel: 0:7 %2573 =  [] -> 1.184us
       %3118 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %3119 = :aten::zero_ [[12288]] -> 1.120us
           %3120 = :aten::fill_ [[12288], []] -> 1.120us
                 -->kernel: 0:7 %2574 =  [] -> 1.120us
                 -->kernel: 0:7 %2575 =  [] -> 660.738us
                 -->kernel: 0:7 %2576 =  [] -> 599.969us
     %3121 = :aten::mul [[4096], [4096]] -> 1.760us
                 -->kernel: 0:7 %2577 =  [] -> 1.760us
     %3122 = :aten::sum [[4096], []] -> 3.072us
       %3123 = :aten::sum [[4096], [], [], []] -> 3.072us
                 -->kernel: 0:7 %2578 =  [] -> 3.072us
     %3124 = :aten::sum [[4096], []] -> 3.296us
       %3125 = :aten::sum [[4096], [], [], []] -> 3.296us
                 -->kernel: 0:7 %2579 =  [] -> 3.296us
     %3126 = :aten::stack [[], [], []] -> 2.240us
       %3127 = :aten::cat [[1], [1], []] -> 2.240us
                 -->kernel: 0:7 %2580 =  [] -> 2.240us
     %3128 = :aten::isnan [[2]] -> 1.792us
       %3129 = :aten::ne [[2], [2]] -> 1.792us
                 -->kernel: 0:7 %2581 =  [] -> 1.792us
     %3130 = :aten::any [[2]] -> 2.624us
                 -->kernel: 0:7 %2582 =  [] -> 2.624us
     %3131 = :aten::is_nonzero [[]] -> 2.880us
       %3132 = :aten::item [[]] -> 2.880us
         %3133 = :aten::_local_scalar_dense [[]] -> 2.880us
     %3134 = :aten::clone [[], []] -> 1.440us
       %3135 = :aten::copy_ [[], [], []] -> 1.440us
     %3136 = :aten::clone [[], []] -> 1.408us
       %3137 = :aten::copy_ [[], [], []] -> 1.408us
     %3138 = :aten::cat [[1], [1], []] -> 1.600us
                 -->kernel: 0:7 %2583 =  [] -> 1.600us
     %3139 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 134.881us
       %3140 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 134.881us
         %3141 = :nccl:all_reduce [[2]] -> 134.881us
           %3142 = NCCL:ncclAllReduce [] -> 134.881us
                 -->kernel: 0:7 %2584 =  [] -> 134.881us
     %3143 = :aten::div [[2], []] -> 1.344us
                 -->kernel: 0:7 %2585 =  [] -> 1.344us
     %3144 = :aten::div [[], []] -> 1.440us
                 -->kernel: 0:7 %2586 =  [] -> 1.440us
     %3145 = :aten::mul [[], []] -> 1.184us
                 -->kernel: 0:7 %2587 =  [] -> 1.184us
     %3146 = :aten::mul_ [[], []] -> 1.120us
                 -->kernel: 0:7 %2588 =  [] -> 1.120us
     %3147 = :aten::div_ [[], []] -> 1.280us
                 -->kernel: 0:7 %2589 =  [] -> 1.280us
     %3148 = :aten::ones [[], [], [], [], []] -> 1.184us
       %3149 = :aten::fill_ [[1], []] -> 1.184us
                 -->kernel: 0:7 %2590 =  [] -> 1.184us
     %3150 = :aten::mul [[1], [1]] -> 1.376us
                 -->kernel: 0:7 %2591 =  [] -> 1.376us
     %3151 = :aten::div [[1], []] -> 1.152us
                 -->kernel: 0:7 %2592 =  [] -> 1.152us
     %3152 = :aten::copy_ [[1], [1], []] -> 1.248us
     %3153 = :aten::ones [[], [], [], [], []] -> 1.152us
       %3154 = :aten::fill_ [[1], []] -> 1.152us
                 -->kernel: 0:7 %2593 =  [] -> 1.152us
     %3155 = :aten::mul [[1], [1]] -> 1.152us
                 -->kernel: 0:7 %2594 =  [] -> 1.152us
     %3156 = :aten::div [[1], []] -> 1.344us
                 -->kernel: 0:7 %2595 =  [] -> 1.344us
     %3157 = :aten::add_ [[], [], []] -> 1.440us
                 -->kernel: 0:7 %2596 =  [] -> 1.440us
     %3158 = :aten::mul [[1], []] -> 1.280us
                 -->kernel: 0:7 %2597 =  [] -> 1.280us
     %3159 = :aten::ones_like [[1], [], [], [], [], []] -> 960.000ns
       %3160 = :aten::fill_ [[1], []] -> 960.000ns
                 -->kernel: 0:7 %2598 =  [] -> 960.000ns
     %3161 = :autograd::engine::evaluate_function: MulBackward0 None -> 108.192us
       %3162 = :MulBackward0 [[1]] -> 1.120us
         %3163 = :aten::mul [[1], [1]] -> 1.120us
                 -->kernel: 0:7 %2599 =  [] -> 1.120us
       %3164 = :aten::sum [[1], []] -> 2.784us
         %3165 = :aten::sum [[1], [], [], []] -> 2.784us
                 -->kernel: 0:7 %2600 =  [] -> 2.784us
     %3166 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.568us
       %3167 = :DivBackward0 [[]] -> 1.568us
         %3168 = :aten::div [[], []] -> 1.568us
                 -->kernel: 0:7 %2601 =  [] -> 1.568us
     %3169 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.184us
       %3170 = :MulBackward0 [[]] -> 1.184us
         %3171 = :aten::mul [[], []] -> 1.184us
                 -->kernel: 0:7 %2602 =  [] -> 1.184us
     %3172 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.152us
       %3173 = :MulBackward0 [[]] -> 1.152us
         %3174 = :aten::mul [[], []] -> 1.152us
                 -->kernel: 0:7 %2603 =  [] -> 1.152us
     %3175 = :autograd::engine::evaluate_function: SelectBackward0 None -> 60.833us
       %3176 = :SelectBackward0 [[]] -> 60.833us
         %3177 = :aten::select_backward [[], [], [], []] -> 60.833us
           %3178 = :aten::zeros [[], [], [], [], []] -> 1.152us
             %3179 = :aten::zero_ [[2]] -> 1.152us
               %3180 = :aten::fill_ [[2], []] -> 1.152us
                 -->kernel: 0:7 %2604 =  [] -> 1.152us
           %3181 = :aten::copy_ [[], [], []] -> 1.248us
     %3182 = :autograd::engine::evaluate_function: MulBackward0 None -> 2.208us
       %3183 = :MulBackward0 [[4096]] -> 2.208us
         %3184 = :aten::mul [[4096], [4096]] -> 2.208us
                 -->kernel: 0:7 %2605 =  [] -> 2.208us
     %3185 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 769.858us
       %3186 = :CrossEntropyFunctionBackward [[4096, 1]] -> 769.858us
         %3187 = :aten::to [[], [], [], [], [], []] -> 832.000ns
           %3188 = :aten::_to_copy [[], [], [], [], [], [], []] -> 832.000ns
             %3189 = :aten::copy_ [[], [], []] -> 832.000ns
                 -->kernel: 0:7 %2606 =  [] -> 598.433us
     %3190 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 109.171ms
       %3191 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.171ms
         %3192 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.610ms
           %3193 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.610ms
                 -->kernel: 0:7 %2607 =  [] -> 55.598ms
                 -->kernel: 0:7 %2608 =  [] -> 53.315ms
     %3194 = :autograd::engine::evaluate_function: MTPLossAutoScalerBackward None -> 75.872us
       %3195 = :MTPLossAutoScalerBackward [[4096, 1, 7168]] -> 75.872us
         %3196 = :aten::ones_like [[1, 4096], [], [], [], [], []] -> 1.120us
           %3197 = :aten::fill_ [[1, 4096], []] -> 1.120us
                 -->kernel: 0:7 %2609 =  [] -> 1.120us
         %3198 = :aten::mul [[1, 4096], [1]] -> 2.176us
                 -->kernel: 0:7 %2610 =  [] -> 2.176us
     %3199 = :autograd::engine::evaluate_function: DivBackward0 None -> 2.272us
       %3200 = :DivBackward0 [[1, 4096]] -> 2.272us
         %3201 = :aten::div [[1, 4096], []] -> 2.272us
                 -->kernel: 0:7 %2611 =  [] -> 2.272us
     %3202 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.376us
       %3203 = :MulBackward0 [[1, 4096]] -> 1.376us
         %3204 = :aten::mul [[1, 4096], []] -> 1.376us
                 -->kernel: 0:7 %2612 =  [] -> 1.376us
     %3205 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.536us
       %3206 = :MulBackward0 [[1, 4096]] -> 1.536us
         %3207 = :aten::mul [[1, 4096], [1, 4096]] -> 1.536us
                 -->kernel: 0:7 %2613 =  [] -> 1.536us
     %3208 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 752.001us
       %3209 = :CrossEntropyFunctionBackward [[4096, 1]] -> 752.001us
         %3210 = :aten::to [[], [], [], [], [], []] -> 832.000ns
           %3211 = :aten::_to_copy [[], [], [], [], [], [], []] -> 832.000ns
             %3212 = :aten::copy_ [[], [], []] -> 832.000ns
                 -->kernel: 0:7 %2614 =  [] -> 592.545us
     %3213 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 110.969ms
       %3214 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.508ms
         %3215 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.818ms
           %3216 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.818ms
                 -->kernel: 0:7 %2615 =  [] -> 55.806ms
                 -->kernel: 0:7 %2616 =  [] -> 53.452ms
       %3217 = :aten::add [[129280, 7168], [129280, 7168], []] -> 1.157ms
                 -->kernel: 0:35 %2617 =  [] -> 1.157ms
     %3218 = :autograd::engine::evaluate_function: SplitBackward0 None -> 163.296us
       %3219 = :SplitBackward0 [[4096, 1, 7168], [4096, 1, 7168]] -> 163.296us
         %3220 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 163.296us
                 -->kernel: 0:7 %2618 =  [] -> 163.296us
     %3221 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 207.616us
       %3222 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 207.616us
         %3223 = :nvte_rmsnorm_bwd [] -> 207.616us
                 -->kernel: 0:7 %2619 =  [] -> 167.040us
                 -->kernel: 0:7 %2620 =  [] -> 7.936us
     %3224 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.760us
       %3225 = :aten::add_ [[7168], [7168], []] -> 1.760us
                 -->kernel: 0:35 %2621 =  [] -> 1.760us
     %3226 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 868.354us
       %3227 = :FusedCombineBackward [[4096, 7168], []] -> 868.354us
                 -->kernel: 0:26 %2622 =  [] -> 8.032us
                 -->kernel: 0:26 %2623 =  [] -> 803.233us
     %3228 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 200.417us
       %3229 = :_moe_unpermute_mask_mapBackward [[15764, 7168]] -> 200.417us
                 -->kernel: 0:7 %2624 =  [] -> 200.417us
     %3230 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.650ms
       %3231 = :_GroupedLinearBackward [[32864, 7168]] -> 8.650ms
         %3232 = :_GroupedLinear_backward [] -> 8.650ms
           %3233 = :nvte_quantize_v2 [] -> 221.601us
             %3234 = :quantize_transpose_vector_blockwise [] -> 221.601us
                 -->kernel: 0:7 %2625 =  [] -> 221.601us
           %3235 = :nvte_quantize_v2 [] -> 223.200us
             %3236 = :quantize_transpose_vector_blockwise [] -> 223.200us
                 -->kernel: 0:7 %2626 =  [] -> 223.200us
           %3237 = :nvte_quantize_v2 [] -> 218.209us
             %3238 = :quantize_transpose_vector_blockwise [] -> 218.209us
                 -->kernel: 0:7 %2627 =  [] -> 218.209us
           %3239 = :nvte_quantize_v2 [] -> 220.384us
             %3240 = :quantize_transpose_vector_blockwise [] -> 220.384us
                 -->kernel: 0:7 %2628 =  [] -> 220.384us
           %3241 = :nvte_multi_stream_cublas_gemm [] -> 3.723ms
             %3242 = :nvte_cublas_gemm [] -> 919.586us
                 -->kernel: 0:159 %2629 =  [] -> 908.130us
             %3243 = :nvte_cublas_gemm [] -> 914.178us
                 -->kernel: 0:160 %2630 =  [] -> 908.482us
             %3244 = :nvte_cublas_gemm [] -> 911.682us
                 -->kernel: 0:161 %2631 =  [] -> 906.498us
             %3245 = :nvte_cublas_gemm [] -> 912.994us
                 -->kernel: 0:162 %2632 =  [] -> 908.194us
           %3246 = :nvte_multi_stream_cublas_gemm [] -> 3.692ms
             %3247 = :nvte_cublas_gemm [] -> 914.498us
                 -->kernel: 0:159 %2633 =  [] -> 905.794us
             %3248 = :nvte_cublas_gemm [] -> 909.250us
                 -->kernel: 0:160 %2634 =  [] -> 905.762us
             %3249 = :nvte_cublas_gemm [] -> 896.098us
                 -->kernel: 0:161 %2635 =  [] -> 892.034us
             %3250 = :nvte_cublas_gemm [] -> 909.186us
                 -->kernel: 0:162 %2636 =  [] -> 905.602us
     %3251 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 599.682us
       %3252 = :WeightedSwiGLUFunctionBackward [[32864, 2048]] -> 599.682us
         %3253 = :Torch-Compiled Region: 4/1 None -> 599.682us
           %3254 = :triton_poi_fused__to_copy_cat_0 [[32864, 2048], [32864, 1], [32864, 4096], [32864, 4096], [], []] -> 404.385us
                 -->kernel: 0:7 %2637 =  [] -> 404.385us
           %3255 = :triton_red_fused__to_copy_mul_silu_sum_1 [[32864, 4096], [32864, 2048], [32864, 1], [], [], [], []] -> 131.104us
                 -->kernel: 0:7 %2638 =  [] -> 131.104us
     %3256 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.859ms
       %3257 = :_GroupedLinearBackward [[32864, 4096]] -> 14.859ms
         %3258 = :_GroupedLinear_backward [] -> 14.859ms
           %3259 = :nvte_quantize_v2 [] -> 126.529us
             %3260 = :quantize_transpose_vector_blockwise [] -> 126.529us
                 -->kernel: 0:7 %2639 =  [] -> 126.529us
           %3261 = :nvte_quantize_v2 [] -> 131.520us
             %3262 = :quantize_transpose_vector_blockwise [] -> 131.520us
                 -->kernel: 0:7 %2640 =  [] -> 131.520us
           %3263 = :nvte_quantize_v2 [] -> 128.896us
             %3264 = :quantize_transpose_vector_blockwise [] -> 128.896us
                 -->kernel: 0:7 %2641 =  [] -> 128.896us
           %3265 = :nvte_quantize_v2 [] -> 129.985us
             %3266 = :quantize_transpose_vector_blockwise [] -> 129.985us
                 -->kernel: 0:7 %2642 =  [] -> 129.985us
           %3267 = :nvte_multi_stream_cublas_gemm [] -> 7.062ms
             %3268 = :nvte_cublas_gemm [] -> 1.760ms
                 -->kernel: 0:159 %2643 =  [] -> 1.752ms
             %3269 = :nvte_cublas_gemm [] -> 1.757ms
                 -->kernel: 0:160 %2644 =  [] -> 1.750ms
             %3270 = :nvte_cublas_gemm [] -> 1.723ms
                 -->kernel: 0:161 %2645 =  [] -> 1.719ms
             %3271 = :nvte_cublas_gemm [] -> 1.754ms
                 -->kernel: 0:162 %2646 =  [] -> 1.750ms
           %3272 = :nvte_multi_stream_cublas_gemm [] -> 7.005ms
             %3273 = :nvte_cublas_gemm [] -> 1.744ms
                 -->kernel: 0:159 %2647 =  [] -> 1.737ms
             %3274 = :nvte_cublas_gemm [] -> 1.742ms
                 -->kernel: 0:160 %2648 =  [] -> 1.737ms
             %3275 = :nvte_cublas_gemm [] -> 1.716ms
                 -->kernel: 0:161 %2649 =  [] -> 1.713ms
             %3276 = :nvte_cublas_gemm [] -> 1.741ms
                 -->kernel: 0:162 %2650 =  [] -> 1.737ms
     %3277 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 395.713us
       %3278 = :_moe_permute_mask_mapBackward [[32864, 7168], [], [32864]] -> 395.713us
         %3279 = :aten::zeros [[], [], [], [], []] -> 1.280us
           %3280 = :aten::zero_ [[15764, 9]] -> 1.280us
             %3281 = :aten::fill_ [[15764, 9], []] -> 1.280us
                 -->kernel: 0:7 %2651 =  [] -> 1.280us
                 -->kernel: 0:7 %2652 =  [] -> 213.152us
     %3282 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 98.849us
       %3283 = :IndicesToMultihotBackward [[], [15764, 4]] -> 98.849us
         %3284 = :aten::zeros [[], [], [], [], []] -> 1.440us
           %3285 = :aten::zero_ [[15764, 4]] -> 1.440us
             %3286 = :aten::fill_ [[15764, 4], []] -> 1.440us
                 -->kernel: 0:7 %2653 =  [] -> 1.440us
                 -->kernel: 0:7 %2654 =  [] -> 11.392us
     %3287 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.176ms
       %3288 = :_LinearBackward [[4096, 1, 7168]] -> 1.176ms
         %3289 = :_Linear_backward [] -> 1.176ms
           %3290 = :nvte_quantize_v2 [] -> 73.536us
             %3291 = :quantize_transpose_vector_blockwise [] -> 73.536us
                 -->kernel: 0:7 %2655 =  [] -> 73.536us
           %3292 = :nvte_cublas_gemm_scaled [] -> 468.001us
                 -->kernel: 0:7 %2656 =  [] -> 458.241us
           %3293 = :nvte_cublas_gemm_scaled [] -> 455.265us
                 -->kernel: 0:7 %2657 =  [] -> 450.273us
     %3294 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 47.297us
       %3295 = :SwiGLUFunctionBackward [[4096, 2048]] -> 47.297us
         %3296 = :Torch-Compiled Region: 5/0 None -> 47.297us
           %3297 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 47.297us
                 -->kernel: 0:7 %2658 =  [] -> 47.297us
     %3298 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.014ms
       %3299 = :_LinearBackward [[4096, 1, 4096]] -> 2.014ms
         %3300 = :_Linear_backward [] -> 2.014ms
           %3301 = :nvte_quantize_v2 [] -> 44.064us
             %3302 = :quantize_transpose_vector_blockwise [] -> 44.064us
                 -->kernel: 0:7 %2659 =  [] -> 44.064us
           %3303 = :nvte_quantize_v2 [] -> 52.512us
             %3304 = :quantize_transpose_vector_blockwise [] -> 52.512us
                 -->kernel: 0:7 %2660 =  [] -> 52.512us
           %3305 = :nvte_cublas_gemm_scaled [] -> 867.330us
                 -->kernel: 0:7 %2661 =  [] -> 861.378us
           %3306 = :nvte_cublas_gemm_scaled [] -> 868.258us
                 -->kernel: 0:7 %2662 =  [] -> 862.562us
     %3307 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 872.610us
       %3308 = :FusedDispatchBackward [[15764, 7168], [], [15764, 8], [], []] -> 872.610us
         %3309 = :aten::zeros [[], [], [], [], []] -> 1.472us
           %3310 = :aten::zero_ [[15764, 8]] -> 1.472us
             %3311 = :aten::fill_ [[15764, 8], []] -> 1.472us
                 -->kernel: 0:7 %2663 =  [] -> 1.472us
                 -->kernel: 0:26 %2664 =  [] -> 13.600us
                 -->kernel: 0:26 %2665 =  [] -> 685.570us
     %3312 = :autograd::engine::evaluate_function: TopkBackward0 None -> 62.752us
       %3313 = :TopkBackward0 [[4096, 8]] -> 62.752us
         %3314 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 62.752us
           %3315 = :aten::zeros [[], [], [], [], []] -> 960.000ns
             %3316 = :aten::zero_ [[4096, 32]] -> 960.000ns
               %3317 = :aten::fill_ [[4096, 32], []] -> 960.000ns
                 -->kernel: 0:7 %2666 =  [] -> 960.000ns
           %3318 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 9.024us
                 -->kernel: 0:7 %2667 =  [] -> 9.024us
     %3319 = :autograd::engine::evaluate_function: ViewBackward0 None -> 53.504us
       %3320 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 53.504us
                 -->kernel: 0:7 %2668 =  [] -> 53.504us
     %3321 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 87.808us
       %3322 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 37.824us
         %3323 = :aten::ones_like [[], [], [], [], [], []] -> 1.312us
           %3324 = :aten::fill_ [[], []] -> 1.312us
                 -->kernel: 0:7 %2669 =  [] -> 1.312us
         %3325 = :aten::mul [[], [1]] -> 1.696us
                 -->kernel: 0:7 %2670 =  [] -> 1.696us
       %3326 = :aten::sum [[1], []] -> 2.656us
         %3327 = :aten::sum [[1], [], [], []] -> 2.656us
                 -->kernel: 0:7 %2671 =  [] -> 2.656us
     %3328 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.280us
       %3329 = :DivBackward0 [[]] -> 1.280us
         %3330 = :aten::div [[], []] -> 1.280us
                 -->kernel: 0:7 %2672 =  [] -> 1.280us
     %3331 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.144us
       %3332 = :FusedAuxLossBackward [[]] -> 2.144us
         %3333 = :nvte_fused_moe_aux_loss_backward [] -> 2.144us
                 -->kernel: 0:7 %2673 =  [] -> 2.144us
     %3334 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 60.321us
       %3335 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 60.321us
         %3336 = :aten::zeros [[], [], [], [], []] -> 1.248us
           %3337 = :aten::zero_ [[4096, 32]] -> 1.248us
             %3338 = :aten::fill_ [[4096, 32], []] -> 1.248us
                 -->kernel: 0:7 %2674 =  [] -> 1.248us
         %3339 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.832us
                 -->kernel: 0:7 %2675 =  [] -> 12.832us
     %3340 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 96.256us
       %3341 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 55.200us
         %3342 = :aten::zeros [[], [], [], [], []] -> 1.152us
           %3343 = :aten::zero_ [[4096, 32]] -> 1.152us
             %3344 = :aten::fill_ [[4096, 32], []] -> 1.152us
                 -->kernel: 0:7 %2676 =  [] -> 1.152us
         %3345 = :nvte_fused_topk_with_score_function_backward [] -> 13.984us
                 -->kernel: 0:7 %2677 =  [] -> 13.984us
       %3346 = :aten::add [[4096, 32], [4096, 32], []] -> 1.664us
                 -->kernel: 0:7 %2678 =  [] -> 1.664us
     %3347 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 799.330us
       %3348 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 704.674us
         %3349 = :aten::to [[32, 7168], [], [], [], []] -> 6.400us
           %3350 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.400us
             %3351 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.400us
                 -->kernel: 0:7 %2679 =  [] -> 6.400us
         %3352 = :nvte_cublas_gemm_scaled [] -> 83.297us
                 -->kernel: 0:7 %2680 =  [] -> 67.520us
         %3353 = :aten::to [[4096, 7168], [], [], [], []] -> 175.968us
           %3354 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 175.968us
             %3355 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 175.968us
                 -->kernel: 0:7 %2681 =  [] -> 175.968us
         %3356 = :nvte_cublas_gemm_scaled [] -> 82.465us
                 -->kernel: 0:7 %2682 =  [] -> 82.465us
         %3357 = :aten::to [[4096, 7168], [], [], [], []] -> 43.936us
           %3358 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.936us
             %3359 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.936us
                 -->kernel: 0:7 %2683 =  [] -> 43.936us
         %3360 = :aten::to [[32, 7168], [], [], [], []] -> 2.112us
           %3361 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.112us
             %3362 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.112us
                 -->kernel: 0:7 %2684 =  [] -> 2.112us
       %3363 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.856us
                 -->kernel: 0:7 %2685 =  [] -> 49.856us
     %3364 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.144us
       %3365 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.144us
                 -->kernel: 0:35 %2686 =  [] -> 2.144us
     %3366 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 319.840us
       %3367 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 196.736us
         %3368 = :nvte_rmsnorm_bwd [] -> 196.736us
                 -->kernel: 0:7 %2687 =  [] -> 166.400us
                 -->kernel: 0:7 %2688 =  [] -> 7.904us
       %3369 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.872us
                 -->kernel: 0:7 %2689 =  [] -> 51.872us
     %3370 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %3371 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %2690 =  [] -> 1.600us
     %3372 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.289ms
       %3373 = :_LinearBackward [[4096, 1, 7168]] -> 7.289ms
         %3374 = :_Linear_backward [] -> 7.289ms
           %3375 = :nvte_quantize_v2 [] -> 73.152us
             %3376 = :quantize_transpose_vector_blockwise [] -> 73.152us
                 -->kernel: 0:7 %2691 =  [] -> 73.152us
           %3377 = :nvte_quantize_v2 [] -> 111.264us
             %3378 = :quantize_transpose_vector_blockwise [] -> 111.264us
                 -->kernel: 0:7 %2692 =  [] -> 111.264us
           %3379 = :nvte_cublas_gemm_scaled [] -> 3.441ms
                 -->kernel: 0:7 %2693 =  [] -> 3.434ms
           %3380 = :nvte_cublas_gemm_scaled [] -> 3.443ms
                 -->kernel: 0:7 %2694 =  [] -> 3.437ms
     %3381 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.918ms
       %3382 = :BmmBackward0 [[128, 4096, 128]] -> 7.918ms
         %3383 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.981ms
                 -->kernel: 0:7 %2695 =  [] -> 3.970ms
         %3384 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.882ms
                 -->kernel: 0:7 %2696 =  [] -> 3.872ms
     %3385 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.949ms
       %3386 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.949ms
         %3387 = :nvte_scaled_softmax_backward [] -> 6.949ms
                 -->kernel: 0:7 %2697 =  [] -> 6.949ms
     %3388 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.210ms
       %3389 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.210ms
         %3390 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.948ms
                 -->kernel: 0:7 %2698 =  [] -> 5.938ms
         %3391 = :aten::mul [[128, 4096, 192], []] -> 115.264us
           %3392 = :aten::mul [[128, 4096, 192], []] -> 115.264us
                 -->kernel: 0:7 %2699 =  [] -> 115.264us
         %3393 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.875ms
                 -->kernel: 0:7 %2700 =  [] -> 5.868ms
         %3394 = :aten::mul [[128, 192, 4096], []] -> 115.777us
           %3395 = :aten::mul [[128, 192, 4096], []] -> 115.777us
                 -->kernel: 0:7 %2701 =  [] -> 115.777us
     %3396 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.470ms
       %3397 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.470ms
         %3398 = :aten::contiguous [[4096, 1, 128, 192], []] -> 744.834us
           %3399 = :aten::clone [[4096, 1, 128, 192], []] -> 744.834us
             %3400 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 744.834us
                 -->kernel: 0:7 %2702 =  [] -> 744.834us
         %3401 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.993us
           %3402 = :aten::clone [[4096, 1, 128, 128], []] -> 280.993us
             %3403 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.993us
                 -->kernel: 0:7 %2703 =  [] -> 280.993us
                 -->kernel: 0:7 %2704 =  [] -> 171.617us
     %3404 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 642.241us
       %3405 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 642.241us
         %3406 = :aten::contiguous [[4096, 1, 128, 192], []] -> 423.041us
           %3407 = :aten::clone [[4096, 1, 128, 192], []] -> 423.041us
             %3408 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 423.041us
                 -->kernel: 0:7 %2705 =  [] -> 423.041us
                 -->kernel: 0:7 %2706 =  [] -> 118.848us
     %3409 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.731ms
       %3410 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.731ms
         %3411 = :_LayerNormLinear_backward [] -> 1.731ms
           %3412 = :nvte_quantize_v2 [] -> 323.905us
             %3413 = :quantize_transpose_vector_blockwise [] -> 323.905us
                 -->kernel: 0:7 %2707 =  [] -> 323.905us
           %3414 = :nvte_cublas_gemm_scaled [] -> 565.985us
                 -->kernel: 0:7 %2708 =  [] -> 519.745us
                 -->kernel: 0:7 %2709 =  [] -> 19.456us
           %3415 = :nvte_cublas_gemm_scaled [] -> 526.754us
                 -->kernel: 0:7 %2710 =  [] -> 521.442us
           %3416 = :nvte_rmsnorm_bwd [] -> 20.768us
                 -->kernel: 0:7 %2711 =  [] -> 6.368us
                 -->kernel: 0:7 %2712 =  [] -> 3.168us
     %3417 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.208us
       %3418 = :aten::add_ [[512], [512], []] -> 2.208us
                 -->kernel: 0:35 %2713 =  [] -> 2.208us
     %3419 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.812ms
       %3420 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.812ms
         %3421 = :_LayerNormLinear_backward [] -> 2.812ms
           %3422 = :nvte_quantize_v2 [] -> 244.480us
             %3423 = :quantize_transpose_vector_blockwise [] -> 244.480us
                 -->kernel: 0:7 %2714 =  [] -> 244.480us
           %3424 = :nvte_cublas_gemm_scaled [] -> 1.119ms
                 -->kernel: 0:7 %2715 =  [] -> 1.110ms
           %3425 = :nvte_cublas_gemm_scaled [] -> 1.122ms
                 -->kernel: 0:7 %2716 =  [] -> 1.116ms
           %3426 = :nvte_rmsnorm_bwd [] -> 55.968us
                 -->kernel: 0:7 %2717 =  [] -> 23.264us
                 -->kernel: 0:7 %2718 =  [] -> 20.800us
     %3427 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.984us
       %3428 = :aten::add_ [[1536], [1536], []] -> 1.984us
                 -->kernel: 0:35 %2719 =  [] -> 1.984us
     %3429 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.016us
       %3430 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.016us
         %3431 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.016us
                 -->kernel: 0:7 %2720 =  [] -> 10.016us
     %3432 = :autograd::engine::evaluate_function: _LinearBackward None -> 434.849us
       %3433 = :_LinearBackward [[4096, 1, 576]] -> 434.849us
         %3434 = :_Linear_backward [] -> 434.849us
           %3435 = :nvte_quantize_v2 [] -> 14.272us
             %3436 = :quantize_transpose_vector_blockwise [] -> 14.272us
                 -->kernel: 0:7 %2721 =  [] -> 14.272us
           %3437 = :nvte_cublas_gemm_scaled [] -> 148.097us
                 -->kernel: 0:7 %2722 =  [] -> 141.569us
           %3438 = :nvte_cublas_gemm_scaled [] -> 138.912us
                 -->kernel: 0:7 %2723 =  [] -> 133.152us
     %3439 = :autograd::engine::evaluate_function: _LinearBackward None -> 986.755us
       %3440 = :_LinearBackward [[4096, 1, 1536]] -> 822.786us
         %3441 = :_Linear_backward [] -> 822.786us
           %3442 = :nvte_quantize_v2 [] -> 18.560us
             %3443 = :quantize_transpose_vector_blockwise [] -> 18.560us
                 -->kernel: 0:7 %2724 =  [] -> 18.560us
           %3444 = :nvte_cublas_gemm_scaled [] -> 335.392us
                 -->kernel: 0:7 %2725 =  [] -> 329.312us
           %3445 = :nvte_cublas_gemm_scaled [] -> 343.104us
                 -->kernel: 0:7 %2726 =  [] -> 337.984us
       %3446 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.176us
                 -->kernel: 0:7 %2727 =  [] -> 50.176us
     %3447 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 324.897us
       %3448 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 196.001us
         %3449 = :nvte_rmsnorm_bwd [] -> 196.001us
                 -->kernel: 0:7 %2728 =  [] -> 165.536us
                 -->kernel: 0:7 %2729 =  [] -> 7.904us
       %3450 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.856us
                 -->kernel: 0:7 %2730 =  [] -> 49.856us
     %3451 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %3452 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %2731 =  [] -> 1.600us
     %3453 = :autograd::engine::evaluate_function: _LinearBackward None -> 6.226ms
       %3454 = :_LinearBackward [[4096, 1, 7168]] -> 6.226ms
         %3455 = :_Linear_backward [] -> 6.226ms
           %3456 = :nvte_quantize_v2 [] -> 74.337us
             %3457 = :quantize_transpose_vector_blockwise [] -> 74.337us
                 -->kernel: 0:7 %2732 =  [] -> 74.337us
           %3458 = :nvte_cublas_gemm_scaled [] -> 2.998ms
                 -->kernel: 0:7 %2733 =  [] -> 2.992ms
           %3459 = :nvte_cublas_gemm_scaled [] -> 3.010ms
                 -->kernel: 0:7 %2734 =  [] -> 3.004ms
     %3460 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 387.873us
       %3461 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 387.873us
         %3462 = :aten::contiguous [[4096, 1, 7168], []] -> 114.688us
           %3463 = :aten::clone [[4096, 1, 7168], []] -> 114.688us
             %3464 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 114.688us
                 -->kernel: 0:7 %2735 =  [] -> 114.688us
         %3465 = :nvte_rmsnorm_bwd [] -> 190.112us
                 -->kernel: 0:7 %2736 =  [] -> 166.496us
                 -->kernel: 0:7 %2737 =  [] -> 7.680us
     %3466 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.792us
       %3467 = :aten::add_ [[7168], [7168], []] -> 1.792us
                 -->kernel: 0:35 %2738 =  [] -> 1.792us
     %3468 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 375.232us
       %3469 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 375.232us
         %3470 = :aten::contiguous [[4096, 1, 7168], []] -> 115.968us
           %3471 = :aten::clone [[4096, 1, 7168], []] -> 115.968us
             %3472 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 115.968us
                 -->kernel: 0:7 %2739 =  [] -> 115.968us
         %3473 = :nvte_rmsnorm_bwd [] -> 189.248us
                 -->kernel: 0:7 %2740 =  [] -> 165.856us
                 -->kernel: 0:7 %2741 =  [] -> 7.744us
     %3474 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.760us
       %3475 = :aten::add_ [[7168], [7168], []] -> 1.760us
                 -->kernel: 0:35 %2742 =  [] -> 1.760us
     %3476 = :autograd::engine::evaluate_function: MakeViewlessTensorBackward None -> 50.816us
       %3477 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.816us
                 -->kernel: 0:7 %2743 =  [] -> 50.816us
     %3478 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 1.436ms
       %3479 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.436ms
         %3480 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.436ms
           %3481 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.436ms
             %3482 = :aten::arange [[], [], [], [], []] -> 1.184us
               %3483 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %2744 =  [] -> 1.184us
             %3484 = CCCL:cub::DeviceRadixSort [] -> 189.313us
                 -->kernel: 0:7 %2745 =  [] -> 3.552us
                 -->kernel: 0:7 %2746 =  [] -> 1.536us
                 -->kernel: 0:7 %2747 =  [] -> 7.776us
                 -->kernel: 0:7 %2748 =  [] -> 7.488us
                 -->kernel: 0:7 %2749 =  [] -> 7.072us
                 -->kernel: 0:7 %2750 =  [] -> 7.008us
                 -->kernel: 0:7 %2751 =  [] -> 7.104us
                 -->kernel: 0:7 %2752 =  [] -> 7.008us
                 -->kernel: 0:7 %2753 =  [] -> 6.912us
                 -->kernel: 0:7 %2754 =  [] -> 6.816us
             %3485 = :aten::zeros [[], [], [], [], []] -> 544.705us
               %3486 = :aten::zero_ [[129280, 7168]] -> 544.705us
                 %3487 = :aten::fill_ [[129280, 7168], []] -> 544.705us
                 -->kernel: 0:7 %2755 =  [] -> 544.705us
             %3488 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 17.408us
                 -->kernel: 0:7 %2756 =  [] -> 1.440us
                 -->kernel: 0:7 %2757 =  [] -> 4.064us
                 -->kernel: 0:7 %2758 =  [] -> 1.760us
             %3489 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 19.232us
                 -->kernel: 0:7 %2759 =  [] -> 1.440us
                 -->kernel: 0:7 %2760 =  [] -> 2.912us
                 -->kernel: 0:7 %2761 =  [] -> 1.312us
                 -->kernel: 0:7 %2762 =  [] -> 1.792us
                 -->kernel: 0:7 %2763 =  [] -> 244.064us
                 -->kernel: 0:7 %2764 =  [] -> 199.969us
     %3490 = :autograd::engine::evaluate_function: SplitBackward0 None -> 34.112us
       %3491 = :SplitBackward0 [[4096, 1, 7168]] -> 34.112us
         %3492 = :aten::cat [[4096, 1, 7168], []] -> 34.112us
     %3493 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 193.825us
       %3494 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 193.825us
         %3495 = :nvte_rmsnorm_bwd [] -> 193.825us
                 -->kernel: 0:7 %2765 =  [] -> 166.561us
                 -->kernel: 0:7 %2766 =  [] -> 7.808us
     %3496 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %3497 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %2767 =  [] -> 1.568us
     %3498 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 852.161us
       %3499 = :FusedCombineBackward [[4096, 7168], []] -> 852.161us
                 -->kernel: 0:26 %2768 =  [] -> 7.936us
                 -->kernel: 0:26 %2769 =  [] -> 793.249us
     %3500 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 200.993us
       %3501 = :_moe_unpermute_mask_mapBackward [[15753, 7168]] -> 200.993us
                 -->kernel: 0:7 %2770 =  [] -> 200.993us
     %3502 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.560ms
       %3503 = :_GroupedLinearBackward [[32928, 7168]] -> 8.560ms
         %3504 = :_GroupedLinear_backward [] -> 8.560ms
           %3505 = :nvte_quantize_v2 [] -> 221.185us
             %3506 = :quantize_transpose_vector_blockwise [] -> 221.185us
                 -->kernel: 0:7 %2771 =  [] -> 221.185us
           %3507 = :nvte_quantize_v2 [] -> 220.672us
             %3508 = :quantize_transpose_vector_blockwise [] -> 220.672us
                 -->kernel: 0:7 %2772 =  [] -> 220.672us
           %3509 = :nvte_quantize_v2 [] -> 222.753us
             %3510 = :quantize_transpose_vector_blockwise [] -> 222.753us
                 -->kernel: 0:7 %2773 =  [] -> 222.753us
           %3511 = :nvte_quantize_v2 [] -> 221.920us
             %3512 = :quantize_transpose_vector_blockwise [] -> 221.920us
                 -->kernel: 0:7 %2774 =  [] -> 221.920us
           %3513 = :nvte_multi_stream_cublas_gemm [] -> 3.709ms
             %3514 = :nvte_cublas_gemm [] -> 916.386us
                 -->kernel: 0:159 %2775 =  [] -> 906.274us
             %3515 = :nvte_cublas_gemm [] -> 910.274us
                 -->kernel: 0:160 %2776 =  [] -> 905.314us
             %3516 = :nvte_cublas_gemm [] -> 910.722us
                 -->kernel: 0:161 %2777 =  [] -> 906.658us
             %3517 = :nvte_cublas_gemm [] -> 911.554us
                 -->kernel: 0:162 %2778 =  [] -> 906.658us
           %3518 = :nvte_multi_stream_cublas_gemm [] -> 3.668ms
             %3519 = :nvte_cublas_gemm [] -> 897.762us
                 -->kernel: 0:159 %2779 =  [] -> 890.146us
             %3520 = :nvte_cublas_gemm [] -> 898.306us
                 -->kernel: 0:160 %2780 =  [] -> 889.378us
             %3521 = :nvte_cublas_gemm [] -> 905.955us
                 -->kernel: 0:161 %2781 =  [] -> 902.787us
             %3522 = :nvte_cublas_gemm [] -> 907.778us
                 -->kernel: 0:162 %2782 =  [] -> 903.362us
     %3523 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 590.977us
       %3524 = :WeightedSwiGLUFunctionBackward [[32928, 2048]] -> 590.977us
         %3525 = :Torch-Compiled Region: 4/1 None -> 590.977us
           %3526 = :triton_poi_fused__to_copy_cat_0 [[32928, 2048], [32928, 1], [32928, 4096], [32928, 4096], [], []] -> 403.201us
                 -->kernel: 0:7 %2783 =  [] -> 403.201us
           %3527 = :triton_red_fused__to_copy_mul_silu_sum_1 [[32928, 4096], [32928, 2048], [32928, 1], [], [], [], []] -> 130.560us
                 -->kernel: 0:7 %2784 =  [] -> 130.560us
     %3528 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.742ms
       %3529 = :_GroupedLinearBackward [[32928, 4096]] -> 14.742ms
         %3530 = :_GroupedLinear_backward [] -> 14.742ms
           %3531 = :nvte_quantize_v2 [] -> 126.240us
             %3532 = :quantize_transpose_vector_blockwise [] -> 126.240us
                 -->kernel: 0:7 %2785 =  [] -> 126.240us
           %3533 = :nvte_quantize_v2 [] -> 130.144us
             %3534 = :quantize_transpose_vector_blockwise [] -> 130.144us
                 -->kernel: 0:7 %2786 =  [] -> 130.144us
           %3535 = :nvte_quantize_v2 [] -> 131.680us
             %3536 = :quantize_transpose_vector_blockwise [] -> 131.680us
                 -->kernel: 0:7 %2787 =  [] -> 131.680us
           %3537 = :nvte_quantize_v2 [] -> 131.808us
             %3538 = :quantize_transpose_vector_blockwise [] -> 131.808us
                 -->kernel: 0:7 %2788 =  [] -> 131.808us
           %3539 = :nvte_multi_stream_cublas_gemm [] -> 7.001ms
             %3540 = :nvte_cublas_gemm [] -> 1.723ms
                 -->kernel: 0:159 %2789 =  [] -> 1.715ms
             %3541 = :nvte_cublas_gemm [] -> 1.718ms
                 -->kernel: 0:160 %2790 =  [] -> 1.713ms
             %3542 = :nvte_cublas_gemm [] -> 1.747ms
                 -->kernel: 0:161 %2791 =  [] -> 1.743ms
             %3543 = :nvte_cublas_gemm [] -> 1.747ms
                 -->kernel: 0:162 %2792 =  [] -> 1.744ms
           %3544 = :nvte_multi_stream_cublas_gemm [] -> 6.956ms
             %3545 = :nvte_cublas_gemm [] -> 1.713ms
                 -->kernel: 0:159 %2793 =  [] -> 1.707ms
             %3546 = :nvte_cublas_gemm [] -> 1.712ms
                 -->kernel: 0:160 %2794 =  [] -> 1.707ms
             %3547 = :nvte_cublas_gemm [] -> 1.735ms
                 -->kernel: 0:161 %2795 =  [] -> 1.730ms
             %3548 = :nvte_cublas_gemm [] -> 1.733ms
                 -->kernel: 0:162 %2796 =  [] -> 1.730ms
     %3549 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 386.848us
       %3550 = :_moe_permute_mask_mapBackward [[32928, 7168], [], [32928]] -> 386.848us
         %3551 = :aten::zeros [[], [], [], [], []] -> 1.248us
           %3552 = :aten::zero_ [[15753, 9]] -> 1.248us
             %3553 = :aten::fill_ [[15753, 9], []] -> 1.248us
                 -->kernel: 0:7 %2797 =  [] -> 1.248us
                 -->kernel: 0:7 %2798 =  [] -> 213.088us
     %3554 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 95.904us
       %3555 = :IndicesToMultihotBackward [[], [15753, 4]] -> 95.904us
         %3556 = :aten::zeros [[], [], [], [], []] -> 1.440us
           %3557 = :aten::zero_ [[15753, 4]] -> 1.440us
             %3558 = :aten::fill_ [[15753, 4], []] -> 1.440us
                 -->kernel: 0:7 %2799 =  [] -> 1.440us
                 -->kernel: 0:7 %2800 =  [] -> 11.520us
     %3559 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.159ms
       %3560 = :_LinearBackward [[4096, 1, 7168]] -> 1.159ms
         %3561 = :_Linear_backward [] -> 1.159ms
           %3562 = :nvte_quantize_v2 [] -> 73.216us
             %3563 = :quantize_transpose_vector_blockwise [] -> 73.216us
                 -->kernel: 0:7 %2801 =  [] -> 73.216us
           %3564 = :nvte_cublas_gemm_scaled [] -> 467.393us
                 -->kernel: 0:7 %2802 =  [] -> 459.041us
           %3565 = :nvte_cublas_gemm_scaled [] -> 454.721us
                 -->kernel: 0:7 %2803 =  [] -> 449.569us
     %3566 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 46.912us
       %3567 = :SwiGLUFunctionBackward [[4096, 2048]] -> 46.912us
         %3568 = :Torch-Compiled Region: 5/0 None -> 46.912us
           %3569 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 46.912us
                 -->kernel: 0:7 %2804 =  [] -> 46.912us
     %3570 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.004ms
       %3571 = :_LinearBackward [[4096, 1, 4096]] -> 2.004ms
         %3572 = :_Linear_backward [] -> 2.004ms
           %3573 = :nvte_quantize_v2 [] -> 44.256us
             %3574 = :quantize_transpose_vector_blockwise [] -> 44.256us
                 -->kernel: 0:7 %2805 =  [] -> 44.256us
           %3575 = :nvte_quantize_v2 [] -> 52.960us
             %3576 = :quantize_transpose_vector_blockwise [] -> 52.960us
                 -->kernel: 0:7 %2806 =  [] -> 52.960us
           %3577 = :nvte_cublas_gemm_scaled [] -> 863.746us
                 -->kernel: 0:7 %2807 =  [] -> 858.401us
           %3578 = :nvte_cublas_gemm_scaled [] -> 863.970us
                 -->kernel: 0:7 %2808 =  [] -> 859.362us
     %3579 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 853.794us
       %3580 = :FusedDispatchBackward [[15753, 7168], [], [15753, 8], [], []] -> 853.794us
         %3581 = :aten::zeros [[], [], [], [], []] -> 1.440us
           %3582 = :aten::zero_ [[15753, 8]] -> 1.440us
             %3583 = :aten::fill_ [[15753, 8], []] -> 1.440us
                 -->kernel: 0:7 %2809 =  [] -> 1.440us
                 -->kernel: 0:26 %2810 =  [] -> 13.792us
                 -->kernel: 0:26 %2811 =  [] -> 672.674us
     %3584 = :autograd::engine::evaluate_function: TopkBackward0 None -> 58.688us
       %3585 = :TopkBackward0 [[4096, 8]] -> 58.688us
         %3586 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 58.688us
           %3587 = :aten::zeros [[], [], [], [], []] -> 1.056us
             %3588 = :aten::zero_ [[4096, 32]] -> 1.056us
               %3589 = :aten::fill_ [[4096, 32], []] -> 1.056us
                 -->kernel: 0:7 %2812 =  [] -> 1.056us
           %3590 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 8.896us
                 -->kernel: 0:7 %2813 =  [] -> 8.896us
     %3591 = :autograd::engine::evaluate_function: ViewBackward0 None -> 53.024us
       %3592 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 53.024us
                 -->kernel: 0:7 %2814 =  [] -> 53.024us
     %3593 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 87.680us
       %3594 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 35.712us
         %3595 = :aten::ones_like [[], [], [], [], [], []] -> 1.248us
           %3596 = :aten::fill_ [[], []] -> 1.248us
                 -->kernel: 0:7 %2815 =  [] -> 1.248us
         %3597 = :aten::mul [[], [1]] -> 1.696us
                 -->kernel: 0:7 %2816 =  [] -> 1.696us
       %3598 = :aten::sum [[1], []] -> 2.592us
         %3599 = :aten::sum [[1], [], [], []] -> 2.592us
                 -->kernel: 0:7 %2817 =  [] -> 2.592us
     %3600 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.312us
       %3601 = :DivBackward0 [[]] -> 1.312us
         %3602 = :aten::div [[], []] -> 1.312us
                 -->kernel: 0:7 %2818 =  [] -> 1.312us
     %3603 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.176us
       %3604 = :FusedAuxLossBackward [[]] -> 2.176us
         %3605 = :nvte_fused_moe_aux_loss_backward [] -> 2.176us
                 -->kernel: 0:7 %2819 =  [] -> 2.176us
     %3606 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 62.753us
       %3607 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 62.753us
         %3608 = :aten::zeros [[], [], [], [], []] -> 1.216us
           %3609 = :aten::zero_ [[4096, 32]] -> 1.216us
             %3610 = :aten::fill_ [[4096, 32], []] -> 1.216us
                 -->kernel: 0:7 %2820 =  [] -> 1.216us
         %3611 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.896us
                 -->kernel: 0:7 %2821 =  [] -> 12.896us
     %3612 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 98.400us
       %3613 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 56.704us
         %3614 = :aten::zeros [[], [], [], [], []] -> 1.248us
           %3615 = :aten::zero_ [[4096, 32]] -> 1.248us
             %3616 = :aten::fill_ [[4096, 32], []] -> 1.248us
                 -->kernel: 0:7 %2822 =  [] -> 1.248us
         %3617 = :nvte_fused_topk_with_score_function_backward [] -> 13.696us
                 -->kernel: 0:7 %2823 =  [] -> 13.696us
       %3618 = :aten::add [[4096, 32], [4096, 32], []] -> 1.696us
                 -->kernel: 0:7 %2824 =  [] -> 1.696us
     %3619 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 799.906us
       %3620 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 705.442us
         %3621 = :aten::to [[32, 7168], [], [], [], []] -> 6.496us
           %3622 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.496us
             %3623 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.496us
                 -->kernel: 0:7 %2825 =  [] -> 6.496us
         %3624 = :nvte_cublas_gemm_scaled [] -> 83.809us
                 -->kernel: 0:7 %2826 =  [] -> 67.904us
         %3625 = :aten::to [[4096, 7168], [], [], [], []] -> 177.248us
           %3626 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 177.248us
             %3627 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 177.248us
                 -->kernel: 0:7 %2827 =  [] -> 177.248us
         %3628 = :nvte_cublas_gemm_scaled [] -> 82.881us
                 -->kernel: 0:7 %2828 =  [] -> 82.881us
         %3629 = :aten::to [[4096, 7168], [], [], [], []] -> 43.552us
           %3630 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.552us
             %3631 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.552us
                 -->kernel: 0:7 %2829 =  [] -> 43.552us
         %3632 = :aten::to [[32, 7168], [], [], [], []] -> 2.304us
           %3633 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.304us
             %3634 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.304us
                 -->kernel: 0:7 %2830 =  [] -> 2.304us
       %3635 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.664us
                 -->kernel: 0:7 %2831 =  [] -> 49.664us
     %3636 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.080us
       %3637 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.080us
                 -->kernel: 0:35 %2832 =  [] -> 2.080us
     %3638 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 327.264us
       %3639 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 197.696us
         %3640 = :nvte_rmsnorm_bwd [] -> 197.696us
                 -->kernel: 0:7 %2833 =  [] -> 167.296us
                 -->kernel: 0:7 %2834 =  [] -> 7.808us
       %3641 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.784us
                 -->kernel: 0:7 %2835 =  [] -> 50.784us
     %3642 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %3643 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %2836 =  [] -> 1.568us
     %3644 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.252ms
       %3645 = :_LinearBackward [[4096, 1, 7168]] -> 7.252ms
         %3646 = :_Linear_backward [] -> 7.252ms
           %3647 = :nvte_quantize_v2 [] -> 73.024us
             %3648 = :quantize_transpose_vector_blockwise [] -> 73.024us
                 -->kernel: 0:7 %2837 =  [] -> 73.024us
           %3649 = :nvte_quantize_v2 [] -> 111.008us
             %3650 = :quantize_transpose_vector_blockwise [] -> 111.008us
                 -->kernel: 0:7 %2838 =  [] -> 111.008us
           %3651 = :nvte_cublas_gemm_scaled [] -> 3.432ms
                 -->kernel: 0:7 %2839 =  [] -> 3.427ms
           %3652 = :nvte_cublas_gemm_scaled [] -> 3.434ms
                 -->kernel: 0:7 %2840 =  [] -> 3.427ms
     %3653 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.904ms
       %3654 = :BmmBackward0 [[128, 4096, 128]] -> 7.904ms
         %3655 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.978ms
                 -->kernel: 0:7 %2841 =  [] -> 3.967ms
         %3656 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.872ms
                 -->kernel: 0:7 %2842 =  [] -> 3.864ms
     %3657 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 7.014ms
       %3658 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 7.014ms
         %3659 = :nvte_scaled_softmax_backward [] -> 7.014ms
                 -->kernel: 0:7 %2843 =  [] -> 7.014ms
     %3660 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.210ms
       %3661 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.210ms
         %3662 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.937ms
                 -->kernel: 0:7 %2844 =  [] -> 5.926ms
         %3663 = :aten::mul [[128, 4096, 192], []] -> 115.008us
           %3664 = :aten::mul [[128, 4096, 192], []] -> 115.008us
                 -->kernel: 0:7 %2845 =  [] -> 115.008us
         %3665 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.867ms
                 -->kernel: 0:7 %2846 =  [] -> 5.861ms
         %3666 = :aten::mul [[128, 192, 4096], []] -> 115.457us
           %3667 = :aten::mul [[128, 192, 4096], []] -> 115.457us
                 -->kernel: 0:7 %2847 =  [] -> 115.457us
     %3668 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.467ms
       %3669 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.467ms
         %3670 = :aten::contiguous [[4096, 1, 128, 192], []] -> 744.802us
           %3671 = :aten::clone [[4096, 1, 128, 192], []] -> 744.802us
             %3672 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 744.802us
                 -->kernel: 0:7 %2848 =  [] -> 744.802us
         %3673 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.705us
           %3674 = :aten::clone [[4096, 1, 128, 128], []] -> 280.705us
             %3675 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.705us
                 -->kernel: 0:7 %2849 =  [] -> 280.705us
                 -->kernel: 0:7 %2850 =  [] -> 173.249us
     %3676 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 637.729us
       %3677 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 637.729us
         %3678 = :aten::contiguous [[4096, 1, 128, 192], []] -> 423.201us
           %3679 = :aten::clone [[4096, 1, 128, 192], []] -> 423.201us
             %3680 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 423.201us
                 -->kernel: 0:7 %2851 =  [] -> 423.201us
                 -->kernel: 0:7 %2852 =  [] -> 118.624us
     %3681 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.737ms
       %3682 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.737ms
         %3683 = :_LayerNormLinear_backward [] -> 1.737ms
           %3684 = :nvte_quantize_v2 [] -> 324.001us
             %3685 = :quantize_transpose_vector_blockwise [] -> 324.001us
                 -->kernel: 0:7 %2853 =  [] -> 324.001us
           %3686 = :nvte_cublas_gemm_scaled [] -> 570.593us
                 -->kernel: 0:7 %2854 =  [] -> 519.489us
                 -->kernel: 0:7 %2855 =  [] -> 19.264us
           %3687 = :nvte_cublas_gemm_scaled [] -> 527.233us
                 -->kernel: 0:7 %2856 =  [] -> 521.889us
           %3688 = :nvte_rmsnorm_bwd [] -> 20.928us
                 -->kernel: 0:7 %2857 =  [] -> 6.176us
                 -->kernel: 0:7 %2858 =  [] -> 3.200us
     %3689 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.984us
       %3690 = :aten::add_ [[512], [512], []] -> 1.984us
                 -->kernel: 0:35 %2859 =  [] -> 1.984us
     %3691 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.778ms
       %3692 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.778ms
         %3693 = :_LayerNormLinear_backward [] -> 2.778ms
           %3694 = :nvte_quantize_v2 [] -> 243.776us
             %3695 = :quantize_transpose_vector_blockwise [] -> 243.776us
                 -->kernel: 0:7 %2860 =  [] -> 243.776us
           %3696 = :nvte_cublas_gemm_scaled [] -> 1.117ms
                 -->kernel: 0:7 %2861 =  [] -> 1.109ms
           %3697 = :nvte_cublas_gemm_scaled [] -> 1.121ms
                 -->kernel: 0:7 %2862 =  [] -> 1.115ms
           %3698 = :nvte_rmsnorm_bwd [] -> 55.520us
                 -->kernel: 0:7 %2863 =  [] -> 23.008us
                 -->kernel: 0:7 %2864 =  [] -> 20.416us
     %3699 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.888us
       %3700 = :aten::add_ [[1536], [1536], []] -> 1.888us
                 -->kernel: 0:35 %2865 =  [] -> 1.888us
     %3701 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 9.952us
       %3702 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 9.952us
         %3703 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 9.952us
                 -->kernel: 0:7 %2866 =  [] -> 9.952us
     %3704 = :autograd::engine::evaluate_function: _LinearBackward None -> 435.649us
       %3705 = :_LinearBackward [[4096, 1, 576]] -> 435.649us
         %3706 = :_Linear_backward [] -> 435.649us
           %3707 = :nvte_quantize_v2 [] -> 14.464us
             %3708 = :quantize_transpose_vector_blockwise [] -> 14.464us
                 -->kernel: 0:7 %2867 =  [] -> 14.464us
           %3709 = :nvte_cublas_gemm_scaled [] -> 148.224us
                 -->kernel: 0:7 %2868 =  [] -> 141.504us
           %3710 = :nvte_cublas_gemm_scaled [] -> 138.913us
                 -->kernel: 0:7 %2869 =  [] -> 133.089us
     %3711 = :autograd::engine::evaluate_function: _LinearBackward None -> 983.107us
       %3712 = :_LinearBackward [[4096, 1, 1536]] -> 823.362us
         %3713 = :_Linear_backward [] -> 823.362us
           %3714 = :nvte_quantize_v2 [] -> 18.848us
             %3715 = :quantize_transpose_vector_blockwise [] -> 18.848us
                 -->kernel: 0:7 %2870 =  [] -> 18.848us
           %3716 = :nvte_cublas_gemm_scaled [] -> 335.584us
                 -->kernel: 0:7 %2871 =  [] -> 329.472us
           %3717 = :nvte_cublas_gemm_scaled [] -> 342.369us
                 -->kernel: 0:7 %2872 =  [] -> 337.857us
       %3718 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.633us
                 -->kernel: 0:7 %2873 =  [] -> 49.633us
     %3719 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 317.121us
       %3720 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 194.496us
         %3721 = :nvte_rmsnorm_bwd [] -> 194.496us
                 -->kernel: 0:7 %2874 =  [] -> 166.208us
                 -->kernel: 0:7 %2875 =  [] -> 7.776us
       %3722 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.184us
                 -->kernel: 0:7 %2876 =  [] -> 49.184us
     %3723 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.632us
       %3724 = :aten::add_ [[7168], [7168], []] -> 1.632us
                 -->kernel: 0:35 %2877 =  [] -> 1.632us
     %3725 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.961ms
       %3726 = :_LinearBackward [[4096, 1, 7168]] -> 7.961ms
         %3727 = :_Linear_backward [] -> 7.961ms
           %3728 = :nvte_quantize_v2 [] -> 74.561us
             %3729 = :quantize_transpose_vector_blockwise [] -> 74.561us
                 -->kernel: 0:7 %2878 =  [] -> 74.561us
           %3730 = :nvte_cublas_gemm_scaled [] -> 3.881ms
                 -->kernel: 0:7 %2879 =  [] -> 3.874ms
           %3731 = :nvte_cublas_gemm_scaled [] -> 3.861ms
                 -->kernel: 0:7 %2880 =  [] -> 3.855ms
     %3732 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 844.769us
       %3733 = :SwiGLUFunctionBackward [[4096, 18432]] -> 844.769us
         %3734 = :Torch-Compiled Region: 5/1 None -> 844.769us
           %3735 = :triton_poi_fused_cat_0 [[4096, 18432], [4096, 36864], [4096, 36864], [], [], [], [], []] -> 844.769us
                 -->kernel: 0:7 %2881 =  [] -> 844.769us
     %3736 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 16.395ms
       %3737 = :_LayerNormLinearBackward [[4096, 1, 36864]] -> 16.226ms
         %3738 = :_LayerNormLinear_backward [] -> 16.226ms
           %3739 = :nvte_quantize_v2 [] -> 360.513us
             %3740 = :quantize_transpose_vector_blockwise [] -> 360.513us
                 -->kernel: 0:7 %2882 =  [] -> 360.513us
           %3741 = :nvte_cublas_gemm_scaled [] -> 7.637ms
                 -->kernel: 0:7 %2883 =  [] -> 7.629ms
           %3742 = :nvte_cublas_gemm_scaled [] -> 7.696ms
                 -->kernel: 0:7 %2884 =  [] -> 7.687ms
           %3743 = :nvte_rmsnorm_bwd [] -> 195.008us
                 -->kernel: 0:7 %2885 =  [] -> 162.560us
                 -->kernel: 0:7 %2886 =  [] -> 7.968us
       %3744 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 48.960us
                 -->kernel: 0:7 %2887 =  [] -> 48.960us
     %3745 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %3746 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %2888 =  [] -> 1.600us
     %3747 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.274ms
       %3748 = :_LinearBackward [[4096, 1, 7168]] -> 7.274ms
         %3749 = :_Linear_backward [] -> 7.274ms
           %3750 = :nvte_quantize_v2 [] -> 73.696us
             %3751 = :quantize_transpose_vector_blockwise [] -> 73.696us
                 -->kernel: 0:7 %2889 =  [] -> 73.696us
           %3752 = :nvte_quantize_v2 [] -> 110.081us
             %3753 = :quantize_transpose_vector_blockwise [] -> 110.081us
                 -->kernel: 0:7 %2890 =  [] -> 110.081us
           %3754 = :nvte_cublas_gemm_scaled [] -> 3.436ms
                 -->kernel: 0:7 %2891 =  [] -> 3.429ms
           %3755 = :nvte_cublas_gemm_scaled [] -> 3.430ms
                 -->kernel: 0:7 %2892 =  [] -> 3.423ms
     %3756 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.905ms
       %3757 = :BmmBackward0 [[128, 4096, 128]] -> 7.905ms
         %3758 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.978ms
                 -->kernel: 0:7 %2893 =  [] -> 3.965ms
         %3759 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.873ms
                 -->kernel: 0:7 %2894 =  [] -> 3.865ms
     %3760 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.965ms
       %3761 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.965ms
         %3762 = :nvte_scaled_softmax_backward [] -> 6.965ms
                 -->kernel: 0:7 %2895 =  [] -> 6.965ms
     %3763 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.190ms
       %3764 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.190ms
         %3765 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.937ms
                 -->kernel: 0:7 %2896 =  [] -> 5.925ms
         %3766 = :aten::mul [[128, 4096, 192], []] -> 115.168us
           %3767 = :aten::mul [[128, 4096, 192], []] -> 115.168us
                 -->kernel: 0:7 %2897 =  [] -> 115.168us
         %3768 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.866ms
                 -->kernel: 0:7 %2898 =  [] -> 5.860ms
         %3769 = :aten::mul [[128, 192, 4096], []] -> 116.160us
           %3770 = :aten::mul [[128, 192, 4096], []] -> 116.160us
                 -->kernel: 0:7 %2899 =  [] -> 116.160us
     %3771 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.480ms
       %3772 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.480ms
         %3773 = :aten::contiguous [[4096, 1, 128, 192], []] -> 743.394us
           %3774 = :aten::clone [[4096, 1, 128, 192], []] -> 743.394us
             %3775 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 743.394us
                 -->kernel: 0:7 %2900 =  [] -> 743.394us
         %3776 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.513us
           %3777 = :aten::clone [[4096, 1, 128, 128], []] -> 280.513us
             %3778 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.513us
                 -->kernel: 0:7 %2901 =  [] -> 280.513us
                 -->kernel: 0:7 %2902 =  [] -> 171.969us
     %3779 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 643.777us
       %3780 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 643.777us
         %3781 = :aten::contiguous [[4096, 1, 128, 192], []] -> 423.361us
           %3782 = :aten::clone [[4096, 1, 128, 192], []] -> 423.361us
             %3783 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 423.361us
                 -->kernel: 0:7 %2903 =  [] -> 423.361us
                 -->kernel: 0:7 %2904 =  [] -> 118.784us
     %3784 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.731ms
       %3785 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.731ms
         %3786 = :_LayerNormLinear_backward [] -> 1.731ms
           %3787 = :nvte_quantize_v2 [] -> 322.977us
             %3788 = :quantize_transpose_vector_blockwise [] -> 322.977us
                 -->kernel: 0:7 %2905 =  [] -> 322.977us
           %3789 = :nvte_cublas_gemm_scaled [] -> 567.073us
                 -->kernel: 0:7 %2906 =  [] -> 519.105us
                 -->kernel: 0:7 %2907 =  [] -> 19.136us
           %3790 = :nvte_cublas_gemm_scaled [] -> 528.098us
                 -->kernel: 0:7 %2908 =  [] -> 522.402us
           %3791 = :nvte_rmsnorm_bwd [] -> 20.992us
                 -->kernel: 0:7 %2909 =  [] -> 6.720us
                 -->kernel: 0:7 %2910 =  [] -> 3.200us
     %3792 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.144us
       %3793 = :aten::add_ [[512], [512], []] -> 2.144us
                 -->kernel: 0:35 %2911 =  [] -> 2.144us
     %3794 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.791ms
       %3795 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.791ms
         %3796 = :_LayerNormLinear_backward [] -> 2.791ms
           %3797 = :nvte_quantize_v2 [] -> 243.232us
             %3798 = :quantize_transpose_vector_blockwise [] -> 243.232us
                 -->kernel: 0:7 %2912 =  [] -> 243.232us
           %3799 = :nvte_cublas_gemm_scaled [] -> 1.117ms
                 -->kernel: 0:7 %2913 =  [] -> 1.109ms
           %3800 = :nvte_cublas_gemm_scaled [] -> 1.120ms
                 -->kernel: 0:7 %2914 =  [] -> 1.115ms
           %3801 = :nvte_rmsnorm_bwd [] -> 55.264us
                 -->kernel: 0:7 %2915 =  [] -> 23.328us
                 -->kernel: 0:7 %2916 =  [] -> 20.384us
     %3802 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.176us
       %3803 = :aten::add_ [[1536], [1536], []] -> 2.176us
                 -->kernel: 0:35 %2917 =  [] -> 2.176us
     %3804 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.016us
       %3805 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.016us
         %3806 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.016us
                 -->kernel: 0:7 %2918 =  [] -> 10.016us
     %3807 = :autograd::engine::evaluate_function: _LinearBackward None -> 432.577us
       %3808 = :_LinearBackward [[4096, 1, 576]] -> 432.577us
         %3809 = :_Linear_backward [] -> 432.577us
           %3810 = :nvte_quantize_v2 [] -> 14.400us
             %3811 = :quantize_transpose_vector_blockwise [] -> 14.400us
                 -->kernel: 0:7 %2919 =  [] -> 14.400us
           %3812 = :nvte_cublas_gemm_scaled [] -> 148.609us
                 -->kernel: 0:7 %2920 =  [] -> 141.281us
           %3813 = :nvte_cublas_gemm_scaled [] -> 139.104us
                 -->kernel: 0:7 %2921 =  [] -> 133.696us
     %3814 = :autograd::engine::evaluate_function: _LinearBackward None -> 986.531us
       %3815 = :_LinearBackward [[4096, 1, 1536]] -> 824.162us
         %3816 = :_Linear_backward [] -> 824.162us
           %3817 = :nvte_quantize_v2 [] -> 18.433us
             %3818 = :quantize_transpose_vector_blockwise [] -> 18.433us
                 -->kernel: 0:7 %2922 =  [] -> 18.433us
           %3819 = :nvte_cublas_gemm_scaled [] -> 335.552us
                 -->kernel: 0:7 %2923 =  [] -> 329.312us
           %3820 = :nvte_cublas_gemm_scaled [] -> 342.336us
                 -->kernel: 0:7 %2924 =  [] -> 337.888us
       %3821 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.824us
                 -->kernel: 0:7 %2925 =  [] -> 49.824us
     %3822 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 320.865us
       %3823 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 195.649us
         %3824 = :nvte_rmsnorm_bwd [] -> 195.649us
                 -->kernel: 0:7 %2926 =  [] -> 165.601us
                 -->kernel: 0:7 %2927 =  [] -> 7.904us
       %3825 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.248us
                 -->kernel: 0:7 %2928 =  [] -> 49.248us
     %3826 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.632us
       %3827 = :aten::add_ [[7168], [7168], []] -> 1.632us
                 -->kernel: 0:35 %2929 =  [] -> 1.632us
     %3828 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 3.051ms
       %3829 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.446ms
         %3830 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.446ms
           %3831 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.446ms
             %3832 = :aten::arange [[], [], [], [], []] -> 1.152us
               %3833 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %2930 =  [] -> 1.152us
             %3834 = CCCL:cub::DeviceRadixSort [] -> 189.249us
                 -->kernel: 0:7 %2931 =  [] -> 3.520us
                 -->kernel: 0:7 %2932 =  [] -> 1.568us
                 -->kernel: 0:7 %2933 =  [] -> 7.904us
                 -->kernel: 0:7 %2934 =  [] -> 7.328us
                 -->kernel: 0:7 %2935 =  [] -> 7.296us
                 -->kernel: 0:7 %2936 =  [] -> 7.200us
                 -->kernel: 0:7 %2937 =  [] -> 6.944us
                 -->kernel: 0:7 %2938 =  [] -> 6.880us
                 -->kernel: 0:7 %2939 =  [] -> 7.072us
                 -->kernel: 0:7 %2940 =  [] -> 7.040us
             %3835 = :aten::zeros [[], [], [], [], []] -> 545.121us
               %3836 = :aten::zero_ [[129280, 7168]] -> 545.121us
                 %3837 = :aten::fill_ [[129280, 7168], []] -> 545.121us
                 -->kernel: 0:7 %2941 =  [] -> 545.121us
             %3838 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 20.704us
                 -->kernel: 0:7 %2942 =  [] -> 1.248us
                 -->kernel: 0:7 %2943 =  [] -> 4.320us
                 -->kernel: 0:7 %2944 =  [] -> 1.632us
             %3839 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 18.913us
                 -->kernel: 0:7 %2945 =  [] -> 1.280us
                 -->kernel: 0:7 %2946 =  [] -> 2.880us
                 -->kernel: 0:7 %2947 =  [] -> 1.600us
                 -->kernel: 0:7 %2948 =  [] -> 1.824us
                 -->kernel: 0:7 %2949 =  [] -> 244.416us
                 -->kernel: 0:7 %2950 =  [] -> 200.417us
       %3840 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.556ms
                 -->kernel: 0:35 %2951 =  [] -> 1.556ms
     %3841 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.557ms
       %3842 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.557ms
                 -->kernel: 0:35 %2952 =  [] -> 1.557ms
     %3843 = :aten::linalg_vector_norm [[3002413056], [], [], [], []] -> 2.550ms
                 -->kernel: 0:7 %2953 =  [] -> 616.001us
                 -->kernel: 0:7 %2954 =  [] -> 609.986us
                 -->kernel: 0:7 %2955 =  [] -> 607.937us
                 -->kernel: 0:7 %2956 =  [] -> 610.081us
     %3844 = :aten::isnan [[]] -> 1.728us
       %3845 = :aten::ne [[], []] -> 1.728us
                 -->kernel: 0:7 %2957 =  [] -> 1.728us
     %3846 = :aten::is_nonzero [[]] -> 2.240us
       %3847 = :aten::item [[]] -> 2.240us
         %3848 = :aten::_local_scalar_dense [[]] -> 2.240us
     %3849 = :aten::isinf [[]] -> 37.824us
       %3850 = :aten::abs [[]] -> 1.568us
         %3851 = :aten::abs [[], [0]] -> 1.568us
                 -->kernel: 0:7 %2958 =  [] -> 1.568us
       %3852 = :aten::eq [[], []] -> 1.568us
                 -->kernel: 0:7 %2959 =  [] -> 1.568us
     %3853 = :aten::is_nonzero [[]] -> 2.240us
       %3854 = :aten::item [[]] -> 2.240us
         %3855 = :aten::_local_scalar_dense [[]] -> 2.240us
     %3856 = :aten::mul_ [[3002413056], []] -> 3.543ms
                 -->kernel: 0:7 %2960 =  [] -> 863.490us
                 -->kernel: 0:7 %2961 =  [] -> 901.218us
                 -->kernel: 0:7 %2962 =  [] -> 872.162us
                 -->kernel: 0:7 %2963 =  [] -> 870.338us
     %3857 = :c10d::reduce_scatter_tensor_coalesced_ [[375301632], [3002413056], [], [], [], []] -> 14.519ms
       %3858 = :record_param_comms [[3002413056], [], [], [], [], [], [], [], [], []] -> 14.519ms
         %3859 = :nccl:reduce_scatter_tensor_coalesced [[3002413056]] -> 14.519ms
           %3860 = NCCL:ncclGroupEnd [] -> 14.519ms
                 -->kernel: 0:7 %2964 =  [] -> 14.519ms
     %3861 = :aten::linalg_vector_norm [[352321536], [], [], [], []] -> 304.545us
                 -->kernel: 0:7 %2965 =  [] -> 290.785us
     %3862 = :aten::isnan [[]] -> 1.728us
       %3863 = :aten::ne [[], []] -> 1.728us
                 -->kernel: 0:7 %2966 =  [] -> 1.728us
     %3864 = :aten::is_nonzero [[]] -> 2.208us
       %3865 = :aten::item [[]] -> 2.208us
         %3866 = :aten::_local_scalar_dense [[]] -> 2.208us
     %3867 = :aten::isinf [[]] -> 26.848us
       %3868 = :aten::abs [[]] -> 1.344us
         %3869 = :aten::abs [[], [0]] -> 1.344us
                 -->kernel: 0:7 %2967 =  [] -> 1.344us
       %3870 = :aten::eq [[], []] -> 1.344us
                 -->kernel: 0:7 %2968 =  [] -> 1.344us
     %3871 = :aten::is_nonzero [[]] -> 2.368us
       %3872 = :aten::item [[]] -> 2.368us
         %3873 = :aten::_local_scalar_dense [[]] -> 2.368us
     %3874 = :aten::mul_ [[352321536], []] -> 403.809us
                 -->kernel: 0:7 %2969 =  [] -> 403.809us
     %3875 = :aten::stack [[32], [32], []] -> 2.560us
       %3876 = :aten::cat [[32], [32], []] -> 2.560us
                 -->kernel: 0:7 %2970 =  [] -> 2.560us
     %3877 = :aten::stack [[32], [32], []] -> 1.856us
       %3878 = :aten::cat [[32], [32], []] -> 1.856us
                 -->kernel: 0:7 %2971 =  [] -> 1.856us
     %3879 = :c10d::allreduce_ [[2, 32], [], [], [], [], []] -> 15.136us
       %3880 = :record_param_comms [[2, 32], [], [], [], [], [], [], [], [], []] -> 15.136us
         %3881 = :nccl:all_reduce [[2, 32]] -> 15.136us
           %3882 = NCCL:ncclAllReduce [] -> 15.136us
                 -->kernel: 0:7 %2972 =  [] -> 15.136us
     %3883 = :aten::sum [[2, 32], [], [], []] -> 3.136us
                 -->kernel: 0:7 %2973 =  [] -> 3.136us
     %3884 = :aten::div [[2, 1], []] -> 1.696us
                 -->kernel: 0:7 %2974 =  [] -> 1.696us
     %3885 = :aten::sub [[2, 1], [2, 32], []] -> 1.792us
                 -->kernel: 0:7 %2975 =  [] -> 1.792us
     %3886 = :aten::sign [[2, 32]] -> 1.472us
                 -->kernel: 0:7 %2976 =  [] -> 1.472us
     %3887 = :aten::mul [[2, 32], []] -> 1.792us
                 -->kernel: 0:7 %2977 =  [] -> 1.792us
     %3888 = :aten::add [[2, 32], [2, 32], []] -> 3.072us
                 -->kernel: 0:7 %2978 =  [] -> 3.072us
     %3889 = :aten::zero_ [[32]] -> 1.024us
       %3890 = :aten::fill_ [[32], []] -> 1.024us
                 -->kernel: 0:7 %2979 =  [] -> 1.024us
     %3891 = :aten::copy_ [[32], [32], []] -> 1.024us
     %3892 = :aten::zero_ [[32]] -> 1.152us
       %3893 = :aten::fill_ [[32], []] -> 1.152us
                 -->kernel: 0:7 %2980 =  [] -> 1.152us
     %3894 = :aten::copy_ [[32], [32], []] -> 1.216us
     %3895 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %3896 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %3897 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %3898 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 8.960us
       %3899 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 8.960us
         %3900 = :nccl:all_reduce [[1]] -> 8.960us
           %3901 = NCCL:ncclAllReduce [] -> 8.960us
                 -->kernel: 0:7 %2981 =  [] -> 8.960us
     %3902 = :aten::item [[1]] -> 2.240us
       %3903 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %3904 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %3905 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %3906 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %3907 = :aten::zeros [[], [], [], [], []] -> 1.024us
       %3908 = :aten::zero_ [[320]] -> 1.024us
         %3909 = :aten::fill_ [[320], []] -> 1.024us
                 -->kernel: 0:7 %2982 =  [] -> 1.024us
     %3910 = :nvte_multi_tensor_l2norm_cuda [] -> 1.383ms
                 -->kernel: 0:7 %2983 =  [] -> 36.256us
                 -->kernel: 0:7 %2984 =  [] -> 33.568us
                 -->kernel: 0:7 %2985 =  [] -> 29.504us
                 -->kernel: 0:7 %2986 =  [] -> 29.760us
                 -->kernel: 0:7 %2987 =  [] -> 30.337us
                 -->kernel: 0:7 %2988 =  [] -> 29.984us
                 -->kernel: 0:7 %2989 =  [] -> 29.952us
                 -->kernel: 0:7 %2990 =  [] -> 29.760us
                 -->kernel: 0:7 %2991 =  [] -> 30.560us
                 -->kernel: 0:7 %2992 =  [] -> 29.760us
                 -->kernel: 0:7 %2993 =  [] -> 29.984us
                 -->kernel: 0:7 %2994 =  [] -> 30.368us
                 -->kernel: 0:7 %2995 =  [] -> 30.240us
                 -->kernel: 0:7 %2996 =  [] -> 30.336us
                 -->kernel: 0:7 %2997 =  [] -> 30.112us
                 -->kernel: 0:7 %2998 =  [] -> 30.049us
                 -->kernel: 0:7 %2999 =  [] -> 30.048us
                 -->kernel: 0:7 %3000 =  [] -> 29.728us
                 -->kernel: 0:7 %3001 =  [] -> 29.984us
                 -->kernel: 0:7 %3002 =  [] -> 30.112us
                 -->kernel: 0:7 %3003 =  [] -> 29.728us
                 -->kernel: 0:7 %3004 =  [] -> 30.240us
                 -->kernel: 0:7 %3005 =  [] -> 29.856us
                 -->kernel: 0:7 %3006 =  [] -> 29.696us
                 -->kernel: 0:7 %3007 =  [] -> 30.176us
                 -->kernel: 0:7 %3008 =  [] -> 30.048us
                 -->kernel: 0:7 %3009 =  [] -> 29.793us
                 -->kernel: 0:7 %3010 =  [] -> 29.792us
                 -->kernel: 0:7 %3011 =  [] -> 30.240us
                 -->kernel: 0:7 %3012 =  [] -> 30.112us
                 -->kernel: 0:7 %3013 =  [] -> 29.664us
                 -->kernel: 0:7 %3014 =  [] -> 29.952us
                 -->kernel: 0:7 %3015 =  [] -> 29.952us
                 -->kernel: 0:7 %3016 =  [] -> 30.496us
                 -->kernel: 0:7 %3017 =  [] -> 17.248us
                 -->kernel: 0:7 %3018 =  [] -> 1.568us
     %3911 = :aten::pow [[1], []] -> 1.632us
                 -->kernel: 0:7 %3019 =  [] -> 1.632us
     %3912 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 51.296us
       %3913 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 51.296us
         %3914 = :nccl:all_reduce [[1]] -> 51.296us
           %3915 = NCCL:ncclAllReduce [] -> 51.296us
                 -->kernel: 0:7 %3020 =  [] -> 51.296us
     %3916 = :aten::item [[1]] -> 2.240us
       %3917 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %3918 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %3919 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %3920 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %3921 = :nvte_multi_tensor_scale_cuda [] -> 933.346us
                 -->kernel: 0:7 %3021 =  [] -> 36.320us
                 -->kernel: 0:7 %3022 =  [] -> 42.592us
                 -->kernel: 0:7 %3023 =  [] -> 44.288us
                 -->kernel: 0:7 %3024 =  [] -> 43.680us
                 -->kernel: 0:7 %3025 =  [] -> 43.776us
                 -->kernel: 0:7 %3026 =  [] -> 43.328us
                 -->kernel: 0:7 %3027 =  [] -> 43.968us
                 -->kernel: 0:7 %3028 =  [] -> 43.264us
                 -->kernel: 0:7 %3029 =  [] -> 42.336us
                 -->kernel: 0:7 %3030 =  [] -> 42.528us
                 -->kernel: 0:7 %3031 =  [] -> 43.104us
                 -->kernel: 0:7 %3032 =  [] -> 43.104us
                 -->kernel: 0:7 %3033 =  [] -> 43.105us
                 -->kernel: 0:7 %3034 =  [] -> 43.648us
                 -->kernel: 0:7 %3035 =  [] -> 43.104us
                 -->kernel: 0:7 %3036 =  [] -> 44.512us
                 -->kernel: 0:7 %3037 =  [] -> 43.168us
                 -->kernel: 0:7 %3038 =  [] -> 30.624us
     %3922 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %3923 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %3924 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %3925 = :nvte_multi_tensor_scale_cuda [] -> 877.538us
                 -->kernel: 0:7 %3039 =  [] -> 42.656us
                 -->kernel: 0:7 %3040 =  [] -> 43.552us
                 -->kernel: 0:7 %3041 =  [] -> 42.880us
                 -->kernel: 0:7 %3042 =  [] -> 43.680us
                 -->kernel: 0:7 %3043 =  [] -> 42.848us
                 -->kernel: 0:7 %3044 =  [] -> 43.520us
                 -->kernel: 0:7 %3045 =  [] -> 42.816us
                 -->kernel: 0:7 %3046 =  [] -> 43.585us
                 -->kernel: 0:7 %3047 =  [] -> 42.880us
                 -->kernel: 0:7 %3048 =  [] -> 43.872us
                 -->kernel: 0:7 %3049 =  [] -> 43.520us
                 -->kernel: 0:7 %3050 =  [] -> 42.240us
                 -->kernel: 0:7 %3051 =  [] -> 42.656us
                 -->kernel: 0:7 %3052 =  [] -> 42.880us
                 -->kernel: 0:7 %3053 =  [] -> 43.456us
                 -->kernel: 0:7 %3054 =  [] -> 43.009us
                 -->kernel: 0:7 %3055 =  [] -> 27.776us
     %3926 = :Optimizer.step#HybridDeviceOptimizer.step None -> 317.614ms
       %3927 = :aten::copy_ [[375301632], [375301632], []] -> 43.652ms
         %3928 = :aten::to [[375301632], [], [], [], []] -> 2.226ms
           %3929 = :aten::_to_copy [[375301632], [], [], [], [], [], []] -> 2.226ms
             %3930 = :aten::copy_ [[375301632], [375301632], []] -> 2.226ms
                 -->kernel: 0:7 %3056 =  [] -> 2.226ms
         %3931 = :aten::copy_ [[375301632], [375301632], []] -> 41.381ms
       %3932 = :Optimizer.step#AdamW.step None -> 72.105ms
         %3933 = :aten::copy_ [[375301632], [375301632], []] -> 72.105ms
           %3934 = :aten::copy_ [[375301632], [375301632], []] -> 71.390ms
           %3935 = :aten::copy_ [[375301632], [375301632], []] -> 602.850us
                 -->kernel: 0:7 %3057 =  [] -> 602.850us
     %3936 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 342.202ms
       %3937 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 342.202ms
         %3938 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 342.202ms
           %3939 = NCCL:ncclGroupEnd [] -> 342.202ms
                 -->kernel: 0:39 %3058 =  [] -> 342.202ms
     %3940 = :Optimizer.step#HybridDeviceOptimizer.step None -> 84.168ms
       %3941 = :aten::to [[14680064], [], [], [], []] -> 89.344us
         %3942 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.344us
           %3943 = :aten::copy_ [[14680064], [14680064], []] -> 89.344us
                 -->kernel: 0:7 %3059 =  [] -> 89.344us
       %3944 = :aten::to [[29360128], [], [], [], []] -> 176.353us
         %3945 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.353us
           %3946 = :aten::copy_ [[29360128], [29360128], []] -> 176.353us
                 -->kernel: 0:7 %3060 =  [] -> 176.353us
       %3947 = :aten::to [[29360128], [], [], [], []] -> 175.584us
         %3948 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 175.584us
           %3949 = :aten::copy_ [[29360128], [29360128], []] -> 175.584us
                 -->kernel: 0:7 %3061 =  [] -> 175.584us
       %3950 = :aten::to [[29360128], [], [], [], []] -> 176.065us
         %3951 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.065us
           %3952 = :aten::copy_ [[29360128], [29360128], []] -> 176.065us
                 -->kernel: 0:7 %3062 =  [] -> 176.065us
       %3953 = :aten::to [[29360128], [], [], [], []] -> 176.128us
         %3954 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.128us
           %3955 = :aten::copy_ [[29360128], [29360128], []] -> 176.128us
                 -->kernel: 0:7 %3063 =  [] -> 176.128us
       %3956 = :aten::to [[14680064], [], [], [], []] -> 89.536us
         %3957 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.536us
           %3958 = :aten::copy_ [[14680064], [14680064], []] -> 89.536us
                 -->kernel: 0:7 %3064 =  [] -> 89.536us
       %3959 = :aten::to [[14680064], [], [], [], []] -> 89.536us
         %3960 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.536us
           %3961 = :aten::copy_ [[14680064], [14680064], []] -> 89.536us
                 -->kernel: 0:7 %3065 =  [] -> 89.536us
       %3962 = :aten::to [[14680064], [], [], [], []] -> 89.184us
         %3963 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.184us
           %3964 = :aten::copy_ [[14680064], [14680064], []] -> 89.184us
                 -->kernel: 0:7 %3066 =  [] -> 89.184us
       %3965 = :aten::to [[14680064], [], [], [], []] -> 89.504us
         %3966 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.504us
           %3967 = :aten::copy_ [[14680064], [14680064], []] -> 89.504us
                 -->kernel: 0:7 %3067 =  [] -> 89.504us
       %3968 = :aten::to [[29360128], [], [], [], []] -> 176.289us
         %3969 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.289us
           %3970 = :aten::copy_ [[29360128], [29360128], []] -> 176.289us
                 -->kernel: 0:7 %3068 =  [] -> 176.289us
       %3971 = :aten::to [[29360128], [], [], [], []] -> 176.288us
         %3972 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.288us
           %3973 = :aten::copy_ [[29360128], [29360128], []] -> 176.288us
                 -->kernel: 0:7 %3069 =  [] -> 176.288us
       %3974 = :aten::to [[29360128], [], [], [], []] -> 175.841us
         %3975 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 175.841us
           %3976 = :aten::copy_ [[29360128], [29360128], []] -> 175.841us
                 -->kernel: 0:7 %3070 =  [] -> 175.841us
       %3977 = :aten::to [[29360128], [], [], [], []] -> 176.512us
         %3978 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.512us
           %3979 = :aten::copy_ [[29360128], [29360128], []] -> 176.512us
                 -->kernel: 0:7 %3071 =  [] -> 176.512us
       %3980 = :aten::copy_ [[14680064], [14680064], []] -> 1.992ms
         %3981 = :aten::to [[14680064], [], [], [], []] -> 89.409us
           %3982 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.409us
             %3983 = :aten::copy_ [[14680064], [14680064], []] -> 89.409us
                 -->kernel: 0:7 %3072 =  [] -> 89.409us
         %3984 = :aten::copy_ [[14680064], [14680064], []] -> 1.842ms
       %3985 = :aten::copy_ [[14680064], [14680064], []] -> 1.841ms
         %3986 = :aten::to [[14680064], [], [], [], []] -> 88.544us
           %3987 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.544us
             %3988 = :aten::copy_ [[14680064], [14680064], []] -> 88.544us
                 -->kernel: 0:7 %3073 =  [] -> 88.544us
         %3989 = :aten::copy_ [[14680064], [14680064], []] -> 1.721ms
       %3990 = :aten::copy_ [[14680064], [14680064], []] -> 1.815ms
         %3991 = :aten::to [[14680064], [], [], [], []] -> 88.000us
           %3992 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.000us
             %3993 = :aten::copy_ [[14680064], [14680064], []] -> 88.000us
                 -->kernel: 0:7 %3074 =  [] -> 88.000us
         %3994 = :aten::copy_ [[14680064], [14680064], []] -> 1.696ms
       %3995 = :Optimizer.step#FusedAdam.step None -> 3.865ms
         %3996 = :nvte_multi_tensor_adam_cuda [] -> 3.082ms
                 -->kernel: 0:7 %3075 =  [] -> 199.072us
                 -->kernel: 0:7 %3076 =  [] -> 200.737us
                 -->kernel: 0:7 %3077 =  [] -> 200.320us
                 -->kernel: 0:7 %3078 =  [] -> 201.345us
                 -->kernel: 0:7 %3079 =  [] -> 198.368us
                 -->kernel: 0:7 %3080 =  [] -> 197.249us
                 -->kernel: 0:7 %3081 =  [] -> 200.320us
                 -->kernel: 0:7 %3082 =  [] -> 199.425us
                 -->kernel: 0:7 %3083 =  [] -> 197.344us
                 -->kernel: 0:7 %3084 =  [] -> 199.393us
                 -->kernel: 0:7 %3085 =  [] -> 198.624us
                 -->kernel: 0:7 %3086 =  [] -> 199.393us
                 -->kernel: 0:7 %3087 =  [] -> 199.232us
                 -->kernel: 0:7 %3088 =  [] -> 200.321us
                 -->kernel: 0:7 %3089 =  [] -> 141.440us
         %3997 = :aten::copy_ [[14680064], [14680064], []] -> 27.168us
                 -->kernel: 0:7 %3090 =  [] -> 27.168us
         %3998 = :aten::copy_ [[29360128], [29360128], []] -> 49.600us
                 -->kernel: 0:7 %3091 =  [] -> 49.600us
         %3999 = :aten::copy_ [[29360128], [29360128], []] -> 49.664us
                 -->kernel: 0:7 %3092 =  [] -> 49.664us
         %4000 = :aten::copy_ [[29360128], [29360128], []] -> 48.224us
                 -->kernel: 0:7 %3093 =  [] -> 48.224us
         %4001 = :aten::copy_ [[29360128], [29360128], []] -> 49.568us
                 -->kernel: 0:7 %3094 =  [] -> 49.568us
         %4002 = :aten::copy_ [[14680064], [14680064], []] -> 25.056us
                 -->kernel: 0:7 %3095 =  [] -> 25.056us
         %4003 = :aten::copy_ [[14680064], [14680064], []] -> 25.088us
                 -->kernel: 0:7 %3096 =  [] -> 25.088us
         %4004 = :aten::copy_ [[14680064], [14680064], []] -> 25.056us
                 -->kernel: 0:7 %3097 =  [] -> 25.056us
         %4005 = :aten::copy_ [[14680064], [14680064], []] -> 26.400us
                 -->kernel: 0:7 %3098 =  [] -> 26.400us
         %4006 = :aten::copy_ [[29360128], [29360128], []] -> 47.617us
                 -->kernel: 0:7 %3099 =  [] -> 47.617us
         %4007 = :aten::copy_ [[29360128], [29360128], []] -> 49.536us
                 -->kernel: 0:7 %3100 =  [] -> 49.536us
         %4008 = :aten::copy_ [[29360128], [29360128], []] -> 49.600us
                 -->kernel: 0:7 %3101 =  [] -> 49.600us
         %4009 = :aten::copy_ [[29360128], [29360128], []] -> 47.968us
                 -->kernel: 0:7 %3102 =  [] -> 47.968us
       %4010 = :Optimizer.step#AdamW.step None -> 8.725ms
         %4011 = :aten::copy_ [[14680064], [14680064], []] -> 2.928ms
           %4012 = :aten::copy_ [[14680064], [14680064], []] -> 2.852ms
           %4013 = :aten::copy_ [[14680064], [14680064], []] -> 24.352us
                 -->kernel: 0:7 %3103 =  [] -> 24.352us
         %4014 = :aten::copy_ [[14680064], [14680064], []] -> 2.783ms
           %4015 = :aten::copy_ [[14680064], [14680064], []] -> 2.744ms
           %4016 = :aten::copy_ [[14680064], [14680064], []] -> 23.456us
                 -->kernel: 0:7 %3104 =  [] -> 23.456us
         %4017 = :aten::copy_ [[14680064], [14680064], []] -> 2.739ms
           %4018 = :aten::copy_ [[14680064], [14680064], []] -> 2.706ms
           %4019 = :aten::copy_ [[14680064], [14680064], []] -> 24.064us
                 -->kernel: 0:7 %3105 =  [] -> 24.064us
     %4020 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 53.683ms
       %4021 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 53.683ms
         %4022 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 53.683ms
           %4023 = NCCL:ncclGroupEnd [] -> 53.683ms
                 -->kernel: 0:39 %3106 =  [] -> 53.683ms
     %4024 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %4025 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %4026 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %4027 = :aten::item [[1]] -> 3.552us
       %4028 = :aten::_local_scalar_dense [[1]] -> 3.552us
     %4029 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %4030 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %4031 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %4032 = :aten::item [[1]] -> 2.464us
       %4033 = :aten::_local_scalar_dense [[1]] -> 2.464us
     %4034 = :aten::item [[1]] -> 2.304us
       %4035 = :aten::_local_scalar_dense [[1]] -> 2.304us
     %4036 = :aten::cat [[1], []] -> 1.312us
     %4037 = :aten::mean [[1], []] -> 2.528us
       %4038 = :aten::mean [[1], [], [], []] -> 2.528us
                 -->kernel: 0:7 %3107 =  [] -> 2.528us
     %4039 = :aten::item [[1]] -> 2.656us
       %4040 = :aten::_local_scalar_dense [[1]] -> 2.656us
     %4041 = :aten::to [[1], [], [], [], [], []] -> 736.000ns
       %4042 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 736.000ns
         %4043 = :aten::copy_ [[1], [1], []] -> 736.000ns
     %4044 = :aten::add [[1], [], []] -> 1.632us
                 -->kernel: 0:7 %3108 =  [] -> 1.632us
     %4045 = :aten::to [[1], [], [], [], [], []] -> 736.000ns
       %4046 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 736.000ns
         %4047 = :aten::copy_ [[1], [1], []] -> 736.000ns
     %4048 = :aten::item [[1]] -> 2.336us
       %4049 = :aten::_local_scalar_dense [[1]] -> 2.336us
     %4050 = :aten::item [[1]] -> 2.176us
       %4051 = :aten::_local_scalar_dense [[1]] -> 2.176us
     %4052 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 1.641ms
       %4053 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 1.641ms
         %4054 = :nccl:all_reduce [[2]] -> 1.641ms
           %4055 = NCCL:ncclAllReduce [] -> 1.641ms
                 -->kernel: 0:7 %3109 =  [] -> 1.641ms
     %4056 = :c10d::allreduce_ [[3], [], [], [], [], []] -> 9.056us
       %4057 = :record_param_comms [[3], [], [], [], [], [], [], [], [], []] -> 9.056us
         %4058 = :nccl:all_reduce [[3]] -> 9.056us
           %4059 = NCCL:ncclAllReduce [] -> 9.056us
                 -->kernel: 0:7 %3110 =  [] -> 9.056us
     %4060 = :aten::mul [[3], []] -> 1.312us
                 -->kernel: 0:7 %3111 =  [] -> 1.312us
     %4061 = :aten::mul [[2], []] -> 1.504us
                 -->kernel: 0:7 %3112 =  [] -> 1.504us
     %4062 = :aten::sum [[3], []] -> 3.232us
       %4063 = :aten::sum [[3], [], [], []] -> 3.232us
                 -->kernel: 0:7 %3113 =  [] -> 3.232us
     %4064 = :aten::div [[], []] -> 1.280us
                 -->kernel: 0:7 %3114 =  [] -> 1.280us
     %4065 = :aten::add_ [[1], [], []] -> 1.280us
                 -->kernel: 0:7 %3115 =  [] -> 1.280us
     %4066 = :aten::sum [[2], []] -> 2.624us
       %4067 = :aten::sum [[2], [], [], []] -> 2.624us
                 -->kernel: 0:7 %3116 =  [] -> 2.624us
     %4068 = :aten::div [[], []] -> 1.344us
                 -->kernel: 0:7 %3117 =  [] -> 1.344us
     %4069 = :aten::add_ [[1], [], []] -> 1.280us
                 -->kernel: 0:7 %3118 =  [] -> 1.280us
     %4070 = :aten::zero_ [[3]] -> 960.000ns
       %4071 = :aten::fill_ [[3], []] -> 960.000ns
                 -->kernel: 0:7 %3119 =  [] -> 960.000ns
     %4072 = :aten::zero_ [[2]] -> 1.184us
       %4073 = :aten::fill_ [[2], []] -> 1.184us
                 -->kernel: 0:7 %3120 =  [] -> 1.184us
     %4074 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 308.737us
       %4075 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 308.737us
         %4076 = :nccl:all_reduce [[1]] -> 308.737us
           %4077 = NCCL:ncclAllReduce [] -> 308.737us
                 -->kernel: 0:7 %3121 =  [] -> 308.737us
     %4078 = :aten::mul [[1], []] -> 1.184us
                 -->kernel: 0:7 %3122 =  [] -> 1.184us
     %4079 = :aten::add_ [[1], [], []] -> 1.280us
                 -->kernel: 0:7 %3123 =  [] -> 1.280us
     %4080 = :aten::zero_ [[1]] -> 1.184us
       %4081 = :aten::fill_ [[1], []] -> 1.184us
                 -->kernel: 0:7 %3124 =  [] -> 1.184us
     %4082 = :c10d::barrier [[1], [], [], [], []] -> 148.705us
       %4083 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 148.705us
         %4084 = :aten::zeros [[], [], [], [], []] -> 1.184us
           %4085 = :aten::zero_ [[1]] -> 1.184us
             %4086 = :aten::fill_ [[1], []] -> 1.184us
                 -->kernel: 0:7 %3125 =  [] -> 1.184us
         %4087 = :nccl:all_reduce_barrier [[1]] -> 112.672us
           %4088 = NCCL:ncclAllReduce [] -> 112.672us
                 -->kernel: 0:7 %3126 =  [] -> 112.672us
     %4089 = :c10d::barrier [[1], [], [], [], []] -> 37.920us
       %4090 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 37.920us
         %4091 = :aten::zeros [[], [], [], [], []] -> 960.000ns
           %4092 = :aten::zero_ [[1]] -> 960.000ns
             %4093 = :aten::fill_ [[1], []] -> 960.000ns
                 -->kernel: 0:7 %3127 =  [] -> 960.000ns
         %4094 = :nccl:all_reduce_barrier [[1]] -> 7.808us
           %4095 = NCCL:ncclAllReduce [] -> 7.808us
                 -->kernel: 0:7 %3128 =  [] -> 7.808us
     %4096 = :aten::item [[1]] -> 2.336us
       %4097 = :aten::_local_scalar_dense [[1]] -> 2.336us
     %4098 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %4099 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %4100 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %4101 = :aten::item [[1]] -> 2.240us
       %4102 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %4103 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %4104 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %4105 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %4106 = :aten::item [[1]] -> 2.240us
       %4107 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %4108 = :aten::to [[1], [], [], [], [], []] -> 736.000ns
       %4109 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 736.000ns
         %4110 = :aten::copy_ [[1], [1], []] -> 736.000ns
     %4111 = :aten::item [[1]] -> 2.432us
       %4112 = :aten::_local_scalar_dense [[1]] -> 2.432us
     %4113 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %4114 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %4115 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %4116 = :aten::zeros [[], [], [], [], []] -> 1.120us
       %4117 = :aten::zero_ [[8, 24]] -> 1.120us
         %4118 = :aten::fill_ [[8, 24], []] -> 1.120us
                 -->kernel: 0:7 %3129 =  [] -> 1.120us
     %4119 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 114.304us
       %4120 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 114.304us
         %4121 = :nccl:_all_gather_base [[24]] -> 114.304us
           %4122 = NCCL:ncclAllGather [] -> 114.304us
                 -->kernel: 0:7 %3130 =  [] -> 114.304us
     %4123 = :aten::gt [[8], []] -> 1.472us
                 -->kernel: 0:7 %3131 =  [] -> 1.472us
     %4124 = :aten::index [[8], [8]] -> 63.040us
       %4125 = :aten::nonzero [[8]] -> 63.040us
         %4126 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3132 =  [] -> 1.440us
         %4127 = CCCL:cub::DeviceSelect::Flagged [] -> 15.392us
                 -->kernel: 0:7 %3133 =  [] -> 1.312us
                 -->kernel: 0:7 %3134 =  [] -> 1.920us
     %4128 = :aten::gt [[8], []] -> 1.504us
                 -->kernel: 0:7 %3135 =  [] -> 1.504us
     %4129 = :aten::index [[8], [8]] -> 45.568us
       %4130 = :aten::nonzero [[8]] -> 45.568us
         %4131 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %3136 =  [] -> 1.472us
         %4132 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %3137 =  [] -> 1.248us
                 -->kernel: 0:7 %3138 =  [] -> 1.824us
     %4133 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3139 =  [] -> 1.344us
     %4134 = :aten::index [[8], [8]] -> 42.944us
       %4135 = :aten::nonzero [[8]] -> 42.944us
         %4136 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3140 =  [] -> 1.440us
         %4137 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3141 =  [] -> 1.280us
                 -->kernel: 0:7 %3142 =  [] -> 1.792us
     %4138 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3143 =  [] -> 1.344us
     %4139 = :aten::index [[8], [8]] -> 43.680us
       %4140 = :aten::nonzero [[8]] -> 43.680us
         %4141 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3144 =  [] -> 1.440us
         %4142 = CCCL:cub::DeviceSelect::Flagged [] -> 12.608us
                 -->kernel: 0:7 %3145 =  [] -> 1.248us
                 -->kernel: 0:7 %3146 =  [] -> 1.824us
     %4143 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3147 =  [] -> 1.344us
     %4144 = :aten::index [[8], [8]] -> 42.848us
       %4145 = :aten::nonzero [[8]] -> 42.848us
         %4146 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3148 =  [] -> 1.440us
         %4147 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3149 =  [] -> 1.312us
                 -->kernel: 0:7 %3150 =  [] -> 1.792us
     %4148 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3151 =  [] -> 1.344us
     %4149 = :aten::index [[8], [8]] -> 42.720us
       %4150 = :aten::nonzero [[8]] -> 42.720us
         %4151 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %3152 =  [] -> 1.408us
         %4152 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3153 =  [] -> 1.248us
                 -->kernel: 0:7 %3154 =  [] -> 1.792us
     %4153 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3155 =  [] -> 1.344us
     %4154 = :aten::index [[8], [8]] -> 43.072us
       %4155 = :aten::nonzero [[8]] -> 43.072us
         %4156 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %3156 =  [] -> 1.408us
         %4157 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %3157 =  [] -> 1.312us
                 -->kernel: 0:7 %3158 =  [] -> 1.792us
     %4158 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3159 =  [] -> 1.344us
     %4159 = :aten::index [[8], [8]] -> 42.112us
       %4160 = :aten::nonzero [[8]] -> 42.112us
         %4161 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3160 =  [] -> 1.440us
         %4162 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %3161 =  [] -> 1.248us
                 -->kernel: 0:7 %3162 =  [] -> 1.792us
     %4163 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3163 =  [] -> 1.344us
     %4164 = :aten::index [[8], [8]] -> 42.144us
       %4165 = :aten::nonzero [[8]] -> 42.144us
         %4166 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3164 =  [] -> 1.440us
         %4167 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %3165 =  [] -> 1.280us
                 -->kernel: 0:7 %3166 =  [] -> 1.792us
     %4168 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3167 =  [] -> 1.344us
     %4169 = :aten::index [[8], [8]] -> 42.912us
       %4170 = :aten::nonzero [[8]] -> 42.912us
         %4171 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3168 =  [] -> 1.440us
         %4172 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %3169 =  [] -> 1.248us
                 -->kernel: 0:7 %3170 =  [] -> 1.824us
     %4173 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3171 =  [] -> 1.344us
     %4174 = :aten::index [[8], [8]] -> 42.048us
       %4175 = :aten::nonzero [[8]] -> 42.048us
         %4176 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %3172 =  [] -> 1.408us
         %4177 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3173 =  [] -> 1.312us
                 -->kernel: 0:7 %3174 =  [] -> 1.824us
     %4178 = :aten::gt [[8], []] -> 1.312us
                 -->kernel: 0:7 %3175 =  [] -> 1.312us
     %4179 = :aten::index [[8], [8]] -> 43.200us
       %4180 = :aten::nonzero [[8]] -> 43.200us
         %4181 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3176 =  [] -> 1.440us
         %4182 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %3177 =  [] -> 1.248us
                 -->kernel: 0:7 %3178 =  [] -> 1.792us
     %4183 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3179 =  [] -> 1.344us
     %4184 = :aten::index [[8], [8]] -> 43.424us
       %4185 = :aten::nonzero [[8]] -> 43.424us
         %4186 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %3180 =  [] -> 1.408us
         %4187 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %3181 =  [] -> 1.280us
                 -->kernel: 0:7 %3182 =  [] -> 1.792us
     %4188 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3183 =  [] -> 1.344us
     %4189 = :aten::index [[8], [8]] -> 48.704us
       %4190 = :aten::nonzero [[8]] -> 48.704us
         %4191 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3184 =  [] -> 1.440us
         %4192 = CCCL:cub::DeviceSelect::Flagged [] -> 12.192us
                 -->kernel: 0:7 %3185 =  [] -> 1.280us
                 -->kernel: 0:7 %3186 =  [] -> 1.824us
     %4193 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3187 =  [] -> 1.344us
     %4194 = :aten::index [[8], [8]] -> 44.704us
       %4195 = :aten::nonzero [[8]] -> 44.704us
         %4196 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3188 =  [] -> 1.440us
         %4197 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %3189 =  [] -> 1.280us
                 -->kernel: 0:7 %3190 =  [] -> 1.792us
     %4198 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3191 =  [] -> 1.344us
     %4199 = :aten::index [[8], [8]] -> 42.720us
       %4200 = :aten::nonzero [[8]] -> 42.720us
         %4201 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3192 =  [] -> 1.440us
         %4202 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %3193 =  [] -> 1.248us
                 -->kernel: 0:7 %3194 =  [] -> 1.824us
     %4203 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3195 =  [] -> 1.344us
     %4204 = :aten::index [[8], [8]] -> 42.496us
       %4205 = :aten::nonzero [[8]] -> 42.496us
         %4206 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3196 =  [] -> 1.440us
         %4207 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %3197 =  [] -> 1.280us
                 -->kernel: 0:7 %3198 =  [] -> 1.792us
     %4208 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3199 =  [] -> 1.344us
     %4209 = :aten::index [[8], [8]] -> 42.624us
       %4210 = :aten::nonzero [[8]] -> 42.624us
         %4211 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3200 =  [] -> 1.440us
         %4212 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %3201 =  [] -> 1.248us
                 -->kernel: 0:7 %3202 =  [] -> 1.792us
     %4213 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3203 =  [] -> 1.344us
     %4214 = :aten::index [[8], [8]] -> 42.784us
       %4215 = :aten::nonzero [[8]] -> 42.784us
         %4216 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %3204 =  [] -> 1.408us
         %4217 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3205 =  [] -> 1.312us
                 -->kernel: 0:7 %3206 =  [] -> 1.824us
     %4218 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3207 =  [] -> 1.344us
     %4219 = :aten::index [[8], [8]] -> 42.817us
       %4220 = :aten::nonzero [[8]] -> 42.817us
         %4221 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3208 =  [] -> 1.440us
         %4222 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %3209 =  [] -> 1.248us
                 -->kernel: 0:7 %3210 =  [] -> 1.792us
     %4223 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3211 =  [] -> 1.344us
     %4224 = :aten::index [[8], [8]] -> 42.816us
       %4225 = :aten::nonzero [[8]] -> 42.816us
         %4226 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3212 =  [] -> 1.440us
         %4227 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %3213 =  [] -> 1.312us
                 -->kernel: 0:7 %3214 =  [] -> 1.792us
     %4228 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3215 =  [] -> 1.344us
     %4229 = :aten::index [[8], [8]] -> 45.760us
       %4230 = :aten::nonzero [[8]] -> 45.760us
         %4231 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3216 =  [] -> 1.440us
         %4232 = CCCL:cub::DeviceSelect::Flagged [] -> 12.288us
                 -->kernel: 0:7 %3217 =  [] -> 1.280us
                 -->kernel: 0:7 %3218 =  [] -> 1.824us
     %4233 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3219 =  [] -> 1.344us
     %4234 = :aten::index [[8], [8]] -> 43.201us
       %4235 = :aten::nonzero [[8]] -> 43.201us
         %4236 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %3220 =  [] -> 1.408us
         %4237 = CCCL:cub::DeviceSelect::Flagged [] -> 12.001us
                 -->kernel: 0:7 %3221 =  [] -> 1.312us
                 -->kernel: 0:7 %3222 =  [] -> 1.824us
     %4238 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3223 =  [] -> 1.344us
     %4239 = :aten::index [[8], [8]] -> 42.272us
       %4240 = :aten::nonzero [[8]] -> 42.272us
         %4241 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3224 =  [] -> 1.440us
         %4242 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %3225 =  [] -> 1.248us
                 -->kernel: 0:7 %3226 =  [] -> 1.792us
     %4243 = :aten::zeros [[], [], [], [], []] -> 960.000ns
       %4244 = :aten::zero_ [[8, 24]] -> 960.000ns
         %4245 = :aten::fill_ [[8, 24], []] -> 960.000ns
                 -->kernel: 0:7 %3227 =  [] -> 960.000ns
     %4246 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.712us
       %4247 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.712us
         %4248 = :nccl:_all_gather_base [[24]] -> 7.712us
           %4249 = NCCL:ncclAllGather [] -> 7.712us
                 -->kernel: 0:7 %3228 =  [] -> 7.712us
     %4250 = :aten::gt [[8], []] -> 1.920us
                 -->kernel: 0:7 %3229 =  [] -> 1.920us
     %4251 = :aten::index [[8], [8]] -> 47.232us
       %4252 = :aten::nonzero [[8]] -> 47.232us
         %4253 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3230 =  [] -> 1.248us
         %4254 = CCCL:cub::DeviceSelect::Flagged [] -> 12.320us
                 -->kernel: 0:7 %3231 =  [] -> 960.000ns
                 -->kernel: 0:7 %3232 =  [] -> 2.144us
     %4255 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %3233 =  [] -> 1.696us
     %4256 = :aten::index [[8], [8]] -> 44.224us
       %4257 = :aten::nonzero [[8]] -> 44.224us
         %4258 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %3234 =  [] -> 1.216us
         %4259 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3235 =  [] -> 992.000ns
                 -->kernel: 0:7 %3236 =  [] -> 2.112us
     %4260 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3237 =  [] -> 1.728us
     %4261 = :aten::index [[8], [8]] -> 42.720us
       %4262 = :aten::nonzero [[8]] -> 42.720us
         %4263 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3238 =  [] -> 1.248us
         %4264 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %3239 =  [] -> 960.000ns
                 -->kernel: 0:7 %3240 =  [] -> 2.112us
     %4265 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %3241 =  [] -> 1.696us
     %4266 = :aten::index [[8], [8]] -> 42.688us
       %4267 = :aten::nonzero [[8]] -> 42.688us
         %4268 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3242 =  [] -> 1.248us
         %4269 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3243 =  [] -> 992.000ns
                 -->kernel: 0:7 %3244 =  [] -> 2.080us
     %4270 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %3245 =  [] -> 1.760us
     %4271 = :aten::index [[8], [8]] -> 41.984us
       %4272 = :aten::nonzero [[8]] -> 41.984us
         %4273 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3246 =  [] -> 1.248us
         %4274 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %3247 =  [] -> 960.000ns
                 -->kernel: 0:7 %3248 =  [] -> 2.144us
     %4275 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %3249 =  [] -> 1.696us
     %4276 = :aten::index [[8], [8]] -> 42.720us
       %4277 = :aten::nonzero [[8]] -> 42.720us
         %4278 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %3250 =  [] -> 1.216us
         %4279 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %3251 =  [] -> 992.000ns
                 -->kernel: 0:7 %3252 =  [] -> 2.080us
     %4280 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %3253 =  [] -> 1.760us
     %4281 = :aten::index [[8], [8]] -> 42.017us
       %4282 = :aten::nonzero [[8]] -> 42.017us
         %4283 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3254 =  [] -> 1.248us
         %4284 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %3255 =  [] -> 960.000ns
                 -->kernel: 0:7 %3256 =  [] -> 2.080us
     %4285 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %3257 =  [] -> 1.696us
     %4286 = :aten::index [[8], [8]] -> 42.272us
       %4287 = :aten::nonzero [[8]] -> 42.272us
         %4288 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3258 =  [] -> 1.248us
         %4289 = CCCL:cub::DeviceSelect::Flagged [] -> 12.192us
                 -->kernel: 0:7 %3259 =  [] -> 992.000ns
                 -->kernel: 0:7 %3260 =  [] -> 2.048us
     %4290 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3261 =  [] -> 1.728us
     %4291 = :aten::index [[8], [8]] -> 41.856us
       %4292 = :aten::nonzero [[8]] -> 41.856us
         %4293 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %3262 =  [] -> 1.216us
         %4294 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %3263 =  [] -> 960.000ns
                 -->kernel: 0:7 %3264 =  [] -> 2.112us
     %4295 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3265 =  [] -> 1.728us
     %4296 = :aten::index [[8], [8]] -> 42.048us
       %4297 = :aten::nonzero [[8]] -> 42.048us
         %4298 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3266 =  [] -> 1.248us
         %4299 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %3267 =  [] -> 992.000ns
                 -->kernel: 0:7 %3268 =  [] -> 2.080us
     %4300 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %3269 =  [] -> 1.760us
     %4301 = :aten::index [[8], [8]] -> 42.176us
       %4302 = :aten::nonzero [[8]] -> 42.176us
         %4303 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3270 =  [] -> 1.248us
         %4304 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %3271 =  [] -> 960.000ns
                 -->kernel: 0:7 %3272 =  [] -> 2.112us
     %4305 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3273 =  [] -> 1.728us
     %4306 = :aten::index [[8], [8]] -> 43.776us
       %4307 = :aten::nonzero [[8]] -> 43.776us
         %4308 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3274 =  [] -> 1.248us
         %4309 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %3275 =  [] -> 992.000ns
                 -->kernel: 0:7 %3276 =  [] -> 2.080us
     %4310 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3277 =  [] -> 1.728us
     %4311 = :aten::index [[8], [8]] -> 41.728us
       %4312 = :aten::nonzero [[8]] -> 41.728us
         %4313 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3278 =  [] -> 1.248us
         %4314 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %3279 =  [] -> 960.000ns
                 -->kernel: 0:7 %3280 =  [] -> 2.144us
     %4315 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3281 =  [] -> 1.728us
     %4316 = :aten::index [[8], [8]] -> 42.016us
       %4317 = :aten::nonzero [[8]] -> 42.016us
         %4318 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %3282 =  [] -> 1.216us
         %4319 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3283 =  [] -> 992.000ns
                 -->kernel: 0:7 %3284 =  [] -> 2.080us
     %4320 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3285 =  [] -> 1.728us
     %4321 = :aten::index [[8], [8]] -> 41.856us
       %4322 = :aten::nonzero [[8]] -> 41.856us
         %4323 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3286 =  [] -> 1.248us
         %4324 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3287 =  [] -> 960.000ns
                 -->kernel: 0:7 %3288 =  [] -> 2.080us
     %4325 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %3289 =  [] -> 1.696us
     %4326 = :aten::index [[8], [8]] -> 41.856us
       %4327 = :aten::nonzero [[8]] -> 41.856us
         %4328 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3290 =  [] -> 1.248us
         %4329 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3291 =  [] -> 960.000ns
                 -->kernel: 0:7 %3292 =  [] -> 2.048us
     %4330 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3293 =  [] -> 1.728us
     %4331 = :aten::index [[8], [8]] -> 41.696us
       %4332 = :aten::nonzero [[8]] -> 41.696us
         %4333 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %3294 =  [] -> 1.216us
         %4334 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %3295 =  [] -> 960.000ns
                 -->kernel: 0:7 %3296 =  [] -> 2.112us
     %4335 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3297 =  [] -> 1.728us
     %4336 = :aten::index [[8], [8]] -> 42.400us
       %4337 = :aten::nonzero [[8]] -> 42.400us
         %4338 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3298 =  [] -> 1.248us
         %4339 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3299 =  [] -> 992.000ns
                 -->kernel: 0:7 %3300 =  [] -> 2.080us
     %4340 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3301 =  [] -> 1.728us
     %4341 = :aten::index [[8], [8]] -> 42.400us
       %4342 = :aten::nonzero [[8]] -> 42.400us
         %4343 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3302 =  [] -> 1.248us
         %4344 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %3303 =  [] -> 960.000ns
                 -->kernel: 0:7 %3304 =  [] -> 2.080us
     %4345 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3305 =  [] -> 1.728us
     %4346 = :aten::index [[8], [8]] -> 42.529us
       %4347 = :aten::nonzero [[8]] -> 42.529us
         %4348 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3306 =  [] -> 1.248us
         %4349 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3307 =  [] -> 992.000ns
                 -->kernel: 0:7 %3308 =  [] -> 2.048us
     %4350 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3309 =  [] -> 1.728us
     %4351 = :aten::index [[8], [8]] -> 42.240us
       %4352 = :aten::nonzero [[8]] -> 42.240us
         %4353 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3310 =  [] -> 1.248us
         %4354 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %3311 =  [] -> 960.000ns
                 -->kernel: 0:7 %3312 =  [] -> 2.112us
     %4355 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3313 =  [] -> 1.728us
     %4356 = :aten::index [[8], [8]] -> 42.848us
       %4357 = :aten::nonzero [[8]] -> 42.848us
         %4358 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3314 =  [] -> 1.248us
         %4359 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3315 =  [] -> 992.000ns
                 -->kernel: 0:7 %3316 =  [] -> 2.080us
     %4360 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %3317 =  [] -> 1.760us
     %4361 = :aten::index [[8], [8]] -> 42.560us
       %4362 = :aten::nonzero [[8]] -> 42.560us
         %4363 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3318 =  [] -> 1.248us
         %4364 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3319 =  [] -> 960.000ns
                 -->kernel: 0:7 %3320 =  [] -> 2.112us
     %4365 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %3321 =  [] -> 1.696us
     %4366 = :aten::index [[8], [8]] -> 42.752us
       %4367 = :aten::nonzero [[8]] -> 42.752us
         %4368 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3322 =  [] -> 1.248us
         %4369 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %3323 =  [] -> 992.000ns
                 -->kernel: 0:7 %3324 =  [] -> 2.048us
     %4370 = :aten::zeros [[], [], [], [], []] -> 1.152us
       %4371 = :aten::zero_ [[8, 24]] -> 1.152us
         %4372 = :aten::fill_ [[8, 24], []] -> 1.152us
                 -->kernel: 0:7 %3325 =  [] -> 1.152us
     %4373 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.552us
       %4374 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.552us
         %4375 = :nccl:_all_gather_base [[24]] -> 7.552us
           %4376 = NCCL:ncclAllGather [] -> 7.552us
                 -->kernel: 0:7 %3326 =  [] -> 7.552us
     %4377 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %3327 =  [] -> 1.376us
     %4378 = :aten::index [[8], [8]] -> 47.393us
       %4379 = :aten::nonzero [[8]] -> 47.393us
         %4380 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3328 =  [] -> 1.440us
         %4381 = CCCL:cub::DeviceSelect::Flagged [] -> 12.512us
                 -->kernel: 0:7 %3329 =  [] -> 1.312us
                 -->kernel: 0:7 %3330 =  [] -> 1.920us
     %4382 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %3331 =  [] -> 1.440us
     %4383 = :aten::index [[8], [8]] -> 43.840us
       %4384 = :aten::nonzero [[8]] -> 43.840us
         %4385 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3332 =  [] -> 1.504us
         %4386 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %3333 =  [] -> 1.344us
                 -->kernel: 0:7 %3334 =  [] -> 1.888us
     %4387 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3335 =  [] -> 1.408us
     %4388 = :aten::index [[8], [8]] -> 42.400us
       %4389 = :aten::nonzero [[8]] -> 42.400us
         %4390 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %3336 =  [] -> 1.536us
         %4391 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %3337 =  [] -> 1.344us
                 -->kernel: 0:7 %3338 =  [] -> 1.888us
     %4392 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %3339 =  [] -> 1.440us
     %4393 = :aten::index [[8], [8]] -> 43.297us
       %4394 = :aten::nonzero [[8]] -> 43.297us
         %4395 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3340 =  [] -> 1.504us
         %4396 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %3341 =  [] -> 1.344us
                 -->kernel: 0:7 %3342 =  [] -> 1.888us
     %4397 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3343 =  [] -> 1.408us
     %4398 = :aten::index [[8], [8]] -> 42.304us
       %4399 = :aten::nonzero [[8]] -> 42.304us
         %4400 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3344 =  [] -> 1.504us
         %4401 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3345 =  [] -> 1.344us
                 -->kernel: 0:7 %3346 =  [] -> 1.888us
     %4402 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %3347 =  [] -> 1.440us
     %4403 = :aten::index [[8], [8]] -> 43.168us
       %4404 = :aten::nonzero [[8]] -> 43.168us
         %4405 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %3348 =  [] -> 1.472us
         %4406 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %3349 =  [] -> 1.376us
                 -->kernel: 0:7 %3350 =  [] -> 1.888us
     %4407 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3351 =  [] -> 1.408us
     %4408 = :aten::index [[8], [8]] -> 43.264us
       %4409 = :aten::nonzero [[8]] -> 43.264us
         %4410 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %3352 =  [] -> 1.536us
         %4411 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %3353 =  [] -> 1.312us
                 -->kernel: 0:7 %3354 =  [] -> 1.920us
     %4412 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %3355 =  [] -> 1.440us
     %4413 = :aten::index [[8], [8]] -> 48.512us
       %4414 = :aten::nonzero [[8]] -> 48.512us
         %4415 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3356 =  [] -> 1.504us
         %4416 = CCCL:cub::DeviceSelect::Flagged [] -> 17.952us
                 -->kernel: 0:7 %3357 =  [] -> 1.376us
                 -->kernel: 0:7 %3358 =  [] -> 1.856us
     %4417 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %3359 =  [] -> 1.376us
     %4418 = :aten::index [[8], [8]] -> 44.448us
       %4419 = :aten::nonzero [[8]] -> 44.448us
         %4420 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %3360 =  [] -> 1.536us
         %4421 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %3361 =  [] -> 1.312us
                 -->kernel: 0:7 %3362 =  [] -> 1.888us
     %4422 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3363 =  [] -> 1.408us
     %4423 = :aten::index [[8], [8]] -> 42.624us
       %4424 = :aten::nonzero [[8]] -> 42.624us
         %4425 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3364 =  [] -> 1.504us
         %4426 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %3365 =  [] -> 1.376us
                 -->kernel: 0:7 %3366 =  [] -> 1.888us
     %4427 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3367 =  [] -> 1.408us
     %4428 = :aten::index [[8], [8]] -> 43.232us
       %4429 = :aten::nonzero [[8]] -> 43.232us
         %4430 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3368 =  [] -> 1.504us
         %4431 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %3369 =  [] -> 1.344us
                 -->kernel: 0:7 %3370 =  [] -> 1.888us
     %4432 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3371 =  [] -> 1.408us
     %4433 = :aten::index [[8], [8]] -> 43.232us
       %4434 = :aten::nonzero [[8]] -> 43.232us
         %4435 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3372 =  [] -> 1.504us
         %4436 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %3373 =  [] -> 1.344us
                 -->kernel: 0:7 %3374 =  [] -> 1.856us
     %4437 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3375 =  [] -> 1.408us
     %4438 = :aten::index [[8], [8]] -> 43.648us
       %4439 = :aten::nonzero [[8]] -> 43.648us
         %4440 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3376 =  [] -> 1.504us
         %4441 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %3377 =  [] -> 1.312us
                 -->kernel: 0:7 %3378 =  [] -> 1.888us
     %4442 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %3379 =  [] -> 1.440us
     %4443 = :aten::index [[8], [8]] -> 43.552us
       %4444 = :aten::nonzero [[8]] -> 43.552us
         %4445 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3380 =  [] -> 1.504us
         %4446 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %3381 =  [] -> 1.344us
                 -->kernel: 0:7 %3382 =  [] -> 1.856us
     %4447 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3383 =  [] -> 1.408us
     %4448 = :aten::index [[8], [8]] -> 42.944us
       %4449 = :aten::nonzero [[8]] -> 42.944us
         %4450 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3384 =  [] -> 1.504us
         %4451 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %3385 =  [] -> 1.312us
                 -->kernel: 0:7 %3386 =  [] -> 1.888us
     %4452 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %3387 =  [] -> 1.440us
     %4453 = :aten::index [[8], [8]] -> 43.776us
       %4454 = :aten::nonzero [[8]] -> 43.776us
         %4455 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %3388 =  [] -> 1.472us
         %4456 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %3389 =  [] -> 1.344us
                 -->kernel: 0:7 %3390 =  [] -> 1.856us
     %4457 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3391 =  [] -> 1.408us
     %4458 = :aten::index [[8], [8]] -> 43.424us
       %4459 = :aten::nonzero [[8]] -> 43.424us
         %4460 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %3392 =  [] -> 1.536us
         %4461 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %3393 =  [] -> 1.312us
                 -->kernel: 0:7 %3394 =  [] -> 1.888us
     %4462 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3395 =  [] -> 1.408us
     %4463 = :aten::index [[8], [8]] -> 42.688us
       %4464 = :aten::nonzero [[8]] -> 42.688us
         %4465 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %3396 =  [] -> 1.472us
         %4466 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %3397 =  [] -> 1.344us
                 -->kernel: 0:7 %3398 =  [] -> 1.856us
     %4467 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3399 =  [] -> 1.408us
     %4468 = :aten::index [[8], [8]] -> 44.448us
       %4469 = :aten::nonzero [[8]] -> 44.448us
         %4470 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3400 =  [] -> 1.504us
         %4471 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %3401 =  [] -> 1.312us
                 -->kernel: 0:7 %3402 =  [] -> 1.888us
     %4472 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %3403 =  [] -> 1.440us
     %4473 = :aten::index [[8], [8]] -> 42.944us
       %4474 = :aten::nonzero [[8]] -> 42.944us
         %4475 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %3404 =  [] -> 1.472us
         %4476 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %3405 =  [] -> 1.344us
                 -->kernel: 0:7 %3406 =  [] -> 1.888us
     %4477 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3407 =  [] -> 1.408us
     %4478 = :aten::index [[8], [8]] -> 43.392us
       %4479 = :aten::nonzero [[8]] -> 43.392us
         %4480 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %3408 =  [] -> 1.536us
         %4481 = CCCL:cub::DeviceSelect::Flagged [] -> 12.384us
                 -->kernel: 0:7 %3409 =  [] -> 1.344us
                 -->kernel: 0:7 %3410 =  [] -> 1.888us
     %4482 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3411 =  [] -> 1.408us
     %4483 = :aten::index [[8], [8]] -> 43.744us
       %4484 = :aten::nonzero [[8]] -> 43.744us
         %4485 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3412 =  [] -> 1.504us
         %4486 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3413 =  [] -> 1.344us
                 -->kernel: 0:7 %3414 =  [] -> 1.856us
     %4487 = :aten::gt [[8], []] -> 1.409us
                 -->kernel: 0:7 %3415 =  [] -> 1.409us
     %4488 = :aten::index [[8], [8]] -> 43.456us
       %4489 = :aten::nonzero [[8]] -> 43.456us
         %4490 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3416 =  [] -> 1.504us
         %4491 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %3417 =  [] -> 1.312us
                 -->kernel: 0:7 %3418 =  [] -> 1.856us
     %4492 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3419 =  [] -> 1.408us
     %4493 = :aten::index [[8], [8]] -> 43.392us
       %4494 = :aten::nonzero [[8]] -> 43.392us
         %4495 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3420 =  [] -> 1.504us
         %4496 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %3421 =  [] -> 1.376us
                 -->kernel: 0:7 %3422 =  [] -> 1.888us
     %4497 = :aten::zero_ [[3002413056]] -> 1.801ms
       %4498 = :aten::fill_ [[3002413056], []] -> 1.801ms
                 -->kernel: 0:7 %3423 =  [] -> 441.473us
                 -->kernel: 0:7 %3424 =  [] -> 441.473us
                 -->kernel: 0:7 %3425 =  [] -> 441.633us
                 -->kernel: 0:7 %3426 =  [] -> 441.697us
     %4499 = :aten::zero_ [[352321536]] -> 207.905us
       %4500 = :aten::fill_ [[352321536], []] -> 207.905us
                 -->kernel: 0:7 %3427 =  [] -> 207.905us
     %4501 = :aten::zeros [[], [], [], [], []] -> 1.312us
       %4502 = :aten::zero_ [[]] -> 1.312us
         %4503 = :aten::fill_ [[], []] -> 1.312us
                 -->kernel: 0:7 %3428 =  [] -> 1.312us
     %4504 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.552us
       %4505 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.552us
         %4506 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.552us
     %4507 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.296us
       %4508 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.296us
         %4509 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.296us
     %4510 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 1.504us
       %4511 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 1.504us
         %4512 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.504us
     %4513 = :aten::to [[1, 1, 4096, 4096], [], [], [], [], [], [], []] -> 293.825us
       %4514 = :aten::_to_copy [[1, 1, 4096, 4096], [], [], [], [], [], []] -> 293.825us
         %4515 = :aten::copy_ [[1, 1, 4096, 4096], [1, 1, 4096, 4096], []] -> 293.825us
     %4516 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.264us
       %4517 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.264us
         %4518 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.264us
     %4519 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 269.761us
       %4520 = :aten::index_select [[129280, 7168], [], [4096]] -> 269.761us
                 -->kernel: 0:7 %3429 =  [] -> 269.761us
     %4521 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 127.745us
       %4522 = :nvte_rmsnorm_fwd [] -> 127.745us
                 -->kernel: 0:7 %3430 =  [] -> 127.745us
     %4523 = :TELinear forward [] -> 668.962us
       %4524 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 668.962us
         %4525 = :nvte_quantize_v2 [] -> 73.537us
           %4526 = :quantize_transpose_vector_blockwise [] -> 73.537us
                 -->kernel: 0:7 %3431 =  [] -> 73.537us
         %4527 = :nvte_quantize_v2 [] -> 20.800us
           %4528 = :quantize_transpose_square_blockwise [] -> 20.800us
                 -->kernel: 0:7 %3432 =  [] -> 20.800us
         %4529 = :nvte_cublas_gemm_scaled [] -> 339.681us
                 -->kernel: 0:7 %3433 =  [] -> 329.697us
     %4530 = :TELinear forward [] -> 424.577us
       %4531 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 424.577us
         %4532 = :nvte_quantize_v2 [] -> 73.792us
           %4533 = :quantize_transpose_vector_blockwise [] -> 73.792us
                 -->kernel: 0:7 %3434 =  [] -> 73.792us
         %4534 = :nvte_quantize_v2 [] -> 11.648us
           %4535 = :quantize_transpose_square_blockwise [] -> 11.648us
                 -->kernel: 0:7 %3435 =  [] -> 11.648us
         %4536 = :nvte_cublas_gemm_scaled [] -> 204.833us
                 -->kernel: 0:7 %3436 =  [] -> 197.441us
     %4537 = :TELayerNormColumnParallelLinear forward [] -> 1.388ms
       %4538 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.388ms
         %4539 = :nvte_rmsnorm_fwd [] -> 29.568us
                 -->kernel: 0:7 %3437 =  [] -> 29.568us
         %4540 = :nvte_quantize_v2 [] -> 17.120us
           %4541 = :quantize_transpose_vector_blockwise [] -> 17.120us
                 -->kernel: 0:7 %3438 =  [] -> 17.120us
         %4542 = :nvte_quantize_v2 [] -> 58.624us
           %4543 = :quantize_transpose_square_blockwise [] -> 58.624us
                 -->kernel: 0:7 %3439 =  [] -> 58.624us
         %4544 = :nvte_cublas_gemm_scaled [] -> 1.135ms
                 -->kernel: 0:7 %3440 =  [] -> 1.128ms
     %4545 = :TELayerNormColumnParallelLinear forward [] -> 941.603us
       %4546 = :aten::contiguous [[4096, 1, 512], []] -> 11.616us
         %4547 = :aten::clone [[4096, 1, 512], []] -> 11.616us
           %4548 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.616us
                 -->kernel: 0:7 %3441 =  [] -> 11.616us
       %4549 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 711.042us
         %4550 = :nvte_rmsnorm_fwd [] -> 4.256us
                 -->kernel: 0:7 %3442 =  [] -> 4.256us
         %4551 = :nvte_quantize_v2 [] -> 7.744us
           %4552 = :quantize_transpose_vector_blockwise [] -> 7.744us
                 -->kernel: 0:7 %3443 =  [] -> 7.744us
         %4553 = :nvte_quantize_v2 [] -> 28.352us
           %4554 = :quantize_transpose_square_blockwise [] -> 28.352us
                 -->kernel: 0:7 %3444 =  [] -> 28.352us
         %4555 = :nvte_cublas_gemm_scaled [] -> 524.002us
                 -->kernel: 0:7 %3445 =  [] -> 517.506us
     %4556 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.432us
                 -->kernel: 0:7 %3446 =  [] -> 114.432us
     %4557 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 173.537us
                 -->kernel: 0:7 %3447 =  [] -> 173.537us
     %4558 = :TEDotProductAttention forward [] -> 22.526ms
       %4559 = :aten::arange [[], [], [], [], []] -> 1.152us
         %4560 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %3448 =  [] -> 1.152us
       %4561 = :aten::arange [[], [], [], [], []] -> 1.152us
         %4562 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %3449 =  [] -> 1.152us
       %4563 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 61.184us
                 -->kernel: 0:7 %3450 =  [] -> 61.184us
       %4564 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 39.520us
                 -->kernel: 0:7 %3451 =  [] -> 39.520us
       %4565 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.336us
                 -->kernel: 0:7 %3452 =  [] -> 38.336us
       %4566 = :aten::le [[1, 1, 4096, 4096], []] -> 28.352us
                 -->kernel: 0:7 %3453 =  [] -> 28.352us
       %4567 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.576us
                 -->kernel: 0:7 %3454 =  [] -> 24.576us
       %4568 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.304us
                 -->kernel: 0:7 %3455 =  [] -> 14.304us
       %4569 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.848us
         %4570 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.848us
                 -->kernel: 0:7 %3456 =  [] -> 18.848us
       %4571 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.960us
         %4572 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.960us
                 -->kernel: 0:7 %3457 =  [] -> 12.960us
       %4573 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.464us
         %4574 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.464us
                 -->kernel: 0:7 %3458 =  [] -> 18.464us
       %4575 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.835ms
                 -->kernel: 0:7 %3459 =  [] -> 5.825ms
       %4576 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.005ms
         %4577 = :nvte_scaled_masked_softmax_forward [] -> 11.005ms
                 -->kernel: 0:7 %3460 =  [] -> 11.005ms
       %4578 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.988ms
                 -->kernel: 0:7 %3461 =  [] -> 3.976ms
       %4579 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.817us
         %4580 = :aten::clone [[4096, 1, 128, 128], []] -> 278.817us
           %4581 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.817us
                 -->kernel: 0:7 %3462 =  [] -> 278.817us
     %4582 = :TERowParallelLinear forward [] -> 3.867ms
       %4583 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.867ms
         %4584 = :nvte_quantize_v2 [] -> 98.048us
           %4585 = :quantize_transpose_vector_blockwise [] -> 98.048us
                 -->kernel: 0:7 %3463 =  [] -> 98.048us
         %4586 = :nvte_quantize_v2 [] -> 170.784us
           %4587 = :quantize_transpose_square_blockwise [] -> 170.784us
                 -->kernel: 0:7 %3464 =  [] -> 170.784us
         %4588 = :nvte_cublas_gemm_scaled [] -> 3.429ms
                 -->kernel: 0:7 %3465 =  [] -> 3.422ms
     %4589 = :Torch-Compiled Region: 1/2 None -> 43.840us
       %4590 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 43.840us
         %4591 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 43.840us
                 -->kernel: 0:7 %3466 =  [] -> 43.840us
     %4592 = :TELayerNormColumnParallelLinear forward [] -> 8.468ms
       %4593 = :_LayerNormLinear [[4096, 1, 7168], [7168], [], [36864, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 8.468ms
         %4594 = :nvte_rmsnorm_fwd [] -> 126.848us
                 -->kernel: 0:7 %3467 =  [] -> 126.848us
         %4595 = :nvte_quantize_v2 [] -> 73.792us
           %4596 = :quantize_transpose_vector_blockwise [] -> 73.792us
                 -->kernel: 0:7 %3468 =  [] -> 73.792us
         %4597 = :nvte_quantize_v2 [] -> 389.057us
           %4598 = :quantize_transpose_square_blockwise [] -> 389.057us
                 -->kernel: 0:7 %3469 =  [] -> 389.057us
         %4599 = :nvte_cublas_gemm_scaled [] -> 7.726ms
                 -->kernel: 0:7 %3470 =  [] -> 7.720ms
     %4600 = :SwiGLUFunction [[4096, 36864], [], []] -> 129.985us
       %4601 = :Torch-Compiled Region: 2/0 None -> 129.985us
         %4602 = :triton_poi_fused_mul_silu_0 [[4096, 36864], [4096, 18432], [], []] -> 129.985us
                 -->kernel: 0:7 %3471 =  [] -> 129.985us
     %4603 = :TERowParallelLinear forward [] -> 4.373ms
       %4604 = :_Linear [[7168, 18432], [4096, 1, 18432], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 4.373ms
         %4605 = :nvte_quantize_v2 [] -> 183.265us
           %4606 = :quantize_transpose_vector_blockwise [] -> 183.265us
                 -->kernel: 0:7 %3472 =  [] -> 183.265us
         %4607 = :nvte_quantize_v2 [] -> 194.496us
           %4608 = :quantize_transpose_square_blockwise [] -> 194.496us
                 -->kernel: 0:7 %3473 =  [] -> 194.496us
         %4609 = :nvte_cublas_gemm_scaled [] -> 3.856ms
                 -->kernel: 0:7 %3474 =  [] -> 3.849ms
     %4610 = :Torch-Compiled Region: 1/2 None -> 44.864us
       %4611 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.864us
         %4612 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.864us
                 -->kernel: 0:7 %3475 =  [] -> 44.864us
     %4613 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 127.104us
       %4614 = :nvte_rmsnorm_fwd [] -> 127.104us
                 -->kernel: 0:7 %3476 =  [] -> 127.104us
     %4615 = :TELinear forward [] -> 561.569us
       %4616 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 561.569us
         %4617 = :nvte_quantize_v2 [] -> 73.760us
           %4618 = :quantize_transpose_vector_blockwise [] -> 73.760us
                 -->kernel: 0:7 %3477 =  [] -> 73.760us
         %4619 = :nvte_quantize_v2 [] -> 20.577us
           %4620 = :quantize_transpose_square_blockwise [] -> 20.577us
                 -->kernel: 0:7 %3478 =  [] -> 20.577us
         %4621 = :nvte_cublas_gemm_scaled [] -> 337.216us
                 -->kernel: 0:7 %3479 =  [] -> 330.912us
     %4622 = :TELinear forward [] -> 414.593us
       %4623 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 414.593us
         %4624 = :nvte_quantize_v2 [] -> 72.960us
           %4625 = :quantize_transpose_vector_blockwise [] -> 72.960us
                 -->kernel: 0:7 %3480 =  [] -> 72.960us
         %4626 = :nvte_quantize_v2 [] -> 11.584us
           %4627 = :quantize_transpose_square_blockwise [] -> 11.584us
                 -->kernel: 0:7 %3481 =  [] -> 11.584us
         %4628 = :nvte_cublas_gemm_scaled [] -> 204.224us
                 -->kernel: 0:7 %3482 =  [] -> 197.856us
     %4629 = :TELayerNormColumnParallelLinear forward [] -> 1.375ms
       %4630 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.375ms
         %4631 = :nvte_rmsnorm_fwd [] -> 30.368us
                 -->kernel: 0:7 %3483 =  [] -> 30.368us
         %4632 = :nvte_quantize_v2 [] -> 17.184us
           %4633 = :quantize_transpose_vector_blockwise [] -> 17.184us
                 -->kernel: 0:7 %3484 =  [] -> 17.184us
         %4634 = :nvte_quantize_v2 [] -> 58.336us
           %4635 = :quantize_transpose_square_blockwise [] -> 58.336us
                 -->kernel: 0:7 %3485 =  [] -> 58.336us
         %4636 = :nvte_cublas_gemm_scaled [] -> 1.136ms
                 -->kernel: 0:7 %3486 =  [] -> 1.130ms
     %4637 = :TELayerNormColumnParallelLinear forward [] -> 900.162us
       %4638 = :aten::contiguous [[4096, 1, 512], []] -> 11.680us
         %4639 = :aten::clone [[4096, 1, 512], []] -> 11.680us
           %4640 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.680us
                 -->kernel: 0:7 %3487 =  [] -> 11.680us
       %4641 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 696.674us
         %4642 = :nvte_rmsnorm_fwd [] -> 4.224us
                 -->kernel: 0:7 %3488 =  [] -> 4.224us
         %4643 = :nvte_quantize_v2 [] -> 7.712us
           %4644 = :quantize_transpose_vector_blockwise [] -> 7.712us
                 -->kernel: 0:7 %3489 =  [] -> 7.712us
         %4645 = :nvte_quantize_v2 [] -> 28.512us
           %4646 = :quantize_transpose_square_blockwise [] -> 28.512us
                 -->kernel: 0:7 %3490 =  [] -> 28.512us
         %4647 = :nvte_cublas_gemm_scaled [] -> 526.178us
                 -->kernel: 0:7 %3491 =  [] -> 519.618us
     %4648 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.657us
                 -->kernel: 0:7 %3492 =  [] -> 114.657us
     %4649 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 172.833us
                 -->kernel: 0:7 %3493 =  [] -> 172.833us
     %4650 = :TEDotProductAttention forward [] -> 22.459ms
       %4651 = :aten::arange [[], [], [], [], []] -> 1.184us
         %4652 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %3494 =  [] -> 1.184us
       %4653 = :aten::arange [[], [], [], [], []] -> 1.184us
         %4654 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %3495 =  [] -> 1.184us
       %4655 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 61.824us
                 -->kernel: 0:7 %3496 =  [] -> 61.824us
       %4656 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 38.912us
                 -->kernel: 0:7 %3497 =  [] -> 38.912us
       %4657 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.816us
                 -->kernel: 0:7 %3498 =  [] -> 38.816us
       %4658 = :aten::le [[1, 1, 4096, 4096], []] -> 28.256us
                 -->kernel: 0:7 %3499 =  [] -> 28.256us
       %4659 = :aten::lt [[1, 1, 4096, 4096], []] -> 25.760us
                 -->kernel: 0:7 %3500 =  [] -> 25.760us
       %4660 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.496us
                 -->kernel: 0:7 %3501 =  [] -> 14.496us
       %4661 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.008us
         %4662 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.008us
                 -->kernel: 0:7 %3502 =  [] -> 19.008us
       %4663 = :aten::logical_not [[1, 1, 4096, 4096]] -> 13.024us
         %4664 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 13.024us
                 -->kernel: 0:7 %3503 =  [] -> 13.024us
       %4665 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.400us
         %4666 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.400us
                 -->kernel: 0:7 %3504 =  [] -> 18.400us
       %4667 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.834ms
                 -->kernel: 0:7 %3505 =  [] -> 5.826ms
       %4668 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.006ms
         %4669 = :nvte_scaled_masked_softmax_forward [] -> 11.006ms
                 -->kernel: 0:7 %3506 =  [] -> 11.006ms
       %4670 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.992ms
                 -->kernel: 0:7 %3507 =  [] -> 3.979ms
       %4671 = :aten::contiguous [[4096, 1, 128, 128], []] -> 279.104us
         %4672 = :aten::clone [[4096, 1, 128, 128], []] -> 279.104us
           %4673 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 279.104us
                 -->kernel: 0:7 %3508 =  [] -> 279.104us
     %4674 = :TERowParallelLinear forward [] -> 3.837ms
       %4675 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.837ms
         %4676 = :nvte_quantize_v2 [] -> 97.376us
           %4677 = :quantize_transpose_vector_blockwise [] -> 97.376us
                 -->kernel: 0:7 %3509 =  [] -> 97.376us
         %4678 = :nvte_quantize_v2 [] -> 168.288us
           %4679 = :quantize_transpose_square_blockwise [] -> 168.288us
                 -->kernel: 0:7 %3510 =  [] -> 168.288us
         %4680 = :nvte_cublas_gemm_scaled [] -> 3.427ms
                 -->kernel: 0:7 %3511 =  [] -> 3.420ms
     %4681 = :Torch-Compiled Region: 1/2 None -> 44.672us
       %4682 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.672us
         %4683 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.672us
                 -->kernel: 0:7 %3512 =  [] -> 44.672us
     %4684 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.688us
       %4685 = :nvte_rmsnorm_fwd [] -> 126.688us
                 -->kernel: 0:7 %3513 =  [] -> 126.688us
     %4686 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 42.592us
       %4687 = :nvte_cublas_gemm_scaled [] -> 42.592us
                 -->kernel: 0:7 %3514 =  [] -> 22.176us
                 -->kernel: 0:7 %3515 =  [] -> 2.592us
     %4688 = :RandomSTE [[4096, 1, 32]] -> 44.992us
       %4689 = :aten::clone [[4096, 1, 32], []] -> 1.632us
         %4690 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.632us
       %4691 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.736us
                 -->kernel: 0:7 %3516 =  [] -> 4.736us
     %4692 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 70.528us
       %4693 = :nvte_fused_topk_with_score_function_forward [] -> 70.528us
                 -->kernel: 0:7 %3517 =  [] -> 70.528us
     %4694 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 27.264us
       %4695 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 27.264us
                 -->kernel: 0:7 %3518 =  [] -> 27.264us
     %4696 = :aten::sum [[4096, 32], [], [], []] -> 46.848us
       %4697 = :aten::to [[4096, 32], [], [], [], []] -> 4.704us
         %4698 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.704us
           %4699 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.704us
                 -->kernel: 0:7 %3519 =  [] -> 4.704us
                 -->kernel: 0:7 %3520 =  [] -> 10.496us
     %4700 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.160us
       %4701 = :nvte_fused_moe_aux_loss_forward [] -> 12.160us
                 -->kernel: 0:7 %3521 =  [] -> 12.160us
     %4702 = :aten::div [[], []] -> 1.152us
                 -->kernel: 0:7 %3522 =  [] -> 1.152us
     %4703 = :aten::div [[], []] -> 1.408us
                 -->kernel: 0:7 %3523 =  [] -> 1.408us
     %4704 = :aten::add_ [[], [], []] -> 1.536us
                 -->kernel: 0:7 %3524 =  [] -> 1.536us
     %4705 = :aten::sum [[4096, 32], [], [], []] -> 36.800us
       %4706 = :aten::to [[4096, 32], [], [], [], []] -> 4.576us
         %4707 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.576us
           %4708 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.576us
                 -->kernel: 0:7 %3525 =  [] -> 4.576us
                 -->kernel: 0:7 %3526 =  [] -> 7.840us
     %4709 = :aten::add_ [[32], [32], []] -> 4.000us
                 -->kernel: 0:7 %3527 =  [] -> 4.000us
     %4710 = :aten::topk [[4096, 32], [], [], [], []] -> 54.880us
                 -->kernel: 0:7 %3528 =  [] -> 14.144us
                 -->kernel: 0:7 %3529 =  [] -> 7.680us
     %4711 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 1.194ms
                 -->kernel: 0:26 %3530 =  [] -> 43.008us
                 -->kernel: 0:26 %3531 =  [] -> 255.009us
                 -->kernel: 0:26 %3532 =  [] -> 760.930us
     %4712 = :TEColumnParallelLinear forward [] -> 1.136ms
       %4713 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.136ms
         %4714 = :nvte_quantize_v2 [] -> 45.248us
           %4715 = :quantize_transpose_vector_blockwise [] -> 45.248us
                 -->kernel: 0:7 %3533 =  [] -> 45.248us
         %4716 = :nvte_quantize_v2 [] -> 45.344us
           %4717 = :quantize_transpose_square_blockwise [] -> 45.344us
                 -->kernel: 0:7 %3534 =  [] -> 45.344us
         %4718 = :nvte_cublas_gemm_scaled [] -> 915.202us
                 -->kernel: 0:7 %3535 =  [] -> 907.746us
     %4719 = :SwiGLUFunction [[4096, 4096], [], []] -> 27.264us
       %4720 = :Torch-Compiled Region: 2/1 None -> 27.264us
         %4721 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 27.264us
                 -->kernel: 0:7 %3536 =  [] -> 27.264us
     %4722 = :TERowParallelLinear forward [] -> 610.817us
       %4723 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 610.817us
         %4724 = :nvte_quantize_v2 [] -> 22.880us
           %4725 = :quantize_transpose_vector_blockwise [] -> 22.880us
                 -->kernel: 0:7 %3537 =  [] -> 22.880us
         %4726 = :nvte_quantize_v2 [] -> 24.480us
           %4727 = :quantize_transpose_square_blockwise [] -> 24.480us
                 -->kernel: 0:7 %3538 =  [] -> 24.480us
         %4728 = :nvte_cublas_gemm_scaled [] -> 441.761us
                 -->kernel: 0:7 %3539 =  [] -> 435.713us
     %4729 = :IndicesToMultihot [[15870, 8], [15870, 8], []] -> 11.552us
                 -->kernel: 0:7 %3540 =  [] -> 11.552us
     %4730 = :aten::contiguous [[4, 15870], []] -> 2.944us
       %4731 = :aten::clone [[4, 15870], []] -> 2.944us
         %4732 = :aten::copy_ [[4, 15870], [4, 15870], []] -> 2.944us
                 -->kernel: 0:7 %3541 =  [] -> 2.944us
     %4733 = :aten::to [[4, 15870], [], [], [], []] -> 4.960us
       %4734 = :aten::_to_copy [[4, 15870], [], [], [], [], [], []] -> 4.960us
         %4735 = :aten::copy_ [[4, 15870], [4, 15870], []] -> 4.960us
                 -->kernel: 0:7 %3542 =  [] -> 4.960us
                 -->kernel: 0:7 %3543 =  [] -> 22.817us
     %4736 = :_moe_permute_mask_map [[15870, 7168], [15870, 4], [], [15870, 4]] -> 413.281us
                 -->kernel: 0:7 %3544 =  [] -> 2.144us
                 -->kernel: 0:7 %3545 =  [] -> 2.432us
                 -->kernel: 0:7 %3546 =  [] -> 13.216us
                 -->kernel: 0:7 %3547 =  [] -> 203.265us
     %4737 = :TEColumnParallelGroupedLinear forward [] -> 8.401ms
       %4738 = :_GroupedLinear [[33040, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.401ms
         %4739 = :nvte_quantize_v2 [] -> 223.616us
           %4740 = :quantize_transpose_vector_blockwise [] -> 223.616us
                 -->kernel: 0:7 %3548 =  [] -> 223.616us
         %4741 = :nvte_quantize_v2 [] -> 219.329us
           %4742 = :quantize_transpose_vector_blockwise [] -> 219.329us
                 -->kernel: 0:7 %3549 =  [] -> 219.329us
         %4743 = :nvte_quantize_v2 [] -> 223.488us
           %4744 = :quantize_transpose_vector_blockwise [] -> 223.488us
                 -->kernel: 0:7 %3550 =  [] -> 223.488us
         %4745 = :nvte_quantize_v2 [] -> 145.825us
           %4746 = :quantize_transpose_vector_blockwise [] -> 145.825us
                 -->kernel: 0:7 %3551 =  [] -> 145.825us
         %4747 = :nvte_quantize_v2 [] -> 45.792us
           %4748 = :quantize_transpose_square_blockwise [] -> 45.792us
                 -->kernel: 0:7 %3552 =  [] -> 45.792us
         %4749 = :nvte_quantize_v2 [] -> 45.344us
           %4750 = :quantize_transpose_square_blockwise [] -> 45.344us
                 -->kernel: 0:7 %3553 =  [] -> 45.344us
         %4751 = :nvte_quantize_v2 [] -> 45.024us
           %4752 = :quantize_transpose_square_blockwise [] -> 45.024us
                 -->kernel: 0:7 %3554 =  [] -> 45.024us
         %4753 = :nvte_quantize_v2 [] -> 45.984us
           %4754 = :quantize_transpose_square_blockwise [] -> 45.984us
                 -->kernel: 0:7 %3555 =  [] -> 45.984us
         %4755 = :nvte_multi_stream_cublas_gemm [] -> 7.085ms
           %4756 = :nvte_cublas_gemm [] -> 1.759ms
                 -->kernel: 0:159 %3556 =  [] -> 1.750ms
           %4757 = :nvte_cublas_gemm [] -> 1.752ms
                 -->kernel: 0:160 %3557 =  [] -> 1.745ms
           %4758 = :nvte_cublas_gemm [] -> 1.754ms
                 -->kernel: 0:161 %3558 =  [] -> 1.749ms
           %4759 = :nvte_cublas_gemm [] -> 1.753ms
                 -->kernel: 0:162 %3559 =  [] -> 1.749ms
     %4760 = :WeightedSwiGLUFunction [[33040, 4096], [33040, 1], []] -> 120.417us
       %4761 = :Torch-Compiled Region: 3/1 None -> 120.417us
         %4762 = :triton_poi_fused__to_copy_mul_silu_0 [[33040, 4096], [33040, 1], [33040, 2048], [], []] -> 120.417us
                 -->kernel: 0:7 %3560 =  [] -> 120.417us
     %4763 = :TERowParallelGroupedLinear forward [] -> 4.227ms
       %4764 = :_GroupedLinear [[33040, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.227ms
         %4765 = :nvte_quantize_v2 [] -> 68.384us
           %4766 = :quantize_transpose_vector_blockwise [] -> 68.384us
                 -->kernel: 0:7 %3561 =  [] -> 68.384us
         %4767 = :nvte_quantize_v2 [] -> 68.993us
           %4768 = :quantize_transpose_vector_blockwise [] -> 68.993us
                 -->kernel: 0:7 %3562 =  [] -> 68.993us
         %4769 = :nvte_quantize_v2 [] -> 69.568us
           %4770 = :quantize_transpose_vector_blockwise [] -> 69.568us
                 -->kernel: 0:7 %3563 =  [] -> 69.568us
         %4771 = :nvte_quantize_v2 [] -> 45.600us
           %4772 = :quantize_transpose_vector_blockwise [] -> 45.600us
                 -->kernel: 0:7 %3564 =  [] -> 45.600us
         %4773 = :nvte_quantize_v2 [] -> 24.640us
           %4774 = :quantize_transpose_square_blockwise [] -> 24.640us
                 -->kernel: 0:7 %3565 =  [] -> 24.640us
         %4775 = :nvte_quantize_v2 [] -> 23.840us
           %4776 = :quantize_transpose_square_blockwise [] -> 23.840us
                 -->kernel: 0:7 %3566 =  [] -> 23.840us
         %4777 = :nvte_quantize_v2 [] -> 24.384us
           %4778 = :quantize_transpose_square_blockwise [] -> 24.384us
                 -->kernel: 0:7 %3567 =  [] -> 24.384us
         %4779 = :nvte_quantize_v2 [] -> 24.385us
           %4780 = :quantize_transpose_square_blockwise [] -> 24.385us
                 -->kernel: 0:7 %3568 =  [] -> 24.385us
         %4781 = :nvte_multi_stream_cublas_gemm [] -> 3.588ms
           %4782 = :nvte_cublas_gemm [] -> 887.938us
                 -->kernel: 0:159 %3569 =  [] -> 880.578us
           %4783 = :nvte_cublas_gemm [] -> 871.010us
                 -->kernel: 0:160 %3570 =  [] -> 866.626us
           %4784 = :nvte_cublas_gemm [] -> 884.162us
                 -->kernel: 0:161 %3571 =  [] -> 880.770us
           %4785 = :nvte_cublas_gemm [] -> 883.682us
                 -->kernel: 0:162 %3572 =  [] -> 879.778us
     %4786 = :_moe_unpermute_mask_map [[33040, 7168], [15870, 9], [], []] -> 227.808us
                 -->kernel: 0:7 %3573 =  [] -> 227.808us
     %4787 = :FusedCombine [[15870, 7168], [], []] -> 755.394us
                 -->kernel: 0:26 %3574 =  [] -> 13.856us
                 -->kernel: 0:26 %3575 =  [] -> 711.458us
     %4788 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.448us
                 -->kernel: 0:7 %3576 =  [] -> 52.448us
     %4789 = :Torch-Compiled Region: 1/2 None -> 48.288us
       %4790 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 48.288us
         %4791 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 48.288us
                 -->kernel: 0:7 %3577 =  [] -> 48.288us
     %4792 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.016us
       %4793 = :nvte_rmsnorm_fwd [] -> 126.016us
                 -->kernel: 0:7 %3578 =  [] -> 126.016us
     %4794 = :aten::roll [[1, 4096], [], []] -> 2.144us
                 -->kernel: 0:7 %3579 =  [] -> 2.144us
     %4795 = :aten::fill_ [[1], []] -> 1.248us
                 -->kernel: 0:7 %3580 =  [] -> 1.248us
     %4796 = :aten::sum [[1, 4096], []] -> 3.680us
       %4797 = :aten::sum [[1, 4096], [], [], []] -> 3.680us
                 -->kernel: 0:7 %3581 =  [] -> 3.680us
     %4798 = :aten::roll [[1, 4096], [], []] -> 2.080us
                 -->kernel: 0:7 %3582 =  [] -> 2.080us
     %4799 = :aten::fill_ [[1], []] -> 1.280us
                 -->kernel: 0:7 %3583 =  [] -> 1.280us
     %4800 = :aten::sum [[1, 4096], []] -> 3.648us
       %4801 = :aten::sum [[1, 4096], [], [], []] -> 3.648us
                 -->kernel: 0:7 %3584 =  [] -> 3.648us
     %4802 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 268.896us
       %4803 = :aten::index_select [[129280, 7168], [], [4096]] -> 268.896us
                 -->kernel: 0:7 %3585 =  [] -> 268.896us
     %4804 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 128.064us
       %4805 = :nvte_rmsnorm_fwd [] -> 128.064us
                 -->kernel: 0:7 %3586 =  [] -> 128.064us
     %4806 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.848us
       %4807 = :nvte_rmsnorm_fwd [] -> 126.848us
                 -->kernel: 0:7 %3587 =  [] -> 126.848us
     %4808 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 163.297us
                 -->kernel: 0:7 %3588 =  [] -> 163.297us
     %4809 = :TEColumnParallelLinear forward [] -> 3.413ms
       %4810 = :_Linear [[7168, 14336], [4096, 1, 14336], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.413ms
         %4811 = :nvte_quantize_v2 [] -> 144.865us
           %4812 = :quantize_transpose_vector_blockwise [] -> 144.865us
                 -->kernel: 0:7 %3589 =  [] -> 144.865us
         %4813 = :nvte_quantize_v2 [] -> 153.536us
           %4814 = :quantize_transpose_square_blockwise [] -> 153.536us
                 -->kernel: 0:7 %3590 =  [] -> 153.536us
         %4815 = :nvte_cublas_gemm_scaled [] -> 2.983ms
                 -->kernel: 0:7 %3591 =  [] -> 2.975ms
     %4816 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 121.345us
       %4817 = :nvte_rmsnorm_fwd [] -> 121.345us
                 -->kernel: 0:7 %3592 =  [] -> 121.345us
     %4818 = :TELinear forward [] -> 559.489us
       %4819 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 559.489us
         %4820 = :nvte_quantize_v2 [] -> 73.344us
           %4821 = :quantize_transpose_vector_blockwise [] -> 73.344us
                 -->kernel: 0:7 %3593 =  [] -> 73.344us
         %4822 = :nvte_quantize_v2 [] -> 20.353us
           %4823 = :quantize_transpose_square_blockwise [] -> 20.353us
                 -->kernel: 0:7 %3594 =  [] -> 20.353us
         %4824 = :nvte_cublas_gemm_scaled [] -> 333.696us
                 -->kernel: 0:7 %3595 =  [] -> 327.648us
     %4825 = :TELinear forward [] -> 401.057us
       %4826 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 401.057us
         %4827 = :nvte_quantize_v2 [] -> 72.352us
           %4828 = :quantize_transpose_vector_blockwise [] -> 72.352us
                 -->kernel: 0:7 %3596 =  [] -> 72.352us
         %4829 = :nvte_quantize_v2 [] -> 12.480us
           %4830 = :quantize_transpose_square_blockwise [] -> 12.480us
                 -->kernel: 0:7 %3597 =  [] -> 12.480us
         %4831 = :nvte_cublas_gemm_scaled [] -> 203.520us
                 -->kernel: 0:7 %3598 =  [] -> 196.896us
     %4832 = :TELayerNormColumnParallelLinear forward [] -> 1.368ms
       %4833 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.368ms
         %4834 = :nvte_rmsnorm_fwd [] -> 30.784us
                 -->kernel: 0:7 %3599 =  [] -> 30.784us
         %4835 = :nvte_quantize_v2 [] -> 16.992us
           %4836 = :quantize_transpose_vector_blockwise [] -> 16.992us
                 -->kernel: 0:7 %3600 =  [] -> 16.992us
         %4837 = :nvte_quantize_v2 [] -> 57.952us
           %4838 = :quantize_transpose_square_blockwise [] -> 57.952us
                 -->kernel: 0:7 %3601 =  [] -> 57.952us
         %4839 = :nvte_cublas_gemm_scaled [] -> 1.129ms
                 -->kernel: 0:7 %3602 =  [] -> 1.122ms
     %4840 = :TELayerNormColumnParallelLinear forward [] -> 886.562us
       %4841 = :aten::contiguous [[4096, 1, 512], []] -> 11.520us
         %4842 = :aten::clone [[4096, 1, 512], []] -> 11.520us
           %4843 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.520us
                 -->kernel: 0:7 %3603 =  [] -> 11.520us
       %4844 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 691.298us
         %4845 = :nvte_rmsnorm_fwd [] -> 4.256us
                 -->kernel: 0:7 %3604 =  [] -> 4.256us
         %4846 = :nvte_quantize_v2 [] -> 7.712us
           %4847 = :quantize_transpose_vector_blockwise [] -> 7.712us
                 -->kernel: 0:7 %3605 =  [] -> 7.712us
         %4848 = :nvte_quantize_v2 [] -> 28.192us
           %4849 = :quantize_transpose_square_blockwise [] -> 28.192us
                 -->kernel: 0:7 %3606 =  [] -> 28.192us
         %4850 = :nvte_cublas_gemm_scaled [] -> 522.338us
                 -->kernel: 0:7 %3607 =  [] -> 515.554us
     %4851 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 113.857us
                 -->kernel: 0:7 %3608 =  [] -> 113.857us
     %4852 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 173.888us
                 -->kernel: 0:7 %3609 =  [] -> 173.888us
     %4853 = :TEDotProductAttention forward [] -> 22.360ms
       %4854 = :aten::arange [[], [], [], [], []] -> 1.184us
         %4855 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %3610 =  [] -> 1.184us
       %4856 = :aten::arange [[], [], [], [], []] -> 1.120us
         %4857 = :aten::arange [[], [], [], [0]] -> 1.120us
                 -->kernel: 0:7 %3611 =  [] -> 1.120us
       %4858 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 60.960us
                 -->kernel: 0:7 %3612 =  [] -> 60.960us
       %4859 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 39.616us
                 -->kernel: 0:7 %3613 =  [] -> 39.616us
       %4860 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.304us
                 -->kernel: 0:7 %3614 =  [] -> 38.304us
       %4861 = :aten::le [[1, 1, 4096, 4096], []] -> 28.192us
                 -->kernel: 0:7 %3615 =  [] -> 28.192us
       %4862 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.960us
                 -->kernel: 0:7 %3616 =  [] -> 24.960us
       %4863 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.528us
                 -->kernel: 0:7 %3617 =  [] -> 14.528us
       %4864 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.944us
         %4865 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.944us
                 -->kernel: 0:7 %3618 =  [] -> 18.944us
       %4866 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.928us
         %4867 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.928us
                 -->kernel: 0:7 %3619 =  [] -> 12.928us
       %4868 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.624us
         %4869 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.624us
                 -->kernel: 0:7 %3620 =  [] -> 18.624us
       %4870 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.804ms
                 -->kernel: 0:7 %3621 =  [] -> 5.796ms
       %4871 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 10.999ms
         %4872 = :nvte_scaled_masked_softmax_forward [] -> 10.999ms
                 -->kernel: 0:7 %3622 =  [] -> 10.999ms
       %4873 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.980ms
                 -->kernel: 0:7 %3623 =  [] -> 3.967ms
       %4874 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.657us
         %4875 = :aten::clone [[4096, 1, 128, 128], []] -> 278.657us
           %4876 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.657us
                 -->kernel: 0:7 %3624 =  [] -> 278.657us
     %4877 = :TERowParallelLinear forward [] -> 3.819ms
       %4878 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.819ms
         %4879 = :nvte_quantize_v2 [] -> 96.800us
           %4880 = :quantize_transpose_vector_blockwise [] -> 96.800us
                 -->kernel: 0:7 %3625 =  [] -> 96.800us
         %4881 = :nvte_quantize_v2 [] -> 169.536us
           %4882 = :quantize_transpose_square_blockwise [] -> 169.536us
                 -->kernel: 0:7 %3626 =  [] -> 169.536us
         %4883 = :nvte_cublas_gemm_scaled [] -> 3.404ms
                 -->kernel: 0:7 %3627 =  [] -> 3.397ms
     %4884 = :Torch-Compiled Region: 1/2 None -> 44.000us
       %4885 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.000us
         %4886 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.000us
                 -->kernel: 0:7 %3628 =  [] -> 44.000us
     %4887 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 127.040us
       %4888 = :nvte_rmsnorm_fwd [] -> 127.040us
                 -->kernel: 0:7 %3629 =  [] -> 127.040us
     %4889 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 41.568us
       %4890 = :nvte_cublas_gemm_scaled [] -> 41.568us
                 -->kernel: 0:7 %3630 =  [] -> 22.304us
                 -->kernel: 0:7 %3631 =  [] -> 2.560us
     %4891 = :RandomSTE [[4096, 1, 32]] -> 41.664us
       %4892 = :aten::clone [[4096, 1, 32], []] -> 1.600us
         %4893 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.600us
       %4894 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.704us
                 -->kernel: 0:7 %3632 =  [] -> 4.704us
     %4895 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 69.793us
       %4896 = :nvte_fused_topk_with_score_function_forward [] -> 69.793us
                 -->kernel: 0:7 %3633 =  [] -> 69.793us
     %4897 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 27.040us
       %4898 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 27.040us
                 -->kernel: 0:7 %3634 =  [] -> 27.040us
     %4899 = :aten::sum [[4096, 32], [], [], []] -> 47.040us
       %4900 = :aten::to [[4096, 32], [], [], [], []] -> 4.704us
         %4901 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.704us
           %4902 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.704us
                 -->kernel: 0:7 %3635 =  [] -> 4.704us
                 -->kernel: 0:7 %3636 =  [] -> 9.984us
     %4903 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.512us
       %4904 = :nvte_fused_moe_aux_loss_forward [] -> 12.512us
                 -->kernel: 0:7 %3637 =  [] -> 12.512us
     %4905 = :aten::div [[], []] -> 1.408us
                 -->kernel: 0:7 %3638 =  [] -> 1.408us
     %4906 = :aten::div [[], []] -> 1.568us
                 -->kernel: 0:7 %3639 =  [] -> 1.568us
     %4907 = :aten::add_ [[], [], []] -> 1.600us
                 -->kernel: 0:7 %3640 =  [] -> 1.600us
     %4908 = :aten::sum [[4096, 32], [], [], []] -> 36.576us
       %4909 = :aten::to [[4096, 32], [], [], [], []] -> 4.672us
         %4910 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.672us
           %4911 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.672us
                 -->kernel: 0:7 %3641 =  [] -> 4.672us
                 -->kernel: 0:7 %3642 =  [] -> 7.712us
     %4912 = :aten::add_ [[32], [32], []] -> 4.448us
                 -->kernel: 0:7 %3643 =  [] -> 4.448us
     %4913 = :aten::topk [[4096, 32], [], [], [], []] -> 51.488us
                 -->kernel: 0:7 %3644 =  [] -> 14.304us
                 -->kernel: 0:7 %3645 =  [] -> 7.680us
     %4914 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 821.666us
                 -->kernel: 0:26 %3646 =  [] -> 44.640us
                 -->kernel: 0:26 %3647 =  [] -> 12.704us
                 -->kernel: 0:26 %3648 =  [] -> 636.065us
     %4915 = :TEColumnParallelLinear forward [] -> 1.154ms
       %4916 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.154ms
         %4917 = :nvte_quantize_v2 [] -> 45.248us
           %4918 = :quantize_transpose_vector_blockwise [] -> 45.248us
                 -->kernel: 0:7 %3649 =  [] -> 45.248us
         %4919 = :nvte_quantize_v2 [] -> 44.480us
           %4920 = :quantize_transpose_square_blockwise [] -> 44.480us
                 -->kernel: 0:7 %3650 =  [] -> 44.480us
         %4921 = :nvte_cublas_gemm_scaled [] -> 914.562us
                 -->kernel: 0:7 %3651 =  [] -> 907.426us
     %4922 = :SwiGLUFunction [[4096, 4096], [], []] -> 27.008us
       %4923 = :Torch-Compiled Region: 2/1 None -> 27.008us
         %4924 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 27.008us
                 -->kernel: 0:7 %3652 =  [] -> 27.008us
     %4925 = :TERowParallelLinear forward [] -> 603.841us
       %4926 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 603.841us
         %4927 = :nvte_quantize_v2 [] -> 23.072us
           %4928 = :quantize_transpose_vector_blockwise [] -> 23.072us
                 -->kernel: 0:7 %3653 =  [] -> 23.072us
         %4929 = :nvte_quantize_v2 [] -> 24.768us
           %4930 = :quantize_transpose_square_blockwise [] -> 24.768us
                 -->kernel: 0:7 %3654 =  [] -> 24.768us
         %4931 = :nvte_cublas_gemm_scaled [] -> 441.569us
                 -->kernel: 0:7 %3655 =  [] -> 435.969us
     %4932 = :IndicesToMultihot [[15637, 8], [15637, 8], []] -> 11.680us
                 -->kernel: 0:7 %3656 =  [] -> 11.680us
     %4933 = :aten::contiguous [[4, 15637], []] -> 2.944us
       %4934 = :aten::clone [[4, 15637], []] -> 2.944us
         %4935 = :aten::copy_ [[4, 15637], [4, 15637], []] -> 2.944us
                 -->kernel: 0:7 %3657 =  [] -> 2.944us
     %4936 = :aten::to [[4, 15637], [], [], [], []] -> 4.832us
       %4937 = :aten::_to_copy [[4, 15637], [], [], [], [], [], []] -> 4.832us
         %4938 = :aten::copy_ [[4, 15637], [4, 15637], []] -> 4.832us
                 -->kernel: 0:7 %3658 =  [] -> 4.832us
                 -->kernel: 0:7 %3659 =  [] -> 22.784us
     %4939 = :_moe_permute_mask_map [[15637, 7168], [15637, 4], [], [15637, 4]] -> 392.513us
                 -->kernel: 0:7 %3660 =  [] -> 2.336us
                 -->kernel: 0:7 %3661 =  [] -> 2.464us
                 -->kernel: 0:7 %3662 =  [] -> 13.120us
                 -->kernel: 0:7 %3663 =  [] -> 200.673us
     %4940 = :TEColumnParallelGroupedLinear forward [] -> 8.535ms
       %4941 = :_GroupedLinear [[32704, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.535ms
         %4942 = :nvte_quantize_v2 [] -> 219.680us
           %4943 = :quantize_transpose_vector_blockwise [] -> 219.680us
                 -->kernel: 0:7 %3664 =  [] -> 219.680us
         %4944 = :nvte_quantize_v2 [] -> 218.977us
           %4945 = :quantize_transpose_vector_blockwise [] -> 218.977us
                 -->kernel: 0:7 %3665 =  [] -> 218.977us
         %4946 = :nvte_quantize_v2 [] -> 223.072us
           %4947 = :quantize_transpose_vector_blockwise [] -> 223.072us
                 -->kernel: 0:7 %3666 =  [] -> 223.072us
         %4948 = :nvte_quantize_v2 [] -> 220.129us
           %4949 = :quantize_transpose_vector_blockwise [] -> 220.129us
                 -->kernel: 0:7 %3667 =  [] -> 220.129us
         %4950 = :nvte_quantize_v2 [] -> 45.408us
           %4951 = :quantize_transpose_square_blockwise [] -> 45.408us
                 -->kernel: 0:7 %3668 =  [] -> 45.408us
         %4952 = :nvte_quantize_v2 [] -> 45.536us
           %4953 = :quantize_transpose_square_blockwise [] -> 45.536us
                 -->kernel: 0:7 %3669 =  [] -> 45.536us
         %4954 = :nvte_quantize_v2 [] -> 45.856us
           %4955 = :quantize_transpose_square_blockwise [] -> 45.856us
                 -->kernel: 0:7 %3670 =  [] -> 45.856us
         %4956 = :nvte_quantize_v2 [] -> 45.569us
           %4957 = :quantize_transpose_square_blockwise [] -> 45.569us
                 -->kernel: 0:7 %3671 =  [] -> 45.569us
         %4958 = :nvte_multi_stream_cublas_gemm [] -> 7.075ms
           %4959 = :nvte_cublas_gemm [] -> 1.756ms
                 -->kernel: 0:159 %3672 =  [] -> 1.748ms
           %4960 = :nvte_cublas_gemm [] -> 1.748ms
                 -->kernel: 0:160 %3673 =  [] -> 1.744ms
           %4961 = :nvte_cublas_gemm [] -> 1.752ms
                 -->kernel: 0:161 %3674 =  [] -> 1.748ms
           %4962 = :nvte_cublas_gemm [] -> 1.749ms
                 -->kernel: 0:162 %3675 =  [] -> 1.744ms
     %4963 = :WeightedSwiGLUFunction [[32704, 4096], [32704, 1], []] -> 119.456us
       %4964 = :Torch-Compiled Region: 3/1 None -> 119.456us
         %4965 = :triton_poi_fused__to_copy_mul_silu_0 [[32704, 4096], [32704, 1], [32704, 2048], [], []] -> 119.456us
                 -->kernel: 0:7 %3676 =  [] -> 119.456us
     %4966 = :TERowParallelGroupedLinear forward [] -> 4.223ms
       %4967 = :_GroupedLinear [[32704, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.223ms
         %4968 = :nvte_quantize_v2 [] -> 66.176us
           %4969 = :quantize_transpose_vector_blockwise [] -> 66.176us
                 -->kernel: 0:7 %3677 =  [] -> 66.176us
         %4970 = :nvte_quantize_v2 [] -> 67.648us
           %4971 = :quantize_transpose_vector_blockwise [] -> 67.648us
                 -->kernel: 0:7 %3678 =  [] -> 67.648us
         %4972 = :nvte_quantize_v2 [] -> 68.992us
           %4973 = :quantize_transpose_vector_blockwise [] -> 68.992us
                 -->kernel: 0:7 %3679 =  [] -> 68.992us
         %4974 = :nvte_quantize_v2 [] -> 68.864us
           %4975 = :quantize_transpose_vector_blockwise [] -> 68.864us
                 -->kernel: 0:7 %3680 =  [] -> 68.864us
         %4976 = :nvte_quantize_v2 [] -> 24.928us
           %4977 = :quantize_transpose_square_blockwise [] -> 24.928us
                 -->kernel: 0:7 %3681 =  [] -> 24.928us
         %4978 = :nvte_quantize_v2 [] -> 24.384us
           %4979 = :quantize_transpose_square_blockwise [] -> 24.384us
                 -->kernel: 0:7 %3682 =  [] -> 24.384us
         %4980 = :nvte_quantize_v2 [] -> 24.704us
           %4981 = :quantize_transpose_square_blockwise [] -> 24.704us
                 -->kernel: 0:7 %3683 =  [] -> 24.704us
         %4982 = :nvte_quantize_v2 [] -> 24.896us
           %4983 = :quantize_transpose_square_blockwise [] -> 24.896us
                 -->kernel: 0:7 %3684 =  [] -> 24.896us
         %4984 = :nvte_multi_stream_cublas_gemm [] -> 3.559ms
           %4985 = :nvte_cublas_gemm [] -> 873.954us
                 -->kernel: 0:159 %3685 =  [] -> 866.562us
           %4986 = :nvte_cublas_gemm [] -> 870.978us
                 -->kernel: 0:160 %3686 =  [] -> 866.594us
           %4987 = :nvte_cublas_gemm [] -> 883.170us
                 -->kernel: 0:161 %3687 =  [] -> 879.522us
           %4988 = :nvte_cublas_gemm [] -> 870.915us
                 -->kernel: 0:162 %3688 =  [] -> 866.850us
     %4989 = :_moe_unpermute_mask_map [[32704, 7168], [15637, 9], [], []] -> 225.057us
                 -->kernel: 0:7 %3689 =  [] -> 225.057us
     %4990 = :FusedCombine [[15637, 7168], [], []] -> 757.058us
                 -->kernel: 0:26 %3690 =  [] -> 14.048us
                 -->kernel: 0:26 %3691 =  [] -> 716.066us
     %4991 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.320us
                 -->kernel: 0:7 %3692 =  [] -> 52.320us
     %4992 = :Torch-Compiled Region: 1/2 None -> 47.104us
       %4993 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 47.104us
         %4994 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 47.104us
                 -->kernel: 0:7 %3693 =  [] -> 47.104us
     %4995 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.657us
       %4996 = :nvte_rmsnorm_fwd [] -> 126.657us
                 -->kernel: 0:7 %3694 =  [] -> 126.657us
     %4997 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 162.400us
                 -->kernel: 0:7 %3695 =  [] -> 162.400us
     %4998 = :aten::clone [[1, 4096], []] -> 1.568us
       %4999 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.568us
     %5000 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.681ms
       %5001 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.681ms
         %5002 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.681ms
                 -->kernel: 0:7 %3696 =  [] -> 53.670ms
     %5003 = :aten::roll [[1, 4096], [], []] -> 2.080us
                 -->kernel: 0:7 %3697 =  [] -> 2.080us
     %5004 = :aten::fill_ [[1], []] -> 1.056us
                 -->kernel: 0:7 %3698 =  [] -> 1.056us
     %5005 = :aten::sum [[1, 4096], []] -> 3.648us
       %5006 = :aten::sum [[1, 4096], [], [], []] -> 3.648us
                 -->kernel: 0:7 %3699 =  [] -> 3.648us
     %5007 = :aten::roll [[1, 4096], [], []] -> 2.176us
                 -->kernel: 0:7 %3700 =  [] -> 2.176us
     %5008 = :aten::fill_ [[1], []] -> 1.088us
                 -->kernel: 0:7 %3701 =  [] -> 1.088us
     %5009 = :aten::sum [[1, 4096], []] -> 3.072us
       %5010 = :aten::sum [[1, 4096], [], [], []] -> 3.072us
                 -->kernel: 0:7 %3702 =  [] -> 3.072us
     %5011 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.481ms
       %5012 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %5013 = :aten::zero_ [[4096]] -> 1.120us
           %5014 = :aten::fill_ [[4096], []] -> 1.120us
                 -->kernel: 0:7 %3703 =  [] -> 1.120us
       %5015 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %5016 = :aten::zero_ [[12288]] -> 1.120us
           %5017 = :aten::fill_ [[12288], []] -> 1.120us
                 -->kernel: 0:7 %3704 =  [] -> 1.120us
                 -->kernel: 0:7 %3705 =  [] -> 659.650us
                 -->kernel: 0:7 %3706 =  [] -> 600.737us
     %5018 = :aten::mul [[1, 4096], [1, 4096]] -> 1.600us
                 -->kernel: 0:7 %3707 =  [] -> 1.600us
     %5019 = :aten::sum [[1, 4096], []] -> 3.232us
       %5020 = :aten::sum [[1, 4096], [], [], []] -> 3.232us
                 -->kernel: 0:7 %3708 =  [] -> 3.232us
     %5021 = :aten::div [[], []] -> 1.696us
                 -->kernel: 0:7 %3709 =  [] -> 1.696us
     %5022 = :aten::add_ [[], [], []] -> 1.376us
                 -->kernel: 0:7 %3710 =  [] -> 1.376us
     %5023 = :aten::mul [[1, 4096], []] -> 1.280us
                 -->kernel: 0:7 %3711 =  [] -> 1.280us
     %5024 = :aten::div [[1, 4096], []] -> 2.464us
                 -->kernel: 0:7 %3712 =  [] -> 2.464us
     %5025 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.692ms
       %5026 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.692ms
         %5027 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.692ms
                 -->kernel: 0:7 %3713 =  [] -> 53.681ms
     %5028 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.481ms
       %5029 = :aten::zeros [[], [], [], [], []] -> 1.152us
         %5030 = :aten::zero_ [[4096]] -> 1.152us
           %5031 = :aten::fill_ [[4096], []] -> 1.152us
                 -->kernel: 0:7 %3714 =  [] -> 1.152us
       %5032 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %5033 = :aten::zero_ [[12288]] -> 1.120us
           %5034 = :aten::fill_ [[12288], []] -> 1.120us
                 -->kernel: 0:7 %3715 =  [] -> 1.120us
                 -->kernel: 0:7 %3716 =  [] -> 658.689us
                 -->kernel: 0:7 %3717 =  [] -> 600.001us
     %5035 = :aten::mul [[4096], [4096]] -> 1.728us
                 -->kernel: 0:7 %3718 =  [] -> 1.728us
     %5036 = :aten::sum [[4096], []] -> 3.424us
       %5037 = :aten::sum [[4096], [], [], []] -> 3.424us
                 -->kernel: 0:7 %3719 =  [] -> 3.424us
     %5038 = :aten::sum [[4096], []] -> 3.264us
       %5039 = :aten::sum [[4096], [], [], []] -> 3.264us
                 -->kernel: 0:7 %3720 =  [] -> 3.264us
     %5040 = :aten::stack [[], [], []] -> 2.080us
       %5041 = :aten::cat [[1], [1], []] -> 2.080us
                 -->kernel: 0:7 %3721 =  [] -> 2.080us
     %5042 = :aten::isnan [[2]] -> 1.408us
       %5043 = :aten::ne [[2], [2]] -> 1.408us
                 -->kernel: 0:7 %3722 =  [] -> 1.408us
     %5044 = :aten::any [[2]] -> 2.944us
                 -->kernel: 0:7 %3723 =  [] -> 2.944us
     %5045 = :aten::is_nonzero [[]] -> 2.976us
       %5046 = :aten::item [[]] -> 2.976us
         %5047 = :aten::_local_scalar_dense [[]] -> 2.976us
     %5048 = :aten::clone [[], []] -> 1.280us
       %5049 = :aten::copy_ [[], [], []] -> 1.280us
     %5050 = :aten::clone [[], []] -> 1.184us
       %5051 = :aten::copy_ [[], [], []] -> 1.184us
     %5052 = :aten::cat [[1], [1], []] -> 1.600us
                 -->kernel: 0:7 %3724 =  [] -> 1.600us
     %5053 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 108.768us
       %5054 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 108.768us
         %5055 = :nccl:all_reduce [[2]] -> 108.768us
           %5056 = NCCL:ncclAllReduce [] -> 108.768us
                 -->kernel: 0:7 %3725 =  [] -> 108.768us
     %5057 = :aten::div [[2], []] -> 1.344us
                 -->kernel: 0:7 %3726 =  [] -> 1.344us
     %5058 = :aten::div [[], []] -> 1.344us
                 -->kernel: 0:7 %3727 =  [] -> 1.344us
     %5059 = :aten::mul [[], []] -> 1.088us
                 -->kernel: 0:7 %3728 =  [] -> 1.088us
     %5060 = :aten::mul_ [[], []] -> 1.216us
                 -->kernel: 0:7 %3729 =  [] -> 1.216us
     %5061 = :aten::div_ [[], []] -> 1.248us
                 -->kernel: 0:7 %3730 =  [] -> 1.248us
     %5062 = :aten::ones [[], [], [], [], []] -> 896.000ns
       %5063 = :aten::fill_ [[1], []] -> 896.000ns
                 -->kernel: 0:7 %3731 =  [] -> 896.000ns
     %5064 = :aten::mul [[1], [1]] -> 1.344us
                 -->kernel: 0:7 %3732 =  [] -> 1.344us
     %5065 = :aten::div [[1], []] -> 1.376us
                 -->kernel: 0:7 %3733 =  [] -> 1.376us
     %5066 = :aten::copy_ [[1], [1], []] -> 1.184us
     %5067 = :aten::ones [[], [], [], [], []] -> 896.000ns
       %5068 = :aten::fill_ [[1], []] -> 896.000ns
                 -->kernel: 0:7 %3734 =  [] -> 896.000ns
     %5069 = :aten::mul [[1], [1]] -> 1.120us
                 -->kernel: 0:7 %3735 =  [] -> 1.120us
     %5070 = :aten::div [[1], []] -> 1.568us
                 -->kernel: 0:7 %3736 =  [] -> 1.568us
     %5071 = :aten::add_ [[], [], []] -> 1.408us
                 -->kernel: 0:7 %3737 =  [] -> 1.408us
     %5072 = :aten::mul [[1], []] -> 1.120us
                 -->kernel: 0:7 %3738 =  [] -> 1.120us
     %5073 = :aten::ones_like [[1], [], [], [], [], []] -> 960.000ns
       %5074 = :aten::fill_ [[1], []] -> 960.000ns
                 -->kernel: 0:7 %3739 =  [] -> 960.000ns
     %5075 = :autograd::engine::evaluate_function: MulBackward0 None -> 105.633us
       %5076 = :MulBackward0 [[1]] -> 1.312us
         %5077 = :aten::mul [[1], [1]] -> 1.312us
                 -->kernel: 0:7 %3740 =  [] -> 1.312us
       %5078 = :aten::sum [[1], []] -> 3.072us
         %5079 = :aten::sum [[1], [], [], []] -> 3.072us
                 -->kernel: 0:7 %3741 =  [] -> 3.072us
     %5080 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.376us
       %5081 = :DivBackward0 [[]] -> 1.376us
         %5082 = :aten::div [[], []] -> 1.376us
                 -->kernel: 0:7 %3742 =  [] -> 1.376us
     %5083 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.152us
       %5084 = :MulBackward0 [[]] -> 1.152us
         %5085 = :aten::mul [[], []] -> 1.152us
                 -->kernel: 0:7 %3743 =  [] -> 1.152us
     %5086 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.312us
       %5087 = :MulBackward0 [[]] -> 1.312us
         %5088 = :aten::mul [[], []] -> 1.312us
                 -->kernel: 0:7 %3744 =  [] -> 1.312us
     %5089 = :autograd::engine::evaluate_function: SelectBackward0 None -> 62.528us
       %5090 = :SelectBackward0 [[]] -> 62.528us
         %5091 = :aten::select_backward [[], [], [], []] -> 62.528us
           %5092 = :aten::zeros [[], [], [], [], []] -> 1.184us
             %5093 = :aten::zero_ [[2]] -> 1.184us
               %5094 = :aten::fill_ [[2], []] -> 1.184us
                 -->kernel: 0:7 %3745 =  [] -> 1.184us
           %5095 = :aten::copy_ [[], [], []] -> 1.024us
     %5096 = :autograd::engine::evaluate_function: MulBackward0 None -> 2.176us
       %5097 = :MulBackward0 [[4096]] -> 2.176us
         %5098 = :aten::mul [[4096], [4096]] -> 2.176us
                 -->kernel: 0:7 %3746 =  [] -> 2.176us
     %5099 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 771.746us
       %5100 = :CrossEntropyFunctionBackward [[4096, 1]] -> 771.746us
         %5101 = :aten::to [[], [], [], [], [], []] -> 832.000ns
           %5102 = :aten::_to_copy [[], [], [], [], [], [], []] -> 832.000ns
             %5103 = :aten::copy_ [[], [], []] -> 832.000ns
                 -->kernel: 0:7 %3747 =  [] -> 598.530us
     %5104 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 109.136ms
       %5105 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.136ms
         %5106 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.582ms
           %5107 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.582ms
                 -->kernel: 0:7 %3748 =  [] -> 55.571ms
                 -->kernel: 0:7 %3749 =  [] -> 53.316ms
     %5108 = :autograd::engine::evaluate_function: MTPLossAutoScalerBackward None -> 70.720us
       %5109 = :MTPLossAutoScalerBackward [[4096, 1, 7168]] -> 70.720us
         %5110 = :aten::ones_like [[1, 4096], [], [], [], [], []] -> 1.152us
           %5111 = :aten::fill_ [[1, 4096], []] -> 1.152us
                 -->kernel: 0:7 %3750 =  [] -> 1.152us
         %5112 = :aten::mul [[1, 4096], [1]] -> 2.080us
                 -->kernel: 0:7 %3751 =  [] -> 2.080us
     %5113 = :autograd::engine::evaluate_function: DivBackward0 None -> 2.304us
       %5114 = :DivBackward0 [[1, 4096]] -> 2.304us
         %5115 = :aten::div [[1, 4096], []] -> 2.304us
                 -->kernel: 0:7 %3752 =  [] -> 2.304us
     %5116 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.376us
       %5117 = :MulBackward0 [[1, 4096]] -> 1.376us
         %5118 = :aten::mul [[1, 4096], []] -> 1.376us
                 -->kernel: 0:7 %3753 =  [] -> 1.376us
     %5119 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.504us
       %5120 = :MulBackward0 [[1, 4096]] -> 1.504us
         %5121 = :aten::mul [[1, 4096], [1, 4096]] -> 1.504us
                 -->kernel: 0:7 %3754 =  [] -> 1.504us
     %5122 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 754.626us
       %5123 = :CrossEntropyFunctionBackward [[4096, 1]] -> 754.626us
         %5124 = :aten::to [[], [], [], [], [], []] -> 896.000ns
           %5125 = :aten::_to_copy [[], [], [], [], [], [], []] -> 896.000ns
             %5126 = :aten::copy_ [[], [], []] -> 896.000ns
                 -->kernel: 0:7 %3755 =  [] -> 592.802us
     %5127 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 110.952ms
       %5128 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.500ms
         %5129 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.782ms
           %5130 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.782ms
                 -->kernel: 0:7 %3756 =  [] -> 55.771ms
                 -->kernel: 0:7 %3757 =  [] -> 53.484ms
       %5131 = :aten::add [[129280, 7168], [129280, 7168], []] -> 1.158ms
                 -->kernel: 0:35 %3758 =  [] -> 1.158ms
     %5132 = :autograd::engine::evaluate_function: SplitBackward0 None -> 163.329us
       %5133 = :SplitBackward0 [[4096, 1, 7168], [4096, 1, 7168]] -> 163.329us
         %5134 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 163.329us
                 -->kernel: 0:7 %3759 =  [] -> 163.329us
     %5135 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 206.657us
       %5136 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 206.657us
         %5137 = :nvte_rmsnorm_bwd [] -> 206.657us
                 -->kernel: 0:7 %3760 =  [] -> 168.961us
                 -->kernel: 0:7 %3761 =  [] -> 7.904us
     %5138 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.952us
       %5139 = :aten::add_ [[7168], [7168], []] -> 1.952us
                 -->kernel: 0:35 %3762 =  [] -> 1.952us
     %5140 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 964.834us
       %5141 = :FusedCombineBackward [[4096, 7168], []] -> 964.834us
                 -->kernel: 0:26 %3763 =  [] -> 123.264us
                 -->kernel: 0:26 %3764 =  [] -> 780.321us
     %5142 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 199.041us
       %5143 = :_moe_unpermute_mask_mapBackward [[15637, 7168]] -> 199.041us
                 -->kernel: 0:7 %3765 =  [] -> 199.041us
     %5144 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.634ms
       %5145 = :_GroupedLinearBackward [[32704, 7168]] -> 8.634ms
         %5146 = :_GroupedLinear_backward [] -> 8.634ms
           %5147 = :nvte_quantize_v2 [] -> 219.905us
             %5148 = :quantize_transpose_vector_blockwise [] -> 219.905us
                 -->kernel: 0:7 %3766 =  [] -> 219.905us
           %5149 = :nvte_quantize_v2 [] -> 218.817us
             %5150 = :quantize_transpose_vector_blockwise [] -> 218.817us
                 -->kernel: 0:7 %3767 =  [] -> 218.817us
           %5151 = :nvte_quantize_v2 [] -> 223.296us
             %5152 = :quantize_transpose_vector_blockwise [] -> 223.296us
                 -->kernel: 0:7 %3768 =  [] -> 223.296us
           %5153 = :nvte_quantize_v2 [] -> 219.713us
             %5154 = :quantize_transpose_vector_blockwise [] -> 219.713us
                 -->kernel: 0:7 %3769 =  [] -> 219.713us
           %5155 = :nvte_multi_stream_cublas_gemm [] -> 3.724ms
             %5156 = :nvte_cublas_gemm [] -> 919.842us
                 -->kernel: 0:159 %3770 =  [] -> 908.546us
             %5157 = :nvte_cublas_gemm [] -> 913.475us
                 -->kernel: 0:160 %3771 =  [] -> 907.747us
             %5158 = :nvte_cublas_gemm [] -> 913.442us
                 -->kernel: 0:161 %3772 =  [] -> 908.834us
             %5159 = :nvte_cublas_gemm [] -> 912.258us
                 -->kernel: 0:162 %3773 =  [] -> 907.362us
           %5160 = :nvte_multi_stream_cublas_gemm [] -> 3.666ms
             %5161 = :nvte_cublas_gemm [] -> 901.346us
                 -->kernel: 0:159 %3774 =  [] -> 892.514us
             %5162 = :nvte_cublas_gemm [] -> 895.651us
                 -->kernel: 0:160 %3775 =  [] -> 891.267us
             %5163 = :nvte_cublas_gemm [] -> 909.858us
                 -->kernel: 0:161 %3776 =  [] -> 905.474us
             %5164 = :nvte_cublas_gemm [] -> 895.490us
                 -->kernel: 0:162 %3777 =  [] -> 892.226us
     %5165 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 590.466us
       %5166 = :WeightedSwiGLUFunctionBackward [[32704, 2048]] -> 590.466us
         %5167 = :Torch-Compiled Region: 4/1 None -> 590.466us
           %5168 = :triton_poi_fused__to_copy_cat_0 [[32704, 2048], [32704, 1], [32704, 4096], [32704, 4096], [], []] -> 400.769us
                 -->kernel: 0:7 %3778 =  [] -> 400.769us
           %5169 = :triton_red_fused__to_copy_mul_silu_sum_1 [[32704, 4096], [32704, 2048], [32704, 1], [], [], [], []] -> 129.505us
                 -->kernel: 0:7 %3779 =  [] -> 129.505us
     %5170 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.759ms
       %5171 = :_GroupedLinearBackward [[32704, 4096]] -> 14.759ms
         %5172 = :_GroupedLinear_backward [] -> 14.759ms
           %5173 = :nvte_quantize_v2 [] -> 124.577us
             %5174 = :quantize_transpose_vector_blockwise [] -> 124.577us
                 -->kernel: 0:7 %3780 =  [] -> 124.577us
           %5175 = :nvte_quantize_v2 [] -> 128.768us
             %5176 = :quantize_transpose_vector_blockwise [] -> 128.768us
                 -->kernel: 0:7 %3781 =  [] -> 128.768us
           %5177 = :nvte_quantize_v2 [] -> 131.200us
             %5178 = :quantize_transpose_vector_blockwise [] -> 131.200us
                 -->kernel: 0:7 %3782 =  [] -> 131.200us
           %5179 = :nvte_quantize_v2 [] -> 130.017us
             %5180 = :quantize_transpose_vector_blockwise [] -> 130.017us
                 -->kernel: 0:7 %3783 =  [] -> 130.017us
           %5181 = :nvte_multi_stream_cublas_gemm [] -> 7.004ms
             %5182 = :nvte_cublas_gemm [] -> 1.725ms
                 -->kernel: 0:159 %3784 =  [] -> 1.718ms
             %5183 = :nvte_cublas_gemm [] -> 1.723ms
                 -->kernel: 0:160 %3785 =  [] -> 1.718ms
             %5184 = :nvte_cublas_gemm [] -> 1.755ms
                 -->kernel: 0:161 %3786 =  [] -> 1.751ms
             %5185 = :nvte_cublas_gemm [] -> 1.724ms
                 -->kernel: 0:162 %3787 =  [] -> 1.718ms
           %5186 = :nvte_multi_stream_cublas_gemm [] -> 6.959ms
             %5187 = :nvte_cublas_gemm [] -> 1.719ms
                 -->kernel: 0:159 %3788 =  [] -> 1.714ms
             %5188 = :nvte_cublas_gemm [] -> 1.717ms
                 -->kernel: 0:160 %3789 =  [] -> 1.713ms
             %5189 = :nvte_cublas_gemm [] -> 1.741ms
                 -->kernel: 0:161 %3790 =  [] -> 1.737ms
             %5190 = :nvte_cublas_gemm [] -> 1.717ms
                 -->kernel: 0:162 %3791 =  [] -> 1.713ms
     %5191 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 388.737us
       %5192 = :_moe_permute_mask_mapBackward [[32704, 7168], [], [32704]] -> 388.737us
         %5193 = :aten::zeros [[], [], [], [], []] -> 1.280us
           %5194 = :aten::zero_ [[15637, 9]] -> 1.280us
             %5195 = :aten::fill_ [[15637, 9], []] -> 1.280us
                 -->kernel: 0:7 %3792 =  [] -> 1.280us
                 -->kernel: 0:7 %3793 =  [] -> 211.872us
     %5196 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 97.537us
       %5197 = :IndicesToMultihotBackward [[], [15637, 4]] -> 97.537us
         %5198 = :aten::zeros [[], [], [], [], []] -> 1.440us
           %5199 = :aten::zero_ [[15637, 4]] -> 1.440us
             %5200 = :aten::fill_ [[15637, 4], []] -> 1.440us
                 -->kernel: 0:7 %3794 =  [] -> 1.440us
                 -->kernel: 0:7 %3795 =  [] -> 11.328us
     %5201 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.185ms
       %5202 = :_LinearBackward [[4096, 1, 7168]] -> 1.185ms
         %5203 = :_Linear_backward [] -> 1.185ms
           %5204 = :nvte_quantize_v2 [] -> 72.928us
             %5205 = :quantize_transpose_vector_blockwise [] -> 72.928us
                 -->kernel: 0:7 %3796 =  [] -> 72.928us
           %5206 = :nvte_cublas_gemm_scaled [] -> 467.841us
                 -->kernel: 0:7 %3797 =  [] -> 456.865us
           %5207 = :nvte_cublas_gemm_scaled [] -> 453.825us
                 -->kernel: 0:7 %3798 =  [] -> 448.609us
     %5208 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 47.104us
       %5209 = :SwiGLUFunctionBackward [[4096, 2048]] -> 47.104us
         %5210 = :Torch-Compiled Region: 5/0 None -> 47.104us
           %5211 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 47.104us
                 -->kernel: 0:7 %3799 =  [] -> 47.104us
     %5212 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.018ms
       %5213 = :_LinearBackward [[4096, 1, 4096]] -> 2.018ms
         %5214 = :_Linear_backward [] -> 2.018ms
           %5215 = :nvte_quantize_v2 [] -> 44.192us
             %5216 = :quantize_transpose_vector_blockwise [] -> 44.192us
                 -->kernel: 0:7 %3800 =  [] -> 44.192us
           %5217 = :nvte_quantize_v2 [] -> 51.937us
             %5218 = :quantize_transpose_vector_blockwise [] -> 51.937us
                 -->kernel: 0:7 %3801 =  [] -> 51.937us
           %5219 = :nvte_cublas_gemm_scaled [] -> 867.170us
                 -->kernel: 0:7 %3802 =  [] -> 860.962us
           %5220 = :nvte_cublas_gemm_scaled [] -> 867.618us
                 -->kernel: 0:7 %3803 =  [] -> 862.562us
     %5221 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 863.618us
       %5222 = :FusedDispatchBackward [[15637, 7168], [], [15637, 8], [], []] -> 863.618us
         %5223 = :aten::zeros [[], [], [], [], []] -> 1.408us
           %5224 = :aten::zero_ [[15637, 8]] -> 1.408us
             %5225 = :aten::fill_ [[15637, 8], []] -> 1.408us
                 -->kernel: 0:7 %3804 =  [] -> 1.408us
                 -->kernel: 0:26 %3805 =  [] -> 13.664us
                 -->kernel: 0:26 %3806 =  [] -> 682.657us
     %5226 = :autograd::engine::evaluate_function: TopkBackward0 None -> 60.576us
       %5227 = :TopkBackward0 [[4096, 8]] -> 60.576us
         %5228 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 60.576us
           %5229 = :aten::zeros [[], [], [], [], []] -> 960.000ns
             %5230 = :aten::zero_ [[4096, 32]] -> 960.000ns
               %5231 = :aten::fill_ [[4096, 32], []] -> 960.000ns
                 -->kernel: 0:7 %3807 =  [] -> 960.000ns
           %5232 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 8.832us
                 -->kernel: 0:7 %3808 =  [] -> 8.832us
     %5233 = :autograd::engine::evaluate_function: ViewBackward0 None -> 52.576us
       %5234 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.576us
                 -->kernel: 0:7 %3809 =  [] -> 52.576us
     %5235 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 89.217us
       %5236 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 37.376us
         %5237 = :aten::ones_like [[], [], [], [], [], []] -> 1.312us
           %5238 = :aten::fill_ [[], []] -> 1.312us
                 -->kernel: 0:7 %3810 =  [] -> 1.312us
         %5239 = :aten::mul [[], [1]] -> 1.504us
                 -->kernel: 0:7 %3811 =  [] -> 1.504us
       %5240 = :aten::sum [[1], []] -> 2.656us
         %5241 = :aten::sum [[1], [], [], []] -> 2.656us
                 -->kernel: 0:7 %3812 =  [] -> 2.656us
     %5242 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.472us
       %5243 = :DivBackward0 [[]] -> 1.472us
         %5244 = :aten::div [[], []] -> 1.472us
                 -->kernel: 0:7 %3813 =  [] -> 1.472us
     %5245 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.272us
       %5246 = :FusedAuxLossBackward [[]] -> 2.272us
         %5247 = :nvte_fused_moe_aux_loss_backward [] -> 2.272us
                 -->kernel: 0:7 %3814 =  [] -> 2.272us
     %5248 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 62.144us
       %5249 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 62.144us
         %5250 = :aten::zeros [[], [], [], [], []] -> 1.216us
           %5251 = :aten::zero_ [[4096, 32]] -> 1.216us
             %5252 = :aten::fill_ [[4096, 32], []] -> 1.216us
                 -->kernel: 0:7 %3815 =  [] -> 1.216us
         %5253 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.992us
                 -->kernel: 0:7 %3816 =  [] -> 12.992us
     %5254 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 105.249us
       %5255 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 57.280us
         %5256 = :aten::zeros [[], [], [], [], []] -> 1.152us
           %5257 = :aten::zero_ [[4096, 32]] -> 1.152us
             %5258 = :aten::fill_ [[4096, 32], []] -> 1.152us
                 -->kernel: 0:7 %3817 =  [] -> 1.152us
         %5259 = :nvte_fused_topk_with_score_function_backward [] -> 13.728us
                 -->kernel: 0:7 %3818 =  [] -> 13.728us
       %5260 = :aten::add [[4096, 32], [4096, 32], []] -> 1.696us
                 -->kernel: 0:7 %3819 =  [] -> 1.696us
     %5261 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 800.610us
       %5262 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 702.753us
         %5263 = :aten::to [[32, 7168], [], [], [], []] -> 6.336us
           %5264 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.336us
             %5265 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.336us
                 -->kernel: 0:7 %3820 =  [] -> 6.336us
         %5266 = :nvte_cublas_gemm_scaled [] -> 84.192us
                 -->kernel: 0:7 %3821 =  [] -> 68.000us
         %5267 = :aten::to [[4096, 7168], [], [], [], []] -> 176.353us
           %5268 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 176.353us
             %5269 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 176.353us
                 -->kernel: 0:7 %3822 =  [] -> 176.353us
         %5270 = :nvte_cublas_gemm_scaled [] -> 82.176us
                 -->kernel: 0:7 %3823 =  [] -> 82.176us
         %5271 = :aten::to [[4096, 7168], [], [], [], []] -> 43.584us
           %5272 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.584us
             %5273 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.584us
                 -->kernel: 0:7 %3824 =  [] -> 43.584us
         %5274 = :aten::to [[32, 7168], [], [], [], []] -> 2.080us
           %5275 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.080us
             %5276 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.080us
                 -->kernel: 0:7 %3825 =  [] -> 2.080us
       %5277 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.008us
                 -->kernel: 0:7 %3826 =  [] -> 51.008us
     %5278 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.016us
       %5279 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.016us
                 -->kernel: 0:35 %3827 =  [] -> 2.016us
     %5280 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 321.249us
       %5281 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 198.497us
         %5282 = :nvte_rmsnorm_bwd [] -> 198.497us
                 -->kernel: 0:7 %3828 =  [] -> 167.169us
                 -->kernel: 0:7 %3829 =  [] -> 8.096us
       %5283 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.720us
                 -->kernel: 0:7 %3830 =  [] -> 50.720us
     %5284 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.536us
       %5285 = :aten::add_ [[7168], [7168], []] -> 1.536us
                 -->kernel: 0:35 %3831 =  [] -> 1.536us
     %5286 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.282ms
       %5287 = :_LinearBackward [[4096, 1, 7168]] -> 7.282ms
         %5288 = :_Linear_backward [] -> 7.282ms
           %5289 = :nvte_quantize_v2 [] -> 73.376us
             %5290 = :quantize_transpose_vector_blockwise [] -> 73.376us
                 -->kernel: 0:7 %3832 =  [] -> 73.376us
           %5291 = :nvte_quantize_v2 [] -> 110.112us
             %5292 = :quantize_transpose_vector_blockwise [] -> 110.112us
                 -->kernel: 0:7 %3833 =  [] -> 110.112us
           %5293 = :nvte_cublas_gemm_scaled [] -> 3.440ms
                 -->kernel: 0:7 %3834 =  [] -> 3.434ms
           %5294 = :nvte_cublas_gemm_scaled [] -> 3.440ms
                 -->kernel: 0:7 %3835 =  [] -> 3.433ms
     %5295 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.917ms
       %5296 = :BmmBackward0 [[128, 4096, 128]] -> 7.917ms
         %5297 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.982ms
                 -->kernel: 0:7 %3836 =  [] -> 3.970ms
         %5298 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.882ms
                 -->kernel: 0:7 %3837 =  [] -> 3.874ms
     %5299 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.950ms
       %5300 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.950ms
         %5301 = :nvte_scaled_softmax_backward [] -> 6.950ms
                 -->kernel: 0:7 %3838 =  [] -> 6.950ms
     %5302 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.215ms
       %5303 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.215ms
         %5304 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.949ms
                 -->kernel: 0:7 %3839 =  [] -> 5.939ms
         %5305 = :aten::mul [[128, 4096, 192], []] -> 114.816us
           %5306 = :aten::mul [[128, 4096, 192], []] -> 114.816us
                 -->kernel: 0:7 %3840 =  [] -> 114.816us
         %5307 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.874ms
                 -->kernel: 0:7 %3841 =  [] -> 5.867ms
         %5308 = :aten::mul [[128, 192, 4096], []] -> 115.072us
           %5309 = :aten::mul [[128, 192, 4096], []] -> 115.072us
                 -->kernel: 0:7 %3842 =  [] -> 115.072us
     %5310 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.467ms
       %5311 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.467ms
         %5312 = :aten::contiguous [[4096, 1, 128, 192], []] -> 744.802us
           %5313 = :aten::clone [[4096, 1, 128, 192], []] -> 744.802us
             %5314 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 744.802us
                 -->kernel: 0:7 %3843 =  [] -> 744.802us
         %5315 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.576us
           %5316 = :aten::clone [[4096, 1, 128, 128], []] -> 280.576us
             %5317 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.576us
                 -->kernel: 0:7 %3844 =  [] -> 280.576us
                 -->kernel: 0:7 %3845 =  [] -> 172.672us
     %5318 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 649.569us
       %5319 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 649.569us
         %5320 = :aten::contiguous [[4096, 1, 128, 192], []] -> 422.977us
           %5321 = :aten::clone [[4096, 1, 128, 192], []] -> 422.977us
             %5322 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 422.977us
                 -->kernel: 0:7 %3846 =  [] -> 422.977us
                 -->kernel: 0:7 %3847 =  [] -> 118.848us
     %5323 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.735ms
       %5324 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.735ms
         %5325 = :_LayerNormLinear_backward [] -> 1.735ms
           %5326 = :nvte_quantize_v2 [] -> 324.321us
             %5327 = :quantize_transpose_vector_blockwise [] -> 324.321us
                 -->kernel: 0:7 %3848 =  [] -> 324.321us
           %5328 = :nvte_cublas_gemm_scaled [] -> 563.873us
                 -->kernel: 0:7 %3849 =  [] -> 519.265us
                 -->kernel: 0:7 %3850 =  [] -> 18.912us
           %5329 = :nvte_cublas_gemm_scaled [] -> 527.874us
                 -->kernel: 0:7 %3851 =  [] -> 521.570us
           %5330 = :nvte_rmsnorm_bwd [] -> 21.536us
                 -->kernel: 0:7 %3852 =  [] -> 5.920us
                 -->kernel: 0:7 %3853 =  [] -> 3.072us
     %5331 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.080us
       %5332 = :aten::add_ [[512], [512], []] -> 2.080us
                 -->kernel: 0:35 %3854 =  [] -> 2.080us
     %5333 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.792ms
       %5334 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.792ms
         %5335 = :_LayerNormLinear_backward [] -> 2.792ms
           %5336 = :nvte_quantize_v2 [] -> 243.840us
             %5337 = :quantize_transpose_vector_blockwise [] -> 243.840us
                 -->kernel: 0:7 %3855 =  [] -> 243.840us
           %5338 = :nvte_cublas_gemm_scaled [] -> 1.117ms
                 -->kernel: 0:7 %3856 =  [] -> 1.109ms
           %5339 = :nvte_cublas_gemm_scaled [] -> 1.121ms
                 -->kernel: 0:7 %3857 =  [] -> 1.116ms
           %5340 = :nvte_rmsnorm_bwd [] -> 54.976us
                 -->kernel: 0:7 %3858 =  [] -> 23.168us
                 -->kernel: 0:7 %3859 =  [] -> 20.704us
     %5341 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.760us
       %5342 = :aten::add_ [[1536], [1536], []] -> 1.760us
                 -->kernel: 0:35 %3860 =  [] -> 1.760us
     %5343 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.080us
       %5344 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.080us
         %5345 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.080us
                 -->kernel: 0:7 %3861 =  [] -> 10.080us
     %5346 = :autograd::engine::evaluate_function: _LinearBackward None -> 440.577us
       %5347 = :_LinearBackward [[4096, 1, 576]] -> 440.577us
         %5348 = :_Linear_backward [] -> 440.577us
           %5349 = :nvte_quantize_v2 [] -> 14.688us
             %5350 = :quantize_transpose_vector_blockwise [] -> 14.688us
                 -->kernel: 0:7 %3862 =  [] -> 14.688us
           %5351 = :nvte_cublas_gemm_scaled [] -> 147.488us
                 -->kernel: 0:7 %3863 =  [] -> 141.664us
           %5352 = :nvte_cublas_gemm_scaled [] -> 139.296us
                 -->kernel: 0:7 %3864 =  [] -> 133.312us
     %5353 = :autograd::engine::evaluate_function: _LinearBackward None -> 974.626us
       %5354 = :_LinearBackward [[4096, 1, 1536]] -> 817.218us
         %5355 = :_Linear_backward [] -> 817.218us
           %5356 = :nvte_quantize_v2 [] -> 18.368us
             %5357 = :quantize_transpose_vector_blockwise [] -> 18.368us
                 -->kernel: 0:7 %3865 =  [] -> 18.368us
           %5358 = :nvte_cublas_gemm_scaled [] -> 335.713us
                 -->kernel: 0:7 %3866 =  [] -> 329.697us
           %5359 = :nvte_cublas_gemm_scaled [] -> 341.793us
                 -->kernel: 0:7 %3867 =  [] -> 337.921us
       %5360 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.600us
                 -->kernel: 0:7 %3868 =  [] -> 49.600us
     %5361 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 320.160us
       %5362 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 197.024us
         %5363 = :nvte_rmsnorm_bwd [] -> 197.024us
                 -->kernel: 0:7 %3869 =  [] -> 165.952us
                 -->kernel: 0:7 %3870 =  [] -> 7.808us
       %5364 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 48.928us
                 -->kernel: 0:7 %3871 =  [] -> 48.928us
     %5365 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.664us
       %5366 = :aten::add_ [[7168], [7168], []] -> 1.664us
                 -->kernel: 0:35 %3872 =  [] -> 1.664us
     %5367 = :autograd::engine::evaluate_function: _LinearBackward None -> 6.211ms
       %5368 = :_LinearBackward [[4096, 1, 7168]] -> 6.211ms
         %5369 = :_Linear_backward [] -> 6.211ms
           %5370 = :nvte_quantize_v2 [] -> 73.952us
             %5371 = :quantize_transpose_vector_blockwise [] -> 73.952us
                 -->kernel: 0:7 %3873 =  [] -> 73.952us
           %5372 = :nvte_cublas_gemm_scaled [] -> 2.990ms
                 -->kernel: 0:7 %3874 =  [] -> 2.984ms
           %5373 = :nvte_cublas_gemm_scaled [] -> 3.006ms
                 -->kernel: 0:7 %3875 =  [] -> 3.000ms
     %5374 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 381.569us
       %5375 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 381.569us
         %5376 = :aten::contiguous [[4096, 1, 7168], []] -> 115.073us
           %5377 = :aten::clone [[4096, 1, 7168], []] -> 115.073us
             %5378 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 115.073us
                 -->kernel: 0:7 %3876 =  [] -> 115.073us
         %5379 = :nvte_rmsnorm_bwd [] -> 192.128us
                 -->kernel: 0:7 %3877 =  [] -> 167.392us
                 -->kernel: 0:7 %3878 =  [] -> 7.680us
     %5380 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %5381 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %3879 =  [] -> 1.568us
     %5382 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 377.377us
       %5383 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 377.377us
         %5384 = :aten::contiguous [[4096, 1, 7168], []] -> 116.256us
           %5385 = :aten::clone [[4096, 1, 7168], []] -> 116.256us
             %5386 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 116.256us
                 -->kernel: 0:7 %3880 =  [] -> 116.256us
         %5387 = :nvte_rmsnorm_bwd [] -> 191.233us
                 -->kernel: 0:7 %3881 =  [] -> 166.657us
                 -->kernel: 0:7 %3882 =  [] -> 8.000us
     %5388 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %5389 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %3883 =  [] -> 1.600us
     %5390 = :autograd::engine::evaluate_function: MakeViewlessTensorBackward None -> 50.336us
       %5391 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.336us
                 -->kernel: 0:7 %3884 =  [] -> 50.336us
     %5392 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 1.377ms
       %5393 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.377ms
         %5394 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.377ms
           %5395 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.377ms
             %5396 = :aten::arange [[], [], [], [], []] -> 1.184us
               %5397 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %3885 =  [] -> 1.184us
             %5398 = CCCL:cub::DeviceRadixSort [] -> 186.464us
                 -->kernel: 0:7 %3886 =  [] -> 3.616us
                 -->kernel: 0:7 %3887 =  [] -> 1.568us
                 -->kernel: 0:7 %3888 =  [] -> 7.616us
                 -->kernel: 0:7 %3889 =  [] -> 7.072us
                 -->kernel: 0:7 %3890 =  [] -> 6.976us
                 -->kernel: 0:7 %3891 =  [] -> 7.200us
                 -->kernel: 0:7 %3892 =  [] -> 7.072us
                 -->kernel: 0:7 %3893 =  [] -> 6.880us
                 -->kernel: 0:7 %3894 =  [] -> 6.944us
                 -->kernel: 0:7 %3895 =  [] -> 7.040us
             %5399 = :aten::zeros [[], [], [], [], []] -> 544.673us
               %5400 = :aten::zero_ [[129280, 7168]] -> 544.673us
                 %5401 = :aten::fill_ [[129280, 7168], []] -> 544.673us
                 -->kernel: 0:7 %3896 =  [] -> 544.673us
             %5402 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 17.184us
                 -->kernel: 0:7 %3897 =  [] -> 1.248us
                 -->kernel: 0:7 %3898 =  [] -> 3.968us
                 -->kernel: 0:7 %3899 =  [] -> 1.664us
             %5403 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 18.752us
                 -->kernel: 0:7 %3900 =  [] -> 1.568us
                 -->kernel: 0:7 %3901 =  [] -> 3.072us
                 -->kernel: 0:7 %3902 =  [] -> 1.344us
                 -->kernel: 0:7 %3903 =  [] -> 1.952us
                 -->kernel: 0:7 %3904 =  [] -> 224.064us
                 -->kernel: 0:7 %3905 =  [] -> 166.337us
     %5404 = :autograd::engine::evaluate_function: SplitBackward0 None -> 35.424us
       %5405 = :SplitBackward0 [[4096, 1, 7168]] -> 35.424us
         %5406 = :aten::cat [[4096, 1, 7168], []] -> 35.424us
     %5407 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 194.689us
       %5408 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 194.689us
         %5409 = :nvte_rmsnorm_bwd [] -> 194.689us
                 -->kernel: 0:7 %3906 =  [] -> 167.745us
                 -->kernel: 0:7 %3907 =  [] -> 7.904us
     %5410 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %5411 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %3908 =  [] -> 1.568us
     %5412 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 848.354us
       %5413 = :FusedCombineBackward [[4096, 7168], []] -> 848.354us
                 -->kernel: 0:26 %3909 =  [] -> 8.224us
                 -->kernel: 0:26 %3910 =  [] -> 787.042us
     %5414 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 201.505us
       %5415 = :_moe_unpermute_mask_mapBackward [[15870, 7168]] -> 201.505us
                 -->kernel: 0:7 %3911 =  [] -> 201.505us
     %5416 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.492ms
       %5417 = :_GroupedLinearBackward [[33040, 7168]] -> 8.492ms
         %5418 = :_GroupedLinear_backward [] -> 8.492ms
           %5419 = :nvte_quantize_v2 [] -> 222.336us
             %5420 = :quantize_transpose_vector_blockwise [] -> 222.336us
                 -->kernel: 0:7 %3912 =  [] -> 222.336us
           %5421 = :nvte_quantize_v2 [] -> 218.945us
             %5422 = :quantize_transpose_vector_blockwise [] -> 218.945us
                 -->kernel: 0:7 %3913 =  [] -> 218.945us
           %5423 = :nvte_quantize_v2 [] -> 223.968us
             %5424 = :quantize_transpose_vector_blockwise [] -> 223.968us
                 -->kernel: 0:7 %3914 =  [] -> 223.968us
           %5425 = :nvte_quantize_v2 [] -> 144.353us
             %5426 = :quantize_transpose_vector_blockwise [] -> 144.353us
                 -->kernel: 0:7 %3915 =  [] -> 144.353us
           %5427 = :nvte_multi_stream_cublas_gemm [] -> 3.713ms
             %5428 = :nvte_cublas_gemm [] -> 916.962us
                 -->kernel: 0:159 %3916 =  [] -> 906.978us
             %5429 = :nvte_cublas_gemm [] -> 910.050us
                 -->kernel: 0:160 %3917 =  [] -> 905.186us
             %5430 = :nvte_cublas_gemm [] -> 910.818us
                 -->kernel: 0:161 %3918 =  [] -> 906.594us
             %5431 = :nvte_cublas_gemm [] -> 911.106us
                 -->kernel: 0:162 %3919 =  [] -> 906.082us
           %5432 = :nvte_multi_stream_cublas_gemm [] -> 3.677ms
             %5433 = :nvte_cublas_gemm [] -> 909.570us
                 -->kernel: 0:159 %3920 =  [] -> 903.394us
             %5434 = :nvte_cublas_gemm [] -> 893.858us
                 -->kernel: 0:160 %3921 =  [] -> 889.154us
             %5435 = :nvte_cublas_gemm [] -> 906.818us
                 -->kernel: 0:161 %3922 =  [] -> 903.330us
             %5436 = :nvte_cublas_gemm [] -> 905.667us
                 -->kernel: 0:162 %3923 =  [] -> 902.531us
     %5437 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 596.161us
       %5438 = :WeightedSwiGLUFunctionBackward [[33040, 2048]] -> 596.161us
         %5439 = :Torch-Compiled Region: 4/1 None -> 596.161us
           %5440 = :triton_poi_fused__to_copy_cat_0 [[33040, 2048], [33040, 1], [33040, 4096], [33040, 4096], [], []] -> 405.473us
                 -->kernel: 0:7 %3924 =  [] -> 405.473us
           %5441 = :triton_red_fused__to_copy_mul_silu_sum_1 [[33040, 4096], [33040, 2048], [33040, 1], [], [], [], []] -> 131.712us
                 -->kernel: 0:7 %3925 =  [] -> 131.712us
     %5442 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.754ms
       %5443 = :_GroupedLinearBackward [[33040, 4096]] -> 14.754ms
         %5444 = :_GroupedLinear_backward [] -> 14.754ms
           %5445 = :nvte_quantize_v2 [] -> 126.656us
             %5446 = :quantize_transpose_vector_blockwise [] -> 126.656us
                 -->kernel: 0:7 %3926 =  [] -> 126.656us
           %5447 = :nvte_quantize_v2 [] -> 129.121us
             %5448 = :quantize_transpose_vector_blockwise [] -> 129.121us
                 -->kernel: 0:7 %3927 =  [] -> 129.121us
           %5449 = :nvte_quantize_v2 [] -> 132.608us
             %5450 = :quantize_transpose_vector_blockwise [] -> 132.608us
                 -->kernel: 0:7 %3928 =  [] -> 132.608us
           %5451 = :nvte_quantize_v2 [] -> 85.824us
             %5452 = :quantize_transpose_vector_blockwise [] -> 85.824us
                 -->kernel: 0:7 %3929 =  [] -> 85.824us
           %5453 = :nvte_multi_stream_cublas_gemm [] -> 7.026ms
             %5454 = :nvte_cublas_gemm [] -> 1.752ms
                 -->kernel: 0:159 %3930 =  [] -> 1.745ms
             %5455 = :nvte_cublas_gemm [] -> 1.715ms
                 -->kernel: 0:160 %3931 =  [] -> 1.711ms
             %5456 = :nvte_cublas_gemm [] -> 1.748ms
                 -->kernel: 0:161 %3932 =  [] -> 1.744ms
             %5457 = :nvte_cublas_gemm [] -> 1.748ms
                 -->kernel: 0:162 %3933 =  [] -> 1.744ms
           %5458 = :nvte_multi_stream_cublas_gemm [] -> 6.983ms
             %5459 = :nvte_cublas_gemm [] -> 1.739ms
                 -->kernel: 0:159 %3934 =  [] -> 1.731ms
             %5460 = :nvte_cublas_gemm [] -> 1.710ms
                 -->kernel: 0:160 %3935 =  [] -> 1.706ms
             %5461 = :nvte_cublas_gemm [] -> 1.734ms
                 -->kernel: 0:161 %3936 =  [] -> 1.730ms
             %5462 = :nvte_cublas_gemm [] -> 1.734ms
                 -->kernel: 0:162 %3937 =  [] -> 1.730ms
     %5463 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 385.569us
       %5464 = :_moe_permute_mask_mapBackward [[33040, 7168], [], [33040]] -> 385.569us
         %5465 = :aten::zeros [[], [], [], [], []] -> 1.280us
           %5466 = :aten::zero_ [[15870, 9]] -> 1.280us
             %5467 = :aten::fill_ [[15870, 9], []] -> 1.280us
                 -->kernel: 0:7 %3938 =  [] -> 1.280us
                 -->kernel: 0:7 %3939 =  [] -> 214.145us
     %5468 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 96.320us
       %5469 = :IndicesToMultihotBackward [[], [15870, 4]] -> 96.320us
         %5470 = :aten::zeros [[], [], [], [], []] -> 1.408us
           %5471 = :aten::zero_ [[15870, 4]] -> 1.408us
             %5472 = :aten::fill_ [[15870, 4], []] -> 1.408us
                 -->kernel: 0:7 %3940 =  [] -> 1.408us
                 -->kernel: 0:7 %3941 =  [] -> 11.392us
     %5473 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.156ms
       %5474 = :_LinearBackward [[4096, 1, 7168]] -> 1.156ms
         %5475 = :_Linear_backward [] -> 1.156ms
           %5476 = :nvte_quantize_v2 [] -> 72.736us
             %5477 = :quantize_transpose_vector_blockwise [] -> 72.736us
                 -->kernel: 0:7 %3942 =  [] -> 72.736us
           %5478 = :nvte_cublas_gemm_scaled [] -> 467.009us
                 -->kernel: 0:7 %3943 =  [] -> 458.881us
           %5479 = :nvte_cublas_gemm_scaled [] -> 455.393us
                 -->kernel: 0:7 %3944 =  [] -> 450.049us
     %5480 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 47.168us
       %5481 = :SwiGLUFunctionBackward [[4096, 2048]] -> 47.168us
         %5482 = :Torch-Compiled Region: 5/0 None -> 47.168us
           %5483 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 47.168us
                 -->kernel: 0:7 %3945 =  [] -> 47.168us
     %5484 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.016ms
       %5485 = :_LinearBackward [[4096, 1, 4096]] -> 2.016ms
         %5486 = :_Linear_backward [] -> 2.016ms
           %5487 = :nvte_quantize_v2 [] -> 44.448us
             %5488 = :quantize_transpose_vector_blockwise [] -> 44.448us
                 -->kernel: 0:7 %3946 =  [] -> 44.448us
           %5489 = :nvte_quantize_v2 [] -> 52.864us
             %5490 = :quantize_transpose_vector_blockwise [] -> 52.864us
                 -->kernel: 0:7 %3947 =  [] -> 52.864us
           %5491 = :nvte_cublas_gemm_scaled [] -> 866.114us
                 -->kernel: 0:7 %3948 =  [] -> 860.034us
           %5492 = :nvte_cublas_gemm_scaled [] -> 866.114us
                 -->kernel: 0:7 %3949 =  [] -> 860.066us
     %5493 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 889.986us
       %5494 = :FusedDispatchBackward [[15870, 7168], [], [15870, 8], [], []] -> 889.986us
         %5495 = :aten::zeros [[], [], [], [], []] -> 1.472us
           %5496 = :aten::zero_ [[15870, 8]] -> 1.472us
             %5497 = :aten::fill_ [[15870, 8], []] -> 1.472us
                 -->kernel: 0:7 %3950 =  [] -> 1.472us
                 -->kernel: 0:26 %3951 =  [] -> 13.664us
                 -->kernel: 0:26 %3952 =  [] -> 703.714us
     %5498 = :autograd::engine::evaluate_function: TopkBackward0 None -> 57.376us
       %5499 = :TopkBackward0 [[4096, 8]] -> 57.376us
         %5500 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 57.376us
           %5501 = :aten::zeros [[], [], [], [], []] -> 960.000ns
             %5502 = :aten::zero_ [[4096, 32]] -> 960.000ns
               %5503 = :aten::fill_ [[4096, 32], []] -> 960.000ns
                 -->kernel: 0:7 %3953 =  [] -> 960.000ns
           %5504 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 9.312us
                 -->kernel: 0:7 %3954 =  [] -> 9.312us
     %5505 = :autograd::engine::evaluate_function: ViewBackward0 None -> 53.152us
       %5506 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 53.152us
                 -->kernel: 0:7 %3955 =  [] -> 53.152us
     %5507 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 87.552us
       %5508 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 35.840us
         %5509 = :aten::ones_like [[], [], [], [], [], []] -> 1.216us
           %5510 = :aten::fill_ [[], []] -> 1.216us
                 -->kernel: 0:7 %3956 =  [] -> 1.216us
         %5511 = :aten::mul [[], [1]] -> 1.472us
                 -->kernel: 0:7 %3957 =  [] -> 1.472us
       %5512 = :aten::sum [[1], []] -> 2.432us
         %5513 = :aten::sum [[1], [], [], []] -> 2.432us
                 -->kernel: 0:7 %3958 =  [] -> 2.432us
     %5514 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.408us
       %5515 = :DivBackward0 [[]] -> 1.408us
         %5516 = :aten::div [[], []] -> 1.408us
                 -->kernel: 0:7 %3959 =  [] -> 1.408us
     %5517 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.176us
       %5518 = :FusedAuxLossBackward [[]] -> 2.176us
         %5519 = :nvte_fused_moe_aux_loss_backward [] -> 2.176us
                 -->kernel: 0:7 %3960 =  [] -> 2.176us
     %5520 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 69.504us
       %5521 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 69.504us
         %5522 = :aten::zeros [[], [], [], [], []] -> 1.216us
           %5523 = :aten::zero_ [[4096, 32]] -> 1.216us
             %5524 = :aten::fill_ [[4096, 32], []] -> 1.216us
                 -->kernel: 0:7 %3961 =  [] -> 1.216us
         %5525 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.864us
                 -->kernel: 0:7 %3962 =  [] -> 12.864us
     %5526 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 97.088us
       %5527 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 55.488us
         %5528 = :aten::zeros [[], [], [], [], []] -> 1.152us
           %5529 = :aten::zero_ [[4096, 32]] -> 1.152us
             %5530 = :aten::fill_ [[4096, 32], []] -> 1.152us
                 -->kernel: 0:7 %3963 =  [] -> 1.152us
         %5531 = :nvte_fused_topk_with_score_function_backward [] -> 13.664us
                 -->kernel: 0:7 %3964 =  [] -> 13.664us
       %5532 = :aten::add [[4096, 32], [4096, 32], []] -> 1.632us
                 -->kernel: 0:7 %3965 =  [] -> 1.632us
     %5533 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 810.754us
       %5534 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 711.810us
         %5535 = :aten::to [[32, 7168], [], [], [], []] -> 6.432us
           %5536 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.432us
             %5537 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.432us
                 -->kernel: 0:7 %3966 =  [] -> 6.432us
         %5538 = :nvte_cublas_gemm_scaled [] -> 83.424us
                 -->kernel: 0:7 %3967 =  [] -> 67.840us
         %5539 = :aten::to [[4096, 7168], [], [], [], []] -> 176.768us
           %5540 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 176.768us
             %5541 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 176.768us
                 -->kernel: 0:7 %3968 =  [] -> 176.768us
         %5542 = :nvte_cublas_gemm_scaled [] -> 82.433us
                 -->kernel: 0:7 %3969 =  [] -> 82.433us
         %5543 = :aten::to [[4096, 7168], [], [], [], []] -> 43.680us
           %5544 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.680us
             %5545 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.680us
                 -->kernel: 0:7 %3970 =  [] -> 43.680us
         %5546 = :aten::to [[32, 7168], [], [], [], []] -> 2.144us
           %5547 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.144us
             %5548 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.144us
                 -->kernel: 0:7 %3971 =  [] -> 2.144us
       %5549 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.888us
                 -->kernel: 0:7 %3972 =  [] -> 49.888us
     %5550 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.144us
       %5551 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.144us
                 -->kernel: 0:35 %3973 =  [] -> 2.144us
     %5552 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 336.289us
       %5553 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 201.504us
         %5554 = :nvte_rmsnorm_bwd [] -> 201.504us
                 -->kernel: 0:7 %3974 =  [] -> 166.976us
                 -->kernel: 0:7 %3975 =  [] -> 7.776us
       %5555 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.073us
                 -->kernel: 0:7 %3976 =  [] -> 51.073us
     %5556 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.536us
       %5557 = :aten::add_ [[7168], [7168], []] -> 1.536us
                 -->kernel: 0:35 %3977 =  [] -> 1.536us
     %5558 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.248ms
       %5559 = :_LinearBackward [[4096, 1, 7168]] -> 7.248ms
         %5560 = :_Linear_backward [] -> 7.248ms
           %5561 = :nvte_quantize_v2 [] -> 73.760us
             %5562 = :quantize_transpose_vector_blockwise [] -> 73.760us
                 -->kernel: 0:7 %3978 =  [] -> 73.760us
           %5563 = :nvte_quantize_v2 [] -> 110.240us
             %5564 = :quantize_transpose_vector_blockwise [] -> 110.240us
                 -->kernel: 0:7 %3979 =  [] -> 110.240us
           %5565 = :nvte_cublas_gemm_scaled [] -> 3.435ms
                 -->kernel: 0:7 %3980 =  [] -> 3.428ms
           %5566 = :nvte_cublas_gemm_scaled [] -> 3.428ms
                 -->kernel: 0:7 %3981 =  [] -> 3.422ms
     %5567 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.904ms
       %5568 = :BmmBackward0 [[128, 4096, 128]] -> 7.904ms
         %5569 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.975ms
                 -->kernel: 0:7 %3982 =  [] -> 3.964ms
         %5570 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.872ms
                 -->kernel: 0:7 %3983 =  [] -> 3.863ms
     %5571 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 7.015ms
       %5572 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 7.015ms
         %5573 = :nvte_scaled_softmax_backward [] -> 7.015ms
                 -->kernel: 0:7 %3984 =  [] -> 7.015ms
     %5574 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.206ms
       %5575 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.206ms
         %5576 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.936ms
                 -->kernel: 0:7 %3985 =  [] -> 5.927ms
         %5577 = :aten::mul [[128, 4096, 192], []] -> 114.881us
           %5578 = :aten::mul [[128, 4096, 192], []] -> 114.881us
                 -->kernel: 0:7 %3986 =  [] -> 114.881us
         %5579 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.862ms
                 -->kernel: 0:7 %3987 =  [] -> 5.856ms
         %5580 = :aten::mul [[128, 192, 4096], []] -> 114.976us
           %5581 = :aten::mul [[128, 192, 4096], []] -> 114.976us
                 -->kernel: 0:7 %3988 =  [] -> 114.976us
     %5582 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.471ms
       %5583 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.471ms
         %5584 = :aten::contiguous [[4096, 1, 128, 192], []] -> 745.089us
           %5585 = :aten::clone [[4096, 1, 128, 192], []] -> 745.089us
             %5586 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 745.089us
                 -->kernel: 0:7 %3989 =  [] -> 745.089us
         %5587 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.929us
           %5588 = :aten::clone [[4096, 1, 128, 128], []] -> 280.929us
             %5589 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.929us
                 -->kernel: 0:7 %3990 =  [] -> 280.929us
                 -->kernel: 0:7 %3991 =  [] -> 172.480us
     %5590 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 640.642us
       %5591 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 640.642us
         %5592 = :aten::contiguous [[4096, 1, 128, 192], []] -> 422.945us
           %5593 = :aten::clone [[4096, 1, 128, 192], []] -> 422.945us
             %5594 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 422.945us
                 -->kernel: 0:7 %3992 =  [] -> 422.945us
                 -->kernel: 0:7 %3993 =  [] -> 118.976us
     %5595 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.742ms
       %5596 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.742ms
         %5597 = :_LayerNormLinear_backward [] -> 1.742ms
           %5598 = :nvte_quantize_v2 [] -> 324.129us
             %5599 = :quantize_transpose_vector_blockwise [] -> 324.129us
                 -->kernel: 0:7 %3994 =  [] -> 324.129us
           %5600 = :nvte_cublas_gemm_scaled [] -> 567.618us
                 -->kernel: 0:7 %3995 =  [] -> 520.962us
                 -->kernel: 0:7 %3996 =  [] -> 19.136us
           %5601 = :nvte_cublas_gemm_scaled [] -> 527.489us
                 -->kernel: 0:7 %3997 =  [] -> 521.537us
           %5602 = :nvte_rmsnorm_bwd [] -> 21.632us
                 -->kernel: 0:7 %3998 =  [] -> 6.656us
                 -->kernel: 0:7 %3999 =  [] -> 3.136us
     %5603 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.984us
       %5604 = :aten::add_ [[512], [512], []] -> 1.984us
                 -->kernel: 0:35 %4000 =  [] -> 1.984us
     %5605 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.789ms
       %5606 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.789ms
         %5607 = :_LayerNormLinear_backward [] -> 2.789ms
           %5608 = :nvte_quantize_v2 [] -> 244.257us
             %5609 = :quantize_transpose_vector_blockwise [] -> 244.257us
                 -->kernel: 0:7 %4001 =  [] -> 244.257us
           %5610 = :nvte_cublas_gemm_scaled [] -> 1.120ms
                 -->kernel: 0:7 %4002 =  [] -> 1.113ms
           %5611 = :nvte_cublas_gemm_scaled [] -> 1.122ms
                 -->kernel: 0:7 %4003 =  [] -> 1.116ms
           %5612 = :nvte_rmsnorm_bwd [] -> 56.128us
                 -->kernel: 0:7 %4004 =  [] -> 23.168us
                 -->kernel: 0:7 %4005 =  [] -> 20.352us
     %5613 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.632us
       %5614 = :aten::add_ [[1536], [1536], []] -> 1.632us
                 -->kernel: 0:35 %4006 =  [] -> 1.632us
     %5615 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.016us
       %5616 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.016us
         %5617 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.016us
                 -->kernel: 0:7 %4007 =  [] -> 10.016us
     %5618 = :autograd::engine::evaluate_function: _LinearBackward None -> 439.777us
       %5619 = :_LinearBackward [[4096, 1, 576]] -> 439.777us
         %5620 = :_Linear_backward [] -> 439.777us
           %5621 = :nvte_quantize_v2 [] -> 14.400us
             %5622 = :quantize_transpose_vector_blockwise [] -> 14.400us
                 -->kernel: 0:7 %4008 =  [] -> 14.400us
           %5623 = :nvte_cublas_gemm_scaled [] -> 148.000us
                 -->kernel: 0:7 %4009 =  [] -> 141.056us
           %5624 = :nvte_cublas_gemm_scaled [] -> 139.456us
                 -->kernel: 0:7 %4010 =  [] -> 133.504us
     %5625 = :autograd::engine::evaluate_function: _LinearBackward None -> 983.651us
       %5626 = :_LinearBackward [[4096, 1, 1536]] -> 822.786us
         %5627 = :_Linear_backward [] -> 822.786us
           %5628 = :nvte_quantize_v2 [] -> 18.400us
             %5629 = :quantize_transpose_vector_blockwise [] -> 18.400us
                 -->kernel: 0:7 %4011 =  [] -> 18.400us
           %5630 = :nvte_cublas_gemm_scaled [] -> 336.672us
                 -->kernel: 0:7 %4012 =  [] -> 330.368us
           %5631 = :nvte_cublas_gemm_scaled [] -> 343.584us
                 -->kernel: 0:7 %4013 =  [] -> 338.592us
       %5632 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.728us
                 -->kernel: 0:7 %4014 =  [] -> 49.728us
     %5633 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 319.137us
       %5634 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 194.785us
         %5635 = :nvte_rmsnorm_bwd [] -> 194.785us
                 -->kernel: 0:7 %4015 =  [] -> 165.857us
                 -->kernel: 0:7 %4016 =  [] -> 7.872us
       %5636 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.920us
                 -->kernel: 0:7 %4017 =  [] -> 49.920us
     %5637 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.536us
       %5638 = :aten::add_ [[7168], [7168], []] -> 1.536us
                 -->kernel: 0:35 %4018 =  [] -> 1.536us
     %5639 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.960ms
       %5640 = :_LinearBackward [[4096, 1, 7168]] -> 7.960ms
         %5641 = :_Linear_backward [] -> 7.960ms
           %5642 = :nvte_quantize_v2 [] -> 73.920us
             %5643 = :quantize_transpose_vector_blockwise [] -> 73.920us
                 -->kernel: 0:7 %4019 =  [] -> 73.920us
           %5644 = :nvte_cublas_gemm_scaled [] -> 3.876ms
                 -->kernel: 0:7 %4020 =  [] -> 3.870ms
           %5645 = :nvte_cublas_gemm_scaled [] -> 3.859ms
                 -->kernel: 0:7 %4021 =  [] -> 3.851ms
     %5646 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 844.706us
       %5647 = :SwiGLUFunctionBackward [[4096, 18432]] -> 844.706us
         %5648 = :Torch-Compiled Region: 5/1 None -> 844.706us
           %5649 = :triton_poi_fused_cat_0 [[4096, 18432], [4096, 36864], [4096, 36864], [], [], [], [], []] -> 844.706us
                 -->kernel: 0:7 %4022 =  [] -> 844.706us
     %5650 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 16.381ms
       %5651 = :_LayerNormLinearBackward [[4096, 1, 36864]] -> 16.202ms
         %5652 = :_LayerNormLinear_backward [] -> 16.202ms
           %5653 = :nvte_quantize_v2 [] -> 361.377us
             %5654 = :quantize_transpose_vector_blockwise [] -> 361.377us
                 -->kernel: 0:7 %4023 =  [] -> 361.377us
           %5655 = :nvte_cublas_gemm_scaled [] -> 7.638ms
                 -->kernel: 0:7 %4024 =  [] -> 7.630ms
           %5656 = :nvte_cublas_gemm_scaled [] -> 7.694ms
                 -->kernel: 0:7 %4025 =  [] -> 7.687ms
           %5657 = :nvte_rmsnorm_bwd [] -> 196.448us
                 -->kernel: 0:7 %4026 =  [] -> 163.200us
                 -->kernel: 0:7 %4027 =  [] -> 7.904us
       %5658 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.952us
                 -->kernel: 0:7 %4028 =  [] -> 49.952us
     %5659 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.696us
       %5660 = :aten::add_ [[7168], [7168], []] -> 1.696us
                 -->kernel: 0:35 %4029 =  [] -> 1.696us
     %5661 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.274ms
       %5662 = :_LinearBackward [[4096, 1, 7168]] -> 7.274ms
         %5663 = :_Linear_backward [] -> 7.274ms
           %5664 = :nvte_quantize_v2 [] -> 73.824us
             %5665 = :quantize_transpose_vector_blockwise [] -> 73.824us
                 -->kernel: 0:7 %4030 =  [] -> 73.824us
           %5666 = :nvte_quantize_v2 [] -> 110.112us
             %5667 = :quantize_transpose_vector_blockwise [] -> 110.112us
                 -->kernel: 0:7 %4031 =  [] -> 110.112us
           %5668 = :nvte_cublas_gemm_scaled [] -> 3.433ms
                 -->kernel: 0:7 %4032 =  [] -> 3.427ms
           %5669 = :nvte_cublas_gemm_scaled [] -> 3.432ms
                 -->kernel: 0:7 %4033 =  [] -> 3.426ms
     %5670 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.908ms
       %5671 = :BmmBackward0 [[128, 4096, 128]] -> 7.908ms
         %5672 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.978ms
                 -->kernel: 0:7 %4034 =  [] -> 3.966ms
         %5673 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.874ms
                 -->kernel: 0:7 %4035 =  [] -> 3.865ms
     %5674 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.963ms
       %5675 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.963ms
         %5676 = :nvte_scaled_softmax_backward [] -> 6.963ms
                 -->kernel: 0:7 %4036 =  [] -> 6.963ms
     %5677 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.187ms
       %5678 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.187ms
         %5679 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.938ms
                 -->kernel: 0:7 %4037 =  [] -> 5.927ms
         %5680 = :aten::mul [[128, 4096, 192], []] -> 114.784us
           %5681 = :aten::mul [[128, 4096, 192], []] -> 114.784us
                 -->kernel: 0:7 %4038 =  [] -> 114.784us
         %5682 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.863ms
                 -->kernel: 0:7 %4039 =  [] -> 5.856ms
         %5683 = :aten::mul [[128, 192, 4096], []] -> 114.944us
           %5684 = :aten::mul [[128, 192, 4096], []] -> 114.944us
                 -->kernel: 0:7 %4040 =  [] -> 114.944us
     %5685 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.486ms
       %5686 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.486ms
         %5687 = :aten::contiguous [[4096, 1, 128, 192], []] -> 744.610us
           %5688 = :aten::clone [[4096, 1, 128, 192], []] -> 744.610us
             %5689 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 744.610us
                 -->kernel: 0:7 %4041 =  [] -> 744.610us
         %5690 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.832us
           %5691 = :aten::clone [[4096, 1, 128, 128], []] -> 280.832us
             %5692 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.832us
                 -->kernel: 0:7 %4042 =  [] -> 280.832us
                 -->kernel: 0:7 %4043 =  [] -> 172.800us
     %5693 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 637.249us
       %5694 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 637.249us
         %5695 = :aten::contiguous [[4096, 1, 128, 192], []] -> 422.785us
           %5696 = :aten::clone [[4096, 1, 128, 192], []] -> 422.785us
             %5697 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 422.785us
                 -->kernel: 0:7 %4044 =  [] -> 422.785us
                 -->kernel: 0:7 %4045 =  [] -> 118.464us
     %5698 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.730ms
       %5699 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.730ms
         %5700 = :_LayerNormLinear_backward [] -> 1.730ms
           %5701 = :nvte_quantize_v2 [] -> 323.520us
             %5702 = :quantize_transpose_vector_blockwise [] -> 323.520us
                 -->kernel: 0:7 %4046 =  [] -> 323.520us
           %5703 = :nvte_cublas_gemm_scaled [] -> 565.281us
                 -->kernel: 0:7 %4047 =  [] -> 518.369us
                 -->kernel: 0:7 %4048 =  [] -> 19.008us
           %5704 = :nvte_cublas_gemm_scaled [] -> 527.073us
                 -->kernel: 0:7 %4049 =  [] -> 521.057us
           %5705 = :nvte_rmsnorm_bwd [] -> 21.536us
                 -->kernel: 0:7 %4050 =  [] -> 6.464us
                 -->kernel: 0:7 %4051 =  [] -> 3.168us
     %5706 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.048us
       %5707 = :aten::add_ [[512], [512], []] -> 2.048us
                 -->kernel: 0:35 %4052 =  [] -> 2.048us
     %5708 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.796ms
       %5709 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.796ms
         %5710 = :_LayerNormLinear_backward [] -> 2.796ms
           %5711 = :nvte_quantize_v2 [] -> 244.096us
             %5712 = :quantize_transpose_vector_blockwise [] -> 244.096us
                 -->kernel: 0:7 %4053 =  [] -> 244.096us
           %5713 = :nvte_cublas_gemm_scaled [] -> 1.118ms
                 -->kernel: 0:7 %4054 =  [] -> 1.109ms
           %5714 = :nvte_cublas_gemm_scaled [] -> 1.121ms
                 -->kernel: 0:7 %4055 =  [] -> 1.115ms
           %5715 = :nvte_rmsnorm_bwd [] -> 55.712us
                 -->kernel: 0:7 %4056 =  [] -> 23.200us
                 -->kernel: 0:7 %4057 =  [] -> 20.544us
     %5716 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.888us
       %5717 = :aten::add_ [[1536], [1536], []] -> 1.888us
                 -->kernel: 0:35 %4058 =  [] -> 1.888us
     %5718 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.048us
       %5719 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.048us
         %5720 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.048us
                 -->kernel: 0:7 %4059 =  [] -> 10.048us
     %5721 = :autograd::engine::evaluate_function: _LinearBackward None -> 431.617us
       %5722 = :_LinearBackward [[4096, 1, 576]] -> 431.617us
         %5723 = :_Linear_backward [] -> 431.617us
           %5724 = :nvte_quantize_v2 [] -> 14.752us
             %5725 = :quantize_transpose_vector_blockwise [] -> 14.752us
                 -->kernel: 0:7 %4060 =  [] -> 14.752us
           %5726 = :nvte_cublas_gemm_scaled [] -> 147.649us
                 -->kernel: 0:7 %4061 =  [] -> 141.313us
           %5727 = :nvte_cublas_gemm_scaled [] -> 139.296us
                 -->kernel: 0:7 %4062 =  [] -> 133.536us
     %5728 = :autograd::engine::evaluate_function: _LinearBackward None -> 990.754us
       %5729 = :_LinearBackward [[4096, 1, 1536]] -> 821.282us
         %5730 = :_Linear_backward [] -> 821.282us
           %5731 = :nvte_quantize_v2 [] -> 18.400us
             %5732 = :quantize_transpose_vector_blockwise [] -> 18.400us
                 -->kernel: 0:7 %4063 =  [] -> 18.400us
           %5733 = :nvte_cublas_gemm_scaled [] -> 335.361us
                 -->kernel: 0:7 %4064 =  [] -> 329.377us
           %5734 = :nvte_cublas_gemm_scaled [] -> 343.233us
                 -->kernel: 0:7 %4065 =  [] -> 338.465us
       %5735 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.176us
                 -->kernel: 0:7 %4066 =  [] -> 50.176us
     %5736 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 319.809us
       %5737 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 195.329us
         %5738 = :nvte_rmsnorm_bwd [] -> 195.329us
                 -->kernel: 0:7 %4067 =  [] -> 163.905us
                 -->kernel: 0:7 %4068 =  [] -> 7.840us
       %5739 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.408us
                 -->kernel: 0:7 %4069 =  [] -> 49.408us
     %5740 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.696us
       %5741 = :aten::add_ [[7168], [7168], []] -> 1.696us
                 -->kernel: 0:35 %4070 =  [] -> 1.696us
     %5742 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 2.989ms
       %5743 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.387ms
         %5744 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.387ms
           %5745 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.387ms
             %5746 = :aten::arange [[], [], [], [], []] -> 1.152us
               %5747 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %4071 =  [] -> 1.152us
             %5748 = CCCL:cub::DeviceRadixSort [] -> 189.696us
                 -->kernel: 0:7 %4072 =  [] -> 3.712us
                 -->kernel: 0:7 %4073 =  [] -> 1.568us
                 -->kernel: 0:7 %4074 =  [] -> 7.616us
                 -->kernel: 0:7 %4075 =  [] -> 7.392us
                 -->kernel: 0:7 %4076 =  [] -> 7.264us
                 -->kernel: 0:7 %4077 =  [] -> 6.944us
                 -->kernel: 0:7 %4078 =  [] -> 6.912us
                 -->kernel: 0:7 %4079 =  [] -> 7.008us
                 -->kernel: 0:7 %4080 =  [] -> 7.200us
                 -->kernel: 0:7 %4081 =  [] -> 6.880us
             %5749 = :aten::zeros [[], [], [], [], []] -> 545.058us
               %5750 = :aten::zero_ [[129280, 7168]] -> 545.058us
                 %5751 = :aten::fill_ [[129280, 7168], []] -> 545.058us
                 -->kernel: 0:7 %4082 =  [] -> 545.058us
             %5752 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 19.776us
                 -->kernel: 0:7 %4083 =  [] -> 1.504us
                 -->kernel: 0:7 %4084 =  [] -> 4.224us
                 -->kernel: 0:7 %4085 =  [] -> 1.728us
             %5753 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 17.760us
                 -->kernel: 0:7 %4086 =  [] -> 1.248us
                 -->kernel: 0:7 %4087 =  [] -> 2.848us
                 -->kernel: 0:7 %4088 =  [] -> 1.568us
                 -->kernel: 0:7 %4089 =  [] -> 1.920us
                 -->kernel: 0:7 %4090 =  [] -> 223.201us
                 -->kernel: 0:7 %4091 =  [] -> 165.824us
       %5754 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.555ms
                 -->kernel: 0:35 %4092 =  [] -> 1.555ms
     %5755 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.557ms
       %5756 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.557ms
                 -->kernel: 0:35 %4093 =  [] -> 1.557ms
     %5757 = :aten::linalg_vector_norm [[3002413056], [], [], [], []] -> 2.544ms
                 -->kernel: 0:7 %4094 =  [] -> 615.073us
                 -->kernel: 0:7 %4095 =  [] -> 610.306us
                 -->kernel: 0:7 %4096 =  [] -> 608.545us
                 -->kernel: 0:7 %4097 =  [] -> 609.346us
     %5758 = :aten::isnan [[]] -> 1.920us
       %5759 = :aten::ne [[], []] -> 1.920us
                 -->kernel: 0:7 %4098 =  [] -> 1.920us
     %5760 = :aten::is_nonzero [[]] -> 2.176us
       %5761 = :aten::item [[]] -> 2.176us
         %5762 = :aten::_local_scalar_dense [[]] -> 2.176us
     %5763 = :aten::isinf [[]] -> 39.200us
       %5764 = :aten::abs [[]] -> 1.472us
         %5765 = :aten::abs [[], [0]] -> 1.472us
                 -->kernel: 0:7 %4099 =  [] -> 1.472us
       %5766 = :aten::eq [[], []] -> 1.536us
                 -->kernel: 0:7 %4100 =  [] -> 1.536us
     %5767 = :aten::is_nonzero [[]] -> 2.176us
       %5768 = :aten::item [[]] -> 2.176us
         %5769 = :aten::_local_scalar_dense [[]] -> 2.176us
     %5770 = :aten::mul_ [[3002413056], []] -> 3.551ms
                 -->kernel: 0:7 %4101 =  [] -> 863.426us
                 -->kernel: 0:7 %4102 =  [] -> 901.442us
                 -->kernel: 0:7 %4103 =  [] -> 871.746us
                 -->kernel: 0:7 %4104 =  [] -> 870.658us
     %5771 = :c10d::reduce_scatter_tensor_coalesced_ [[375301632], [3002413056], [], [], [], []] -> 14.493ms
       %5772 = :record_param_comms [[3002413056], [], [], [], [], [], [], [], [], []] -> 14.493ms
         %5773 = :nccl:reduce_scatter_tensor_coalesced [[3002413056]] -> 14.493ms
           %5774 = NCCL:ncclGroupEnd [] -> 14.493ms
                 -->kernel: 0:7 %4105 =  [] -> 14.493ms
     %5775 = :aten::linalg_vector_norm [[352321536], [], [], [], []] -> 305.025us
                 -->kernel: 0:7 %4106 =  [] -> 291.553us
     %5776 = :aten::isnan [[]] -> 1.504us
       %5777 = :aten::ne [[], []] -> 1.504us
                 -->kernel: 0:7 %4107 =  [] -> 1.504us
     %5778 = :aten::is_nonzero [[]] -> 2.176us
       %5779 = :aten::item [[]] -> 2.176us
         %5780 = :aten::_local_scalar_dense [[]] -> 2.176us
     %5781 = :aten::isinf [[]] -> 26.880us
       %5782 = :aten::abs [[]] -> 1.312us
         %5783 = :aten::abs [[], [0]] -> 1.312us
                 -->kernel: 0:7 %4108 =  [] -> 1.312us
       %5784 = :aten::eq [[], []] -> 1.696us
                 -->kernel: 0:7 %4109 =  [] -> 1.696us
     %5785 = :aten::is_nonzero [[]] -> 2.464us
       %5786 = :aten::item [[]] -> 2.464us
         %5787 = :aten::_local_scalar_dense [[]] -> 2.464us
     %5788 = :aten::mul_ [[352321536], []] -> 404.001us
                 -->kernel: 0:7 %4110 =  [] -> 404.001us
     %5789 = :aten::stack [[32], [32], []] -> 1.984us
       %5790 = :aten::cat [[32], [32], []] -> 1.984us
                 -->kernel: 0:7 %4111 =  [] -> 1.984us
     %5791 = :aten::stack [[32], [32], []] -> 1.856us
       %5792 = :aten::cat [[32], [32], []] -> 1.856us
                 -->kernel: 0:7 %4112 =  [] -> 1.856us
     %5793 = :c10d::allreduce_ [[2, 32], [], [], [], [], []] -> 15.488us
       %5794 = :record_param_comms [[2, 32], [], [], [], [], [], [], [], [], []] -> 15.488us
         %5795 = :nccl:all_reduce [[2, 32]] -> 15.488us
           %5796 = NCCL:ncclAllReduce [] -> 15.488us
                 -->kernel: 0:7 %4113 =  [] -> 15.488us
     %5797 = :aten::sum [[2, 32], [], [], []] -> 3.072us
                 -->kernel: 0:7 %4114 =  [] -> 3.072us
     %5798 = :aten::div [[2, 1], []] -> 1.696us
                 -->kernel: 0:7 %4115 =  [] -> 1.696us
     %5799 = :aten::sub [[2, 1], [2, 32], []] -> 2.048us
                 -->kernel: 0:7 %4116 =  [] -> 2.048us
     %5800 = :aten::sign [[2, 32]] -> 1.696us
                 -->kernel: 0:7 %4117 =  [] -> 1.696us
     %5801 = :aten::mul [[2, 32], []] -> 1.504us
                 -->kernel: 0:7 %4118 =  [] -> 1.504us
     %5802 = :aten::add [[2, 32], [2, 32], []] -> 3.008us
                 -->kernel: 0:7 %4119 =  [] -> 3.008us
     %5803 = :aten::zero_ [[32]] -> 992.000ns
       %5804 = :aten::fill_ [[32], []] -> 992.000ns
                 -->kernel: 0:7 %4120 =  [] -> 992.000ns
     %5805 = :aten::copy_ [[32], [32], []] -> 1.184us
     %5806 = :aten::zero_ [[32]] -> 1.152us
       %5807 = :aten::fill_ [[32], []] -> 1.152us
                 -->kernel: 0:7 %4121 =  [] -> 1.152us
     %5808 = :aten::copy_ [[32], [32], []] -> 992.000ns
     %5809 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %5810 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %5811 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %5812 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 8.928us
       %5813 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 8.928us
         %5814 = :nccl:all_reduce [[1]] -> 8.928us
           %5815 = NCCL:ncclAllReduce [] -> 8.928us
                 -->kernel: 0:7 %4122 =  [] -> 8.928us
     %5816 = :aten::item [[1]] -> 2.208us
       %5817 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %5818 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %5819 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %5820 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %5821 = :aten::zeros [[], [], [], [], []] -> 1.216us
       %5822 = :aten::zero_ [[320]] -> 1.216us
         %5823 = :aten::fill_ [[320], []] -> 1.216us
                 -->kernel: 0:7 %4123 =  [] -> 1.216us
     %5824 = :nvte_multi_tensor_l2norm_cuda [] -> 1.395ms
                 -->kernel: 0:7 %4124 =  [] -> 36.032us
                 -->kernel: 0:7 %4125 =  [] -> 33.120us
                 -->kernel: 0:7 %4126 =  [] -> 29.760us
                 -->kernel: 0:7 %4127 =  [] -> 29.888us
                 -->kernel: 0:7 %4128 =  [] -> 30.112us
                 -->kernel: 0:7 %4129 =  [] -> 30.144us
                 -->kernel: 0:7 %4130 =  [] -> 29.760us
                 -->kernel: 0:7 %4131 =  [] -> 30.368us
                 -->kernel: 0:7 %4132 =  [] -> 30.241us
                 -->kernel: 0:7 %4133 =  [] -> 30.112us
                 -->kernel: 0:7 %4134 =  [] -> 29.728us
                 -->kernel: 0:7 %4135 =  [] -> 29.792us
                 -->kernel: 0:7 %4136 =  [] -> 30.240us
                 -->kernel: 0:7 %4137 =  [] -> 29.696us
                 -->kernel: 0:7 %4138 =  [] -> 29.952us
                 -->kernel: 0:7 %4139 =  [] -> 30.208us
                 -->kernel: 0:7 %4140 =  [] -> 29.920us
                 -->kernel: 0:7 %4141 =  [] -> 30.304us
                 -->kernel: 0:7 %4142 =  [] -> 29.697us
                 -->kernel: 0:7 %4143 =  [] -> 29.760us
                 -->kernel: 0:7 %4144 =  [] -> 29.696us
                 -->kernel: 0:7 %4145 =  [] -> 29.664us
                 -->kernel: 0:7 %4146 =  [] -> 30.176us
                 -->kernel: 0:7 %4147 =  [] -> 30.016us
                 -->kernel: 0:7 %4148 =  [] -> 30.400us
                 -->kernel: 0:7 %4149 =  [] -> 29.760us
                 -->kernel: 0:7 %4150 =  [] -> 29.984us
                 -->kernel: 0:7 %4151 =  [] -> 30.528us
                 -->kernel: 0:7 %4152 =  [] -> 29.856us
                 -->kernel: 0:7 %4153 =  [] -> 30.241us
                 -->kernel: 0:7 %4154 =  [] -> 29.728us
                 -->kernel: 0:7 %4155 =  [] -> 29.952us
                 -->kernel: 0:7 %4156 =  [] -> 30.432us
                 -->kernel: 0:7 %4157 =  [] -> 30.112us
                 -->kernel: 0:7 %4158 =  [] -> 17.152us
                 -->kernel: 0:7 %4159 =  [] -> 1.984us
     %5825 = :aten::pow [[1], []] -> 1.696us
                 -->kernel: 0:7 %4160 =  [] -> 1.696us
     %5826 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 33.568us
       %5827 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 33.568us
         %5828 = :nccl:all_reduce [[1]] -> 33.568us
           %5829 = NCCL:ncclAllReduce [] -> 33.568us
                 -->kernel: 0:7 %4161 =  [] -> 33.568us
     %5830 = :aten::item [[1]] -> 2.240us
       %5831 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %5832 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %5833 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %5834 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %5835 = :nvte_multi_tensor_scale_cuda [] -> 934.370us
                 -->kernel: 0:7 %4162 =  [] -> 35.872us
                 -->kernel: 0:7 %4163 =  [] -> 43.264us
                 -->kernel: 0:7 %4164 =  [] -> 43.680us
                 -->kernel: 0:7 %4165 =  [] -> 42.848us
                 -->kernel: 0:7 %4166 =  [] -> 43.584us
                 -->kernel: 0:7 %4167 =  [] -> 43.265us
                 -->kernel: 0:7 %4168 =  [] -> 44.000us
                 -->kernel: 0:7 %4169 =  [] -> 43.200us
                 -->kernel: 0:7 %4170 =  [] -> 44.512us
                 -->kernel: 0:7 %4171 =  [] -> 42.816us
                 -->kernel: 0:7 %4172 =  [] -> 43.552us
                 -->kernel: 0:7 %4173 =  [] -> 43.488us
                 -->kernel: 0:7 %4174 =  [] -> 43.488us
                 -->kernel: 0:7 %4175 =  [] -> 42.848us
                 -->kernel: 0:7 %4176 =  [] -> 42.848us
                 -->kernel: 0:7 %4177 =  [] -> 42.976us
                 -->kernel: 0:7 %4178 =  [] -> 42.880us
                 -->kernel: 0:7 %4179 =  [] -> 29.600us
     %5836 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %5837 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %5838 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %5839 = :nvte_multi_tensor_scale_cuda [] -> 883.298us
                 -->kernel: 0:7 %4180 =  [] -> 43.808us
                 -->kernel: 0:7 %4181 =  [] -> 42.976us
                 -->kernel: 0:7 %4182 =  [] -> 42.848us
                 -->kernel: 0:7 %4183 =  [] -> 43.264us
                 -->kernel: 0:7 %4184 =  [] -> 42.720us
                 -->kernel: 0:7 %4185 =  [] -> 43.264us
                 -->kernel: 0:7 %4186 =  [] -> 42.816us
                 -->kernel: 0:7 %4187 =  [] -> 44.097us
                 -->kernel: 0:7 %4188 =  [] -> 42.752us
                 -->kernel: 0:7 %4189 =  [] -> 44.160us
                 -->kernel: 0:7 %4190 =  [] -> 43.456us
                 -->kernel: 0:7 %4191 =  [] -> 43.936us
                 -->kernel: 0:7 %4192 =  [] -> 42.784us
                 -->kernel: 0:7 %4193 =  [] -> 44.000us
                 -->kernel: 0:7 %4194 =  [] -> 42.912us
                 -->kernel: 0:7 %4195 =  [] -> 43.361us
                 -->kernel: 0:7 %4196 =  [] -> 28.000us
     %5840 = :Optimizer.step#HybridDeviceOptimizer.step None -> 318.560ms
       %5841 = :aten::copy_ [[375301632], [375301632], []] -> 43.906ms
         %5842 = :aten::to [[375301632], [], [], [], []] -> 2.226ms
           %5843 = :aten::_to_copy [[375301632], [], [], [], [], [], []] -> 2.226ms
             %5844 = :aten::copy_ [[375301632], [375301632], []] -> 2.226ms
                 -->kernel: 0:7 %4197 =  [] -> 2.226ms
         %5845 = :aten::copy_ [[375301632], [375301632], []] -> 41.625ms
       %5846 = :Optimizer.step#AdamW.step None -> 72.093ms
         %5847 = :aten::copy_ [[375301632], [375301632], []] -> 72.093ms
           %5848 = :aten::copy_ [[375301632], [375301632], []] -> 71.375ms
           %5849 = :aten::copy_ [[375301632], [375301632], []] -> 604.609us
                 -->kernel: 0:7 %4198 =  [] -> 604.609us
     %5850 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 340.741ms
       %5851 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 340.741ms
         %5852 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 340.741ms
           %5853 = NCCL:ncclGroupEnd [] -> 340.741ms
                 -->kernel: 0:39 %4199 =  [] -> 340.741ms
     %5854 = :Optimizer.step#HybridDeviceOptimizer.step None -> 84.104ms
       %5855 = :aten::to [[14680064], [], [], [], []] -> 88.992us
         %5856 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.992us
           %5857 = :aten::copy_ [[14680064], [14680064], []] -> 88.992us
                 -->kernel: 0:7 %4200 =  [] -> 88.992us
       %5858 = :aten::to [[29360128], [], [], [], []] -> 176.480us
         %5859 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.480us
           %5860 = :aten::copy_ [[29360128], [29360128], []] -> 176.480us
                 -->kernel: 0:7 %4201 =  [] -> 176.480us
       %5861 = :aten::to [[29360128], [], [], [], []] -> 176.513us
         %5862 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.513us
           %5863 = :aten::copy_ [[29360128], [29360128], []] -> 176.513us
                 -->kernel: 0:7 %4202 =  [] -> 176.513us
       %5864 = :aten::to [[29360128], [], [], [], []] -> 176.448us
         %5865 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.448us
           %5866 = :aten::copy_ [[29360128], [29360128], []] -> 176.448us
                 -->kernel: 0:7 %4203 =  [] -> 176.448us
       %5867 = :aten::to [[29360128], [], [], [], []] -> 176.353us
         %5868 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.353us
           %5869 = :aten::copy_ [[29360128], [29360128], []] -> 176.353us
                 -->kernel: 0:7 %4204 =  [] -> 176.353us
       %5870 = :aten::to [[14680064], [], [], [], []] -> 89.216us
         %5871 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.216us
           %5872 = :aten::copy_ [[14680064], [14680064], []] -> 89.216us
                 -->kernel: 0:7 %4205 =  [] -> 89.216us
       %5873 = :aten::to [[14680064], [], [], [], []] -> 89.568us
         %5874 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.568us
           %5875 = :aten::copy_ [[14680064], [14680064], []] -> 89.568us
                 -->kernel: 0:7 %4206 =  [] -> 89.568us
       %5876 = :aten::to [[14680064], [], [], [], []] -> 89.280us
         %5877 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.280us
           %5878 = :aten::copy_ [[14680064], [14680064], []] -> 89.280us
                 -->kernel: 0:7 %4207 =  [] -> 89.280us
       %5879 = :aten::to [[14680064], [], [], [], []] -> 89.568us
         %5880 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.568us
           %5881 = :aten::copy_ [[14680064], [14680064], []] -> 89.568us
                 -->kernel: 0:7 %4208 =  [] -> 89.568us
       %5882 = :aten::to [[29360128], [], [], [], []] -> 176.449us
         %5883 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.449us
           %5884 = :aten::copy_ [[29360128], [29360128], []] -> 176.449us
                 -->kernel: 0:7 %4209 =  [] -> 176.449us
       %5885 = :aten::to [[29360128], [], [], [], []] -> 176.896us
         %5886 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.896us
           %5887 = :aten::copy_ [[29360128], [29360128], []] -> 176.896us
                 -->kernel: 0:7 %4210 =  [] -> 176.896us
       %5888 = :aten::to [[29360128], [], [], [], []] -> 175.969us
         %5889 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 175.969us
           %5890 = :aten::copy_ [[29360128], [29360128], []] -> 175.969us
                 -->kernel: 0:7 %4211 =  [] -> 175.969us
       %5891 = :aten::to [[29360128], [], [], [], []] -> 175.968us
         %5892 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 175.968us
           %5893 = :aten::copy_ [[29360128], [29360128], []] -> 175.968us
                 -->kernel: 0:7 %4212 =  [] -> 175.968us
       %5894 = :aten::copy_ [[14680064], [14680064], []] -> 1.997ms
         %5895 = :aten::to [[14680064], [], [], [], []] -> 89.024us
           %5896 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.024us
             %5897 = :aten::copy_ [[14680064], [14680064], []] -> 89.024us
                 -->kernel: 0:7 %4213 =  [] -> 89.024us
         %5898 = :aten::copy_ [[14680064], [14680064], []] -> 1.847ms
       %5899 = :aten::copy_ [[14680064], [14680064], []] -> 1.825ms
         %5900 = :aten::to [[14680064], [], [], [], []] -> 88.224us
           %5901 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.224us
             %5902 = :aten::copy_ [[14680064], [14680064], []] -> 88.224us
                 -->kernel: 0:7 %4214 =  [] -> 88.224us
         %5903 = :aten::copy_ [[14680064], [14680064], []] -> 1.707ms
       %5904 = :aten::copy_ [[14680064], [14680064], []] -> 1.791ms
         %5905 = :aten::to [[14680064], [], [], [], []] -> 88.256us
           %5906 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.256us
             %5907 = :aten::copy_ [[14680064], [14680064], []] -> 88.256us
                 -->kernel: 0:7 %4215 =  [] -> 88.256us
         %5908 = :aten::copy_ [[14680064], [14680064], []] -> 1.676ms
       %5909 = :Optimizer.step#FusedAdam.step None -> 3.869ms
         %5910 = :nvte_multi_tensor_adam_cuda [] -> 3.083ms
                 -->kernel: 0:7 %4216 =  [] -> 199.424us
                 -->kernel: 0:7 %4217 =  [] -> 199.841us
                 -->kernel: 0:7 %4218 =  [] -> 200.736us
                 -->kernel: 0:7 %4219 =  [] -> 199.073us
                 -->kernel: 0:7 %4220 =  [] -> 199.776us
                 -->kernel: 0:7 %4221 =  [] -> 198.913us
                 -->kernel: 0:7 %4222 =  [] -> 200.768us
                 -->kernel: 0:7 %4223 =  [] -> 198.913us
                 -->kernel: 0:7 %4224 =  [] -> 197.536us
                 -->kernel: 0:7 %4225 =  [] -> 198.305us
                 -->kernel: 0:7 %4226 =  [] -> 199.136us
                 -->kernel: 0:7 %4227 =  [] -> 199.681us
                 -->kernel: 0:7 %4228 =  [] -> 198.496us
                 -->kernel: 0:7 %4229 =  [] -> 199.105us
                 -->kernel: 0:7 %4230 =  [] -> 141.280us
         %5911 = :aten::copy_ [[14680064], [14680064], []] -> 28.000us
                 -->kernel: 0:7 %4231 =  [] -> 28.000us
         %5912 = :aten::copy_ [[29360128], [29360128], []] -> 48.992us
                 -->kernel: 0:7 %4232 =  [] -> 48.992us
         %5913 = :aten::copy_ [[29360128], [29360128], []] -> 48.160us
                 -->kernel: 0:7 %4233 =  [] -> 48.160us
         %5914 = :aten::copy_ [[29360128], [29360128], []] -> 49.632us
                 -->kernel: 0:7 %4234 =  [] -> 49.632us
         %5915 = :aten::copy_ [[29360128], [29360128], []] -> 48.160us
                 -->kernel: 0:7 %4235 =  [] -> 48.160us
         %5916 = :aten::copy_ [[14680064], [14680064], []] -> 25.856us
                 -->kernel: 0:7 %4236 =  [] -> 25.856us
         %5917 = :aten::copy_ [[14680064], [14680064], []] -> 25.216us
                 -->kernel: 0:7 %4237 =  [] -> 25.216us
         %5918 = :aten::copy_ [[14680064], [14680064], []] -> 26.240us
                 -->kernel: 0:7 %4238 =  [] -> 26.240us
         %5919 = :aten::copy_ [[14680064], [14680064], []] -> 24.992us
                 -->kernel: 0:7 %4239 =  [] -> 24.992us
         %5920 = :aten::copy_ [[29360128], [29360128], []] -> 49.408us
                 -->kernel: 0:7 %4240 =  [] -> 49.408us
         %5921 = :aten::copy_ [[29360128], [29360128], []] -> 47.809us
                 -->kernel: 0:7 %4241 =  [] -> 47.809us
         %5922 = :aten::copy_ [[29360128], [29360128], []] -> 49.504us
                 -->kernel: 0:7 %4242 =  [] -> 49.504us
         %5923 = :aten::copy_ [[29360128], [29360128], []] -> 49.696us
                 -->kernel: 0:7 %4243 =  [] -> 49.696us
       %5924 = :Optimizer.step#AdamW.step None -> 8.738ms
         %5925 = :aten::copy_ [[14680064], [14680064], []] -> 2.944ms
           %5926 = :aten::copy_ [[14680064], [14680064], []] -> 2.864ms
           %5927 = :aten::copy_ [[14680064], [14680064], []] -> 25.216us
                 -->kernel: 0:7 %4244 =  [] -> 25.216us
         %5928 = :aten::copy_ [[14680064], [14680064], []] -> 2.770ms
           %5929 = :aten::copy_ [[14680064], [14680064], []] -> 2.735ms
           %5930 = :aten::copy_ [[14680064], [14680064], []] -> 23.488us
                 -->kernel: 0:7 %4245 =  [] -> 23.488us
         %5931 = :aten::copy_ [[14680064], [14680064], []] -> 2.737ms
           %5932 = :aten::copy_ [[14680064], [14680064], []] -> 2.703ms
           %5933 = :aten::copy_ [[14680064], [14680064], []] -> 24.128us
                 -->kernel: 0:7 %4246 =  [] -> 24.128us
     %5934 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 53.807ms
       %5935 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 53.807ms
         %5936 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 53.807ms
           %5937 = NCCL:ncclGroupEnd [] -> 53.807ms
                 -->kernel: 0:39 %4247 =  [] -> 53.807ms
     %5938 = :aten::to [[1], [], [], [], [], []] -> 768.000ns
       %5939 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 768.000ns
         %5940 = :aten::copy_ [[1], [1], []] -> 768.000ns
     %5941 = :aten::item [[1]] -> 3.232us
       %5942 = :aten::_local_scalar_dense [[1]] -> 3.232us
     %5943 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %5944 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %5945 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %5946 = :aten::item [[1]] -> 2.240us
       %5947 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %5948 = :aten::item [[1]] -> 2.240us
       %5949 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %5950 = :aten::cat [[1], []] -> 1.472us
     %5951 = :aten::mean [[1], []] -> 2.816us
       %5952 = :aten::mean [[1], [], [], []] -> 2.816us
                 -->kernel: 0:7 %4248 =  [] -> 2.816us
     %5953 = :aten::item [[1]] -> 2.880us
       %5954 = :aten::_local_scalar_dense [[1]] -> 2.880us
     %5955 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %5956 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %5957 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %5958 = :aten::add [[1], [], []] -> 1.728us
                 -->kernel: 0:7 %4249 =  [] -> 1.728us
     %5959 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %5960 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %5961 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %5962 = :aten::item [[1]] -> 2.176us
       %5963 = :aten::_local_scalar_dense [[1]] -> 2.176us
     %5964 = :aten::item [[1]] -> 2.368us
       %5965 = :aten::_local_scalar_dense [[1]] -> 2.368us
     %5966 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 1.727ms
       %5967 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 1.727ms
         %5968 = :nccl:all_reduce [[2]] -> 1.727ms
           %5969 = NCCL:ncclAllReduce [] -> 1.727ms
                 -->kernel: 0:7 %4250 =  [] -> 1.727ms
     %5970 = :c10d::allreduce_ [[3], [], [], [], [], []] -> 9.024us
       %5971 = :record_param_comms [[3], [], [], [], [], [], [], [], [], []] -> 9.024us
         %5972 = :nccl:all_reduce [[3]] -> 9.024us
           %5973 = NCCL:ncclAllReduce [] -> 9.024us
                 -->kernel: 0:7 %4251 =  [] -> 9.024us
     %5974 = :aten::mul [[3], []] -> 1.504us
                 -->kernel: 0:7 %4252 =  [] -> 1.504us
     %5975 = :aten::mul [[2], []] -> 1.376us
                 -->kernel: 0:7 %4253 =  [] -> 1.376us
     %5976 = :aten::sum [[3], []] -> 2.656us
       %5977 = :aten::sum [[3], [], [], []] -> 2.656us
                 -->kernel: 0:7 %4254 =  [] -> 2.656us
     %5978 = :aten::div [[], []] -> 1.056us
                 -->kernel: 0:7 %4255 =  [] -> 1.056us
     %5979 = :aten::add_ [[1], [], []] -> 1.536us
                 -->kernel: 0:7 %4256 =  [] -> 1.536us
     %5980 = :aten::sum [[2], []] -> 2.720us
       %5981 = :aten::sum [[2], [], [], []] -> 2.720us
                 -->kernel: 0:7 %4257 =  [] -> 2.720us
     %5982 = :aten::div [[], []] -> 1.056us
                 -->kernel: 0:7 %4258 =  [] -> 1.056us
     %5983 = :aten::add_ [[1], [], []] -> 1.344us
                 -->kernel: 0:7 %4259 =  [] -> 1.344us
     %5984 = :aten::zero_ [[3]] -> 1.184us
       %5985 = :aten::fill_ [[3], []] -> 1.184us
                 -->kernel: 0:7 %4260 =  [] -> 1.184us
     %5986 = :aten::zero_ [[2]] -> 1.056us
       %5987 = :aten::fill_ [[2], []] -> 1.056us
                 -->kernel: 0:7 %4261 =  [] -> 1.056us
     %5988 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 309.089us
       %5989 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 309.089us
         %5990 = :nccl:all_reduce [[1]] -> 309.089us
           %5991 = NCCL:ncclAllReduce [] -> 309.089us
                 -->kernel: 0:7 %4262 =  [] -> 309.089us
     %5992 = :aten::mul [[1], []] -> 1.152us
                 -->kernel: 0:7 %4263 =  [] -> 1.152us
     %5993 = :aten::add_ [[1], [], []] -> 1.440us
                 -->kernel: 0:7 %4264 =  [] -> 1.440us
     %5994 = :aten::zero_ [[1]] -> 1.120us
       %5995 = :aten::fill_ [[1], []] -> 1.120us
                 -->kernel: 0:7 %4265 =  [] -> 1.120us
     %5996 = :c10d::barrier [[1], [], [], [], []] -> 162.432us
       %5997 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 162.432us
         %5998 = :aten::zeros [[], [], [], [], []] -> 896.000ns
           %5999 = :aten::zero_ [[1]] -> 896.000ns
             %6000 = :aten::fill_ [[1], []] -> 896.000ns
                 -->kernel: 0:7 %4266 =  [] -> 896.000ns
         %6001 = :nccl:all_reduce_barrier [[1]] -> 127.904us
           %6002 = NCCL:ncclAllReduce [] -> 127.904us
                 -->kernel: 0:7 %4267 =  [] -> 127.904us
     %6003 = :c10d::barrier [[1], [], [], [], []] -> 38.369us
       %6004 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 38.369us
         %6005 = :aten::zeros [[], [], [], [], []] -> 1.184us
           %6006 = :aten::zero_ [[1]] -> 1.184us
             %6007 = :aten::fill_ [[1], []] -> 1.184us
                 -->kernel: 0:7 %4268 =  [] -> 1.184us
         %6008 = :nccl:all_reduce_barrier [[1]] -> 7.872us
           %6009 = NCCL:ncclAllReduce [] -> 7.872us
                 -->kernel: 0:7 %4269 =  [] -> 7.872us
     %6010 = :aten::item [[1]] -> 2.368us
       %6011 = :aten::_local_scalar_dense [[1]] -> 2.368us
     %6012 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %6013 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %6014 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %6015 = :aten::item [[1]] -> 2.176us
       %6016 = :aten::_local_scalar_dense [[1]] -> 2.176us
     %6017 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %6018 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %6019 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %6020 = :aten::item [[1]] -> 2.176us
       %6021 = :aten::_local_scalar_dense [[1]] -> 2.176us
     %6022 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %6023 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %6024 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %6025 = :aten::item [[1]] -> 2.208us
       %6026 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %6027 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %6028 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %6029 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %6030 = :aten::zeros [[], [], [], [], []] -> 928.000ns
       %6031 = :aten::zero_ [[8, 24]] -> 928.000ns
         %6032 = :aten::fill_ [[8, 24], []] -> 928.000ns
                 -->kernel: 0:7 %4270 =  [] -> 928.000ns
     %6033 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 58.432us
       %6034 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 58.432us
         %6035 = :nccl:_all_gather_base [[24]] -> 58.432us
           %6036 = NCCL:ncclAllGather [] -> 58.432us
                 -->kernel: 0:7 %4271 =  [] -> 58.432us
     %6037 = :aten::gt [[8], []] -> 1.856us
                 -->kernel: 0:7 %4272 =  [] -> 1.856us
     %6038 = :aten::index [[8], [8]] -> 62.049us
       %6039 = :aten::nonzero [[8]] -> 62.049us
         %6040 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %4273 =  [] -> 1.536us
         %6041 = CCCL:cub::DeviceSelect::Flagged [] -> 14.592us
                 -->kernel: 0:7 %4274 =  [] -> 1.024us
                 -->kernel: 0:7 %4275 =  [] -> 2.048us
     %6042 = :aten::gt [[8], []] -> 1.952us
                 -->kernel: 0:7 %4276 =  [] -> 1.952us
     %6043 = :aten::index [[8], [8]] -> 44.768us
       %6044 = :aten::nonzero [[8]] -> 44.768us
         %6045 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4277 =  [] -> 1.504us
         %6046 = CCCL:cub::DeviceSelect::Flagged [] -> 12.608us
                 -->kernel: 0:7 %4278 =  [] -> 992.000ns
                 -->kernel: 0:7 %4279 =  [] -> 1.888us
     %6047 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4280 =  [] -> 1.792us
     %6048 = :aten::index [[8], [8]] -> 43.200us
       %6049 = :aten::nonzero [[8]] -> 43.200us
         %6050 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4281 =  [] -> 1.504us
         %6051 = CCCL:cub::DeviceSelect::Flagged [] -> 11.680us
                 -->kernel: 0:7 %4282 =  [] -> 992.000ns
                 -->kernel: 0:7 %4283 =  [] -> 1.824us
     %6052 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4284 =  [] -> 1.792us
     %6053 = :aten::index [[8], [8]] -> 44.512us
       %6054 = :aten::nonzero [[8]] -> 44.512us
         %6055 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4285 =  [] -> 1.472us
         %6056 = CCCL:cub::DeviceSelect::Flagged [] -> 12.480us
                 -->kernel: 0:7 %4286 =  [] -> 992.000ns
                 -->kernel: 0:7 %4287 =  [] -> 1.856us
     %6057 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4288 =  [] -> 1.792us
     %6058 = :aten::index [[8], [8]] -> 42.720us
       %6059 = :aten::nonzero [[8]] -> 42.720us
         %6060 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4289 =  [] -> 1.504us
         %6061 = CCCL:cub::DeviceSelect::Flagged [] -> 11.680us
                 -->kernel: 0:7 %4290 =  [] -> 992.000ns
                 -->kernel: 0:7 %4291 =  [] -> 1.856us
     %6062 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4292 =  [] -> 1.792us
     %6063 = :aten::index [[8], [8]] -> 43.808us
       %6064 = :aten::nonzero [[8]] -> 43.808us
         %6065 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4293 =  [] -> 1.472us
         %6066 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %4294 =  [] -> 992.000ns
                 -->kernel: 0:7 %4295 =  [] -> 1.888us
     %6067 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4296 =  [] -> 1.792us
     %6068 = :aten::index [[8], [8]] -> 42.240us
       %6069 = :aten::nonzero [[8]] -> 42.240us
         %6070 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4297 =  [] -> 1.504us
         %6071 = CCCL:cub::DeviceSelect::Flagged [] -> 11.552us
                 -->kernel: 0:7 %4298 =  [] -> 1.024us
                 -->kernel: 0:7 %4299 =  [] -> 1.856us
     %6072 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4300 =  [] -> 1.792us
     %6073 = :aten::index [[8], [8]] -> 42.624us
       %6074 = :aten::nonzero [[8]] -> 42.624us
         %6075 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4301 =  [] -> 1.472us
         %6076 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %4302 =  [] -> 1.024us
                 -->kernel: 0:7 %4303 =  [] -> 1.856us
     %6077 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4304 =  [] -> 1.760us
     %6078 = :aten::index [[8], [8]] -> 42.432us
       %6079 = :aten::nonzero [[8]] -> 42.432us
         %6080 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4305 =  [] -> 1.472us
         %6081 = CCCL:cub::DeviceSelect::Flagged [] -> 11.520us
                 -->kernel: 0:7 %4306 =  [] -> 992.000ns
                 -->kernel: 0:7 %4307 =  [] -> 1.824us
     %6082 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4308 =  [] -> 1.792us
     %6083 = :aten::index [[8], [8]] -> 44.192us
       %6084 = :aten::nonzero [[8]] -> 44.192us
         %6085 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4309 =  [] -> 1.472us
         %6086 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %4310 =  [] -> 992.000ns
                 -->kernel: 0:7 %4311 =  [] -> 1.888us
     %6087 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4312 =  [] -> 1.760us
     %6088 = :aten::index [[8], [8]] -> 43.392us
       %6089 = :aten::nonzero [[8]] -> 43.392us
         %6090 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4313 =  [] -> 1.504us
         %6091 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %4314 =  [] -> 1.024us
                 -->kernel: 0:7 %4315 =  [] -> 1.856us
     %6092 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4316 =  [] -> 1.792us
     %6093 = :aten::index [[8], [8]] -> 42.368us
       %6094 = :aten::nonzero [[8]] -> 42.368us
         %6095 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4317 =  [] -> 1.504us
         %6096 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %4318 =  [] -> 992.000ns
                 -->kernel: 0:7 %4319 =  [] -> 1.856us
     %6097 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4320 =  [] -> 1.792us
     %6098 = :aten::index [[8], [8]] -> 48.481us
       %6099 = :aten::nonzero [[8]] -> 48.481us
         %6100 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4321 =  [] -> 1.504us
         %6101 = CCCL:cub::DeviceSelect::Flagged [] -> 11.680us
                 -->kernel: 0:7 %4322 =  [] -> 992.000ns
                 -->kernel: 0:7 %4323 =  [] -> 1.856us
     %6102 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4324 =  [] -> 1.824us
     %6103 = :aten::index [[8], [8]] -> 48.576us
       %6104 = :aten::nonzero [[8]] -> 48.576us
         %6105 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4325 =  [] -> 1.472us
         %6106 = CCCL:cub::DeviceSelect::Flagged [] -> 12.640us
                 -->kernel: 0:7 %4326 =  [] -> 992.000ns
                 -->kernel: 0:7 %4327 =  [] -> 1.856us
     %6107 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4328 =  [] -> 1.792us
     %6108 = :aten::index [[8], [8]] -> 43.264us
       %6109 = :aten::nonzero [[8]] -> 43.264us
         %6110 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4329 =  [] -> 1.504us
         %6111 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %4330 =  [] -> 992.000ns
                 -->kernel: 0:7 %4331 =  [] -> 1.856us
     %6112 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4332 =  [] -> 1.792us
     %6113 = :aten::index [[8], [8]] -> 43.809us
       %6114 = :aten::nonzero [[8]] -> 43.809us
         %6115 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4333 =  [] -> 1.472us
         %6116 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %4334 =  [] -> 1.024us
                 -->kernel: 0:7 %4335 =  [] -> 1.856us
     %6117 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4336 =  [] -> 1.760us
     %6118 = :aten::index [[8], [8]] -> 51.968us
       %6119 = :aten::nonzero [[8]] -> 51.968us
         %6120 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4337 =  [] -> 1.504us
         %6121 = CCCL:cub::DeviceSelect::Flagged [] -> 12.384us
                 -->kernel: 0:7 %4338 =  [] -> 1.024us
                 -->kernel: 0:7 %4339 =  [] -> 1.856us
     %6122 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4340 =  [] -> 1.792us
     %6123 = :aten::index [[8], [8]] -> 44.224us
       %6124 = :aten::nonzero [[8]] -> 44.224us
         %6125 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4341 =  [] -> 1.472us
         %6126 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %4342 =  [] -> 1.056us
                 -->kernel: 0:7 %4343 =  [] -> 1.888us
     %6127 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4344 =  [] -> 1.760us
     %6128 = :aten::index [[8], [8]] -> 43.041us
       %6129 = :aten::nonzero [[8]] -> 43.041us
         %6130 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4345 =  [] -> 1.504us
         %6131 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %4346 =  [] -> 1.056us
                 -->kernel: 0:7 %4347 =  [] -> 1.856us
     %6132 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4348 =  [] -> 1.824us
     %6133 = :aten::index [[8], [8]] -> 49.920us
       %6134 = :aten::nonzero [[8]] -> 49.920us
         %6135 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4349 =  [] -> 1.472us
         %6136 = CCCL:cub::DeviceSelect::Flagged [] -> 17.600us
                 -->kernel: 0:7 %4350 =  [] -> 1.056us
                 -->kernel: 0:7 %4351 =  [] -> 1.856us
     %6137 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4352 =  [] -> 1.792us
     %6138 = :aten::index [[8], [8]] -> 43.520us
       %6139 = :aten::nonzero [[8]] -> 43.520us
         %6140 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4353 =  [] -> 1.472us
         %6141 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %4354 =  [] -> 1.056us
                 -->kernel: 0:7 %4355 =  [] -> 1.856us
     %6142 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4356 =  [] -> 1.824us
     %6143 = :aten::index [[8], [8]] -> 44.257us
       %6144 = :aten::nonzero [[8]] -> 44.257us
         %6145 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4357 =  [] -> 1.472us
         %6146 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %4358 =  [] -> 1.056us
                 -->kernel: 0:7 %4359 =  [] -> 1.888us
     %6147 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4360 =  [] -> 1.760us
     %6148 = :aten::index [[8], [8]] -> 43.392us
       %6149 = :aten::nonzero [[8]] -> 43.392us
         %6150 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4361 =  [] -> 1.504us
         %6151 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %4362 =  [] -> 1.056us
                 -->kernel: 0:7 %4363 =  [] -> 1.856us
     %6152 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4364 =  [] -> 1.824us
     %6153 = :aten::index [[8], [8]] -> 43.456us
       %6154 = :aten::nonzero [[8]] -> 43.456us
         %6155 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4365 =  [] -> 1.504us
         %6156 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %4366 =  [] -> 1.088us
                 -->kernel: 0:7 %4367 =  [] -> 1.856us
     %6157 = :aten::zeros [[], [], [], [], []] -> 1.216us
       %6158 = :aten::zero_ [[8, 24]] -> 1.216us
         %6159 = :aten::fill_ [[8, 24], []] -> 1.216us
                 -->kernel: 0:7 %4368 =  [] -> 1.216us
     %6160 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.840us
       %6161 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.840us
         %6162 = :nccl:_all_gather_base [[24]] -> 7.840us
           %6163 = NCCL:ncclAllGather [] -> 7.840us
                 -->kernel: 0:7 %4369 =  [] -> 7.840us
     %6164 = :aten::gt [[8], []] -> 1.600us
                 -->kernel: 0:7 %4370 =  [] -> 1.600us
     %6165 = :aten::index [[8], [8]] -> 48.864us
       %6166 = :aten::nonzero [[8]] -> 48.864us
         %6167 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4371 =  [] -> 1.312us
         %6168 = CCCL:cub::DeviceSelect::Flagged [] -> 12.576us
                 -->kernel: 0:7 %4372 =  [] -> 1.376us
                 -->kernel: 0:7 %4373 =  [] -> 2.176us
     %6169 = :aten::gt [[8], []] -> 1.472us
                 -->kernel: 0:7 %4374 =  [] -> 1.472us
     %6170 = :aten::index [[8], [8]] -> 46.976us
       %6171 = :aten::nonzero [[8]] -> 46.976us
         %6172 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4375 =  [] -> 1.312us
         %6173 = CCCL:cub::DeviceSelect::Flagged [] -> 12.832us
                 -->kernel: 0:7 %4376 =  [] -> 1.312us
                 -->kernel: 0:7 %4377 =  [] -> 2.208us
     %6174 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4378 =  [] -> 1.440us
     %6175 = :aten::index [[8], [8]] -> 44.064us
       %6176 = :aten::nonzero [[8]] -> 44.064us
         %6177 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4379 =  [] -> 1.312us
         %6178 = CCCL:cub::DeviceSelect::Flagged [] -> 12.480us
                 -->kernel: 0:7 %4380 =  [] -> 1.376us
                 -->kernel: 0:7 %4381 =  [] -> 2.144us
     %6179 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4382 =  [] -> 1.440us
     %6180 = :aten::index [[8], [8]] -> 43.680us
       %6181 = :aten::nonzero [[8]] -> 43.680us
         %6182 = CCCL:cub::DeviceReduce::Sum [] -> 1.344us
                 -->kernel: 0:7 %4383 =  [] -> 1.344us
         %6183 = CCCL:cub::DeviceSelect::Flagged [] -> 12.576us
                 -->kernel: 0:7 %4384 =  [] -> 1.344us
                 -->kernel: 0:7 %4385 =  [] -> 2.176us
     %6184 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4386 =  [] -> 1.440us
     %6185 = :aten::index [[8], [8]] -> 42.816us
       %6186 = :aten::nonzero [[8]] -> 42.816us
         %6187 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %4387 =  [] -> 1.280us
         %6188 = CCCL:cub::DeviceSelect::Flagged [] -> 12.448us
                 -->kernel: 0:7 %4388 =  [] -> 1.344us
                 -->kernel: 0:7 %4389 =  [] -> 2.144us
     %6189 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4390 =  [] -> 1.440us
     %6190 = :aten::index [[8], [8]] -> 43.392us
       %6191 = :aten::nonzero [[8]] -> 43.392us
         %6192 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4391 =  [] -> 1.312us
         %6193 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %4392 =  [] -> 1.312us
                 -->kernel: 0:7 %4393 =  [] -> 2.176us
     %6194 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %4394 =  [] -> 1.408us
     %6195 = :aten::index [[8], [8]] -> 43.232us
       %6196 = :aten::nonzero [[8]] -> 43.232us
         %6197 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %4395 =  [] -> 1.280us
         %6198 = CCCL:cub::DeviceSelect::Flagged [] -> 13.216us
                 -->kernel: 0:7 %4396 =  [] -> 1.344us
                 -->kernel: 0:7 %4397 =  [] -> 2.144us
     %6199 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4398 =  [] -> 1.440us
     %6200 = :aten::index [[8], [8]] -> 42.592us
       %6201 = :aten::nonzero [[8]] -> 42.592us
         %6202 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4399 =  [] -> 1.312us
         %6203 = CCCL:cub::DeviceSelect::Flagged [] -> 12.512us
                 -->kernel: 0:7 %4400 =  [] -> 1.312us
                 -->kernel: 0:7 %4401 =  [] -> 2.144us
     %6204 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4402 =  [] -> 1.440us
     %6205 = :aten::index [[8], [8]] -> 43.488us
       %6206 = :aten::nonzero [[8]] -> 43.488us
         %6207 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4403 =  [] -> 1.312us
         %6208 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %4404 =  [] -> 1.344us
                 -->kernel: 0:7 %4405 =  [] -> 2.112us
     %6209 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4406 =  [] -> 1.440us
     %6210 = :aten::index [[8], [8]] -> 43.872us
       %6211 = :aten::nonzero [[8]] -> 43.872us
         %6212 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4407 =  [] -> 1.312us
         %6213 = CCCL:cub::DeviceSelect::Flagged [] -> 12.384us
                 -->kernel: 0:7 %4408 =  [] -> 1.312us
                 -->kernel: 0:7 %4409 =  [] -> 2.176us
     %6214 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4410 =  [] -> 1.440us
     %6215 = :aten::index [[8], [8]] -> 43.200us
       %6216 = :aten::nonzero [[8]] -> 43.200us
         %6217 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4411 =  [] -> 1.312us
         %6218 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %4412 =  [] -> 1.344us
                 -->kernel: 0:7 %4413 =  [] -> 2.144us
     %6219 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4414 =  [] -> 1.440us
     %6220 = :aten::index [[8], [8]] -> 42.817us
       %6221 = :aten::nonzero [[8]] -> 42.817us
         %6222 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4415 =  [] -> 1.312us
         %6223 = CCCL:cub::DeviceSelect::Flagged [] -> 12.480us
                 -->kernel: 0:7 %4416 =  [] -> 1.312us
                 -->kernel: 0:7 %4417 =  [] -> 2.176us
     %6224 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %4418 =  [] -> 1.408us
     %6225 = :aten::index [[8], [8]] -> 42.336us
       %6226 = :aten::nonzero [[8]] -> 42.336us
         %6227 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %4419 =  [] -> 1.280us
         %6228 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %4420 =  [] -> 1.344us
                 -->kernel: 0:7 %4421 =  [] -> 2.112us
     %6229 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4422 =  [] -> 1.440us
     %6230 = :aten::index [[8], [8]] -> 42.496us
       %6231 = :aten::nonzero [[8]] -> 42.496us
         %6232 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4423 =  [] -> 1.312us
         %6233 = CCCL:cub::DeviceSelect::Flagged [] -> 12.416us
                 -->kernel: 0:7 %4424 =  [] -> 1.312us
                 -->kernel: 0:7 %4425 =  [] -> 2.176us
     %6234 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4426 =  [] -> 1.440us
     %6235 = :aten::index [[8], [8]] -> 43.009us
       %6236 = :aten::nonzero [[8]] -> 43.009us
         %6237 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %4427 =  [] -> 1.280us
         %6238 = CCCL:cub::DeviceSelect::Flagged [] -> 12.385us
                 -->kernel: 0:7 %4428 =  [] -> 1.344us
                 -->kernel: 0:7 %4429 =  [] -> 2.144us
     %6239 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %4430 =  [] -> 1.408us
     %6240 = :aten::index [[8], [8]] -> 42.912us
       %6241 = :aten::nonzero [[8]] -> 42.912us
         %6242 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4431 =  [] -> 1.312us
         %6243 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %4432 =  [] -> 1.344us
                 -->kernel: 0:7 %4433 =  [] -> 2.176us
     %6244 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4434 =  [] -> 1.440us
     %6245 = :aten::index [[8], [8]] -> 49.408us
       %6246 = :aten::nonzero [[8]] -> 49.408us
         %6247 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %4435 =  [] -> 1.280us
         %6248 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %4436 =  [] -> 1.344us
                 -->kernel: 0:7 %4437 =  [] -> 2.112us
     %6249 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4438 =  [] -> 1.440us
     %6250 = :aten::index [[8], [8]] -> 43.648us
       %6251 = :aten::nonzero [[8]] -> 43.648us
         %6252 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4439 =  [] -> 1.312us
         %6253 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %4440 =  [] -> 1.312us
                 -->kernel: 0:7 %4441 =  [] -> 2.176us
     %6254 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4442 =  [] -> 1.440us
     %6255 = :aten::index [[8], [8]] -> 43.168us
       %6256 = :aten::nonzero [[8]] -> 43.168us
         %6257 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %4443 =  [] -> 1.280us
         %6258 = CCCL:cub::DeviceSelect::Flagged [] -> 12.288us
                 -->kernel: 0:7 %4444 =  [] -> 1.344us
                 -->kernel: 0:7 %4445 =  [] -> 2.144us
     %6259 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4446 =  [] -> 1.440us
     %6260 = :aten::index [[8], [8]] -> 42.784us
       %6261 = :aten::nonzero [[8]] -> 42.784us
         %6262 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4447 =  [] -> 1.312us
         %6263 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %4448 =  [] -> 1.344us
                 -->kernel: 0:7 %4449 =  [] -> 2.176us
     %6264 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %4450 =  [] -> 1.408us
     %6265 = :aten::index [[8], [8]] -> 43.584us
       %6266 = :aten::nonzero [[8]] -> 43.584us
         %6267 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4451 =  [] -> 1.312us
         %6268 = CCCL:cub::DeviceSelect::Flagged [] -> 12.192us
                 -->kernel: 0:7 %4452 =  [] -> 1.344us
                 -->kernel: 0:7 %4453 =  [] -> 2.144us
     %6269 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4454 =  [] -> 1.440us
     %6270 = :aten::index [[8], [8]] -> 43.424us
       %6271 = :aten::nonzero [[8]] -> 43.424us
         %6272 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %4455 =  [] -> 1.280us
         %6273 = CCCL:cub::DeviceSelect::Flagged [] -> 12.448us
                 -->kernel: 0:7 %4456 =  [] -> 1.312us
                 -->kernel: 0:7 %4457 =  [] -> 2.176us
     %6274 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4458 =  [] -> 1.440us
     %6275 = :aten::index [[8], [8]] -> 42.176us
       %6276 = :aten::nonzero [[8]] -> 42.176us
         %6277 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4459 =  [] -> 1.312us
         %6278 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %4460 =  [] -> 1.376us
                 -->kernel: 0:7 %4461 =  [] -> 2.144us
     %6279 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %4462 =  [] -> 1.408us
     %6280 = :aten::index [[8], [8]] -> 42.432us
       %6281 = :aten::nonzero [[8]] -> 42.432us
         %6282 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4463 =  [] -> 1.312us
         %6283 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %4464 =  [] -> 1.280us
                 -->kernel: 0:7 %4465 =  [] -> 2.176us
     %6284 = :aten::zeros [[], [], [], [], []] -> 992.000ns
       %6285 = :aten::zero_ [[8, 24]] -> 992.000ns
         %6286 = :aten::fill_ [[8, 24], []] -> 992.000ns
                 -->kernel: 0:7 %4466 =  [] -> 992.000ns
     %6287 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.552us
       %6288 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.552us
         %6289 = :nccl:_all_gather_base [[24]] -> 7.552us
           %6290 = NCCL:ncclAllGather [] -> 7.552us
                 -->kernel: 0:7 %4467 =  [] -> 7.552us
     %6291 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4468 =  [] -> 1.824us
     %6292 = :aten::index [[8], [8]] -> 47.488us
       %6293 = :aten::nonzero [[8]] -> 47.488us
         %6294 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4469 =  [] -> 1.504us
         %6295 = CCCL:cub::DeviceSelect::Flagged [] -> 12.352us
                 -->kernel: 0:7 %4470 =  [] -> 1.056us
                 -->kernel: 0:7 %4471 =  [] -> 1.888us
     %6296 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4472 =  [] -> 1.760us
     %6297 = :aten::index [[8], [8]] -> 43.552us
       %6298 = :aten::nonzero [[8]] -> 43.552us
         %6299 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4473 =  [] -> 1.504us
         %6300 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %4474 =  [] -> 1.056us
                 -->kernel: 0:7 %4475 =  [] -> 1.856us
     %6301 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4476 =  [] -> 1.792us
     %6302 = :aten::index [[8], [8]] -> 42.752us
       %6303 = :aten::nonzero [[8]] -> 42.752us
         %6304 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4477 =  [] -> 1.472us
         %6305 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %4478 =  [] -> 1.056us
                 -->kernel: 0:7 %4479 =  [] -> 1.856us
     %6306 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4480 =  [] -> 1.792us
     %6307 = :aten::index [[8], [8]] -> 42.464us
       %6308 = :aten::nonzero [[8]] -> 42.464us
         %6309 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4481 =  [] -> 1.504us
         %6310 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %4482 =  [] -> 1.056us
                 -->kernel: 0:7 %4483 =  [] -> 1.856us
     %6311 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4484 =  [] -> 1.792us
     %6312 = :aten::index [[8], [8]] -> 43.808us
       %6313 = :aten::nonzero [[8]] -> 43.808us
         %6314 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4485 =  [] -> 1.504us
         %6315 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %4486 =  [] -> 1.056us
                 -->kernel: 0:7 %4487 =  [] -> 1.856us
     %6316 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4488 =  [] -> 1.760us
     %6317 = :aten::index [[8], [8]] -> 42.048us
       %6318 = :aten::nonzero [[8]] -> 42.048us
         %6319 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4489 =  [] -> 1.472us
         %6320 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %4490 =  [] -> 1.088us
                 -->kernel: 0:7 %4491 =  [] -> 1.856us
     %6321 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4492 =  [] -> 1.824us
     %6322 = :aten::index [[8], [8]] -> 43.296us
       %6323 = :aten::nonzero [[8]] -> 43.296us
         %6324 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4493 =  [] -> 1.504us
         %6325 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %4494 =  [] -> 1.088us
                 -->kernel: 0:7 %4495 =  [] -> 1.888us
     %6326 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4496 =  [] -> 1.824us
     %6327 = :aten::index [[8], [8]] -> 42.624us
       %6328 = :aten::nonzero [[8]] -> 42.624us
         %6329 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4497 =  [] -> 1.504us
         %6330 = CCCL:cub::DeviceSelect::Flagged [] -> 11.680us
                 -->kernel: 0:7 %4498 =  [] -> 1.056us
                 -->kernel: 0:7 %4499 =  [] -> 1.824us
     %6331 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4500 =  [] -> 1.824us
     %6332 = :aten::index [[8], [8]] -> 42.528us
       %6333 = :aten::nonzero [[8]] -> 42.528us
         %6334 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4501 =  [] -> 1.504us
         %6335 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %4502 =  [] -> 1.088us
                 -->kernel: 0:7 %4503 =  [] -> 1.888us
     %6336 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4504 =  [] -> 1.792us
     %6337 = :aten::index [[8], [8]] -> 43.136us
       %6338 = :aten::nonzero [[8]] -> 43.136us
         %6339 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %4505 =  [] -> 1.536us
         %6340 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %4506 =  [] -> 1.056us
                 -->kernel: 0:7 %4507 =  [] -> 1.856us
     %6341 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4508 =  [] -> 1.824us
     %6342 = :aten::index [[8], [8]] -> 42.464us
       %6343 = :aten::nonzero [[8]] -> 42.464us
         %6344 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4509 =  [] -> 1.504us
         %6345 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %4510 =  [] -> 1.088us
                 -->kernel: 0:7 %4511 =  [] -> 1.888us
     %6346 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4512 =  [] -> 1.792us
     %6347 = :aten::index [[8], [8]] -> 42.465us
       %6348 = :aten::nonzero [[8]] -> 42.465us
         %6349 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %4513 =  [] -> 1.536us
         %6350 = CCCL:cub::DeviceSelect::Flagged [] -> 11.520us
                 -->kernel: 0:7 %4514 =  [] -> 1.056us
                 -->kernel: 0:7 %4515 =  [] -> 1.856us
     %6351 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4516 =  [] -> 1.792us
     %6352 = :aten::index [[8], [8]] -> 42.592us
       %6353 = :aten::nonzero [[8]] -> 42.592us
         %6354 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4517 =  [] -> 1.472us
         %6355 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %4518 =  [] -> 1.088us
                 -->kernel: 0:7 %4519 =  [] -> 1.888us
     %6356 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4520 =  [] -> 1.792us
     %6357 = :aten::index [[8], [8]] -> 42.208us
       %6358 = :aten::nonzero [[8]] -> 42.208us
         %6359 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %4521 =  [] -> 1.536us
         %6360 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %4522 =  [] -> 1.056us
                 -->kernel: 0:7 %4523 =  [] -> 1.856us
     %6361 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4524 =  [] -> 1.792us
     %6362 = :aten::index [[8], [8]] -> 42.657us
       %6363 = :aten::nonzero [[8]] -> 42.657us
         %6364 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4525 =  [] -> 1.472us
         %6365 = CCCL:cub::DeviceSelect::Flagged [] -> 11.841us
                 -->kernel: 0:7 %4526 =  [] -> 1.056us
                 -->kernel: 0:7 %4527 =  [] -> 1.888us
     %6366 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4528 =  [] -> 1.760us
     %6367 = :aten::index [[8], [8]] -> 42.176us
       %6368 = :aten::nonzero [[8]] -> 42.176us
         %6369 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4529 =  [] -> 1.504us
         %6370 = CCCL:cub::DeviceSelect::Flagged [] -> 11.552us
                 -->kernel: 0:7 %4530 =  [] -> 1.056us
                 -->kernel: 0:7 %4531 =  [] -> 1.824us
     %6371 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4532 =  [] -> 1.792us
     %6372 = :aten::index [[8], [8]] -> 42.816us
       %6373 = :aten::nonzero [[8]] -> 42.816us
         %6374 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4533 =  [] -> 1.504us
         %6375 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %4534 =  [] -> 1.088us
                 -->kernel: 0:7 %4535 =  [] -> 1.888us
     %6376 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4536 =  [] -> 1.792us
     %6377 = :aten::index [[8], [8]] -> 41.792us
       %6378 = :aten::nonzero [[8]] -> 41.792us
         %6379 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4537 =  [] -> 1.504us
         %6380 = CCCL:cub::DeviceSelect::Flagged [] -> 11.456us
                 -->kernel: 0:7 %4538 =  [] -> 1.056us
                 -->kernel: 0:7 %4539 =  [] -> 1.856us
     %6381 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4540 =  [] -> 1.824us
     %6382 = :aten::index [[8], [8]] -> 42.272us
       %6383 = :aten::nonzero [[8]] -> 42.272us
         %6384 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4541 =  [] -> 1.504us
         %6385 = CCCL:cub::DeviceSelect::Flagged [] -> 11.584us
                 -->kernel: 0:7 %4542 =  [] -> 1.024us
                 -->kernel: 0:7 %4543 =  [] -> 1.888us
     %6386 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4544 =  [] -> 1.760us
     %6387 = :aten::index [[8], [8]] -> 42.752us
       %6388 = :aten::nonzero [[8]] -> 42.752us
         %6389 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4545 =  [] -> 1.504us
         %6390 = CCCL:cub::DeviceSelect::Flagged [] -> 11.456us
                 -->kernel: 0:7 %4546 =  [] -> 992.000ns
                 -->kernel: 0:7 %4547 =  [] -> 1.824us
     %6391 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4548 =  [] -> 1.824us
     %6392 = :aten::index [[8], [8]] -> 42.976us
       %6393 = :aten::nonzero [[8]] -> 42.976us
         %6394 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4549 =  [] -> 1.472us
         %6395 = CCCL:cub::DeviceSelect::Flagged [] -> 11.648us
                 -->kernel: 0:7 %4550 =  [] -> 1.024us
                 -->kernel: 0:7 %4551 =  [] -> 1.856us
     %6396 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4552 =  [] -> 1.792us
     %6397 = :aten::index [[8], [8]] -> 47.648us
       %6398 = :aten::nonzero [[8]] -> 47.648us
         %6399 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4553 =  [] -> 1.504us
         %6400 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %4554 =  [] -> 992.000ns
                 -->kernel: 0:7 %4555 =  [] -> 1.856us
     %6401 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4556 =  [] -> 1.824us
     %6402 = :aten::index [[8], [8]] -> 43.136us
       %6403 = :aten::nonzero [[8]] -> 43.136us
         %6404 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4557 =  [] -> 1.472us
         %6405 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %4558 =  [] -> 992.000ns
                 -->kernel: 0:7 %4559 =  [] -> 1.856us
     %6406 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4560 =  [] -> 1.792us
     %6407 = :aten::index [[8], [8]] -> 43.648us
       %6408 = :aten::nonzero [[8]] -> 43.648us
         %6409 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4561 =  [] -> 1.504us
         %6410 = CCCL:cub::DeviceSelect::Flagged [] -> 11.584us
                 -->kernel: 0:7 %4562 =  [] -> 992.000ns
                 -->kernel: 0:7 %4563 =  [] -> 1.824us
     %6411 = :aten::zero_ [[3002413056]] -> 1.799ms
       %6412 = :aten::fill_ [[3002413056], []] -> 1.799ms
                 -->kernel: 0:7 %4564 =  [] -> 441.409us
                 -->kernel: 0:7 %4565 =  [] -> 441.473us
                 -->kernel: 0:7 %4566 =  [] -> 441.473us
                 -->kernel: 0:7 %4567 =  [] -> 441.473us
     %6413 = :aten::zero_ [[352321536]] -> 207.873us
       %6414 = :aten::fill_ [[352321536], []] -> 207.873us
                 -->kernel: 0:7 %4568 =  [] -> 207.873us
     %6415 = :aten::zeros [[], [], [], [], []] -> 1.344us
       %6416 = :aten::zero_ [[]] -> 1.344us
         %6417 = :aten::fill_ [[], []] -> 1.344us
                 -->kernel: 0:7 %4569 =  [] -> 1.344us
     %6418 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.520us
       %6419 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.520us
         %6420 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.520us
     %6421 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.296us
       %6422 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.296us
         %6423 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.296us
     %6424 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 1.472us
       %6425 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 1.472us
         %6426 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.472us
     %6427 = :aten::to [[1, 1, 4096, 4096], [], [], [], [], [], [], []] -> 293.888us
       %6428 = :aten::_to_copy [[1, 1, 4096, 4096], [], [], [], [], [], []] -> 293.888us
         %6429 = :aten::copy_ [[1, 1, 4096, 4096], [1, 1, 4096, 4096], []] -> 293.888us
     %6430 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.040us
       %6431 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.040us
         %6432 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.040us
     %6433 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 273.632us
       %6434 = :aten::index_select [[129280, 7168], [], [4096]] -> 273.632us
                 -->kernel: 0:7 %4570 =  [] -> 273.632us
     %6435 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 127.680us
       %6436 = :nvte_rmsnorm_fwd [] -> 127.680us
                 -->kernel: 0:7 %4571 =  [] -> 127.680us
     %6437 = :TELinear forward [] -> 660.930us
       %6438 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 660.930us
         %6439 = :nvte_quantize_v2 [] -> 74.016us
           %6440 = :quantize_transpose_vector_blockwise [] -> 74.016us
                 -->kernel: 0:7 %4572 =  [] -> 74.016us
         %6441 = :nvte_quantize_v2 [] -> 19.936us
           %6442 = :quantize_transpose_square_blockwise [] -> 19.936us
                 -->kernel: 0:7 %4573 =  [] -> 19.936us
         %6443 = :nvte_cublas_gemm_scaled [] -> 338.881us
                 -->kernel: 0:7 %4574 =  [] -> 329.825us
     %6444 = :TELinear forward [] -> 409.889us
       %6445 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 409.889us
         %6446 = :nvte_quantize_v2 [] -> 73.248us
           %6447 = :quantize_transpose_vector_blockwise [] -> 73.248us
                 -->kernel: 0:7 %4575 =  [] -> 73.248us
         %6448 = :nvte_quantize_v2 [] -> 11.616us
           %6449 = :quantize_transpose_square_blockwise [] -> 11.616us
                 -->kernel: 0:7 %4576 =  [] -> 11.616us
         %6450 = :nvte_cublas_gemm_scaled [] -> 205.824us
                 -->kernel: 0:7 %4577 =  [] -> 198.144us
     %6451 = :TELayerNormColumnParallelLinear forward [] -> 1.374ms
       %6452 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.374ms
         %6453 = :nvte_rmsnorm_fwd [] -> 30.176us
                 -->kernel: 0:7 %4578 =  [] -> 30.176us
         %6454 = :nvte_quantize_v2 [] -> 17.056us
           %6455 = :quantize_transpose_vector_blockwise [] -> 17.056us
                 -->kernel: 0:7 %4579 =  [] -> 17.056us
         %6456 = :nvte_quantize_v2 [] -> 57.952us
           %6457 = :quantize_transpose_square_blockwise [] -> 57.952us
                 -->kernel: 0:7 %4580 =  [] -> 57.952us
         %6458 = :nvte_cublas_gemm_scaled [] -> 1.133ms
                 -->kernel: 0:7 %4581 =  [] -> 1.126ms
     %6459 = :TELayerNormColumnParallelLinear forward [] -> 911.106us
       %6460 = :aten::contiguous [[4096, 1, 512], []] -> 11.616us
         %6461 = :aten::clone [[4096, 1, 512], []] -> 11.616us
           %6462 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.616us
                 -->kernel: 0:7 %4582 =  [] -> 11.616us
       %6463 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 698.690us
         %6464 = :nvte_rmsnorm_fwd [] -> 4.320us
                 -->kernel: 0:7 %4583 =  [] -> 4.320us
         %6465 = :nvte_quantize_v2 [] -> 7.680us
           %6466 = :quantize_transpose_vector_blockwise [] -> 7.680us
                 -->kernel: 0:7 %4584 =  [] -> 7.680us
         %6467 = :nvte_quantize_v2 [] -> 28.640us
           %6468 = :quantize_transpose_square_blockwise [] -> 28.640us
                 -->kernel: 0:7 %4585 =  [] -> 28.640us
         %6469 = :nvte_cublas_gemm_scaled [] -> 525.761us
                 -->kernel: 0:7 %4586 =  [] -> 519.521us
     %6470 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.528us
                 -->kernel: 0:7 %4587 =  [] -> 114.528us
     %6471 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 173.792us
                 -->kernel: 0:7 %4588 =  [] -> 173.792us
     %6472 = :TEDotProductAttention forward [] -> 22.514ms
       %6473 = :aten::arange [[], [], [], [], []] -> 1.152us
         %6474 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %4589 =  [] -> 1.152us
       %6475 = :aten::arange [[], [], [], [], []] -> 1.152us
         %6476 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %4590 =  [] -> 1.152us
       %6477 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 61.312us
                 -->kernel: 0:7 %4591 =  [] -> 61.312us
       %6478 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 38.816us
                 -->kernel: 0:7 %4592 =  [] -> 38.816us
       %6479 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.145us
                 -->kernel: 0:7 %4593 =  [] -> 38.145us
       %6480 = :aten::le [[1, 1, 4096, 4096], []] -> 29.344us
                 -->kernel: 0:7 %4594 =  [] -> 29.344us
       %6481 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.704us
                 -->kernel: 0:7 %4595 =  [] -> 24.704us
       %6482 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.528us
                 -->kernel: 0:7 %4596 =  [] -> 14.528us
       %6483 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.912us
         %6484 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.912us
                 -->kernel: 0:7 %4597 =  [] -> 18.912us
       %6485 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.960us
         %6486 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.960us
                 -->kernel: 0:7 %4598 =  [] -> 12.960us
       %6487 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.304us
         %6488 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.304us
                 -->kernel: 0:7 %4599 =  [] -> 18.304us
       %6489 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.837ms
                 -->kernel: 0:7 %4600 =  [] -> 5.828ms
       %6490 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.004ms
         %6491 = :nvte_scaled_masked_softmax_forward [] -> 11.004ms
                 -->kernel: 0:7 %4601 =  [] -> 11.004ms
       %6492 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.991ms
                 -->kernel: 0:7 %4602 =  [] -> 3.978ms
       %6493 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.945us
         %6494 = :aten::clone [[4096, 1, 128, 128], []] -> 278.945us
           %6495 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.945us
                 -->kernel: 0:7 %4603 =  [] -> 278.945us
     %6496 = :TERowParallelLinear forward [] -> 3.849ms
       %6497 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.849ms
         %6498 = :nvte_quantize_v2 [] -> 97.761us
           %6499 = :quantize_transpose_vector_blockwise [] -> 97.761us
                 -->kernel: 0:7 %4604 =  [] -> 97.761us
         %6500 = :nvte_quantize_v2 [] -> 170.208us
           %6501 = :quantize_transpose_square_blockwise [] -> 170.208us
                 -->kernel: 0:7 %4605 =  [] -> 170.208us
         %6502 = :nvte_cublas_gemm_scaled [] -> 3.430ms
                 -->kernel: 0:7 %4606 =  [] -> 3.423ms
     %6503 = :Torch-Compiled Region: 1/2 None -> 43.649us
       %6504 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 43.649us
         %6505 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 43.649us
                 -->kernel: 0:7 %4607 =  [] -> 43.649us
     %6506 = :TELayerNormColumnParallelLinear forward [] -> 8.459ms
       %6507 = :_LayerNormLinear [[4096, 1, 7168], [7168], [], [36864, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 8.459ms
         %6508 = :nvte_rmsnorm_fwd [] -> 126.337us
                 -->kernel: 0:7 %4608 =  [] -> 126.337us
         %6509 = :nvte_quantize_v2 [] -> 73.120us
           %6510 = :quantize_transpose_vector_blockwise [] -> 73.120us
                 -->kernel: 0:7 %4609 =  [] -> 73.120us
         %6511 = :nvte_quantize_v2 [] -> 390.433us
           %6512 = :quantize_transpose_square_blockwise [] -> 390.433us
                 -->kernel: 0:7 %4610 =  [] -> 390.433us
         %6513 = :nvte_cublas_gemm_scaled [] -> 7.714ms
                 -->kernel: 0:7 %4611 =  [] -> 7.708ms
     %6514 = :SwiGLUFunction [[4096, 36864], [], []] -> 131.585us
       %6515 = :Torch-Compiled Region: 2/0 None -> 131.585us
         %6516 = :triton_poi_fused_mul_silu_0 [[4096, 36864], [4096, 18432], [], []] -> 131.585us
                 -->kernel: 0:7 %4612 =  [] -> 131.585us
     %6517 = :TERowParallelLinear forward [] -> 4.395ms
       %6518 = :_Linear [[7168, 18432], [4096, 1, 18432], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 4.395ms
         %6519 = :nvte_quantize_v2 [] -> 183.137us
           %6520 = :quantize_transpose_vector_blockwise [] -> 183.137us
                 -->kernel: 0:7 %4613 =  [] -> 183.137us
         %6521 = :nvte_quantize_v2 [] -> 194.720us
           %6522 = :quantize_transpose_square_blockwise [] -> 194.720us
                 -->kernel: 0:7 %4614 =  [] -> 194.720us
         %6523 = :nvte_cublas_gemm_scaled [] -> 3.871ms
                 -->kernel: 0:7 %4615 =  [] -> 3.864ms
     %6524 = :Torch-Compiled Region: 1/2 None -> 44.000us
       %6525 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.000us
         %6526 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.000us
                 -->kernel: 0:7 %4616 =  [] -> 44.000us
     %6527 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.241us
       %6528 = :nvte_rmsnorm_fwd [] -> 126.241us
                 -->kernel: 0:7 %4617 =  [] -> 126.241us
     %6529 = :TELinear forward [] -> 565.922us
       %6530 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 565.922us
         %6531 = :nvte_quantize_v2 [] -> 73.888us
           %6532 = :quantize_transpose_vector_blockwise [] -> 73.888us
                 -->kernel: 0:7 %4618 =  [] -> 73.888us
         %6533 = :nvte_quantize_v2 [] -> 20.512us
           %6534 = :quantize_transpose_square_blockwise [] -> 20.512us
                 -->kernel: 0:7 %4619 =  [] -> 20.512us
         %6535 = :nvte_cublas_gemm_scaled [] -> 337.601us
                 -->kernel: 0:7 %4620 =  [] -> 331.329us
     %6536 = :TELinear forward [] -> 403.457us
       %6537 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 403.457us
         %6538 = :nvte_quantize_v2 [] -> 72.704us
           %6539 = :quantize_transpose_vector_blockwise [] -> 72.704us
                 -->kernel: 0:7 %4621 =  [] -> 72.704us
         %6540 = :nvte_quantize_v2 [] -> 11.649us
           %6541 = :quantize_transpose_square_blockwise [] -> 11.649us
                 -->kernel: 0:7 %4622 =  [] -> 11.649us
         %6542 = :nvte_cublas_gemm_scaled [] -> 204.864us
                 -->kernel: 0:7 %4623 =  [] -> 198.080us
     %6543 = :TELayerNormColumnParallelLinear forward [] -> 1.373ms
       %6544 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.373ms
         %6545 = :nvte_rmsnorm_fwd [] -> 30.208us
                 -->kernel: 0:7 %4624 =  [] -> 30.208us
         %6546 = :nvte_quantize_v2 [] -> 17.056us
           %6547 = :quantize_transpose_vector_blockwise [] -> 17.056us
                 -->kernel: 0:7 %4625 =  [] -> 17.056us
         %6548 = :nvte_quantize_v2 [] -> 58.400us
           %6549 = :quantize_transpose_square_blockwise [] -> 58.400us
                 -->kernel: 0:7 %4626 =  [] -> 58.400us
         %6550 = :nvte_cublas_gemm_scaled [] -> 1.135ms
                 -->kernel: 0:7 %4627 =  [] -> 1.129ms
     %6551 = :TELayerNormColumnParallelLinear forward [] -> 900.514us
       %6552 = :aten::contiguous [[4096, 1, 512], []] -> 11.584us
         %6553 = :aten::clone [[4096, 1, 512], []] -> 11.584us
           %6554 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.584us
                 -->kernel: 0:7 %4628 =  [] -> 11.584us
       %6555 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 699.042us
         %6556 = :nvte_rmsnorm_fwd [] -> 4.256us
                 -->kernel: 0:7 %4629 =  [] -> 4.256us
         %6557 = :nvte_quantize_v2 [] -> 7.744us
           %6558 = :quantize_transpose_vector_blockwise [] -> 7.744us
                 -->kernel: 0:7 %4630 =  [] -> 7.744us
         %6559 = :nvte_quantize_v2 [] -> 28.576us
           %6560 = :quantize_transpose_square_blockwise [] -> 28.576us
                 -->kernel: 0:7 %4631 =  [] -> 28.576us
         %6561 = :nvte_cublas_gemm_scaled [] -> 527.009us
                 -->kernel: 0:7 %4632 =  [] -> 520.673us
     %6562 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.496us
                 -->kernel: 0:7 %4633 =  [] -> 114.496us
     %6563 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 173.089us
                 -->kernel: 0:7 %4634 =  [] -> 173.089us
     %6564 = :TEDotProductAttention forward [] -> 22.429ms
       %6565 = :aten::arange [[], [], [], [], []] -> 1.344us
         %6566 = :aten::arange [[], [], [], [0]] -> 1.344us
                 -->kernel: 0:7 %4635 =  [] -> 1.344us
       %6567 = :aten::arange [[], [], [], [], []] -> 1.152us
         %6568 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %4636 =  [] -> 1.152us
       %6569 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 61.216us
                 -->kernel: 0:7 %4637 =  [] -> 61.216us
       %6570 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 39.904us
                 -->kernel: 0:7 %4638 =  [] -> 39.904us
       %6571 = :aten::add [[1, 1, 4096, 4096], [], []] -> 37.888us
                 -->kernel: 0:7 %4639 =  [] -> 37.888us
       %6572 = :aten::le [[1, 1, 4096, 4096], []] -> 28.544us
                 -->kernel: 0:7 %4640 =  [] -> 28.544us
       %6573 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.512us
                 -->kernel: 0:7 %4641 =  [] -> 24.512us
       %6574 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.336us
                 -->kernel: 0:7 %4642 =  [] -> 14.336us
       %6575 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.976us
         %6576 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.976us
                 -->kernel: 0:7 %4643 =  [] -> 18.976us
       %6577 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.960us
         %6578 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.960us
                 -->kernel: 0:7 %4644 =  [] -> 12.960us
       %6579 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.112us
         %6580 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.112us
                 -->kernel: 0:7 %4645 =  [] -> 18.112us
       %6581 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.834ms
                 -->kernel: 0:7 %4646 =  [] -> 5.825ms
       %6582 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.000ms
         %6583 = :nvte_scaled_masked_softmax_forward [] -> 11.000ms
                 -->kernel: 0:7 %4647 =  [] -> 11.000ms
       %6584 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.991ms
                 -->kernel: 0:7 %4648 =  [] -> 3.977ms
       %6585 = :aten::contiguous [[4096, 1, 128, 128], []] -> 279.201us
         %6586 = :aten::clone [[4096, 1, 128, 128], []] -> 279.201us
           %6587 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 279.201us
                 -->kernel: 0:7 %4649 =  [] -> 279.201us
     %6588 = :TERowParallelLinear forward [] -> 3.847ms
       %6589 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.847ms
         %6590 = :nvte_quantize_v2 [] -> 97.696us
           %6591 = :quantize_transpose_vector_blockwise [] -> 97.696us
                 -->kernel: 0:7 %4650 =  [] -> 97.696us
         %6592 = :nvte_quantize_v2 [] -> 169.601us
           %6593 = :quantize_transpose_square_blockwise [] -> 169.601us
                 -->kernel: 0:7 %4651 =  [] -> 169.601us
         %6594 = :nvte_cublas_gemm_scaled [] -> 3.429ms
                 -->kernel: 0:7 %4652 =  [] -> 3.422ms
     %6595 = :Torch-Compiled Region: 1/2 None -> 44.992us
       %6596 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.992us
         %6597 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.992us
                 -->kernel: 0:7 %4653 =  [] -> 44.992us
     %6598 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.849us
       %6599 = :nvte_rmsnorm_fwd [] -> 126.849us
                 -->kernel: 0:7 %4654 =  [] -> 126.849us
     %6600 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 42.112us
       %6601 = :nvte_cublas_gemm_scaled [] -> 42.112us
                 -->kernel: 0:7 %4655 =  [] -> 21.984us
                 -->kernel: 0:7 %4656 =  [] -> 2.656us
     %6602 = :RandomSTE [[4096, 1, 32]] -> 45.441us
       %6603 = :aten::clone [[4096, 1, 32], []] -> 1.600us
         %6604 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.600us
       %6605 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.736us
                 -->kernel: 0:7 %4657 =  [] -> 4.736us
     %6606 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 70.368us
       %6607 = :nvte_fused_topk_with_score_function_forward [] -> 70.368us
                 -->kernel: 0:7 %4658 =  [] -> 70.368us
     %6608 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 27.200us
       %6609 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 27.200us
                 -->kernel: 0:7 %4659 =  [] -> 27.200us
     %6610 = :aten::sum [[4096, 32], [], [], []] -> 48.129us
       %6611 = :aten::to [[4096, 32], [], [], [], []] -> 4.769us
         %6612 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.769us
           %6613 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.769us
                 -->kernel: 0:7 %4660 =  [] -> 4.769us
                 -->kernel: 0:7 %4661 =  [] -> 10.112us
     %6614 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.320us
       %6615 = :nvte_fused_moe_aux_loss_forward [] -> 12.320us
                 -->kernel: 0:7 %4662 =  [] -> 12.320us
     %6616 = :aten::div [[], []] -> 1.248us
                 -->kernel: 0:7 %4663 =  [] -> 1.248us
     %6617 = :aten::div [[], []] -> 1.376us
                 -->kernel: 0:7 %4664 =  [] -> 1.376us
     %6618 = :aten::add_ [[], [], []] -> 1.344us
                 -->kernel: 0:7 %4665 =  [] -> 1.344us
     %6619 = :aten::sum [[4096, 32], [], [], []] -> 40.609us
       %6620 = :aten::to [[4096, 32], [], [], [], []] -> 4.736us
         %6621 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.736us
           %6622 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.736us
                 -->kernel: 0:7 %4666 =  [] -> 4.736us
                 -->kernel: 0:7 %4667 =  [] -> 7.744us
     %6623 = :aten::add_ [[32], [32], []] -> 4.096us
                 -->kernel: 0:7 %4668 =  [] -> 4.096us
     %6624 = :aten::topk [[4096, 32], [], [], [], []] -> 54.688us
                 -->kernel: 0:7 %4669 =  [] -> 14.464us
                 -->kernel: 0:7 %4670 =  [] -> 7.680us
     %6625 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 1.114ms
                 -->kernel: 0:26 %4671 =  [] -> 43.936us
                 -->kernel: 0:26 %4672 =  [] -> 155.392us
                 -->kernel: 0:26 %4673 =  [] -> 753.313us
     %6626 = :TEColumnParallelLinear forward [] -> 1.143ms
       %6627 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.143ms
         %6628 = :nvte_quantize_v2 [] -> 45.696us
           %6629 = :quantize_transpose_vector_blockwise [] -> 45.696us
                 -->kernel: 0:7 %4674 =  [] -> 45.696us
         %6630 = :nvte_quantize_v2 [] -> 45.248us
           %6631 = :quantize_transpose_square_blockwise [] -> 45.248us
                 -->kernel: 0:7 %4675 =  [] -> 45.248us
         %6632 = :nvte_cublas_gemm_scaled [] -> 921.506us
                 -->kernel: 0:7 %4676 =  [] -> 915.106us
     %6633 = :SwiGLUFunction [[4096, 4096], [], []] -> 27.424us
       %6634 = :Torch-Compiled Region: 2/1 None -> 27.424us
         %6635 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 27.424us
                 -->kernel: 0:7 %4677 =  [] -> 27.424us
     %6636 = :TERowParallelLinear forward [] -> 615.106us
       %6637 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 615.106us
         %6638 = :nvte_quantize_v2 [] -> 23.616us
           %6639 = :quantize_transpose_vector_blockwise [] -> 23.616us
                 -->kernel: 0:7 %4678 =  [] -> 23.616us
         %6640 = :nvte_quantize_v2 [] -> 24.768us
           %6641 = :quantize_transpose_square_blockwise [] -> 24.768us
                 -->kernel: 0:7 %4679 =  [] -> 24.768us
         %6642 = :nvte_cublas_gemm_scaled [] -> 446.977us
                 -->kernel: 0:7 %4680 =  [] -> 440.481us
     %6643 = :IndicesToMultihot [[15636, 8], [15636, 8], []] -> 10.976us
                 -->kernel: 0:7 %4681 =  [] -> 10.976us
     %6644 = :aten::contiguous [[4, 15636], []] -> 3.040us
       %6645 = :aten::clone [[4, 15636], []] -> 3.040us
         %6646 = :aten::copy_ [[4, 15636], [4, 15636], []] -> 3.040us
                 -->kernel: 0:7 %4682 =  [] -> 3.040us
     %6647 = :aten::to [[4, 15636], [], [], [], []] -> 5.024us
       %6648 = :aten::_to_copy [[4, 15636], [], [], [], [], [], []] -> 5.024us
         %6649 = :aten::copy_ [[4, 15636], [4, 15636], []] -> 5.024us
                 -->kernel: 0:7 %4683 =  [] -> 5.024us
                 -->kernel: 0:7 %4684 =  [] -> 22.496us
     %6650 = :_moe_permute_mask_map [[15636, 7168], [15636, 4], [], [15636, 4]] -> 407.073us
                 -->kernel: 0:7 %4685 =  [] -> 2.496us
                 -->kernel: 0:7 %4686 =  [] -> 2.624us
                 -->kernel: 0:7 %4687 =  [] -> 13.184us
                 -->kernel: 0:7 %4688 =  [] -> 200.129us
     %6651 = :TEColumnParallelGroupedLinear forward [] -> 8.462ms
       %6652 = :_GroupedLinear [[32640, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.462ms
         %6653 = :nvte_quantize_v2 [] -> 221.217us
           %6654 = :quantize_transpose_vector_blockwise [] -> 221.217us
                 -->kernel: 0:7 %4689 =  [] -> 221.217us
         %6655 = :nvte_quantize_v2 [] -> 220.001us
           %6656 = :quantize_transpose_vector_blockwise [] -> 220.001us
                 -->kernel: 0:7 %4690 =  [] -> 220.001us
         %6657 = :nvte_quantize_v2 [] -> 223.296us
           %6658 = :quantize_transpose_vector_blockwise [] -> 223.296us
                 -->kernel: 0:7 %4691 =  [] -> 223.296us
         %6659 = :nvte_quantize_v2 [] -> 220.225us
           %6660 = :quantize_transpose_vector_blockwise [] -> 220.225us
                 -->kernel: 0:7 %4692 =  [] -> 220.225us
         %6661 = :nvte_quantize_v2 [] -> 46.016us
           %6662 = :quantize_transpose_square_blockwise [] -> 46.016us
                 -->kernel: 0:7 %4693 =  [] -> 46.016us
         %6663 = :nvte_quantize_v2 [] -> 45.984us
           %6664 = :quantize_transpose_square_blockwise [] -> 45.984us
                 -->kernel: 0:7 %4694 =  [] -> 45.984us
         %6665 = :nvte_quantize_v2 [] -> 46.240us
           %6666 = :quantize_transpose_square_blockwise [] -> 46.240us
                 -->kernel: 0:7 %4695 =  [] -> 46.240us
         %6667 = :nvte_quantize_v2 [] -> 46.208us
           %6668 = :quantize_transpose_square_blockwise [] -> 46.208us
                 -->kernel: 0:7 %4696 =  [] -> 46.208us
         %6669 = :nvte_multi_stream_cublas_gemm [] -> 7.080ms
           %6670 = :nvte_cublas_gemm [] -> 1.757ms
                 -->kernel: 0:159 %4697 =  [] -> 1.749ms
           %6671 = :nvte_cublas_gemm [] -> 1.750ms
                 -->kernel: 0:160 %4698 =  [] -> 1.745ms
           %6672 = :nvte_cublas_gemm [] -> 1.753ms
                 -->kernel: 0:161 %4699 =  [] -> 1.748ms
           %6673 = :nvte_cublas_gemm [] -> 1.749ms
                 -->kernel: 0:162 %4700 =  [] -> 1.745ms
     %6674 = :WeightedSwiGLUFunction [[32640, 4096], [32640, 1], []] -> 119.393us
       %6675 = :Torch-Compiled Region: 3/1 None -> 119.393us
         %6676 = :triton_poi_fused__to_copy_mul_silu_0 [[32640, 4096], [32640, 1], [32640, 2048], [], []] -> 119.393us
                 -->kernel: 0:7 %4701 =  [] -> 119.393us
     %6677 = :TERowParallelGroupedLinear forward [] -> 4.239ms
       %6678 = :_GroupedLinear [[32640, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.239ms
         %6679 = :nvte_quantize_v2 [] -> 66.849us
           %6680 = :quantize_transpose_vector_blockwise [] -> 66.849us
                 -->kernel: 0:7 %4702 =  [] -> 66.849us
         %6681 = :nvte_quantize_v2 [] -> 67.680us
           %6682 = :quantize_transpose_vector_blockwise [] -> 67.680us
                 -->kernel: 0:7 %4703 =  [] -> 67.680us
         %6683 = :nvte_quantize_v2 [] -> 69.664us
           %6684 = :quantize_transpose_vector_blockwise [] -> 69.664us
                 -->kernel: 0:7 %4704 =  [] -> 69.664us
         %6685 = :nvte_quantize_v2 [] -> 69.280us
           %6686 = :quantize_transpose_vector_blockwise [] -> 69.280us
                 -->kernel: 0:7 %4705 =  [] -> 69.280us
         %6687 = :nvte_quantize_v2 [] -> 24.256us
           %6688 = :quantize_transpose_square_blockwise [] -> 24.256us
                 -->kernel: 0:7 %4706 =  [] -> 24.256us
         %6689 = :nvte_quantize_v2 [] -> 24.160us
           %6690 = :quantize_transpose_square_blockwise [] -> 24.160us
                 -->kernel: 0:7 %4707 =  [] -> 24.160us
         %6691 = :nvte_quantize_v2 [] -> 24.704us
           %6692 = :quantize_transpose_square_blockwise [] -> 24.704us
                 -->kernel: 0:7 %4708 =  [] -> 24.704us
         %6693 = :nvte_quantize_v2 [] -> 24.384us
           %6694 = :quantize_transpose_square_blockwise [] -> 24.384us
                 -->kernel: 0:7 %4709 =  [] -> 24.384us
         %6695 = :nvte_multi_stream_cublas_gemm [] -> 3.573ms
           %6696 = :nvte_cublas_gemm [] -> 877.186us
                 -->kernel: 0:159 %4710 =  [] -> 869.570us
           %6697 = :nvte_cublas_gemm [] -> 874.722us
                 -->kernel: 0:160 %4711 =  [] -> 869.730us
           %6698 = :nvte_cublas_gemm [] -> 886.850us
                 -->kernel: 0:161 %4712 =  [] -> 883.490us
           %6699 = :nvte_cublas_gemm [] -> 870.435us
                 -->kernel: 0:162 %4713 =  [] -> 866.787us
     %6700 = :_moe_unpermute_mask_map [[32640, 7168], [15636, 9], [], []] -> 225.089us
                 -->kernel: 0:7 %4714 =  [] -> 225.089us
     %6701 = :FusedCombine [[15636, 7168], [], []] -> 740.962us
                 -->kernel: 0:26 %4715 =  [] -> 14.464us
                 -->kernel: 0:26 %4716 =  [] -> 697.218us
     %6702 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 53.152us
                 -->kernel: 0:7 %4717 =  [] -> 53.152us
     %6703 = :Torch-Compiled Region: 1/2 None -> 47.072us
       %6704 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 47.072us
         %6705 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 47.072us
                 -->kernel: 0:7 %4718 =  [] -> 47.072us
     %6706 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.561us
       %6707 = :nvte_rmsnorm_fwd [] -> 126.561us
                 -->kernel: 0:7 %4719 =  [] -> 126.561us
     %6708 = :aten::roll [[1, 4096], [], []] -> 2.208us
                 -->kernel: 0:7 %4720 =  [] -> 2.208us
     %6709 = :aten::fill_ [[1], []] -> 1.216us
                 -->kernel: 0:7 %4721 =  [] -> 1.216us
     %6710 = :aten::sum [[1, 4096], []] -> 3.200us
       %6711 = :aten::sum [[1, 4096], [], [], []] -> 3.200us
                 -->kernel: 0:7 %4722 =  [] -> 3.200us
     %6712 = :aten::roll [[1, 4096], [], []] -> 2.208us
                 -->kernel: 0:7 %4723 =  [] -> 2.208us
     %6713 = :aten::fill_ [[1], []] -> 1.248us
                 -->kernel: 0:7 %4724 =  [] -> 1.248us
     %6714 = :aten::sum [[1, 4096], []] -> 3.520us
       %6715 = :aten::sum [[1, 4096], [], [], []] -> 3.520us
                 -->kernel: 0:7 %4725 =  [] -> 3.520us
     %6716 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 277.025us
       %6717 = :aten::index_select [[129280, 7168], [], [4096]] -> 277.025us
                 -->kernel: 0:7 %4726 =  [] -> 277.025us
     %6718 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 128.065us
       %6719 = :nvte_rmsnorm_fwd [] -> 128.065us
                 -->kernel: 0:7 %4727 =  [] -> 128.065us
     %6720 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.049us
       %6721 = :nvte_rmsnorm_fwd [] -> 126.049us
                 -->kernel: 0:7 %4728 =  [] -> 126.049us
     %6722 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 162.880us
                 -->kernel: 0:7 %4729 =  [] -> 162.880us
     %6723 = :TEColumnParallelLinear forward [] -> 3.413ms
       %6724 = :_Linear [[7168, 14336], [4096, 1, 14336], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.413ms
         %6725 = :nvte_quantize_v2 [] -> 144.480us
           %6726 = :quantize_transpose_vector_blockwise [] -> 144.480us
                 -->kernel: 0:7 %4730 =  [] -> 144.480us
         %6727 = :nvte_quantize_v2 [] -> 152.513us
           %6728 = :quantize_transpose_square_blockwise [] -> 152.513us
                 -->kernel: 0:7 %4731 =  [] -> 152.513us
         %6729 = :nvte_cublas_gemm_scaled [] -> 2.982ms
                 -->kernel: 0:7 %4732 =  [] -> 2.975ms
     %6730 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 121.312us
       %6731 = :nvte_rmsnorm_fwd [] -> 121.312us
                 -->kernel: 0:7 %4733 =  [] -> 121.312us
     %6732 = :TELinear forward [] -> 564.641us
       %6733 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 564.641us
         %6734 = :nvte_quantize_v2 [] -> 74.432us
           %6735 = :quantize_transpose_vector_blockwise [] -> 74.432us
                 -->kernel: 0:7 %4734 =  [] -> 74.432us
         %6736 = :nvte_quantize_v2 [] -> 20.544us
           %6737 = :quantize_transpose_square_blockwise [] -> 20.544us
                 -->kernel: 0:7 %4735 =  [] -> 20.544us
         %6738 = :nvte_cublas_gemm_scaled [] -> 333.857us
                 -->kernel: 0:7 %4736 =  [] -> 327.329us
     %6739 = :TELinear forward [] -> 402.720us
       %6740 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 402.720us
         %6741 = :nvte_quantize_v2 [] -> 73.088us
           %6742 = :quantize_transpose_vector_blockwise [] -> 73.088us
                 -->kernel: 0:7 %4737 =  [] -> 73.088us
         %6743 = :nvte_quantize_v2 [] -> 11.488us
           %6744 = :quantize_transpose_square_blockwise [] -> 11.488us
                 -->kernel: 0:7 %4738 =  [] -> 11.488us
         %6745 = :nvte_cublas_gemm_scaled [] -> 203.360us
                 -->kernel: 0:7 %4739 =  [] -> 197.088us
     %6746 = :TELayerNormColumnParallelLinear forward [] -> 1.366ms
       %6747 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.366ms
         %6748 = :nvte_rmsnorm_fwd [] -> 30.880us
                 -->kernel: 0:7 %4740 =  [] -> 30.880us
         %6749 = :nvte_quantize_v2 [] -> 16.992us
           %6750 = :quantize_transpose_vector_blockwise [] -> 16.992us
                 -->kernel: 0:7 %4741 =  [] -> 16.992us
         %6751 = :nvte_quantize_v2 [] -> 57.376us
           %6752 = :quantize_transpose_square_blockwise [] -> 57.376us
                 -->kernel: 0:7 %4742 =  [] -> 57.376us
         %6753 = :nvte_cublas_gemm_scaled [] -> 1.126ms
                 -->kernel: 0:7 %4743 =  [] -> 1.121ms
     %6754 = :TELayerNormColumnParallelLinear forward [] -> 888.898us
       %6755 = :aten::contiguous [[4096, 1, 512], []] -> 11.552us
         %6756 = :aten::clone [[4096, 1, 512], []] -> 11.552us
           %6757 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.552us
                 -->kernel: 0:7 %4744 =  [] -> 11.552us
       %6758 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 693.217us
         %6759 = :nvte_rmsnorm_fwd [] -> 4.448us
                 -->kernel: 0:7 %4745 =  [] -> 4.448us
         %6760 = :nvte_quantize_v2 [] -> 7.744us
           %6761 = :quantize_transpose_vector_blockwise [] -> 7.744us
                 -->kernel: 0:7 %4746 =  [] -> 7.744us
         %6762 = :nvte_quantize_v2 [] -> 28.128us
           %6763 = :quantize_transpose_square_blockwise [] -> 28.128us
                 -->kernel: 0:7 %4747 =  [] -> 28.128us
         %6764 = :nvte_cublas_gemm_scaled [] -> 522.721us
                 -->kernel: 0:7 %4748 =  [] -> 516.577us
     %6765 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.272us
                 -->kernel: 0:7 %4749 =  [] -> 114.272us
     %6766 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 173.504us
                 -->kernel: 0:7 %4750 =  [] -> 173.504us
     %6767 = :TEDotProductAttention forward [] -> 22.357ms
       %6768 = :aten::arange [[], [], [], [], []] -> 1.152us
         %6769 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %4751 =  [] -> 1.152us
       %6770 = :aten::arange [[], [], [], [], []] -> 1.344us
         %6771 = :aten::arange [[], [], [], [0]] -> 1.344us
                 -->kernel: 0:7 %4752 =  [] -> 1.344us
       %6772 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 60.704us
                 -->kernel: 0:7 %4753 =  [] -> 60.704us
       %6773 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 40.096us
                 -->kernel: 0:7 %4754 =  [] -> 40.096us
       %6774 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.112us
                 -->kernel: 0:7 %4755 =  [] -> 38.112us
       %6775 = :aten::le [[1, 1, 4096, 4096], []] -> 28.193us
                 -->kernel: 0:7 %4756 =  [] -> 28.193us
       %6776 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.800us
                 -->kernel: 0:7 %4757 =  [] -> 24.800us
       %6777 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.240us
                 -->kernel: 0:7 %4758 =  [] -> 14.240us
       %6778 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.976us
         %6779 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.976us
                 -->kernel: 0:7 %4759 =  [] -> 18.976us
       %6780 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.864us
         %6781 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.864us
                 -->kernel: 0:7 %4760 =  [] -> 12.864us
       %6782 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.176us
         %6783 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.176us
                 -->kernel: 0:7 %4761 =  [] -> 18.176us
       %6784 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.805ms
                 -->kernel: 0:7 %4762 =  [] -> 5.797ms
       %6785 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 10.992ms
         %6786 = :nvte_scaled_masked_softmax_forward [] -> 10.992ms
                 -->kernel: 0:7 %4763 =  [] -> 10.992ms
       %6787 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.981ms
                 -->kernel: 0:7 %4764 =  [] -> 3.966ms
       %6788 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.784us
         %6789 = :aten::clone [[4096, 1, 128, 128], []] -> 278.784us
           %6790 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.784us
                 -->kernel: 0:7 %4765 =  [] -> 278.784us
     %6791 = :TERowParallelLinear forward [] -> 3.821ms
       %6792 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.821ms
         %6793 = :nvte_quantize_v2 [] -> 96.576us
           %6794 = :quantize_transpose_vector_blockwise [] -> 96.576us
                 -->kernel: 0:7 %4766 =  [] -> 96.576us
         %6795 = :nvte_quantize_v2 [] -> 169.857us
           %6796 = :quantize_transpose_square_blockwise [] -> 169.857us
                 -->kernel: 0:7 %4767 =  [] -> 169.857us
         %6797 = :nvte_cublas_gemm_scaled [] -> 3.405ms
                 -->kernel: 0:7 %4768 =  [] -> 3.398ms
     %6798 = :Torch-Compiled Region: 1/2 None -> 44.032us
       %6799 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.032us
         %6800 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.032us
                 -->kernel: 0:7 %4769 =  [] -> 44.032us
     %6801 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 125.953us
       %6802 = :nvte_rmsnorm_fwd [] -> 125.953us
                 -->kernel: 0:7 %4770 =  [] -> 125.953us
     %6803 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 41.728us
       %6804 = :nvte_cublas_gemm_scaled [] -> 41.728us
                 -->kernel: 0:7 %4771 =  [] -> 22.176us
                 -->kernel: 0:7 %4772 =  [] -> 2.560us
     %6805 = :RandomSTE [[4096, 1, 32]] -> 41.729us
       %6806 = :aten::clone [[4096, 1, 32], []] -> 1.536us
         %6807 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.536us
       %6808 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.833us
                 -->kernel: 0:7 %4773 =  [] -> 4.833us
     %6809 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 69.696us
       %6810 = :nvte_fused_topk_with_score_function_forward [] -> 69.696us
                 -->kernel: 0:7 %4774 =  [] -> 69.696us
     %6811 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 26.784us
       %6812 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 26.784us
                 -->kernel: 0:7 %4775 =  [] -> 26.784us
     %6813 = :aten::sum [[4096, 32], [], [], []] -> 46.497us
       %6814 = :aten::to [[4096, 32], [], [], [], []] -> 4.768us
         %6815 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.768us
           %6816 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.768us
                 -->kernel: 0:7 %4776 =  [] -> 4.768us
                 -->kernel: 0:7 %4777 =  [] -> 9.856us
     %6817 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.096us
       %6818 = :nvte_fused_moe_aux_loss_forward [] -> 12.096us
                 -->kernel: 0:7 %4778 =  [] -> 12.096us
     %6819 = :aten::div [[], []] -> 1.344us
                 -->kernel: 0:7 %4779 =  [] -> 1.344us
     %6820 = :aten::div [[], []] -> 1.632us
                 -->kernel: 0:7 %4780 =  [] -> 1.632us
     %6821 = :aten::add_ [[], [], []] -> 1.472us
                 -->kernel: 0:7 %4781 =  [] -> 1.472us
     %6822 = :aten::sum [[4096, 32], [], [], []] -> 35.425us
       %6823 = :aten::to [[4096, 32], [], [], [], []] -> 4.672us
         %6824 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.672us
           %6825 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.672us
                 -->kernel: 0:7 %4782 =  [] -> 4.672us
                 -->kernel: 0:7 %4783 =  [] -> 7.745us
     %6826 = :aten::add_ [[32], [32], []] -> 4.032us
                 -->kernel: 0:7 %4784 =  [] -> 4.032us
     %6827 = :aten::topk [[4096, 32], [], [], [], []] -> 51.584us
                 -->kernel: 0:7 %4785 =  [] -> 14.464us
                 -->kernel: 0:7 %4786 =  [] -> 7.648us
     %6828 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 844.354us
                 -->kernel: 0:26 %4787 =  [] -> 45.184us
                 -->kernel: 0:26 %4788 =  [] -> 12.480us
                 -->kernel: 0:26 %4789 =  [] -> 657.986us
     %6829 = :TEColumnParallelLinear forward [] -> 1.152ms
       %6830 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.152ms
         %6831 = :nvte_quantize_v2 [] -> 44.960us
           %6832 = :quantize_transpose_vector_blockwise [] -> 44.960us
                 -->kernel: 0:7 %4790 =  [] -> 44.960us
         %6833 = :nvte_quantize_v2 [] -> 44.641us
           %6834 = :quantize_transpose_square_blockwise [] -> 44.641us
                 -->kernel: 0:7 %4791 =  [] -> 44.641us
         %6835 = :nvte_cublas_gemm_scaled [] -> 912.258us
                 -->kernel: 0:7 %4792 =  [] -> 905.826us
     %6836 = :SwiGLUFunction [[4096, 4096], [], []] -> 26.944us
       %6837 = :Torch-Compiled Region: 2/1 None -> 26.944us
         %6838 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 26.944us
                 -->kernel: 0:7 %4793 =  [] -> 26.944us
     %6839 = :TERowParallelLinear forward [] -> 607.874us
       %6840 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 607.874us
         %6841 = :nvte_quantize_v2 [] -> 23.008us
           %6842 = :quantize_transpose_vector_blockwise [] -> 23.008us
                 -->kernel: 0:7 %4794 =  [] -> 23.008us
         %6843 = :nvte_quantize_v2 [] -> 24.832us
           %6844 = :quantize_transpose_square_blockwise [] -> 24.832us
                 -->kernel: 0:7 %4795 =  [] -> 24.832us
         %6845 = :nvte_cublas_gemm_scaled [] -> 441.601us
                 -->kernel: 0:7 %4796 =  [] -> 435.233us
     %6846 = :IndicesToMultihot [[15871, 8], [15871, 8], []] -> 11.104us
                 -->kernel: 0:7 %4797 =  [] -> 11.104us
     %6847 = :aten::contiguous [[4, 15871], []] -> 3.040us
       %6848 = :aten::clone [[4, 15871], []] -> 3.040us
         %6849 = :aten::copy_ [[4, 15871], [4, 15871], []] -> 3.040us
                 -->kernel: 0:7 %4798 =  [] -> 3.040us
     %6850 = :aten::to [[4, 15871], [], [], [], []] -> 4.960us
       %6851 = :aten::_to_copy [[4, 15871], [], [], [], [], [], []] -> 4.960us
         %6852 = :aten::copy_ [[4, 15871], [4, 15871], []] -> 4.960us
                 -->kernel: 0:7 %4799 =  [] -> 4.960us
                 -->kernel: 0:7 %4800 =  [] -> 23.136us
     %6853 = :_moe_permute_mask_map [[15871, 7168], [15871, 4], [], [15871, 4]] -> 401.633us
                 -->kernel: 0:7 %4801 =  [] -> 2.176us
                 -->kernel: 0:7 %4802 =  [] -> 2.464us
                 -->kernel: 0:7 %4803 =  [] -> 13.312us
                 -->kernel: 0:7 %4804 =  [] -> 203.169us
     %6854 = :TEColumnParallelGroupedLinear forward [] -> 8.219ms
       %6855 = :_GroupedLinear [[33104, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.219ms
         %6856 = :nvte_quantize_v2 [] -> 147.137us
           %6857 = :quantize_transpose_vector_blockwise [] -> 147.137us
                 -->kernel: 0:7 %4805 =  [] -> 147.137us
         %6858 = :nvte_quantize_v2 [] -> 219.456us
           %6859 = :quantize_transpose_vector_blockwise [] -> 219.456us
                 -->kernel: 0:7 %4806 =  [] -> 219.456us
         %6860 = :nvte_quantize_v2 [] -> 144.001us
           %6861 = :quantize_transpose_vector_blockwise [] -> 144.001us
                 -->kernel: 0:7 %4807 =  [] -> 144.001us
         %6862 = :nvte_quantize_v2 [] -> 146.112us
           %6863 = :quantize_transpose_vector_blockwise [] -> 146.112us
                 -->kernel: 0:7 %4808 =  [] -> 146.112us
         %6864 = :nvte_quantize_v2 [] -> 45.888us
           %6865 = :quantize_transpose_square_blockwise [] -> 45.888us
                 -->kernel: 0:7 %4809 =  [] -> 45.888us
         %6866 = :nvte_quantize_v2 [] -> 45.536us
           %6867 = :quantize_transpose_square_blockwise [] -> 45.536us
                 -->kernel: 0:7 %4810 =  [] -> 45.536us
         %6868 = :nvte_quantize_v2 [] -> 45.217us
           %6869 = :quantize_transpose_square_blockwise [] -> 45.217us
                 -->kernel: 0:7 %4811 =  [] -> 45.217us
         %6870 = :nvte_quantize_v2 [] -> 45.472us
           %6871 = :quantize_transpose_square_blockwise [] -> 45.472us
                 -->kernel: 0:7 %4812 =  [] -> 45.472us
         %6872 = :nvte_multi_stream_cublas_gemm [] -> 7.079ms
           %6873 = :nvte_cublas_gemm [] -> 1.758ms
                 -->kernel: 0:159 %4813 =  [] -> 1.749ms
           %6874 = :nvte_cublas_gemm [] -> 1.751ms
                 -->kernel: 0:160 %4814 =  [] -> 1.745ms
           %6875 = :nvte_cublas_gemm [] -> 1.753ms
                 -->kernel: 0:161 %4815 =  [] -> 1.749ms
           %6876 = :nvte_cublas_gemm [] -> 1.754ms
                 -->kernel: 0:162 %4816 =  [] -> 1.749ms
     %6877 = :WeightedSwiGLUFunction [[33104, 4096], [33104, 1], []] -> 122.048us
       %6878 = :Torch-Compiled Region: 3/1 None -> 122.048us
         %6879 = :triton_poi_fused__to_copy_mul_silu_0 [[33104, 4096], [33104, 1], [33104, 2048], [], []] -> 122.048us
                 -->kernel: 0:7 %4817 =  [] -> 122.048us
     %6880 = :TERowParallelGroupedLinear forward [] -> 4.183ms
       %6881 = :_GroupedLinear [[33104, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.183ms
         %6882 = :nvte_quantize_v2 [] -> 44.960us
           %6883 = :quantize_transpose_vector_blockwise [] -> 44.960us
                 -->kernel: 0:7 %4818 =  [] -> 44.960us
         %6884 = :nvte_quantize_v2 [] -> 68.736us
           %6885 = :quantize_transpose_vector_blockwise [] -> 68.736us
                 -->kernel: 0:7 %4819 =  [] -> 68.736us
         %6886 = :nvte_quantize_v2 [] -> 45.440us
           %6887 = :quantize_transpose_vector_blockwise [] -> 45.440us
                 -->kernel: 0:7 %4820 =  [] -> 45.440us
         %6888 = :nvte_quantize_v2 [] -> 45.792us
           %6889 = :quantize_transpose_vector_blockwise [] -> 45.792us
                 -->kernel: 0:7 %4821 =  [] -> 45.792us
         %6890 = :nvte_quantize_v2 [] -> 25.056us
           %6891 = :quantize_transpose_square_blockwise [] -> 25.056us
                 -->kernel: 0:7 %4822 =  [] -> 25.056us
         %6892 = :nvte_quantize_v2 [] -> 24.321us
           %6893 = :quantize_transpose_square_blockwise [] -> 24.321us
                 -->kernel: 0:7 %4823 =  [] -> 24.321us
         %6894 = :nvte_quantize_v2 [] -> 24.384us
           %6895 = :quantize_transpose_square_blockwise [] -> 24.384us
                 -->kernel: 0:7 %4824 =  [] -> 24.384us
         %6896 = :nvte_quantize_v2 [] -> 24.640us
           %6897 = :quantize_transpose_square_blockwise [] -> 24.640us
                 -->kernel: 0:7 %4825 =  [] -> 24.640us
         %6898 = :nvte_multi_stream_cublas_gemm [] -> 3.600ms
           %6899 = :nvte_cublas_gemm [] -> 890.882us
                 -->kernel: 0:159 %4826 =  [] -> 884.098us
           %6900 = :nvte_cublas_gemm [] -> 870.562us
                 -->kernel: 0:160 %4827 =  [] -> 866.882us
           %6901 = :nvte_cublas_gemm [] -> 887.490us
                 -->kernel: 0:161 %4828 =  [] -> 884.034us
           %6902 = :nvte_cublas_gemm [] -> 887.970us
                 -->kernel: 0:162 %4829 =  [] -> 883.778us
     %6903 = :_moe_unpermute_mask_map [[33104, 7168], [15871, 9], [], []] -> 228.033us
                 -->kernel: 0:7 %4830 =  [] -> 228.033us
     %6904 = :FusedCombine [[15871, 7168], [], []] -> 788.226us
                 -->kernel: 0:26 %4831 =  [] -> 30.400us
                 -->kernel: 0:26 %4832 =  [] -> 729.186us
     %6905 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.968us
                 -->kernel: 0:7 %4833 =  [] -> 51.968us
     %6906 = :Torch-Compiled Region: 1/2 None -> 48.320us
       %6907 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 48.320us
         %6908 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 48.320us
                 -->kernel: 0:7 %4834 =  [] -> 48.320us
     %6909 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.272us
       %6910 = :nvte_rmsnorm_fwd [] -> 126.272us
                 -->kernel: 0:7 %4835 =  [] -> 126.272us
     %6911 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 163.009us
                 -->kernel: 0:7 %4836 =  [] -> 163.009us
     %6912 = :aten::clone [[1, 4096], []] -> 1.728us
       %6913 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.728us
     %6914 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.677ms
       %6915 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.677ms
         %6916 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.677ms
                 -->kernel: 0:7 %4837 =  [] -> 53.667ms
     %6917 = :aten::roll [[1, 4096], [], []] -> 2.080us
                 -->kernel: 0:7 %4838 =  [] -> 2.080us
     %6918 = :aten::fill_ [[1], []] -> 1.344us
                 -->kernel: 0:7 %4839 =  [] -> 1.344us
     %6919 = :aten::sum [[1, 4096], []] -> 3.616us
       %6920 = :aten::sum [[1, 4096], [], [], []] -> 3.616us
                 -->kernel: 0:7 %4840 =  [] -> 3.616us
     %6921 = :aten::roll [[1, 4096], [], []] -> 2.112us
                 -->kernel: 0:7 %4841 =  [] -> 2.112us
     %6922 = :aten::fill_ [[1], []] -> 1.120us
                 -->kernel: 0:7 %4842 =  [] -> 1.120us
     %6923 = :aten::sum [[1, 4096], []] -> 3.456us
       %6924 = :aten::sum [[1, 4096], [], [], []] -> 3.456us
                 -->kernel: 0:7 %4843 =  [] -> 3.456us
     %6925 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.476ms
       %6926 = :aten::zeros [[], [], [], [], []] -> 1.152us
         %6927 = :aten::zero_ [[4096]] -> 1.152us
           %6928 = :aten::fill_ [[4096], []] -> 1.152us
                 -->kernel: 0:7 %4844 =  [] -> 1.152us
       %6929 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %6930 = :aten::zero_ [[12288]] -> 1.120us
           %6931 = :aten::fill_ [[12288], []] -> 1.120us
                 -->kernel: 0:7 %4845 =  [] -> 1.120us
                 -->kernel: 0:7 %4846 =  [] -> 659.041us
                 -->kernel: 0:7 %4847 =  [] -> 600.130us
     %6932 = :aten::mul [[1, 4096], [1, 4096]] -> 1.920us
                 -->kernel: 0:7 %4848 =  [] -> 1.920us
     %6933 = :aten::sum [[1, 4096], []] -> 2.752us
       %6934 = :aten::sum [[1, 4096], [], [], []] -> 2.752us
                 -->kernel: 0:7 %4849 =  [] -> 2.752us
     %6935 = :aten::div [[], []] -> 1.728us
                 -->kernel: 0:7 %4850 =  [] -> 1.728us
     %6936 = :aten::add_ [[], [], []] -> 1.632us
                 -->kernel: 0:7 %4851 =  [] -> 1.632us
     %6937 = :aten::mul [[1, 4096], []] -> 1.312us
                 -->kernel: 0:7 %4852 =  [] -> 1.312us
     %6938 = :aten::div [[1, 4096], []] -> 2.240us
                 -->kernel: 0:7 %4853 =  [] -> 2.240us
     %6939 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.695ms
       %6940 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.695ms
         %6941 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.695ms
                 -->kernel: 0:7 %4854 =  [] -> 53.686ms
     %6942 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.481ms
       %6943 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %6944 = :aten::zero_ [[4096]] -> 1.120us
           %6945 = :aten::fill_ [[4096], []] -> 1.120us
                 -->kernel: 0:7 %4855 =  [] -> 1.120us
       %6946 = :aten::zeros [[], [], [], [], []] -> 1.248us
         %6947 = :aten::zero_ [[12288]] -> 1.248us
           %6948 = :aten::fill_ [[12288], []] -> 1.248us
                 -->kernel: 0:7 %4856 =  [] -> 1.248us
                 -->kernel: 0:7 %4857 =  [] -> 659.681us
                 -->kernel: 0:7 %4858 =  [] -> 600.898us
     %6949 = :aten::mul [[4096], [4096]] -> 1.888us
                 -->kernel: 0:7 %4859 =  [] -> 1.888us
     %6950 = :aten::sum [[4096], []] -> 3.360us
       %6951 = :aten::sum [[4096], [], [], []] -> 3.360us
                 -->kernel: 0:7 %4860 =  [] -> 3.360us
     %6952 = :aten::sum [[4096], []] -> 2.816us
       %6953 = :aten::sum [[4096], [], [], []] -> 2.816us
                 -->kernel: 0:7 %4861 =  [] -> 2.816us
     %6954 = :aten::stack [[], [], []] -> 1.920us
       %6955 = :aten::cat [[1], [1], []] -> 1.920us
                 -->kernel: 0:7 %4862 =  [] -> 1.920us
     %6956 = :aten::isnan [[2]] -> 1.600us
       %6957 = :aten::ne [[2], [2]] -> 1.600us
                 -->kernel: 0:7 %4863 =  [] -> 1.600us
     %6958 = :aten::any [[2]] -> 3.072us
                 -->kernel: 0:7 %4864 =  [] -> 3.072us
     %6959 = :aten::is_nonzero [[]] -> 2.944us
       %6960 = :aten::item [[]] -> 2.944us
         %6961 = :aten::_local_scalar_dense [[]] -> 2.944us
     %6962 = :aten::clone [[], []] -> 1.120us
       %6963 = :aten::copy_ [[], [], []] -> 1.120us
     %6964 = :aten::clone [[], []] -> 1.152us
       %6965 = :aten::copy_ [[], [], []] -> 1.152us
     %6966 = :aten::cat [[1], [1], []] -> 2.112us
                 -->kernel: 0:7 %4865 =  [] -> 2.112us
     %6967 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 113.120us
       %6968 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 113.120us
         %6969 = :nccl:all_reduce [[2]] -> 113.120us
           %6970 = NCCL:ncclAllReduce [] -> 113.120us
                 -->kernel: 0:7 %4866 =  [] -> 113.120us
     %6971 = :aten::div [[2], []] -> 1.184us
                 -->kernel: 0:7 %4867 =  [] -> 1.184us
     %6972 = :aten::div [[], []] -> 1.312us
                 -->kernel: 0:7 %4868 =  [] -> 1.312us
     %6973 = :aten::mul [[], []] -> 1.280us
                 -->kernel: 0:7 %4869 =  [] -> 1.280us
     %6974 = :aten::mul_ [[], []] -> 1.280us
                 -->kernel: 0:7 %4870 =  [] -> 1.280us
     %6975 = :aten::div_ [[], []] -> 1.056us
                 -->kernel: 0:7 %4871 =  [] -> 1.056us
     %6976 = :aten::ones [[], [], [], [], []] -> 896.000ns
       %6977 = :aten::fill_ [[1], []] -> 896.000ns
                 -->kernel: 0:7 %4872 =  [] -> 896.000ns
     %6978 = :aten::mul [[1], [1]] -> 1.536us
                 -->kernel: 0:7 %4873 =  [] -> 1.536us
     %6979 = :aten::div [[1], []] -> 1.344us
                 -->kernel: 0:7 %4874 =  [] -> 1.344us
     %6980 = :aten::copy_ [[1], [1], []] -> 992.000ns
     %6981 = :aten::ones [[], [], [], [], []] -> 928.000ns
       %6982 = :aten::fill_ [[1], []] -> 928.000ns
                 -->kernel: 0:7 %4875 =  [] -> 928.000ns
     %6983 = :aten::mul [[1], [1]] -> 1.312us
                 -->kernel: 0:7 %4876 =  [] -> 1.312us
     %6984 = :aten::div [[1], []] -> 1.568us
                 -->kernel: 0:7 %4877 =  [] -> 1.568us
     %6985 = :aten::add_ [[], [], []] -> 1.408us
                 -->kernel: 0:7 %4878 =  [] -> 1.408us
     %6986 = :aten::mul [[1], []] -> 1.088us
                 -->kernel: 0:7 %4879 =  [] -> 1.088us
     %6987 = :aten::ones_like [[1], [], [], [], [], []] -> 1.088us
       %6988 = :aten::fill_ [[1], []] -> 1.088us
                 -->kernel: 0:7 %4880 =  [] -> 1.088us
     %6989 = :autograd::engine::evaluate_function: MulBackward0 None -> 107.041us
       %6990 = :MulBackward0 [[1]] -> 1.440us
         %6991 = :aten::mul [[1], [1]] -> 1.440us
                 -->kernel: 0:7 %4881 =  [] -> 1.440us
       %6992 = :aten::sum [[1], []] -> 2.464us
         %6993 = :aten::sum [[1], [], [], []] -> 2.464us
                 -->kernel: 0:7 %4882 =  [] -> 2.464us
     %6994 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.344us
       %6995 = :DivBackward0 [[]] -> 1.344us
         %6996 = :aten::div [[], []] -> 1.344us
                 -->kernel: 0:7 %4883 =  [] -> 1.344us
     %6997 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.344us
       %6998 = :MulBackward0 [[]] -> 1.344us
         %6999 = :aten::mul [[], []] -> 1.344us
                 -->kernel: 0:7 %4884 =  [] -> 1.344us
     %7000 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.344us
       %7001 = :MulBackward0 [[]] -> 1.344us
         %7002 = :aten::mul [[], []] -> 1.344us
                 -->kernel: 0:7 %4885 =  [] -> 1.344us
     %7003 = :autograd::engine::evaluate_function: SelectBackward0 None -> 60.448us
       %7004 = :SelectBackward0 [[]] -> 60.448us
         %7005 = :aten::select_backward [[], [], [], []] -> 60.448us
           %7006 = :aten::zeros [[], [], [], [], []] -> 960.000ns
             %7007 = :aten::zero_ [[2]] -> 960.000ns
               %7008 = :aten::fill_ [[2], []] -> 960.000ns
                 -->kernel: 0:7 %4886 =  [] -> 960.000ns
           %7009 = :aten::copy_ [[], [], []] -> 992.000ns
     %7010 = :autograd::engine::evaluate_function: MulBackward0 None -> 2.048us
       %7011 = :MulBackward0 [[4096]] -> 2.048us
         %7012 = :aten::mul [[4096], [4096]] -> 2.048us
                 -->kernel: 0:7 %4887 =  [] -> 2.048us
     %7013 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 769.922us
       %7014 = :CrossEntropyFunctionBackward [[4096, 1]] -> 769.922us
         %7015 = :aten::to [[], [], [], [], [], []] -> 832.000ns
           %7016 = :aten::_to_copy [[], [], [], [], [], [], []] -> 832.000ns
             %7017 = :aten::copy_ [[], [], []] -> 832.000ns
                 -->kernel: 0:7 %4888 =  [] -> 597.826us
     %7018 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 109.152ms
       %7019 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.152ms
         %7020 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.629ms
           %7021 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.629ms
                 -->kernel: 0:7 %4889 =  [] -> 55.615ms
                 -->kernel: 0:7 %4890 =  [] -> 53.279ms
     %7022 = :autograd::engine::evaluate_function: MTPLossAutoScalerBackward None -> 75.360us
       %7023 = :MTPLossAutoScalerBackward [[4096, 1, 7168]] -> 75.360us
         %7024 = :aten::ones_like [[1, 4096], [], [], [], [], []] -> 1.120us
           %7025 = :aten::fill_ [[1, 4096], []] -> 1.120us
                 -->kernel: 0:7 %4891 =  [] -> 1.120us
         %7026 = :aten::mul [[1, 4096], [1]] -> 2.112us
                 -->kernel: 0:7 %4892 =  [] -> 2.112us
     %7027 = :autograd::engine::evaluate_function: DivBackward0 None -> 2.176us
       %7028 = :DivBackward0 [[1, 4096]] -> 2.176us
         %7029 = :aten::div [[1, 4096], []] -> 2.176us
                 -->kernel: 0:7 %4893 =  [] -> 2.176us
     %7030 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.376us
       %7031 = :MulBackward0 [[1, 4096]] -> 1.376us
         %7032 = :aten::mul [[1, 4096], []] -> 1.376us
                 -->kernel: 0:7 %4894 =  [] -> 1.376us
     %7033 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.632us
       %7034 = :MulBackward0 [[1, 4096]] -> 1.632us
         %7035 = :aten::mul [[1, 4096], [1, 4096]] -> 1.632us
                 -->kernel: 0:7 %4895 =  [] -> 1.632us
     %7036 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 755.394us
       %7037 = :CrossEntropyFunctionBackward [[4096, 1]] -> 755.394us
         %7038 = :aten::to [[], [], [], [], [], []] -> 864.000ns
           %7039 = :aten::_to_copy [[], [], [], [], [], [], []] -> 864.000ns
             %7040 = :aten::copy_ [[], [], []] -> 864.000ns
                 -->kernel: 0:7 %4896 =  [] -> 594.561us
     %7041 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 110.959ms
       %7042 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.506ms
         %7043 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.803ms
           %7044 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.803ms
                 -->kernel: 0:7 %4897 =  [] -> 55.792ms
                 -->kernel: 0:7 %4898 =  [] -> 53.471ms
       %7045 = :aten::add [[129280, 7168], [129280, 7168], []] -> 1.157ms
                 -->kernel: 0:35 %4899 =  [] -> 1.157ms
     %7046 = :autograd::engine::evaluate_function: SplitBackward0 None -> 163.553us
       %7047 = :SplitBackward0 [[4096, 1, 7168], [4096, 1, 7168]] -> 163.553us
         %7048 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 163.553us
                 -->kernel: 0:7 %4900 =  [] -> 163.553us
     %7049 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 204.896us
       %7050 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 204.896us
         %7051 = :nvte_rmsnorm_bwd [] -> 204.896us
                 -->kernel: 0:7 %4901 =  [] -> 166.656us
                 -->kernel: 0:7 %4902 =  [] -> 7.584us
     %7052 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %7053 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %4903 =  [] -> 1.568us
     %7054 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 845.986us
       %7055 = :FusedCombineBackward [[4096, 7168], []] -> 845.986us
                 -->kernel: 0:26 %4904 =  [] -> 8.000us
                 -->kernel: 0:26 %4905 =  [] -> 779.745us
     %7056 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 202.177us
       %7057 = :_moe_unpermute_mask_mapBackward [[15871, 7168]] -> 202.177us
                 -->kernel: 0:7 %4906 =  [] -> 202.177us
     %7058 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.436ms
       %7059 = :_GroupedLinearBackward [[33104, 7168]] -> 8.436ms
         %7060 = :_GroupedLinear_backward [] -> 8.436ms
           %7061 = :nvte_quantize_v2 [] -> 146.080us
             %7062 = :quantize_transpose_vector_blockwise [] -> 146.080us
                 -->kernel: 0:7 %4907 =  [] -> 146.080us
           %7063 = :nvte_quantize_v2 [] -> 220.896us
             %7064 = :quantize_transpose_vector_blockwise [] -> 220.896us
                 -->kernel: 0:7 %4908 =  [] -> 220.896us
           %7065 = :nvte_quantize_v2 [] -> 144.737us
             %7066 = :quantize_transpose_vector_blockwise [] -> 144.737us
                 -->kernel: 0:7 %4909 =  [] -> 144.737us
           %7067 = :nvte_quantize_v2 [] -> 146.240us
             %7068 = :quantize_transpose_vector_blockwise [] -> 146.240us
                 -->kernel: 0:7 %4910 =  [] -> 146.240us
           %7069 = :nvte_multi_stream_cublas_gemm [] -> 3.731ms
             %7070 = :nvte_cublas_gemm [] -> 923.746us
                 -->kernel: 0:159 %4911 =  [] -> 911.682us
             %7071 = :nvte_cublas_gemm [] -> 915.394us
                 -->kernel: 0:160 %4912 =  [] -> 908.642us
             %7072 = :nvte_cublas_gemm [] -> 913.378us
                 -->kernel: 0:161 %4913 =  [] -> 908.642us
             %7073 = :nvte_cublas_gemm [] -> 913.667us
                 -->kernel: 0:162 %4914 =  [] -> 908.099us
           %7074 = :nvte_multi_stream_cublas_gemm [] -> 3.687ms
             %7075 = :nvte_cublas_gemm [] -> 913.890us
                 -->kernel: 0:159 %4915 =  [] -> 905.282us
             %7076 = :nvte_cublas_gemm [] -> 895.426us
                 -->kernel: 0:160 %4916 =  [] -> 891.778us
             %7077 = :nvte_cublas_gemm [] -> 908.194us
                 -->kernel: 0:161 %4917 =  [] -> 904.610us
             %7078 = :nvte_cublas_gemm [] -> 908.610us
                 -->kernel: 0:162 %4918 =  [] -> 904.994us
     %7079 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 602.498us
       %7080 = :WeightedSwiGLUFunctionBackward [[33104, 2048]] -> 602.498us
         %7081 = :Torch-Compiled Region: 4/1 None -> 602.498us
           %7082 = :triton_poi_fused__to_copy_cat_0 [[33104, 2048], [33104, 1], [33104, 4096], [33104, 4096], [], []] -> 406.561us
                 -->kernel: 0:7 %4919 =  [] -> 406.561us
           %7083 = :triton_red_fused__to_copy_mul_silu_sum_1 [[33104, 4096], [33104, 2048], [33104, 1], [], [], [], []] -> 131.585us
                 -->kernel: 0:7 %4920 =  [] -> 131.585us
     %7084 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.709ms
       %7085 = :_GroupedLinearBackward [[33104, 4096]] -> 14.709ms
         %7086 = :_GroupedLinear_backward [] -> 14.709ms
           %7087 = :nvte_quantize_v2 [] -> 85.120us
             %7088 = :quantize_transpose_vector_blockwise [] -> 85.120us
                 -->kernel: 0:7 %4921 =  [] -> 85.120us
           %7089 = :nvte_quantize_v2 [] -> 130.657us
             %7090 = :quantize_transpose_vector_blockwise [] -> 130.657us
                 -->kernel: 0:7 %4922 =  [] -> 130.657us
           %7091 = :nvte_quantize_v2 [] -> 84.928us
             %7092 = :quantize_transpose_vector_blockwise [] -> 84.928us
                 -->kernel: 0:7 %4923 =  [] -> 84.928us
           %7093 = :nvte_quantize_v2 [] -> 86.144us
             %7094 = :quantize_transpose_vector_blockwise [] -> 86.144us
                 -->kernel: 0:7 %4924 =  [] -> 86.144us
           %7095 = :nvte_multi_stream_cublas_gemm [] -> 7.042ms
             %7096 = :nvte_cublas_gemm [] -> 1.755ms
                 -->kernel: 0:159 %4925 =  [] -> 1.748ms
             %7097 = :nvte_cublas_gemm [] -> 1.722ms
                 -->kernel: 0:160 %4926 =  [] -> 1.718ms
             %7098 = :nvte_cublas_gemm [] -> 1.751ms
                 -->kernel: 0:161 %4927 =  [] -> 1.747ms
             %7099 = :nvte_cublas_gemm [] -> 1.751ms
                 -->kernel: 0:162 %4928 =  [] -> 1.747ms
           %7100 = :nvte_multi_stream_cublas_gemm [] -> 7.006ms
             %7101 = :nvte_cublas_gemm [] -> 1.743ms
                 -->kernel: 0:159 %4929 =  [] -> 1.736ms
             %7102 = :nvte_cublas_gemm [] -> 1.716ms
                 -->kernel: 0:160 %4930 =  [] -> 1.712ms
             %7103 = :nvte_cublas_gemm [] -> 1.740ms
                 -->kernel: 0:161 %4931 =  [] -> 1.735ms
             %7104 = :nvte_cublas_gemm [] -> 1.739ms
                 -->kernel: 0:162 %4932 =  [] -> 1.735ms
     %7105 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 394.017us
       %7106 = :_moe_permute_mask_mapBackward [[33104, 7168], [], [33104]] -> 394.017us
         %7107 = :aten::zeros [[], [], [], [], []] -> 1.312us
           %7108 = :aten::zero_ [[15871, 9]] -> 1.312us
             %7109 = :aten::fill_ [[15871, 9], []] -> 1.312us
                 -->kernel: 0:7 %4933 =  [] -> 1.312us
                 -->kernel: 0:7 %4934 =  [] -> 214.528us
     %7110 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 99.393us
       %7111 = :IndicesToMultihotBackward [[], [15871, 4]] -> 99.393us
         %7112 = :aten::zeros [[], [], [], [], []] -> 1.472us
           %7113 = :aten::zero_ [[15871, 4]] -> 1.472us
             %7114 = :aten::fill_ [[15871, 4], []] -> 1.472us
                 -->kernel: 0:7 %4935 =  [] -> 1.472us
                 -->kernel: 0:7 %4936 =  [] -> 11.648us
     %7115 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.182ms
       %7116 = :_LinearBackward [[4096, 1, 7168]] -> 1.182ms
         %7117 = :_Linear_backward [] -> 1.182ms
           %7118 = :nvte_quantize_v2 [] -> 73.632us
             %7119 = :quantize_transpose_vector_blockwise [] -> 73.632us
                 -->kernel: 0:7 %4937 =  [] -> 73.632us
           %7120 = :nvte_cublas_gemm_scaled [] -> 468.801us
                 -->kernel: 0:7 %4938 =  [] -> 458.497us
           %7121 = :nvte_cublas_gemm_scaled [] -> 456.705us
                 -->kernel: 0:7 %4939 =  [] -> 450.977us
     %7122 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 47.328us
       %7123 = :SwiGLUFunctionBackward [[4096, 2048]] -> 47.328us
         %7124 = :Torch-Compiled Region: 5/0 None -> 47.328us
           %7125 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 47.328us
                 -->kernel: 0:7 %4940 =  [] -> 47.328us
     %7126 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.020ms
       %7127 = :_LinearBackward [[4096, 1, 4096]] -> 2.020ms
         %7128 = :_Linear_backward [] -> 2.020ms
           %7129 = :nvte_quantize_v2 [] -> 45.312us
             %7130 = :quantize_transpose_vector_blockwise [] -> 45.312us
                 -->kernel: 0:7 %4941 =  [] -> 45.312us
           %7131 = :nvte_quantize_v2 [] -> 53.120us
             %7132 = :quantize_transpose_vector_blockwise [] -> 53.120us
                 -->kernel: 0:7 %4942 =  [] -> 53.120us
           %7133 = :nvte_cublas_gemm_scaled [] -> 870.146us
                 -->kernel: 0:7 %4943 =  [] -> 864.418us
           %7134 = :nvte_cublas_gemm_scaled [] -> 868.098us
                 -->kernel: 0:7 %4944 =  [] -> 862.562us
     %7135 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 895.106us
       %7136 = :FusedDispatchBackward [[15871, 7168], [], [15871, 8], [], []] -> 895.106us
         %7137 = :aten::zeros [[], [], [], [], []] -> 1.408us
           %7138 = :aten::zero_ [[15871, 8]] -> 1.408us
             %7139 = :aten::fill_ [[15871, 8], []] -> 1.408us
                 -->kernel: 0:7 %4945 =  [] -> 1.408us
                 -->kernel: 0:26 %4946 =  [] -> 13.888us
                 -->kernel: 0:26 %4947 =  [] -> 690.274us
     %7140 = :autograd::engine::evaluate_function: TopkBackward0 None -> 61.184us
       %7141 = :TopkBackward0 [[4096, 8]] -> 61.184us
         %7142 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 61.184us
           %7143 = :aten::zeros [[], [], [], [], []] -> 992.000ns
             %7144 = :aten::zero_ [[4096, 32]] -> 992.000ns
               %7145 = :aten::fill_ [[4096, 32], []] -> 992.000ns
                 -->kernel: 0:7 %4948 =  [] -> 992.000ns
           %7146 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 8.768us
                 -->kernel: 0:7 %4949 =  [] -> 8.768us
     %7147 = :autograd::engine::evaluate_function: ViewBackward0 None -> 53.025us
       %7148 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 53.025us
                 -->kernel: 0:7 %4950 =  [] -> 53.025us
     %7149 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 90.592us
       %7150 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 38.784us
         %7151 = :aten::ones_like [[], [], [], [], [], []] -> 1.056us
           %7152 = :aten::fill_ [[], []] -> 1.056us
                 -->kernel: 0:7 %4951 =  [] -> 1.056us
         %7153 = :aten::mul [[], [1]] -> 1.504us
                 -->kernel: 0:7 %4952 =  [] -> 1.504us
       %7154 = :aten::sum [[1], []] -> 3.072us
         %7155 = :aten::sum [[1], [], [], []] -> 3.072us
                 -->kernel: 0:7 %4953 =  [] -> 3.072us
     %7156 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.504us
       %7157 = :DivBackward0 [[]] -> 1.504us
         %7158 = :aten::div [[], []] -> 1.504us
                 -->kernel: 0:7 %4954 =  [] -> 1.504us
     %7159 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.208us
       %7160 = :FusedAuxLossBackward [[]] -> 2.208us
         %7161 = :nvte_fused_moe_aux_loss_backward [] -> 2.208us
                 -->kernel: 0:7 %4955 =  [] -> 2.208us
     %7162 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 62.400us
       %7163 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 62.400us
         %7164 = :aten::zeros [[], [], [], [], []] -> 1.216us
           %7165 = :aten::zero_ [[4096, 32]] -> 1.216us
             %7166 = :aten::fill_ [[4096, 32], []] -> 1.216us
                 -->kernel: 0:7 %4956 =  [] -> 1.216us
         %7167 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.896us
                 -->kernel: 0:7 %4957 =  [] -> 12.896us
     %7168 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 100.576us
       %7169 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 56.672us
         %7170 = :aten::zeros [[], [], [], [], []] -> 1.344us
           %7171 = :aten::zero_ [[4096, 32]] -> 1.344us
             %7172 = :aten::fill_ [[4096, 32], []] -> 1.344us
                 -->kernel: 0:7 %4958 =  [] -> 1.344us
         %7173 = :nvte_fused_topk_with_score_function_backward [] -> 13.792us
                 -->kernel: 0:7 %4959 =  [] -> 13.792us
       %7174 = :aten::add [[4096, 32], [4096, 32], []] -> 1.696us
                 -->kernel: 0:7 %4960 =  [] -> 1.696us
     %7175 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 807.842us
       %7176 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 710.242us
         %7177 = :aten::to [[32, 7168], [], [], [], []] -> 6.496us
           %7178 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.496us
             %7179 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.496us
                 -->kernel: 0:7 %4961 =  [] -> 6.496us
         %7180 = :nvte_cublas_gemm_scaled [] -> 83.905us
                 -->kernel: 0:7 %4962 =  [] -> 67.681us
         %7181 = :aten::to [[4096, 7168], [], [], [], []] -> 176.256us
           %7182 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 176.256us
             %7183 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 176.256us
                 -->kernel: 0:7 %4963 =  [] -> 176.256us
         %7184 = :nvte_cublas_gemm_scaled [] -> 82.273us
                 -->kernel: 0:7 %4964 =  [] -> 82.273us
         %7185 = :aten::to [[4096, 7168], [], [], [], []] -> 43.520us
           %7186 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.520us
             %7187 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.520us
                 -->kernel: 0:7 %4965 =  [] -> 43.520us
         %7188 = :aten::to [[32, 7168], [], [], [], []] -> 2.208us
           %7189 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.208us
             %7190 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.208us
                 -->kernel: 0:7 %4966 =  [] -> 2.208us
       %7191 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.944us
                 -->kernel: 0:7 %4967 =  [] -> 50.944us
     %7192 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.048us
       %7193 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.048us
                 -->kernel: 0:35 %4968 =  [] -> 2.048us
     %7194 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 322.976us
       %7195 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 199.488us
         %7196 = :nvte_rmsnorm_bwd [] -> 199.488us
                 -->kernel: 0:7 %4969 =  [] -> 167.072us
                 -->kernel: 0:7 %4970 =  [] -> 7.968us
       %7197 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.656us
                 -->kernel: 0:7 %4971 =  [] -> 50.656us
     %7198 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %7199 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %4972 =  [] -> 1.600us
     %7200 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.281ms
       %7201 = :_LinearBackward [[4096, 1, 7168]] -> 7.281ms
         %7202 = :_Linear_backward [] -> 7.281ms
           %7203 = :nvte_quantize_v2 [] -> 73.792us
             %7204 = :quantize_transpose_vector_blockwise [] -> 73.792us
                 -->kernel: 0:7 %4973 =  [] -> 73.792us
           %7205 = :nvte_quantize_v2 [] -> 110.657us
             %7206 = :quantize_transpose_vector_blockwise [] -> 110.657us
                 -->kernel: 0:7 %4974 =  [] -> 110.657us
           %7207 = :nvte_cublas_gemm_scaled [] -> 3.439ms
                 -->kernel: 0:7 %4975 =  [] -> 3.433ms
           %7208 = :nvte_cublas_gemm_scaled [] -> 3.444ms
                 -->kernel: 0:7 %4976 =  [] -> 3.437ms
     %7209 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.913ms
       %7210 = :BmmBackward0 [[128, 4096, 128]] -> 7.913ms
         %7211 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.981ms
                 -->kernel: 0:7 %4977 =  [] -> 3.969ms
         %7212 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.881ms
                 -->kernel: 0:7 %4978 =  [] -> 3.873ms
     %7213 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.947ms
       %7214 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.947ms
         %7215 = :nvte_scaled_softmax_backward [] -> 6.947ms
                 -->kernel: 0:7 %4979 =  [] -> 6.947ms
     %7216 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.236ms
       %7217 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.236ms
         %7218 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.948ms
                 -->kernel: 0:7 %4980 =  [] -> 5.939ms
         %7219 = :aten::mul [[128, 4096, 192], []] -> 115.520us
           %7220 = :aten::mul [[128, 4096, 192], []] -> 115.520us
                 -->kernel: 0:7 %4981 =  [] -> 115.520us
         %7221 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.880ms
                 -->kernel: 0:7 %4982 =  [] -> 5.874ms
         %7222 = :aten::mul [[128, 192, 4096], []] -> 115.969us
           %7223 = :aten::mul [[128, 192, 4096], []] -> 115.969us
                 -->kernel: 0:7 %4983 =  [] -> 115.969us
     %7224 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.470ms
       %7225 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.470ms
         %7226 = :aten::contiguous [[4096, 1, 128, 192], []] -> 749.986us
           %7227 = :aten::clone [[4096, 1, 128, 192], []] -> 749.986us
             %7228 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 749.986us
                 -->kernel: 0:7 %4984 =  [] -> 749.986us
         %7229 = :aten::contiguous [[4096, 1, 128, 128], []] -> 281.249us
           %7230 = :aten::clone [[4096, 1, 128, 128], []] -> 281.249us
             %7231 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 281.249us
                 -->kernel: 0:7 %4985 =  [] -> 281.249us
                 -->kernel: 0:7 %4986 =  [] -> 171.809us
     %7232 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 644.834us
       %7233 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 644.834us
         %7234 = :aten::contiguous [[4096, 1, 128, 192], []] -> 424.577us
           %7235 = :aten::clone [[4096, 1, 128, 192], []] -> 424.577us
             %7236 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 424.577us
                 -->kernel: 0:7 %4987 =  [] -> 424.577us
                 -->kernel: 0:7 %4988 =  [] -> 119.745us
     %7237 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.753ms
       %7238 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.753ms
         %7239 = :_LayerNormLinear_backward [] -> 1.753ms
           %7240 = :nvte_quantize_v2 [] -> 324.481us
             %7241 = :quantize_transpose_vector_blockwise [] -> 324.481us
                 -->kernel: 0:7 %4989 =  [] -> 324.481us
           %7242 = :nvte_cublas_gemm_scaled [] -> 569.026us
                 -->kernel: 0:7 %4990 =  [] -> 522.401us
                 -->kernel: 0:7 %4991 =  [] -> 19.008us
           %7243 = :nvte_cublas_gemm_scaled [] -> 528.801us
                 -->kernel: 0:7 %4992 =  [] -> 522.785us
           %7244 = :nvte_rmsnorm_bwd [] -> 22.048us
                 -->kernel: 0:7 %4993 =  [] -> 6.560us
                 -->kernel: 0:7 %4994 =  [] -> 3.136us
     %7245 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.920us
       %7246 = :aten::add_ [[512], [512], []] -> 1.920us
                 -->kernel: 0:35 %4995 =  [] -> 1.920us
     %7247 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.800ms
       %7248 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.800ms
         %7249 = :_LayerNormLinear_backward [] -> 2.800ms
           %7250 = :nvte_quantize_v2 [] -> 244.001us
             %7251 = :quantize_transpose_vector_blockwise [] -> 244.001us
                 -->kernel: 0:7 %4996 =  [] -> 244.001us
           %7252 = :nvte_cublas_gemm_scaled [] -> 1.121ms
                 -->kernel: 0:7 %4997 =  [] -> 1.113ms
           %7253 = :nvte_cublas_gemm_scaled [] -> 1.120ms
                 -->kernel: 0:7 %4998 =  [] -> 1.115ms
           %7254 = :nvte_rmsnorm_bwd [] -> 56.128us
                 -->kernel: 0:7 %4999 =  [] -> 22.944us
                 -->kernel: 0:7 %5000 =  [] -> 20.608us
     %7255 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.920us
       %7256 = :aten::add_ [[1536], [1536], []] -> 1.920us
                 -->kernel: 0:35 %5001 =  [] -> 1.920us
     %7257 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.017us
       %7258 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.017us
         %7259 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.017us
                 -->kernel: 0:7 %5002 =  [] -> 10.017us
     %7260 = :autograd::engine::evaluate_function: _LinearBackward None -> 432.737us
       %7261 = :_LinearBackward [[4096, 1, 576]] -> 432.737us
         %7262 = :_Linear_backward [] -> 432.737us
           %7263 = :nvte_quantize_v2 [] -> 14.880us
             %7264 = :quantize_transpose_vector_blockwise [] -> 14.880us
                 -->kernel: 0:7 %5003 =  [] -> 14.880us
           %7265 = :nvte_cublas_gemm_scaled [] -> 147.936us
                 -->kernel: 0:7 %5004 =  [] -> 141.632us
           %7266 = :nvte_cublas_gemm_scaled [] -> 139.136us
                 -->kernel: 0:7 %5005 =  [] -> 133.472us
     %7267 = :autograd::engine::evaluate_function: _LinearBackward None -> 988.675us
       %7268 = :_LinearBackward [[4096, 1, 1536]] -> 824.610us
         %7269 = :_Linear_backward [] -> 824.610us
           %7270 = :nvte_quantize_v2 [] -> 18.336us
             %7271 = :quantize_transpose_vector_blockwise [] -> 18.336us
                 -->kernel: 0:7 %5006 =  [] -> 18.336us
           %7272 = :nvte_cublas_gemm_scaled [] -> 336.096us
                 -->kernel: 0:7 %5007 =  [] -> 329.088us
           %7273 = :nvte_cublas_gemm_scaled [] -> 342.016us
                 -->kernel: 0:7 %5008 =  [] -> 337.856us
       %7274 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.432us
                 -->kernel: 0:7 %5009 =  [] -> 50.432us
     %7275 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 322.913us
       %7276 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 194.657us
         %7277 = :nvte_rmsnorm_bwd [] -> 194.657us
                 -->kernel: 0:7 %5010 =  [] -> 164.705us
                 -->kernel: 0:7 %5011 =  [] -> 7.904us
       %7278 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.664us
                 -->kernel: 0:7 %5012 =  [] -> 49.664us
     %7279 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %7280 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %5013 =  [] -> 1.568us
     %7281 = :autograd::engine::evaluate_function: _LinearBackward None -> 6.229ms
       %7282 = :_LinearBackward [[4096, 1, 7168]] -> 6.229ms
         %7283 = :_Linear_backward [] -> 6.229ms
           %7284 = :nvte_quantize_v2 [] -> 73.153us
             %7285 = :quantize_transpose_vector_blockwise [] -> 73.153us
                 -->kernel: 0:7 %5014 =  [] -> 73.153us
           %7286 = :nvte_cublas_gemm_scaled [] -> 3.001ms
                 -->kernel: 0:7 %5015 =  [] -> 2.993ms
           %7287 = :nvte_cublas_gemm_scaled [] -> 3.012ms
                 -->kernel: 0:7 %5016 =  [] -> 3.006ms
     %7288 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 388.705us
       %7289 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 388.705us
         %7290 = :aten::contiguous [[4096, 1, 7168], []] -> 114.464us
           %7291 = :aten::clone [[4096, 1, 7168], []] -> 114.464us
             %7292 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 114.464us
                 -->kernel: 0:7 %5017 =  [] -> 114.464us
         %7293 = :nvte_rmsnorm_bwd [] -> 192.448us
                 -->kernel: 0:7 %5018 =  [] -> 165.792us
                 -->kernel: 0:7 %5019 =  [] -> 8.192us
     %7294 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %7295 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %5020 =  [] -> 1.600us
     %7296 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 373.408us
       %7297 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 373.408us
         %7298 = :aten::contiguous [[4096, 1, 7168], []] -> 115.744us
           %7299 = :aten::clone [[4096, 1, 7168], []] -> 115.744us
             %7300 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 115.744us
                 -->kernel: 0:7 %5021 =  [] -> 115.744us
         %7301 = :nvte_rmsnorm_bwd [] -> 189.792us
                 -->kernel: 0:7 %5022 =  [] -> 166.784us
                 -->kernel: 0:7 %5023 =  [] -> 7.712us
     %7302 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.728us
       %7303 = :aten::add_ [[7168], [7168], []] -> 1.728us
                 -->kernel: 0:35 %5024 =  [] -> 1.728us
     %7304 = :autograd::engine::evaluate_function: MakeViewlessTensorBackward None -> 50.592us
       %7305 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.592us
                 -->kernel: 0:7 %5025 =  [] -> 50.592us
     %7306 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 1.351ms
       %7307 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.351ms
         %7308 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.351ms
           %7309 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.351ms
             %7310 = :aten::arange [[], [], [], [], []] -> 1.184us
               %7311 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %5026 =  [] -> 1.184us
             %7312 = CCCL:cub::DeviceRadixSort [] -> 191.105us
                 -->kernel: 0:7 %5027 =  [] -> 3.776us
                 -->kernel: 0:7 %5028 =  [] -> 1.664us
                 -->kernel: 0:7 %5029 =  [] -> 7.777us
                 -->kernel: 0:7 %5030 =  [] -> 7.008us
                 -->kernel: 0:7 %5031 =  [] -> 7.232us
                 -->kernel: 0:7 %5032 =  [] -> 7.136us
                 -->kernel: 0:7 %5033 =  [] -> 6.816us
                 -->kernel: 0:7 %5034 =  [] -> 6.784us
                 -->kernel: 0:7 %5035 =  [] -> 7.072us
                 -->kernel: 0:7 %5036 =  [] -> 7.008us
             %7313 = :aten::zeros [[], [], [], [], []] -> 544.673us
               %7314 = :aten::zero_ [[129280, 7168]] -> 544.673us
                 %7315 = :aten::fill_ [[129280, 7168], []] -> 544.673us
                 -->kernel: 0:7 %5037 =  [] -> 544.673us
             %7316 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 17.632us
                 -->kernel: 0:7 %5038 =  [] -> 1.248us
                 -->kernel: 0:7 %5039 =  [] -> 4.096us
                 -->kernel: 0:7 %5040 =  [] -> 1.984us
             %7317 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 17.568us
                 -->kernel: 0:7 %5041 =  [] -> 1.248us
                 -->kernel: 0:7 %5042 =  [] -> 3.008us
                 -->kernel: 0:7 %5043 =  [] -> 1.600us
                 -->kernel: 0:7 %5044 =  [] -> 1.920us
                 -->kernel: 0:7 %5045 =  [] -> 213.184us
                 -->kernel: 0:7 %5046 =  [] -> 148.705us
     %7318 = :autograd::engine::evaluate_function: SplitBackward0 None -> 33.984us
       %7319 = :SplitBackward0 [[4096, 1, 7168]] -> 33.984us
         %7320 = :aten::cat [[4096, 1, 7168], []] -> 33.984us
     %7321 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 195.713us
       %7322 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 195.713us
         %7323 = :nvte_rmsnorm_bwd [] -> 195.713us
                 -->kernel: 0:7 %5047 =  [] -> 168.545us
                 -->kernel: 0:7 %5048 =  [] -> 8.032us
     %7324 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %7325 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %5049 =  [] -> 1.568us
     %7326 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 822.529us
       %7327 = :FusedCombineBackward [[4096, 7168], []] -> 822.529us
                 -->kernel: 0:26 %5050 =  [] -> 8.000us
                 -->kernel: 0:26 %5051 =  [] -> 764.001us
     %7328 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 198.593us
       %7329 = :_moe_unpermute_mask_mapBackward [[15636, 7168]] -> 198.593us
                 -->kernel: 0:7 %5052 =  [] -> 198.593us
     %7330 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.527ms
       %7331 = :_GroupedLinearBackward [[32640, 7168]] -> 8.527ms
         %7332 = :_GroupedLinear_backward [] -> 8.527ms
           %7333 = :nvte_quantize_v2 [] -> 219.489us
             %7334 = :quantize_transpose_vector_blockwise [] -> 219.489us
                 -->kernel: 0:7 %5053 =  [] -> 219.489us
           %7335 = :nvte_quantize_v2 [] -> 217.536us
             %7336 = :quantize_transpose_vector_blockwise [] -> 217.536us
                 -->kernel: 0:7 %5054 =  [] -> 217.536us
           %7337 = :nvte_quantize_v2 [] -> 221.441us
             %7338 = :quantize_transpose_vector_blockwise [] -> 221.441us
                 -->kernel: 0:7 %5055 =  [] -> 221.441us
           %7339 = :nvte_quantize_v2 [] -> 219.872us
             %7340 = :quantize_transpose_vector_blockwise [] -> 219.872us
                 -->kernel: 0:7 %5056 =  [] -> 219.872us
           %7341 = :nvte_multi_stream_cublas_gemm [] -> 3.711ms
             %7342 = :nvte_cublas_gemm [] -> 916.898us
                 -->kernel: 0:159 %5057 =  [] -> 906.562us
             %7343 = :nvte_cublas_gemm [] -> 911.522us
                 -->kernel: 0:160 %5058 =  [] -> 906.338us
             %7344 = :nvte_cublas_gemm [] -> 910.594us
                 -->kernel: 0:161 %5059 =  [] -> 906.338us
             %7345 = :nvte_cublas_gemm [] -> 910.979us
                 -->kernel: 0:162 %5060 =  [] -> 905.891us
           %7346 = :nvte_multi_stream_cublas_gemm [] -> 3.645ms
             %7347 = :nvte_cublas_gemm [] -> 896.258us
                 -->kernel: 0:159 %5061 =  [] -> 889.954us
             %7348 = :nvte_cublas_gemm [] -> 893.250us
                 -->kernel: 0:160 %5062 =  [] -> 889.762us
             %7349 = :nvte_cublas_gemm [] -> 906.594us
                 -->kernel: 0:161 %5063 =  [] -> 903.618us
             %7350 = :nvte_cublas_gemm [] -> 893.027us
                 -->kernel: 0:162 %5064 =  [] -> 889.763us
     %7351 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 586.593us
       %7352 = :WeightedSwiGLUFunctionBackward [[32640, 2048]] -> 586.593us
         %7353 = :Torch-Compiled Region: 4/1 None -> 586.593us
           %7354 = :triton_poi_fused__to_copy_cat_0 [[32640, 2048], [32640, 1], [32640, 4096], [32640, 4096], [], []] -> 400.129us
                 -->kernel: 0:7 %5065 =  [] -> 400.129us
           %7355 = :triton_red_fused__to_copy_mul_silu_sum_1 [[32640, 4096], [32640, 2048], [32640, 1], [], [], [], []] -> 129.504us
                 -->kernel: 0:7 %5066 =  [] -> 129.504us
     %7356 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.691ms
       %7357 = :_GroupedLinearBackward [[32640, 4096]] -> 14.691ms
         %7358 = :_GroupedLinear_backward [] -> 14.691ms
           %7359 = :nvte_quantize_v2 [] -> 125.728us
             %7360 = :quantize_transpose_vector_blockwise [] -> 125.728us
                 -->kernel: 0:7 %5067 =  [] -> 125.728us
           %7361 = :nvte_quantize_v2 [] -> 128.577us
             %7362 = :quantize_transpose_vector_blockwise [] -> 128.577us
                 -->kernel: 0:7 %5068 =  [] -> 128.577us
           %7363 = :nvte_quantize_v2 [] -> 131.584us
             %7364 = :quantize_transpose_vector_blockwise [] -> 131.584us
                 -->kernel: 0:7 %5069 =  [] -> 131.584us
           %7365 = :nvte_quantize_v2 [] -> 129.728us
             %7366 = :quantize_transpose_vector_blockwise [] -> 129.728us
                 -->kernel: 0:7 %5070 =  [] -> 129.728us
           %7367 = :nvte_multi_stream_cublas_gemm [] -> 6.971ms
             %7368 = :nvte_cublas_gemm [] -> 1.719ms
                 -->kernel: 0:159 %5071 =  [] -> 1.712ms
             %7369 = :nvte_cublas_gemm [] -> 1.716ms
                 -->kernel: 0:160 %5072 =  [] -> 1.711ms
             %7370 = :nvte_cublas_gemm [] -> 1.749ms
                 -->kernel: 0:161 %5073 =  [] -> 1.744ms
             %7371 = :nvte_cublas_gemm [] -> 1.715ms
                 -->kernel: 0:162 %5074 =  [] -> 1.711ms
           %7372 = :nvte_multi_stream_cublas_gemm [] -> 6.939ms
             %7373 = :nvte_cublas_gemm [] -> 1.712ms
                 -->kernel: 0:159 %5075 =  [] -> 1.706ms
             %7374 = :nvte_cublas_gemm [] -> 1.710ms
                 -->kernel: 0:160 %5076 =  [] -> 1.706ms
             %7375 = :nvte_cublas_gemm [] -> 1.737ms
                 -->kernel: 0:161 %5077 =  [] -> 1.732ms
             %7376 = :nvte_cublas_gemm [] -> 1.715ms
                 -->kernel: 0:162 %5078 =  [] -> 1.711ms
     %7377 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 384.705us
       %7378 = :_moe_permute_mask_mapBackward [[32640, 7168], [], [32640]] -> 384.705us
         %7379 = :aten::zeros [[], [], [], [], []] -> 1.344us
           %7380 = :aten::zero_ [[15636, 9]] -> 1.344us
             %7381 = :aten::fill_ [[15636, 9], []] -> 1.344us
                 -->kernel: 0:7 %5079 =  [] -> 1.344us
                 -->kernel: 0:7 %5080 =  [] -> 211.585us
     %7382 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 97.632us
       %7383 = :IndicesToMultihotBackward [[], [15636, 4]] -> 97.632us
         %7384 = :aten::zeros [[], [], [], [], []] -> 1.312us
           %7385 = :aten::zero_ [[15636, 4]] -> 1.312us
             %7386 = :aten::fill_ [[15636, 4], []] -> 1.312us
                 -->kernel: 0:7 %5081 =  [] -> 1.312us
                 -->kernel: 0:7 %5082 =  [] -> 11.296us
     %7387 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.155ms
       %7388 = :_LinearBackward [[4096, 1, 7168]] -> 1.155ms
         %7389 = :_Linear_backward [] -> 1.155ms
           %7390 = :nvte_quantize_v2 [] -> 72.864us
             %7391 = :quantize_transpose_vector_blockwise [] -> 72.864us
                 -->kernel: 0:7 %5083 =  [] -> 72.864us
           %7392 = :nvte_cublas_gemm_scaled [] -> 464.961us
                 -->kernel: 0:7 %5084 =  [] -> 456.609us
           %7393 = :nvte_cublas_gemm_scaled [] -> 454.561us
                 -->kernel: 0:7 %5085 =  [] -> 448.705us
     %7394 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 47.296us
       %7395 = :SwiGLUFunctionBackward [[4096, 2048]] -> 47.296us
         %7396 = :Torch-Compiled Region: 5/0 None -> 47.296us
           %7397 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 47.296us
                 -->kernel: 0:7 %5086 =  [] -> 47.296us
     %7398 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.011ms
       %7399 = :_LinearBackward [[4096, 1, 4096]] -> 2.011ms
         %7400 = :_Linear_backward [] -> 2.011ms
           %7401 = :nvte_quantize_v2 [] -> 45.216us
             %7402 = :quantize_transpose_vector_blockwise [] -> 45.216us
                 -->kernel: 0:7 %5087 =  [] -> 45.216us
           %7403 = :nvte_quantize_v2 [] -> 52.672us
             %7404 = :quantize_transpose_vector_blockwise [] -> 52.672us
                 -->kernel: 0:7 %5088 =  [] -> 52.672us
           %7405 = :nvte_cublas_gemm_scaled [] -> 867.362us
                 -->kernel: 0:7 %5089 =  [] -> 861.186us
           %7406 = :nvte_cublas_gemm_scaled [] -> 865.379us
                 -->kernel: 0:7 %5090 =  [] -> 860.515us
     %7407 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 856.738us
       %7408 = :FusedDispatchBackward [[15636, 7168], [], [15636, 8], [], []] -> 856.738us
         %7409 = :aten::zeros [[], [], [], [], []] -> 1.376us
           %7410 = :aten::zero_ [[15636, 8]] -> 1.376us
             %7411 = :aten::fill_ [[15636, 8], []] -> 1.376us
                 -->kernel: 0:7 %5091 =  [] -> 1.376us
                 -->kernel: 0:26 %5092 =  [] -> 13.792us
                 -->kernel: 0:26 %5093 =  [] -> 685.506us
     %7412 = :autograd::engine::evaluate_function: TopkBackward0 None -> 57.664us
       %7413 = :TopkBackward0 [[4096, 8]] -> 57.664us
         %7414 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 57.664us
           %7415 = :aten::zeros [[], [], [], [], []] -> 928.000ns
             %7416 = :aten::zero_ [[4096, 32]] -> 928.000ns
               %7417 = :aten::fill_ [[4096, 32], []] -> 928.000ns
                 -->kernel: 0:7 %5094 =  [] -> 928.000ns
           %7418 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 9.568us
                 -->kernel: 0:7 %5095 =  [] -> 9.568us
     %7419 = :autograd::engine::evaluate_function: ViewBackward0 None -> 52.416us
       %7420 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.416us
                 -->kernel: 0:7 %5096 =  [] -> 52.416us
     %7421 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 89.696us
       %7422 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 35.552us
         %7423 = :aten::ones_like [[], [], [], [], [], []] -> 1.152us
           %7424 = :aten::fill_ [[], []] -> 1.152us
                 -->kernel: 0:7 %5097 =  [] -> 1.152us
         %7425 = :aten::mul [[], [1]] -> 1.504us
                 -->kernel: 0:7 %5098 =  [] -> 1.504us
       %7426 = :aten::sum [[1], []] -> 3.072us
         %7427 = :aten::sum [[1], [], [], []] -> 3.072us
                 -->kernel: 0:7 %5099 =  [] -> 3.072us
     %7428 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.504us
       %7429 = :DivBackward0 [[]] -> 1.504us
         %7430 = :aten::div [[], []] -> 1.504us
                 -->kernel: 0:7 %5100 =  [] -> 1.504us
     %7431 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.208us
       %7432 = :FusedAuxLossBackward [[]] -> 2.208us
         %7433 = :nvte_fused_moe_aux_loss_backward [] -> 2.208us
                 -->kernel: 0:7 %5101 =  [] -> 2.208us
     %7434 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 61.728us
       %7435 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 61.728us
         %7436 = :aten::zeros [[], [], [], [], []] -> 1.216us
           %7437 = :aten::zero_ [[4096, 32]] -> 1.216us
             %7438 = :aten::fill_ [[4096, 32], []] -> 1.216us
                 -->kernel: 0:7 %5102 =  [] -> 1.216us
         %7439 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.992us
                 -->kernel: 0:7 %5103 =  [] -> 12.992us
     %7440 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 99.872us
       %7441 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 56.640us
         %7442 = :aten::zeros [[], [], [], [], []] -> 1.184us
           %7443 = :aten::zero_ [[4096, 32]] -> 1.184us
             %7444 = :aten::fill_ [[4096, 32], []] -> 1.184us
                 -->kernel: 0:7 %5104 =  [] -> 1.184us
         %7445 = :nvte_fused_topk_with_score_function_backward [] -> 13.792us
                 -->kernel: 0:7 %5105 =  [] -> 13.792us
       %7446 = :aten::add [[4096, 32], [4096, 32], []] -> 1.632us
                 -->kernel: 0:7 %5106 =  [] -> 1.632us
     %7447 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 795.810us
       %7448 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 700.866us
         %7449 = :aten::to [[32, 7168], [], [], [], []] -> 6.464us
           %7450 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.464us
             %7451 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.464us
                 -->kernel: 0:7 %5107 =  [] -> 6.464us
         %7452 = :nvte_cublas_gemm_scaled [] -> 84.736us
                 -->kernel: 0:7 %5108 =  [] -> 67.776us
         %7453 = :aten::to [[4096, 7168], [], [], [], []] -> 176.736us
           %7454 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 176.736us
             %7455 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 176.736us
                 -->kernel: 0:7 %5109 =  [] -> 176.736us
         %7456 = :nvte_cublas_gemm_scaled [] -> 82.176us
                 -->kernel: 0:7 %5110 =  [] -> 82.176us
         %7457 = :aten::to [[4096, 7168], [], [], [], []] -> 43.584us
           %7458 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.584us
             %7459 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.584us
                 -->kernel: 0:7 %5111 =  [] -> 43.584us
         %7460 = :aten::to [[32, 7168], [], [], [], []] -> 2.112us
           %7461 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.112us
             %7462 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.112us
                 -->kernel: 0:7 %5112 =  [] -> 2.112us
       %7463 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.400us
                 -->kernel: 0:7 %5113 =  [] -> 50.400us
     %7464 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.112us
       %7465 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.112us
                 -->kernel: 0:35 %5114 =  [] -> 2.112us
     %7466 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 321.953us
       %7467 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 199.200us
         %7468 = :nvte_rmsnorm_bwd [] -> 199.200us
                 -->kernel: 0:7 %5115 =  [] -> 167.520us
                 -->kernel: 0:7 %5116 =  [] -> 7.712us
       %7469 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.041us
                 -->kernel: 0:7 %5117 =  [] -> 51.041us
     %7470 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %7471 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %5118 =  [] -> 1.600us
     %7472 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.250ms
       %7473 = :_LinearBackward [[4096, 1, 7168]] -> 7.250ms
         %7474 = :_Linear_backward [] -> 7.250ms
           %7475 = :nvte_quantize_v2 [] -> 73.856us
             %7476 = :quantize_transpose_vector_blockwise [] -> 73.856us
                 -->kernel: 0:7 %5119 =  [] -> 73.856us
           %7477 = :nvte_quantize_v2 [] -> 110.816us
             %7478 = :quantize_transpose_vector_blockwise [] -> 110.816us
                 -->kernel: 0:7 %5120 =  [] -> 110.816us
           %7479 = :nvte_cublas_gemm_scaled [] -> 3.433ms
                 -->kernel: 0:7 %5121 =  [] -> 3.427ms
           %7480 = :nvte_cublas_gemm_scaled [] -> 3.433ms
                 -->kernel: 0:7 %5122 =  [] -> 3.426ms
     %7481 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.901ms
       %7482 = :BmmBackward0 [[128, 4096, 128]] -> 7.901ms
         %7483 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.976ms
                 -->kernel: 0:7 %5123 =  [] -> 3.964ms
         %7484 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.873ms
                 -->kernel: 0:7 %5124 =  [] -> 3.865ms
     %7485 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 7.012ms
       %7486 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 7.012ms
         %7487 = :nvte_scaled_softmax_backward [] -> 7.012ms
                 -->kernel: 0:7 %5125 =  [] -> 7.012ms
     %7488 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.200ms
       %7489 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.200ms
         %7490 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.935ms
                 -->kernel: 0:7 %5126 =  [] -> 5.926ms
         %7491 = :aten::mul [[128, 4096, 192], []] -> 114.720us
           %7492 = :aten::mul [[128, 4096, 192], []] -> 114.720us
                 -->kernel: 0:7 %5127 =  [] -> 114.720us
         %7493 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.862ms
                 -->kernel: 0:7 %5128 =  [] -> 5.856ms
         %7494 = :aten::mul [[128, 192, 4096], []] -> 115.168us
           %7495 = :aten::mul [[128, 192, 4096], []] -> 115.168us
                 -->kernel: 0:7 %5129 =  [] -> 115.168us
     %7496 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.478ms
       %7497 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.478ms
         %7498 = :aten::contiguous [[4096, 1, 128, 192], []] -> 744.610us
           %7499 = :aten::clone [[4096, 1, 128, 192], []] -> 744.610us
             %7500 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 744.610us
                 -->kernel: 0:7 %5130 =  [] -> 744.610us
         %7501 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.769us
           %7502 = :aten::clone [[4096, 1, 128, 128], []] -> 280.769us
             %7503 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.769us
                 -->kernel: 0:7 %5131 =  [] -> 280.769us
                 -->kernel: 0:7 %5132 =  [] -> 173.409us
     %7504 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 640.354us
       %7505 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 640.354us
         %7506 = :aten::contiguous [[4096, 1, 128, 192], []] -> 422.401us
           %7507 = :aten::clone [[4096, 1, 128, 192], []] -> 422.401us
             %7508 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 422.401us
                 -->kernel: 0:7 %5133 =  [] -> 422.401us
                 -->kernel: 0:7 %5134 =  [] -> 118.529us
     %7509 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.739ms
       %7510 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.739ms
         %7511 = :_LayerNormLinear_backward [] -> 1.739ms
           %7512 = :nvte_quantize_v2 [] -> 323.649us
             %7513 = :quantize_transpose_vector_blockwise [] -> 323.649us
                 -->kernel: 0:7 %5135 =  [] -> 323.649us
           %7514 = :nvte_cublas_gemm_scaled [] -> 565.122us
                 -->kernel: 0:7 %5136 =  [] -> 519.074us
                 -->kernel: 0:7 %5137 =  [] -> 19.008us
           %7515 = :nvte_cublas_gemm_scaled [] -> 527.201us
                 -->kernel: 0:7 %5138 =  [] -> 521.825us
           %7516 = :nvte_rmsnorm_bwd [] -> 21.696us
                 -->kernel: 0:7 %5139 =  [] -> 6.624us
                 -->kernel: 0:7 %5140 =  [] -> 3.136us
     %7517 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.888us
       %7518 = :aten::add_ [[512], [512], []] -> 1.888us
                 -->kernel: 0:35 %5141 =  [] -> 1.888us
     %7519 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.776ms
       %7520 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.776ms
         %7521 = :_LayerNormLinear_backward [] -> 2.776ms
           %7522 = :nvte_quantize_v2 [] -> 241.057us
             %7523 = :quantize_transpose_vector_blockwise [] -> 241.057us
                 -->kernel: 0:7 %5142 =  [] -> 241.057us
           %7524 = :nvte_cublas_gemm_scaled [] -> 1.118ms
                 -->kernel: 0:7 %5143 =  [] -> 1.110ms
           %7525 = :nvte_cublas_gemm_scaled [] -> 1.121ms
                 -->kernel: 0:7 %5144 =  [] -> 1.116ms
           %7526 = :nvte_rmsnorm_bwd [] -> 54.912us
                 -->kernel: 0:7 %5145 =  [] -> 23.296us
                 -->kernel: 0:7 %5146 =  [] -> 20.448us
     %7527 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.664us
       %7528 = :aten::add_ [[1536], [1536], []] -> 1.664us
                 -->kernel: 0:35 %5147 =  [] -> 1.664us
     %7529 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.016us
       %7530 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.016us
         %7531 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.016us
                 -->kernel: 0:7 %5148 =  [] -> 10.016us
     %7532 = :autograd::engine::evaluate_function: _LinearBackward None -> 432.897us
       %7533 = :_LinearBackward [[4096, 1, 576]] -> 432.897us
         %7534 = :_Linear_backward [] -> 432.897us
           %7535 = :nvte_quantize_v2 [] -> 14.400us
             %7536 = :quantize_transpose_vector_blockwise [] -> 14.400us
                 -->kernel: 0:7 %5149 =  [] -> 14.400us
           %7537 = :nvte_cublas_gemm_scaled [] -> 147.936us
                 -->kernel: 0:7 %5150 =  [] -> 141.376us
           %7538 = :nvte_cublas_gemm_scaled [] -> 141.120us
                 -->kernel: 0:7 %5151 =  [] -> 133.312us
     %7539 = :autograd::engine::evaluate_function: _LinearBackward None -> 987.619us
       %7540 = :_LinearBackward [[4096, 1, 1536]] -> 822.402us
         %7541 = :_Linear_backward [] -> 822.402us
           %7542 = :nvte_quantize_v2 [] -> 18.400us
             %7543 = :quantize_transpose_vector_blockwise [] -> 18.400us
                 -->kernel: 0:7 %5152 =  [] -> 18.400us
           %7544 = :nvte_cublas_gemm_scaled [] -> 335.328us
                 -->kernel: 0:7 %5153 =  [] -> 329.024us
           %7545 = :nvte_cublas_gemm_scaled [] -> 342.112us
                 -->kernel: 0:7 %5154 =  [] -> 337.600us
       %7546 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.688us
                 -->kernel: 0:7 %5155 =  [] -> 50.688us
     %7547 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 321.505us
       %7548 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 196.353us
         %7549 = :nvte_rmsnorm_bwd [] -> 196.353us
                 -->kernel: 0:7 %5156 =  [] -> 165.185us
                 -->kernel: 0:7 %5157 =  [] -> 7.840us
       %7550 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 48.960us
                 -->kernel: 0:7 %5158 =  [] -> 48.960us
     %7551 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %7552 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %5159 =  [] -> 1.568us
     %7553 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.958ms
       %7554 = :_LinearBackward [[4096, 1, 7168]] -> 7.958ms
         %7555 = :_Linear_backward [] -> 7.958ms
           %7556 = :nvte_quantize_v2 [] -> 73.536us
             %7557 = :quantize_transpose_vector_blockwise [] -> 73.536us
                 -->kernel: 0:7 %5160 =  [] -> 73.536us
           %7558 = :nvte_cublas_gemm_scaled [] -> 3.876ms
                 -->kernel: 0:7 %5161 =  [] -> 3.869ms
           %7559 = :nvte_cublas_gemm_scaled [] -> 3.860ms
                 -->kernel: 0:7 %5162 =  [] -> 3.852ms
     %7560 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 844.738us
       %7561 = :SwiGLUFunctionBackward [[4096, 18432]] -> 844.738us
         %7562 = :Torch-Compiled Region: 5/1 None -> 844.738us
           %7563 = :triton_poi_fused_cat_0 [[4096, 18432], [4096, 36864], [4096, 36864], [], [], [], [], []] -> 844.738us
                 -->kernel: 0:7 %5163 =  [] -> 844.738us
     %7564 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 16.379ms
       %7565 = :_LayerNormLinearBackward [[4096, 1, 36864]] -> 16.207ms
         %7566 = :_LayerNormLinear_backward [] -> 16.207ms
           %7567 = :nvte_quantize_v2 [] -> 362.017us
             %7568 = :quantize_transpose_vector_blockwise [] -> 362.017us
                 -->kernel: 0:7 %5164 =  [] -> 362.017us
           %7569 = :nvte_cublas_gemm_scaled [] -> 7.637ms
                 -->kernel: 0:7 %5165 =  [] -> 7.629ms
           %7570 = :nvte_cublas_gemm_scaled [] -> 7.695ms
                 -->kernel: 0:7 %5166 =  [] -> 7.686ms
           %7571 = :nvte_rmsnorm_bwd [] -> 195.872us
                 -->kernel: 0:7 %5167 =  [] -> 163.456us
                 -->kernel: 0:7 %5168 =  [] -> 7.776us
       %7572 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.856us
                 -->kernel: 0:7 %5169 =  [] -> 49.856us
     %7573 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.760us
       %7574 = :aten::add_ [[7168], [7168], []] -> 1.760us
                 -->kernel: 0:35 %5170 =  [] -> 1.760us
     %7575 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.283ms
       %7576 = :_LinearBackward [[4096, 1, 7168]] -> 7.283ms
         %7577 = :_Linear_backward [] -> 7.283ms
           %7578 = :nvte_quantize_v2 [] -> 73.920us
             %7579 = :quantize_transpose_vector_blockwise [] -> 73.920us
                 -->kernel: 0:7 %5171 =  [] -> 73.920us
           %7580 = :nvte_quantize_v2 [] -> 111.648us
             %7581 = :quantize_transpose_vector_blockwise [] -> 111.648us
                 -->kernel: 0:7 %5172 =  [] -> 111.648us
           %7582 = :nvte_cublas_gemm_scaled [] -> 3.435ms
                 -->kernel: 0:7 %5173 =  [] -> 3.428ms
           %7583 = :nvte_cublas_gemm_scaled [] -> 3.431ms
                 -->kernel: 0:7 %5174 =  [] -> 3.424ms
     %7584 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.904ms
       %7585 = :BmmBackward0 [[128, 4096, 128]] -> 7.904ms
         %7586 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.978ms
                 -->kernel: 0:7 %5175 =  [] -> 3.965ms
         %7587 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.873ms
                 -->kernel: 0:7 %5176 =  [] -> 3.865ms
     %7588 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.964ms
       %7589 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.964ms
         %7590 = :nvte_scaled_softmax_backward [] -> 6.964ms
                 -->kernel: 0:7 %5177 =  [] -> 6.964ms
     %7591 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.197ms
       %7592 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.197ms
         %7593 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.941ms
                 -->kernel: 0:7 %5178 =  [] -> 5.928ms
         %7594 = :aten::mul [[128, 4096, 192], []] -> 115.360us
           %7595 = :aten::mul [[128, 4096, 192], []] -> 115.360us
                 -->kernel: 0:7 %5179 =  [] -> 115.360us
         %7596 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.864ms
                 -->kernel: 0:7 %5180 =  [] -> 5.858ms
         %7597 = :aten::mul [[128, 192, 4096], []] -> 114.624us
           %7598 = :aten::mul [[128, 192, 4096], []] -> 114.624us
                 -->kernel: 0:7 %5181 =  [] -> 114.624us
     %7599 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.485ms
       %7600 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.485ms
         %7601 = :aten::contiguous [[4096, 1, 128, 192], []] -> 742.946us
           %7602 = :aten::clone [[4096, 1, 128, 192], []] -> 742.946us
             %7603 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 742.946us
                 -->kernel: 0:7 %5182 =  [] -> 742.946us
         %7604 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.545us
           %7605 = :aten::clone [[4096, 1, 128, 128], []] -> 280.545us
             %7606 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.545us
                 -->kernel: 0:7 %5183 =  [] -> 280.545us
                 -->kernel: 0:7 %5184 =  [] -> 172.960us
     %7607 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 637.794us
       %7608 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 637.794us
         %7609 = :aten::contiguous [[4096, 1, 128, 192], []] -> 422.913us
           %7610 = :aten::clone [[4096, 1, 128, 192], []] -> 422.913us
             %7611 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 422.913us
                 -->kernel: 0:7 %5185 =  [] -> 422.913us
                 -->kernel: 0:7 %5186 =  [] -> 118.465us
     %7612 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.743ms
       %7613 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.743ms
         %7614 = :_LayerNormLinear_backward [] -> 1.743ms
           %7615 = :nvte_quantize_v2 [] -> 322.433us
             %7616 = :quantize_transpose_vector_blockwise [] -> 322.433us
                 -->kernel: 0:7 %5187 =  [] -> 322.433us
           %7617 = :nvte_cublas_gemm_scaled [] -> 565.730us
                 -->kernel: 0:7 %5188 =  [] -> 519.330us
                 -->kernel: 0:7 %5189 =  [] -> 18.848us
           %7618 = :nvte_cublas_gemm_scaled [] -> 527.041us
                 -->kernel: 0:7 %5190 =  [] -> 521.441us
           %7619 = :nvte_rmsnorm_bwd [] -> 20.672us
                 -->kernel: 0:7 %5191 =  [] -> 6.112us
                 -->kernel: 0:7 %5192 =  [] -> 3.136us
     %7620 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.824us
       %7621 = :aten::add_ [[512], [512], []] -> 1.824us
                 -->kernel: 0:35 %5193 =  [] -> 1.824us
     %7622 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.784ms
       %7623 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.784ms
         %7624 = :_LayerNormLinear_backward [] -> 2.784ms
           %7625 = :nvte_quantize_v2 [] -> 242.721us
             %7626 = :quantize_transpose_vector_blockwise [] -> 242.721us
                 -->kernel: 0:7 %5194 =  [] -> 242.721us
           %7627 = :nvte_cublas_gemm_scaled [] -> 1.117ms
                 -->kernel: 0:7 %5195 =  [] -> 1.110ms
           %7628 = :nvte_cublas_gemm_scaled [] -> 1.120ms
                 -->kernel: 0:7 %5196 =  [] -> 1.115ms
           %7629 = :nvte_rmsnorm_bwd [] -> 56.128us
                 -->kernel: 0:7 %5197 =  [] -> 23.232us
                 -->kernel: 0:7 %5198 =  [] -> 20.448us
     %7630 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.824us
       %7631 = :aten::add_ [[1536], [1536], []] -> 1.824us
                 -->kernel: 0:35 %5199 =  [] -> 1.824us
     %7632 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.016us
       %7633 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.016us
         %7634 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.016us
                 -->kernel: 0:7 %5200 =  [] -> 10.016us
     %7635 = :autograd::engine::evaluate_function: _LinearBackward None -> 431.905us
       %7636 = :_LinearBackward [[4096, 1, 576]] -> 431.905us
         %7637 = :_Linear_backward [] -> 431.905us
           %7638 = :nvte_quantize_v2 [] -> 14.624us
             %7639 = :quantize_transpose_vector_blockwise [] -> 14.624us
                 -->kernel: 0:7 %5201 =  [] -> 14.624us
           %7640 = :nvte_cublas_gemm_scaled [] -> 147.937us
                 -->kernel: 0:7 %5202 =  [] -> 141.153us
           %7641 = :nvte_cublas_gemm_scaled [] -> 139.648us
                 -->kernel: 0:7 %5203 =  [] -> 133.664us
     %7642 = :autograd::engine::evaluate_function: _LinearBackward None -> 985.634us
       %7643 = :_LinearBackward [[4096, 1, 1536]] -> 818.850us
         %7644 = :_Linear_backward [] -> 818.850us
           %7645 = :nvte_quantize_v2 [] -> 18.368us
             %7646 = :quantize_transpose_vector_blockwise [] -> 18.368us
                 -->kernel: 0:7 %5204 =  [] -> 18.368us
           %7647 = :nvte_cublas_gemm_scaled [] -> 335.329us
                 -->kernel: 0:7 %5205 =  [] -> 328.993us
           %7648 = :nvte_cublas_gemm_scaled [] -> 342.529us
                 -->kernel: 0:7 %5206 =  [] -> 338.017us
       %7649 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.720us
                 -->kernel: 0:7 %5207 =  [] -> 50.720us
     %7650 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 320.929us
       %7651 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 195.169us
         %7652 = :nvte_rmsnorm_bwd [] -> 195.169us
                 -->kernel: 0:7 %5208 =  [] -> 165.281us
                 -->kernel: 0:7 %5209 =  [] -> 7.776us
       %7653 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.856us
                 -->kernel: 0:7 %5210 =  [] -> 49.856us
     %7654 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.664us
       %7655 = :aten::add_ [[7168], [7168], []] -> 1.664us
                 -->kernel: 0:35 %5211 =  [] -> 1.664us
     %7656 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 2.965ms
       %7657 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.361ms
         %7658 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.361ms
           %7659 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.361ms
             %7660 = :aten::arange [[], [], [], [], []] -> 1.152us
               %7661 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %5212 =  [] -> 1.152us
             %7662 = CCCL:cub::DeviceRadixSort [] -> 188.960us
                 -->kernel: 0:7 %5213 =  [] -> 3.520us
                 -->kernel: 0:7 %5214 =  [] -> 1.568us
                 -->kernel: 0:7 %5215 =  [] -> 7.968us
                 -->kernel: 0:7 %5216 =  [] -> 7.488us
                 -->kernel: 0:7 %5217 =  [] -> 7.168us
                 -->kernel: 0:7 %5218 =  [] -> 7.104us
                 -->kernel: 0:7 %5219 =  [] -> 7.200us
                 -->kernel: 0:7 %5220 =  [] -> 7.200us
                 -->kernel: 0:7 %5221 =  [] -> 6.912us
                 -->kernel: 0:7 %5222 =  [] -> 6.912us
             %7663 = :aten::zeros [[], [], [], [], []] -> 545.154us
               %7664 = :aten::zero_ [[129280, 7168]] -> 545.154us
                 %7665 = :aten::fill_ [[129280, 7168], []] -> 545.154us
                 -->kernel: 0:7 %5223 =  [] -> 545.154us
             %7666 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 17.152us
                 -->kernel: 0:7 %5224 =  [] -> 1.440us
                 -->kernel: 0:7 %5225 =  [] -> 3.840us
                 -->kernel: 0:7 %5226 =  [] -> 1.696us
             %7667 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 18.880us
                 -->kernel: 0:7 %5227 =  [] -> 1.440us
                 -->kernel: 0:7 %5228 =  [] -> 3.200us
                 -->kernel: 0:7 %5229 =  [] -> 1.344us
                 -->kernel: 0:7 %5230 =  [] -> 1.952us
                 -->kernel: 0:7 %5231 =  [] -> 212.801us
                 -->kernel: 0:7 %5232 =  [] -> 149.312us
       %7668 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.556ms
                 -->kernel: 0:35 %5233 =  [] -> 1.556ms
     %7669 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.558ms
       %7670 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.558ms
                 -->kernel: 0:35 %5234 =  [] -> 1.558ms
     %7671 = :aten::linalg_vector_norm [[3002413056], [], [], [], []] -> 2.546ms
                 -->kernel: 0:7 %5235 =  [] -> 616.386us
                 -->kernel: 0:7 %5236 =  [] -> 609.025us
                 -->kernel: 0:7 %5237 =  [] -> 608.738us
                 -->kernel: 0:7 %5238 =  [] -> 609.825us
     %7672 = :aten::isnan [[]] -> 1.568us
       %7673 = :aten::ne [[], []] -> 1.568us
                 -->kernel: 0:7 %5239 =  [] -> 1.568us
     %7674 = :aten::is_nonzero [[]] -> 2.208us
       %7675 = :aten::item [[]] -> 2.208us
         %7676 = :aten::_local_scalar_dense [[]] -> 2.208us
     %7677 = :aten::isinf [[]] -> 38.880us
       %7678 = :aten::abs [[]] -> 1.248us
         %7679 = :aten::abs [[], [0]] -> 1.248us
                 -->kernel: 0:7 %5240 =  [] -> 1.248us
       %7680 = :aten::eq [[], []] -> 1.536us
                 -->kernel: 0:7 %5241 =  [] -> 1.536us
     %7681 = :aten::is_nonzero [[]] -> 2.240us
       %7682 = :aten::item [[]] -> 2.240us
         %7683 = :aten::_local_scalar_dense [[]] -> 2.240us
     %7684 = :aten::mul_ [[3002413056], []] -> 3.545ms
                 -->kernel: 0:7 %5242 =  [] -> 864.514us
                 -->kernel: 0:7 %5243 =  [] -> 901.666us
                 -->kernel: 0:7 %5244 =  [] -> 873.378us
                 -->kernel: 0:7 %5245 =  [] -> 870.946us
     %7685 = :c10d::reduce_scatter_tensor_coalesced_ [[375301632], [3002413056], [], [], [], []] -> 14.664ms
       %7686 = :record_param_comms [[3002413056], [], [], [], [], [], [], [], [], []] -> 14.664ms
         %7687 = :nccl:reduce_scatter_tensor_coalesced [[3002413056]] -> 14.664ms
           %7688 = NCCL:ncclGroupEnd [] -> 14.664ms
                 -->kernel: 0:7 %5246 =  [] -> 14.664ms
     %7689 = :aten::linalg_vector_norm [[352321536], [], [], [], []] -> 305.313us
                 -->kernel: 0:7 %5247 =  [] -> 291.361us
     %7690 = :aten::isnan [[]] -> 1.632us
       %7691 = :aten::ne [[], []] -> 1.632us
                 -->kernel: 0:7 %5248 =  [] -> 1.632us
     %7692 = :aten::is_nonzero [[]] -> 2.240us
       %7693 = :aten::item [[]] -> 2.240us
         %7694 = :aten::_local_scalar_dense [[]] -> 2.240us
     %7695 = :aten::isinf [[]] -> 27.040us
       %7696 = :aten::abs [[]] -> 1.472us
         %7697 = :aten::abs [[], [0]] -> 1.472us
                 -->kernel: 0:7 %5249 =  [] -> 1.472us
       %7698 = :aten::eq [[], []] -> 1.536us
                 -->kernel: 0:7 %5250 =  [] -> 1.536us
     %7699 = :aten::is_nonzero [[]] -> 2.368us
       %7700 = :aten::item [[]] -> 2.368us
         %7701 = :aten::_local_scalar_dense [[]] -> 2.368us
     %7702 = :aten::mul_ [[352321536], []] -> 403.617us
                 -->kernel: 0:7 %5251 =  [] -> 403.617us
     %7703 = :aten::stack [[32], [32], []] -> 1.856us
       %7704 = :aten::cat [[32], [32], []] -> 1.856us
                 -->kernel: 0:7 %5252 =  [] -> 1.856us
     %7705 = :aten::stack [[32], [32], []] -> 2.336us
       %7706 = :aten::cat [[32], [32], []] -> 2.336us
                 -->kernel: 0:7 %5253 =  [] -> 2.336us
     %7707 = :c10d::allreduce_ [[2, 32], [], [], [], [], []] -> 15.328us
       %7708 = :record_param_comms [[2, 32], [], [], [], [], [], [], [], [], []] -> 15.328us
         %7709 = :nccl:all_reduce [[2, 32]] -> 15.328us
           %7710 = NCCL:ncclAllReduce [] -> 15.328us
                 -->kernel: 0:7 %5254 =  [] -> 15.328us
     %7711 = :aten::sum [[2, 32], [], [], []] -> 2.560us
                 -->kernel: 0:7 %5255 =  [] -> 2.560us
     %7712 = :aten::div [[2, 1], []] -> 1.408us
                 -->kernel: 0:7 %5256 =  [] -> 1.408us
     %7713 = :aten::sub [[2, 1], [2, 32], []] -> 2.112us
                 -->kernel: 0:7 %5257 =  [] -> 2.112us
     %7714 = :aten::sign [[2, 32]] -> 1.600us
                 -->kernel: 0:7 %5258 =  [] -> 1.600us
     %7715 = :aten::mul [[2, 32], []] -> 1.248us
                 -->kernel: 0:7 %5259 =  [] -> 1.248us
     %7716 = :aten::add [[2, 32], [2, 32], []] -> 2.848us
                 -->kernel: 0:7 %5260 =  [] -> 2.848us
     %7717 = :aten::zero_ [[32]] -> 1.184us
       %7718 = :aten::fill_ [[32], []] -> 1.184us
                 -->kernel: 0:7 %5261 =  [] -> 1.184us
     %7719 = :aten::copy_ [[32], [32], []] -> 1.184us
     %7720 = :aten::zero_ [[32]] -> 896.000ns
       %7721 = :aten::fill_ [[32], []] -> 896.000ns
                 -->kernel: 0:7 %5262 =  [] -> 896.000ns
     %7722 = :aten::copy_ [[32], [32], []] -> 896.000ns
     %7723 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7724 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7725 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7726 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 9.184us
       %7727 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 9.184us
         %7728 = :nccl:all_reduce [[1]] -> 9.184us
           %7729 = NCCL:ncclAllReduce [] -> 9.184us
                 -->kernel: 0:7 %5263 =  [] -> 9.184us
     %7730 = :aten::item [[1]] -> 2.240us
       %7731 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %7732 = :aten::to [[1], [], [], [], [], []] -> 768.000ns
       %7733 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 768.000ns
         %7734 = :aten::copy_ [[1], [1], []] -> 768.000ns
     %7735 = :aten::zeros [[], [], [], [], []] -> 1.152us
       %7736 = :aten::zero_ [[320]] -> 1.152us
         %7737 = :aten::fill_ [[320], []] -> 1.152us
                 -->kernel: 0:7 %5264 =  [] -> 1.152us
     %7738 = :nvte_multi_tensor_l2norm_cuda [] -> 1.388ms
                 -->kernel: 0:7 %5265 =  [] -> 35.616us
                 -->kernel: 0:7 %5266 =  [] -> 33.504us
                 -->kernel: 0:7 %5267 =  [] -> 29.984us
                 -->kernel: 0:7 %5268 =  [] -> 30.016us
                 -->kernel: 0:7 %5269 =  [] -> 30.048us
                 -->kernel: 0:7 %5270 =  [] -> 30.304us
                 -->kernel: 0:7 %5271 =  [] -> 30.112us
                 -->kernel: 0:7 %5272 =  [] -> 30.113us
                 -->kernel: 0:7 %5273 =  [] -> 29.952us
                 -->kernel: 0:7 %5274 =  [] -> 29.728us
                 -->kernel: 0:7 %5275 =  [] -> 29.824us
                 -->kernel: 0:7 %5276 =  [] -> 30.624us
                 -->kernel: 0:7 %5277 =  [] -> 29.952us
                 -->kernel: 0:7 %5278 =  [] -> 29.984us
                 -->kernel: 0:7 %5279 =  [] -> 30.144us
                 -->kernel: 0:7 %5280 =  [] -> 30.304us
                 -->kernel: 0:7 %5281 =  [] -> 30.240us
                 -->kernel: 0:7 %5282 =  [] -> 29.600us
                 -->kernel: 0:7 %5283 =  [] -> 29.889us
                 -->kernel: 0:7 %5284 =  [] -> 29.984us
                 -->kernel: 0:7 %5285 =  [] -> 29.792us
                 -->kernel: 0:7 %5286 =  [] -> 30.208us
                 -->kernel: 0:7 %5287 =  [] -> 29.920us
                 -->kernel: 0:7 %5288 =  [] -> 29.696us
                 -->kernel: 0:7 %5289 =  [] -> 29.984us
                 -->kernel: 0:7 %5290 =  [] -> 30.592us
                 -->kernel: 0:7 %5291 =  [] -> 30.272us
                 -->kernel: 0:7 %5292 =  [] -> 30.144us
                 -->kernel: 0:7 %5293 =  [] -> 29.920us
                 -->kernel: 0:7 %5294 =  [] -> 30.048us
                 -->kernel: 0:7 %5295 =  [] -> 29.984us
                 -->kernel: 0:7 %5296 =  [] -> 30.336us
                 -->kernel: 0:7 %5297 =  [] -> 30.272us
                 -->kernel: 0:7 %5298 =  [] -> 29.824us
                 -->kernel: 0:7 %5299 =  [] -> 17.024us
                 -->kernel: 0:7 %5300 =  [] -> 1.728us
     %7739 = :aten::pow [[1], []] -> 1.536us
                 -->kernel: 0:7 %5301 =  [] -> 1.536us
     %7740 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 33.536us
       %7741 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 33.536us
         %7742 = :nccl:all_reduce [[1]] -> 33.536us
           %7743 = NCCL:ncclAllReduce [] -> 33.536us
                 -->kernel: 0:7 %5302 =  [] -> 33.536us
     %7744 = :aten::item [[1]] -> 2.240us
       %7745 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %7746 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7747 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7748 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7749 = :nvte_multi_tensor_scale_cuda [] -> 936.738us
                 -->kernel: 0:7 %5303 =  [] -> 36.800us
                 -->kernel: 0:7 %5304 =  [] -> 43.072us
                 -->kernel: 0:7 %5305 =  [] -> 44.160us
                 -->kernel: 0:7 %5306 =  [] -> 43.072us
                 -->kernel: 0:7 %5307 =  [] -> 43.745us
                 -->kernel: 0:7 %5308 =  [] -> 42.784us
                 -->kernel: 0:7 %5309 =  [] -> 42.656us
                 -->kernel: 0:7 %5310 =  [] -> 43.168us
                 -->kernel: 0:7 %5311 =  [] -> 42.784us
                 -->kernel: 0:7 %5312 =  [] -> 43.136us
                 -->kernel: 0:7 %5313 =  [] -> 43.040us
                 -->kernel: 0:7 %5314 =  [] -> 43.488us
                 -->kernel: 0:7 %5315 =  [] -> 42.401us
                 -->kernel: 0:7 %5316 =  [] -> 43.808us
                 -->kernel: 0:7 %5317 =  [] -> 42.784us
                 -->kernel: 0:7 %5318 =  [] -> 43.552us
                 -->kernel: 0:7 %5319 =  [] -> 42.816us
                 -->kernel: 0:7 %5320 =  [] -> 30.656us
     %7750 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7751 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7752 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7753 = :nvte_multi_tensor_scale_cuda [] -> 884.482us
                 -->kernel: 0:7 %5321 =  [] -> 43.584us
                 -->kernel: 0:7 %5322 =  [] -> 43.968us
                 -->kernel: 0:7 %5323 =  [] -> 42.848us
                 -->kernel: 0:7 %5324 =  [] -> 43.712us
                 -->kernel: 0:7 %5325 =  [] -> 42.912us
                 -->kernel: 0:7 %5326 =  [] -> 43.584us
                 -->kernel: 0:7 %5327 =  [] -> 42.625us
                 -->kernel: 0:7 %5328 =  [] -> 43.648us
                 -->kernel: 0:7 %5329 =  [] -> 43.136us
                 -->kernel: 0:7 %5330 =  [] -> 43.200us
                 -->kernel: 0:7 %5331 =  [] -> 42.784us
                 -->kernel: 0:7 %5332 =  [] -> 43.008us
                 -->kernel: 0:7 %5333 =  [] -> 43.008us
                 -->kernel: 0:7 %5334 =  [] -> 43.744us
                 -->kernel: 0:7 %5335 =  [] -> 44.321us
                 -->kernel: 0:7 %5336 =  [] -> 43.552us
                 -->kernel: 0:7 %5337 =  [] -> 28.288us
     %7754 = :Optimizer.step#HybridDeviceOptimizer.step None -> 317.934ms
       %7755 = :aten::copy_ [[375301632], [375301632], []] -> 43.869ms
         %7756 = :aten::to [[375301632], [], [], [], []] -> 2.226ms
           %7757 = :aten::_to_copy [[375301632], [], [], [], [], [], []] -> 2.226ms
             %7758 = :aten::copy_ [[375301632], [375301632], []] -> 2.226ms
                 -->kernel: 0:7 %5338 =  [] -> 2.226ms
         %7759 = :aten::copy_ [[375301632], [375301632], []] -> 41.599ms
       %7760 = :Optimizer.step#AdamW.step None -> 72.103ms
         %7761 = :aten::copy_ [[375301632], [375301632], []] -> 72.103ms
           %7762 = :aten::copy_ [[375301632], [375301632], []] -> 71.392ms
           %7763 = :aten::copy_ [[375301632], [375301632], []] -> 603.777us
                 -->kernel: 0:7 %5339 =  [] -> 603.777us
     %7764 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 341.324ms
       %7765 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 341.324ms
         %7766 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 341.324ms
           %7767 = NCCL:ncclGroupEnd [] -> 341.324ms
                 -->kernel: 0:39 %5340 =  [] -> 341.324ms
     %7768 = :Optimizer.step#HybridDeviceOptimizer.step None -> 84.311ms
       %7769 = :aten::to [[14680064], [], [], [], []] -> 89.344us
         %7770 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.344us
           %7771 = :aten::copy_ [[14680064], [14680064], []] -> 89.344us
                 -->kernel: 0:7 %5341 =  [] -> 89.344us
       %7772 = :aten::to [[29360128], [], [], [], []] -> 176.193us
         %7773 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.193us
           %7774 = :aten::copy_ [[29360128], [29360128], []] -> 176.193us
                 -->kernel: 0:7 %5342 =  [] -> 176.193us
       %7775 = :aten::to [[29360128], [], [], [], []] -> 176.160us
         %7776 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.160us
           %7777 = :aten::copy_ [[29360128], [29360128], []] -> 176.160us
                 -->kernel: 0:7 %5343 =  [] -> 176.160us
       %7778 = :aten::to [[29360128], [], [], [], []] -> 176.225us
         %7779 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.225us
           %7780 = :aten::copy_ [[29360128], [29360128], []] -> 176.225us
                 -->kernel: 0:7 %5344 =  [] -> 176.225us
       %7781 = :aten::to [[29360128], [], [], [], []] -> 176.128us
         %7782 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.128us
           %7783 = :aten::copy_ [[29360128], [29360128], []] -> 176.128us
                 -->kernel: 0:7 %5345 =  [] -> 176.128us
       %7784 = :aten::to [[14680064], [], [], [], []] -> 89.536us
         %7785 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.536us
           %7786 = :aten::copy_ [[14680064], [14680064], []] -> 89.536us
                 -->kernel: 0:7 %5346 =  [] -> 89.536us
       %7787 = :aten::to [[14680064], [], [], [], []] -> 89.569us
         %7788 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.569us
           %7789 = :aten::copy_ [[14680064], [14680064], []] -> 89.569us
                 -->kernel: 0:7 %5347 =  [] -> 89.569us
       %7790 = :aten::to [[14680064], [], [], [], []] -> 89.312us
         %7791 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.312us
           %7792 = :aten::copy_ [[14680064], [14680064], []] -> 89.312us
                 -->kernel: 0:7 %5348 =  [] -> 89.312us
       %7793 = :aten::to [[14680064], [], [], [], []] -> 89.440us
         %7794 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.440us
           %7795 = :aten::copy_ [[14680064], [14680064], []] -> 89.440us
                 -->kernel: 0:7 %5349 =  [] -> 89.440us
       %7796 = :aten::to [[29360128], [], [], [], []] -> 176.705us
         %7797 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.705us
           %7798 = :aten::copy_ [[29360128], [29360128], []] -> 176.705us
                 -->kernel: 0:7 %5350 =  [] -> 176.705us
       %7799 = :aten::to [[29360128], [], [], [], []] -> 176.640us
         %7800 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.640us
           %7801 = :aten::copy_ [[29360128], [29360128], []] -> 176.640us
                 -->kernel: 0:7 %5351 =  [] -> 176.640us
       %7802 = :aten::to [[29360128], [], [], [], []] -> 176.033us
         %7803 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.033us
           %7804 = :aten::copy_ [[29360128], [29360128], []] -> 176.033us
                 -->kernel: 0:7 %5352 =  [] -> 176.033us
       %7805 = :aten::to [[29360128], [], [], [], []] -> 176.384us
         %7806 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.384us
           %7807 = :aten::copy_ [[29360128], [29360128], []] -> 176.384us
                 -->kernel: 0:7 %5353 =  [] -> 176.384us
       %7808 = :aten::copy_ [[14680064], [14680064], []] -> 1.993ms
         %7809 = :aten::to [[14680064], [], [], [], []] -> 89.409us
           %7810 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.409us
             %7811 = :aten::copy_ [[14680064], [14680064], []] -> 89.409us
                 -->kernel: 0:7 %5354 =  [] -> 89.409us
         %7812 = :aten::copy_ [[14680064], [14680064], []] -> 1.843ms
       %7813 = :aten::copy_ [[14680064], [14680064], []] -> 1.849ms
         %7814 = :aten::to [[14680064], [], [], [], []] -> 87.936us
           %7815 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 87.936us
             %7816 = :aten::copy_ [[14680064], [14680064], []] -> 87.936us
                 -->kernel: 0:7 %5355 =  [] -> 87.936us
         %7817 = :aten::copy_ [[14680064], [14680064], []] -> 1.731ms
       %7818 = :aten::copy_ [[14680064], [14680064], []] -> 1.802ms
         %7819 = :aten::to [[14680064], [], [], [], []] -> 87.648us
           %7820 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 87.648us
             %7821 = :aten::copy_ [[14680064], [14680064], []] -> 87.648us
                 -->kernel: 0:7 %5356 =  [] -> 87.648us
         %7822 = :aten::copy_ [[14680064], [14680064], []] -> 1.689ms
       %7823 = :Optimizer.step#FusedAdam.step None -> 3.873ms
         %7824 = :nvte_multi_tensor_adam_cuda [] -> 3.086ms
                 -->kernel: 0:7 %5357 =  [] -> 198.784us
                 -->kernel: 0:7 %5358 =  [] -> 200.801us
                 -->kernel: 0:7 %5359 =  [] -> 199.808us
                 -->kernel: 0:7 %5360 =  [] -> 199.137us
                 -->kernel: 0:7 %5361 =  [] -> 199.360us
                 -->kernel: 0:7 %5362 =  [] -> 199.201us
                 -->kernel: 0:7 %5363 =  [] -> 199.104us
                 -->kernel: 0:7 %5364 =  [] -> 199.169us
                 -->kernel: 0:7 %5365 =  [] -> 197.632us
                 -->kernel: 0:7 %5366 =  [] -> 199.201us
                 -->kernel: 0:7 %5367 =  [] -> 199.104us
                 -->kernel: 0:7 %5368 =  [] -> 198.273us
                 -->kernel: 0:7 %5369 =  [] -> 199.840us
                 -->kernel: 0:7 %5370 =  [] -> 200.001us
                 -->kernel: 0:7 %5371 =  [] -> 141.120us
         %7825 = :aten::copy_ [[14680064], [14680064], []] -> 27.200us
                 -->kernel: 0:7 %5372 =  [] -> 27.200us
         %7826 = :aten::copy_ [[29360128], [29360128], []] -> 49.601us
                 -->kernel: 0:7 %5373 =  [] -> 49.601us
         %7827 = :aten::copy_ [[29360128], [29360128], []] -> 49.728us
                 -->kernel: 0:7 %5374 =  [] -> 49.728us
         %7828 = :aten::copy_ [[29360128], [29360128], []] -> 48.256us
                 -->kernel: 0:7 %5375 =  [] -> 48.256us
         %7829 = :aten::copy_ [[29360128], [29360128], []] -> 49.344us
                 -->kernel: 0:7 %5376 =  [] -> 49.344us
         %7830 = :aten::copy_ [[14680064], [14680064], []] -> 25.280us
                 -->kernel: 0:7 %5377 =  [] -> 25.280us
         %7831 = :aten::copy_ [[14680064], [14680064], []] -> 24.960us
                 -->kernel: 0:7 %5378 =  [] -> 24.960us
         %7832 = :aten::copy_ [[14680064], [14680064], []] -> 25.120us
                 -->kernel: 0:7 %5379 =  [] -> 25.120us
         %7833 = :aten::copy_ [[14680064], [14680064], []] -> 26.304us
                 -->kernel: 0:7 %5380 =  [] -> 26.304us
         %7834 = :aten::copy_ [[29360128], [29360128], []] -> 48.128us
                 -->kernel: 0:7 %5381 =  [] -> 48.128us
         %7835 = :aten::copy_ [[29360128], [29360128], []] -> 49.280us
                 -->kernel: 0:7 %5382 =  [] -> 49.280us
         %7836 = :aten::copy_ [[29360128], [29360128], []] -> 49.792us
                 -->kernel: 0:7 %5383 =  [] -> 49.792us
         %7837 = :aten::copy_ [[29360128], [29360128], []] -> 47.904us
                 -->kernel: 0:7 %5384 =  [] -> 47.904us
       %7838 = :Optimizer.step#AdamW.step None -> 8.762ms
         %7839 = :aten::copy_ [[14680064], [14680064], []] -> 2.931ms
           %7840 = :aten::copy_ [[14680064], [14680064], []] -> 2.851ms
           %7841 = :aten::copy_ [[14680064], [14680064], []] -> 24.256us
                 -->kernel: 0:7 %5385 =  [] -> 24.256us
         %7842 = :aten::copy_ [[14680064], [14680064], []] -> 2.781ms
           %7843 = :aten::copy_ [[14680064], [14680064], []] -> 2.746ms
           %7844 = :aten::copy_ [[14680064], [14680064], []] -> 24.032us
                 -->kernel: 0:7 %5386 =  [] -> 24.032us
         %7845 = :aten::copy_ [[14680064], [14680064], []] -> 2.776ms
           %7846 = :aten::copy_ [[14680064], [14680064], []] -> 2.734ms
           %7847 = :aten::copy_ [[14680064], [14680064], []] -> 25.120us
                 -->kernel: 0:7 %5387 =  [] -> 25.120us
     %7848 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 53.545ms
       %7849 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 53.545ms
         %7850 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 53.545ms
           %7851 = NCCL:ncclGroupEnd [] -> 53.545ms
                 -->kernel: 0:39 %5388 =  [] -> 53.545ms
     %7852 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7853 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7854 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7855 = :aten::item [[1]] -> 3.040us
       %7856 = :aten::_local_scalar_dense [[1]] -> 3.040us
     %7857 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7858 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7859 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7860 = :aten::item [[1]] -> 2.240us
       %7861 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %7862 = :aten::item [[1]] -> 2.240us
       %7863 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %7864 = :aten::cat [[1], []] -> 1.632us
     %7865 = :aten::mean [[1], []] -> 2.848us
       %7866 = :aten::mean [[1], [], [], []] -> 2.848us
                 -->kernel: 0:7 %5389 =  [] -> 2.848us
     %7867 = :aten::item [[1]] -> 2.624us
       %7868 = :aten::_local_scalar_dense [[1]] -> 2.624us
     %7869 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7870 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7871 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7872 = :aten::add [[1], [], []] -> 1.536us
                 -->kernel: 0:7 %5390 =  [] -> 1.536us
     %7873 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7874 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7875 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7876 = :aten::item [[1]] -> 2.368us
       %7877 = :aten::_local_scalar_dense [[1]] -> 2.368us
     %7878 = :aten::item [[1]] -> 2.240us
       %7879 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %7880 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 1.708ms
       %7881 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 1.708ms
         %7882 = :nccl:all_reduce [[2]] -> 1.708ms
           %7883 = NCCL:ncclAllReduce [] -> 1.708ms
                 -->kernel: 0:7 %5391 =  [] -> 1.708ms
     %7884 = :c10d::allreduce_ [[3], [], [], [], [], []] -> 11.296us
       %7885 = :record_param_comms [[3], [], [], [], [], [], [], [], [], []] -> 11.296us
         %7886 = :nccl:all_reduce [[3]] -> 11.296us
           %7887 = NCCL:ncclAllReduce [] -> 11.296us
                 -->kernel: 0:7 %5392 =  [] -> 11.296us
     %7888 = :aten::mul [[3], []] -> 1.472us
                 -->kernel: 0:7 %5393 =  [] -> 1.472us
     %7889 = :aten::mul [[2], []] -> 1.280us
                 -->kernel: 0:7 %5394 =  [] -> 1.280us
     %7890 = :aten::sum [[3], []] -> 2.624us
       %7891 = :aten::sum [[3], [], [], []] -> 2.624us
                 -->kernel: 0:7 %5395 =  [] -> 2.624us
     %7892 = :aten::div [[], []] -> 1.472us
                 -->kernel: 0:7 %5396 =  [] -> 1.472us
     %7893 = :aten::add_ [[1], [], []] -> 1.472us
                 -->kernel: 0:7 %5397 =  [] -> 1.472us
     %7894 = :aten::sum [[2], []] -> 2.304us
       %7895 = :aten::sum [[2], [], [], []] -> 2.304us
                 -->kernel: 0:7 %5398 =  [] -> 2.304us
     %7896 = :aten::div [[], []] -> 1.120us
                 -->kernel: 0:7 %5399 =  [] -> 1.120us
     %7897 = :aten::add_ [[1], [], []] -> 1.440us
                 -->kernel: 0:7 %5400 =  [] -> 1.440us
     %7898 = :aten::zero_ [[3]] -> 1.184us
       %7899 = :aten::fill_ [[3], []] -> 1.184us
                 -->kernel: 0:7 %5401 =  [] -> 1.184us
     %7900 = :aten::zero_ [[2]] -> 992.000ns
       %7901 = :aten::fill_ [[2], []] -> 992.000ns
                 -->kernel: 0:7 %5402 =  [] -> 992.000ns
     %7902 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 331.873us
       %7903 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 331.873us
         %7904 = :nccl:all_reduce [[1]] -> 331.873us
           %7905 = NCCL:ncclAllReduce [] -> 331.873us
                 -->kernel: 0:7 %5403 =  [] -> 331.873us
     %7906 = :aten::mul [[1], []] -> 1.312us
                 -->kernel: 0:7 %5404 =  [] -> 1.312us
     %7907 = :aten::add_ [[1], [], []] -> 1.472us
                 -->kernel: 0:7 %5405 =  [] -> 1.472us
     %7908 = :aten::zero_ [[1]] -> 992.000ns
       %7909 = :aten::fill_ [[1], []] -> 992.000ns
                 -->kernel: 0:7 %5406 =  [] -> 992.000ns
     %7910 = :c10d::barrier [[1], [], [], [], []] -> 190.336us
       %7911 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 190.336us
         %7912 = :aten::zeros [[], [], [], [], []] -> 928.000ns
           %7913 = :aten::zero_ [[1]] -> 928.000ns
             %7914 = :aten::fill_ [[1], []] -> 928.000ns
                 -->kernel: 0:7 %5407 =  [] -> 928.000ns
         %7915 = :nccl:all_reduce_barrier [[1]] -> 155.872us
           %7916 = NCCL:ncclAllReduce [] -> 155.872us
                 -->kernel: 0:7 %5408 =  [] -> 155.872us
     %7917 = :c10d::barrier [[1], [], [], [], []] -> 37.345us
       %7918 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 37.345us
         %7919 = :aten::zeros [[], [], [], [], []] -> 1.152us
           %7920 = :aten::zero_ [[1]] -> 1.152us
             %7921 = :aten::fill_ [[1], []] -> 1.152us
                 -->kernel: 0:7 %5409 =  [] -> 1.152us
         %7922 = :nccl:all_reduce_barrier [[1]] -> 7.808us
           %7923 = NCCL:ncclAllReduce [] -> 7.808us
                 -->kernel: 0:7 %5410 =  [] -> 7.808us
     %7924 = :aten::item [[1]] -> 2.240us
       %7925 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %7926 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7927 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7928 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7929 = :aten::item [[1]] -> 2.208us
       %7930 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %7931 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7932 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7933 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7934 = :aten::item [[1]] -> 2.240us
       %7935 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %7936 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7937 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7938 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7939 = :aten::item [[1]] -> 2.272us
       %7940 = :aten::_local_scalar_dense [[1]] -> 2.272us
     %7941 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7942 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7943 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7944 = :aten::zeros [[], [], [], [], []] -> 992.000ns
       %7945 = :aten::zero_ [[8, 24]] -> 992.000ns
         %7946 = :aten::fill_ [[8, 24], []] -> 992.000ns
                 -->kernel: 0:7 %5411 =  [] -> 992.000ns
     %7947 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 85.600us
       %7948 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 85.600us
         %7949 = :nccl:_all_gather_base [[24]] -> 85.600us
           %7950 = NCCL:ncclAllGather [] -> 85.600us
                 -->kernel: 0:7 %5412 =  [] -> 85.600us
     %7951 = :aten::gt [[8], []] -> 1.856us
                 -->kernel: 0:7 %5413 =  [] -> 1.856us
     %7952 = :aten::index [[8], [8]] -> 61.600us
       %7953 = :aten::nonzero [[8]] -> 61.600us
         %7954 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5414 =  [] -> 1.408us
         %7955 = CCCL:cub::DeviceSelect::Flagged [] -> 15.072us
                 -->kernel: 0:7 %5415 =  [] -> 1.056us
                 -->kernel: 0:7 %5416 =  [] -> 2.240us
     %7956 = :aten::gt [[8], []] -> 1.952us
                 -->kernel: 0:7 %5417 =  [] -> 1.952us
     %7957 = :aten::index [[8], [8]] -> 45.632us
       %7958 = :aten::nonzero [[8]] -> 45.632us
         %7959 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5418 =  [] -> 1.280us
         %7960 = CCCL:cub::DeviceSelect::Flagged [] -> 12.416us
                 -->kernel: 0:7 %5419 =  [] -> 1.056us
                 -->kernel: 0:7 %5420 =  [] -> 2.144us
     %7961 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %5421 =  [] -> 1.824us
     %7962 = :aten::index [[8], [8]] -> 52.320us
       %7963 = :aten::nonzero [[8]] -> 52.320us
         %7964 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5422 =  [] -> 1.312us
         %7965 = CCCL:cub::DeviceSelect::Flagged [] -> 12.448us
                 -->kernel: 0:7 %5423 =  [] -> 1.056us
                 -->kernel: 0:7 %5424 =  [] -> 2.176us
     %7966 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5425 =  [] -> 1.792us
     %7967 = :aten::index [[8], [8]] -> 44.096us
       %7968 = :aten::nonzero [[8]] -> 44.096us
         %7969 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5426 =  [] -> 1.312us
         %7970 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %5427 =  [] -> 1.088us
                 -->kernel: 0:7 %5428 =  [] -> 2.144us
     %7971 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5429 =  [] -> 1.792us
     %7972 = :aten::index [[8], [8]] -> 42.688us
       %7973 = :aten::nonzero [[8]] -> 42.688us
         %7974 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5430 =  [] -> 1.312us
         %7975 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %5431 =  [] -> 1.024us
                 -->kernel: 0:7 %5432 =  [] -> 2.176us
     %7976 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5433 =  [] -> 1.792us
     %7977 = :aten::index [[8], [8]] -> 43.968us
       %7978 = :aten::nonzero [[8]] -> 43.968us
         %7979 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5434 =  [] -> 1.280us
         %7980 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %5435 =  [] -> 1.088us
                 -->kernel: 0:7 %5436 =  [] -> 2.144us
     %7981 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %5437 =  [] -> 1.824us
     %7982 = :aten::index [[8], [8]] -> 42.688us
       %7983 = :aten::nonzero [[8]] -> 42.688us
         %7984 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5438 =  [] -> 1.312us
         %7985 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %5439 =  [] -> 1.056us
                 -->kernel: 0:7 %5440 =  [] -> 2.176us
     %7986 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5441 =  [] -> 1.792us
     %7987 = :aten::index [[8], [8]] -> 43.072us
       %7988 = :aten::nonzero [[8]] -> 43.072us
         %7989 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5442 =  [] -> 1.312us
         %7990 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5443 =  [] -> 1.056us
                 -->kernel: 0:7 %5444 =  [] -> 2.112us
     %7991 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5445 =  [] -> 1.792us
     %7992 = :aten::index [[8], [8]] -> 42.080us
       %7993 = :aten::nonzero [[8]] -> 42.080us
         %7994 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5446 =  [] -> 1.312us
         %7995 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %5447 =  [] -> 992.000ns
                 -->kernel: 0:7 %5448 =  [] -> 2.144us
     %7996 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %5449 =  [] -> 1.760us
     %7997 = :aten::index [[8], [8]] -> 42.112us
       %7998 = :aten::nonzero [[8]] -> 42.112us
         %7999 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5450 =  [] -> 1.280us
         %8000 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %5451 =  [] -> 1.056us
                 -->kernel: 0:7 %5452 =  [] -> 2.112us
     %8001 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5453 =  [] -> 1.792us
     %8002 = :aten::index [[8], [8]] -> 44.128us
       %8003 = :aten::nonzero [[8]] -> 44.128us
         %8004 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5454 =  [] -> 1.280us
         %8005 = CCCL:cub::DeviceSelect::Flagged [] -> 13.024us
                 -->kernel: 0:7 %5455 =  [] -> 1.024us
                 -->kernel: 0:7 %5456 =  [] -> 2.144us
     %8006 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %5457 =  [] -> 1.760us
     %8007 = :aten::index [[8], [8]] -> 42.592us
       %8008 = :aten::nonzero [[8]] -> 42.592us
         %8009 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5458 =  [] -> 1.312us
         %8010 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %5459 =  [] -> 1.056us
                 -->kernel: 0:7 %5460 =  [] -> 2.112us
     %8011 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5461 =  [] -> 1.792us
     %8012 = :aten::index [[8], [8]] -> 42.336us
       %8013 = :aten::nonzero [[8]] -> 42.336us
         %8014 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5462 =  [] -> 1.280us
         %8015 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %5463 =  [] -> 1.024us
                 -->kernel: 0:7 %5464 =  [] -> 2.144us
     %8016 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %5465 =  [] -> 1.760us
     %8017 = :aten::index [[8], [8]] -> 42.848us
       %8018 = :aten::nonzero [[8]] -> 42.848us
         %8019 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5466 =  [] -> 1.280us
         %8020 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %5467 =  [] -> 1.024us
                 -->kernel: 0:7 %5468 =  [] -> 2.144us
     %8021 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5469 =  [] -> 1.792us
     %8022 = :aten::index [[8], [8]] -> 42.496us
       %8023 = :aten::nonzero [[8]] -> 42.496us
         %8024 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5470 =  [] -> 1.312us
         %8025 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %5471 =  [] -> 1.024us
                 -->kernel: 0:7 %5472 =  [] -> 2.144us
     %8026 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5473 =  [] -> 1.792us
     %8027 = :aten::index [[8], [8]] -> 42.785us
       %8028 = :aten::nonzero [[8]] -> 42.785us
         %8029 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5474 =  [] -> 1.312us
         %8030 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %5475 =  [] -> 1.056us
                 -->kernel: 0:7 %5476 =  [] -> 2.112us
     %8031 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5477 =  [] -> 1.792us
     %8032 = :aten::index [[8], [8]] -> 41.760us
       %8033 = :aten::nonzero [[8]] -> 41.760us
         %8034 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5478 =  [] -> 1.280us
         %8035 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5479 =  [] -> 1.024us
                 -->kernel: 0:7 %5480 =  [] -> 2.144us
     %8036 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %5481 =  [] -> 1.760us
     %8037 = :aten::index [[8], [8]] -> 45.888us
       %8038 = :aten::nonzero [[8]] -> 45.888us
         %8039 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5482 =  [] -> 1.280us
         %8040 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %5483 =  [] -> 1.024us
                 -->kernel: 0:7 %5484 =  [] -> 2.112us
     %8041 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5485 =  [] -> 1.792us
     %8042 = :aten::index [[8], [8]] -> 42.273us
       %8043 = :aten::nonzero [[8]] -> 42.273us
         %8044 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5486 =  [] -> 1.280us
         %8045 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %5487 =  [] -> 1.024us
                 -->kernel: 0:7 %5488 =  [] -> 2.144us
     %8046 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %5489 =  [] -> 1.760us
     %8047 = :aten::index [[8], [8]] -> 42.880us
       %8048 = :aten::nonzero [[8]] -> 42.880us
         %8049 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5490 =  [] -> 1.280us
         %8050 = CCCL:cub::DeviceSelect::Flagged [] -> 11.648us
                 -->kernel: 0:7 %5491 =  [] -> 1.024us
                 -->kernel: 0:7 %5492 =  [] -> 2.112us
     %8051 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5493 =  [] -> 1.792us
     %8052 = :aten::index [[8], [8]] -> 43.328us
       %8053 = :aten::nonzero [[8]] -> 43.328us
         %8054 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %5494 =  [] -> 1.248us
         %8055 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %5495 =  [] -> 1.024us
                 -->kernel: 0:7 %5496 =  [] -> 2.144us
     %8056 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5497 =  [] -> 1.792us
     %8057 = :aten::index [[8], [8]] -> 42.656us
       %8058 = :aten::nonzero [[8]] -> 42.656us
         %8059 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5498 =  [] -> 1.312us
         %8060 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %5499 =  [] -> 1.056us
                 -->kernel: 0:7 %5500 =  [] -> 2.144us
     %8061 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5501 =  [] -> 1.792us
     %8062 = :aten::index [[8], [8]] -> 42.272us
       %8063 = :aten::nonzero [[8]] -> 42.272us
         %8064 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5502 =  [] -> 1.312us
         %8065 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %5503 =  [] -> 1.056us
                 -->kernel: 0:7 %5504 =  [] -> 2.144us
     %8066 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5505 =  [] -> 1.792us
     %8067 = :aten::index [[8], [8]] -> 42.144us
       %8068 = :aten::nonzero [[8]] -> 42.144us
         %8069 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5506 =  [] -> 1.312us
         %8070 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5507 =  [] -> 1.056us
                 -->kernel: 0:7 %5508 =  [] -> 2.144us
     %8071 = :aten::zeros [[], [], [], [], []] -> 1.216us
       %8072 = :aten::zero_ [[8, 24]] -> 1.216us
         %8073 = :aten::fill_ [[8, 24], []] -> 1.216us
                 -->kernel: 0:7 %5509 =  [] -> 1.216us
     %8074 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.584us
       %8075 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.584us
         %8076 = :nccl:_all_gather_base [[24]] -> 7.584us
           %8077 = NCCL:ncclAllGather [] -> 7.584us
                 -->kernel: 0:7 %5510 =  [] -> 7.584us
     %8078 = :aten::gt [[8], []] -> 1.600us
                 -->kernel: 0:7 %5511 =  [] -> 1.600us
     %8079 = :aten::index [[8], [8]] -> 47.616us
       %8080 = :aten::nonzero [[8]] -> 47.616us
         %8081 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %5512 =  [] -> 1.536us
         %8082 = CCCL:cub::DeviceSelect::Flagged [] -> 12.608us
                 -->kernel: 0:7 %5513 =  [] -> 1.344us
                 -->kernel: 0:7 %5514 =  [] -> 1.888us
     %8083 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5515 =  [] -> 1.408us
     %8084 = :aten::index [[8], [8]] -> 43.392us
       %8085 = :aten::nonzero [[8]] -> 43.392us
         %8086 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %5516 =  [] -> 1.504us
         %8087 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %5517 =  [] -> 1.376us
                 -->kernel: 0:7 %5518 =  [] -> 1.856us
     %8088 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5519 =  [] -> 1.408us
     %8089 = :aten::index [[8], [8]] -> 43.553us
       %8090 = :aten::nonzero [[8]] -> 43.553us
         %8091 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %5520 =  [] -> 1.504us
         %8092 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %5521 =  [] -> 1.312us
                 -->kernel: 0:7 %5522 =  [] -> 1.888us
     %8093 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5523 =  [] -> 1.408us
     %8094 = :aten::index [[8], [8]] -> 42.880us
       %8095 = :aten::nonzero [[8]] -> 42.880us
         %8096 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %5524 =  [] -> 1.472us
         %8097 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %5525 =  [] -> 1.376us
                 -->kernel: 0:7 %5526 =  [] -> 1.856us
     %8098 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5527 =  [] -> 1.408us
     %8099 = :aten::index [[8], [8]] -> 42.784us
       %8100 = :aten::nonzero [[8]] -> 42.784us
         %8101 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %5528 =  [] -> 1.472us
         %8102 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %5529 =  [] -> 1.312us
                 -->kernel: 0:7 %5530 =  [] -> 1.856us
     %8103 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5531 =  [] -> 1.408us
     %8104 = :aten::index [[8], [8]] -> 42.081us
       %8105 = :aten::nonzero [[8]] -> 42.081us
         %8106 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %5532 =  [] -> 1.472us
         %8107 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %5533 =  [] -> 1.376us
                 -->kernel: 0:7 %5534 =  [] -> 1.856us
     %8108 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %5535 =  [] -> 1.376us
     %8109 = :aten::index [[8], [8]] -> 42.400us
       %8110 = :aten::nonzero [[8]] -> 42.400us
         %8111 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %5536 =  [] -> 1.504us
         %8112 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %5537 =  [] -> 1.344us
                 -->kernel: 0:7 %5538 =  [] -> 1.888us
     %8113 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5539 =  [] -> 1.408us
     %8114 = :aten::index [[8], [8]] -> 43.392us
       %8115 = :aten::nonzero [[8]] -> 43.392us
         %8116 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %5540 =  [] -> 1.504us
         %8117 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %5541 =  [] -> 1.344us
                 -->kernel: 0:7 %5542 =  [] -> 1.856us
     %8118 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5543 =  [] -> 1.408us
     %8119 = :aten::index [[8], [8]] -> 42.112us
       %8120 = :aten::nonzero [[8]] -> 42.112us
         %8121 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %5544 =  [] -> 1.472us
         %8122 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %5545 =  [] -> 1.312us
                 -->kernel: 0:7 %5546 =  [] -> 1.888us
     %8123 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5547 =  [] -> 1.408us
     %8124 = :aten::index [[8], [8]] -> 43.456us
       %8125 = :aten::nonzero [[8]] -> 43.456us
         %8126 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %5548 =  [] -> 1.440us
         %8127 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %5549 =  [] -> 1.312us
                 -->kernel: 0:7 %5550 =  [] -> 1.760us
     %8128 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5551 =  [] -> 1.344us
     %8129 = :aten::index [[8], [8]] -> 42.560us
       %8130 = :aten::nonzero [[8]] -> 42.560us
         %8131 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5552 =  [] -> 1.408us
         %8132 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %5553 =  [] -> 1.248us
                 -->kernel: 0:7 %5554 =  [] -> 1.760us
     %8133 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5555 =  [] -> 1.344us
     %8134 = :aten::index [[8], [8]] -> 43.137us
       %8135 = :aten::nonzero [[8]] -> 43.137us
         %8136 = CCCL:cub::DeviceReduce::Sum [] -> 1.376us
                 -->kernel: 0:7 %5556 =  [] -> 1.376us
         %8137 = CCCL:cub::DeviceSelect::Flagged [] -> 12.065us
                 -->kernel: 0:7 %5557 =  [] -> 1.312us
                 -->kernel: 0:7 %5558 =  [] -> 1.792us
     %8138 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5559 =  [] -> 1.344us
     %8139 = :aten::index [[8], [8]] -> 42.816us
       %8140 = :aten::nonzero [[8]] -> 42.816us
         %8141 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5560 =  [] -> 1.408us
         %8142 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %5561 =  [] -> 1.248us
                 -->kernel: 0:7 %5562 =  [] -> 1.792us
     %8143 = :aten::gt [[8], []] -> 1.312us
                 -->kernel: 0:7 %5563 =  [] -> 1.312us
     %8144 = :aten::index [[8], [8]] -> 43.008us
       %8145 = :aten::nonzero [[8]] -> 43.008us
         %8146 = CCCL:cub::DeviceReduce::Sum [] -> 1.376us
                 -->kernel: 0:7 %5564 =  [] -> 1.376us
         %8147 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %5565 =  [] -> 1.280us
                 -->kernel: 0:7 %5566 =  [] -> 1.760us
     %8148 = :aten::gt [[8], []] -> 1.312us
                 -->kernel: 0:7 %5567 =  [] -> 1.312us
     %8149 = :aten::index [[8], [8]] -> 43.328us
       %8150 = :aten::nonzero [[8]] -> 43.328us
         %8151 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5568 =  [] -> 1.408us
         %8152 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5569 =  [] -> 1.280us
                 -->kernel: 0:7 %5570 =  [] -> 1.792us
     %8153 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5571 =  [] -> 1.344us
     %8154 = :aten::index [[8], [8]] -> 44.032us
       %8155 = :aten::nonzero [[8]] -> 44.032us
         %8156 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5572 =  [] -> 1.408us
         %8157 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %5573 =  [] -> 1.312us
                 -->kernel: 0:7 %5574 =  [] -> 1.792us
     %8158 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5575 =  [] -> 1.344us
     %8159 = :aten::index [[8], [8]] -> 41.664us
       %8160 = :aten::nonzero [[8]] -> 41.664us
         %8161 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5576 =  [] -> 1.408us
         %8162 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %5577 =  [] -> 1.248us
                 -->kernel: 0:7 %5578 =  [] -> 1.760us
     %8163 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5579 =  [] -> 1.344us
     %8164 = :aten::index [[8], [8]] -> 42.976us
       %8165 = :aten::nonzero [[8]] -> 42.976us
         %8166 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5580 =  [] -> 1.408us
         %8167 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %5581 =  [] -> 1.280us
                 -->kernel: 0:7 %5582 =  [] -> 1.792us
     %8168 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5583 =  [] -> 1.344us
     %8169 = :aten::index [[8], [8]] -> 41.952us
       %8170 = :aten::nonzero [[8]] -> 41.952us
         %8171 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %5584 =  [] -> 1.440us
         %8172 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %5585 =  [] -> 1.248us
                 -->kernel: 0:7 %5586 =  [] -> 1.792us
     %8173 = :aten::gt [[8], []] -> 1.312us
                 -->kernel: 0:7 %5587 =  [] -> 1.312us
     %8174 = :aten::index [[8], [8]] -> 42.816us
       %8175 = :aten::nonzero [[8]] -> 42.816us
         %8176 = CCCL:cub::DeviceReduce::Sum [] -> 1.376us
                 -->kernel: 0:7 %5588 =  [] -> 1.376us
         %8177 = CCCL:cub::DeviceSelect::Flagged [] -> 12.576us
                 -->kernel: 0:7 %5589 =  [] -> 1.312us
                 -->kernel: 0:7 %5590 =  [] -> 1.792us
     %8178 = :aten::gt [[8], []] -> 1.312us
                 -->kernel: 0:7 %5591 =  [] -> 1.312us
     %8179 = :aten::index [[8], [8]] -> 42.176us
       %8180 = :aten::nonzero [[8]] -> 42.176us
         %8181 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5592 =  [] -> 1.408us
         %8182 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5593 =  [] -> 1.248us
                 -->kernel: 0:7 %5594 =  [] -> 1.792us
     %8183 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %5595 =  [] -> 1.376us
     %8184 = :aten::index [[8], [8]] -> 42.336us
       %8185 = :aten::nonzero [[8]] -> 42.336us
         %8186 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5596 =  [] -> 1.408us
         %8187 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %5597 =  [] -> 1.312us
                 -->kernel: 0:7 %5598 =  [] -> 1.792us
     %8188 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5599 =  [] -> 1.344us
     %8189 = :aten::index [[8], [8]] -> 43.136us
       %8190 = :aten::nonzero [[8]] -> 43.136us
         %8191 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %5600 =  [] -> 1.440us
         %8192 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %5601 =  [] -> 1.248us
                 -->kernel: 0:7 %5602 =  [] -> 1.792us
     %8193 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5603 =  [] -> 1.344us
     %8194 = :aten::index [[8], [8]] -> 45.056us
       %8195 = :aten::nonzero [[8]] -> 45.056us
         %8196 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5604 =  [] -> 1.408us
         %8197 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %5605 =  [] -> 1.312us
                 -->kernel: 0:7 %5606 =  [] -> 1.760us
     %8198 = :aten::zeros [[], [], [], [], []] -> 928.000ns
       %8199 = :aten::zero_ [[8, 24]] -> 928.000ns
         %8200 = :aten::fill_ [[8, 24], []] -> 928.000ns
                 -->kernel: 0:7 %5607 =  [] -> 928.000ns
     %8201 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.776us
       %8202 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.776us
         %8203 = :nccl:_all_gather_base [[24]] -> 7.776us
           %8204 = NCCL:ncclAllGather [] -> 7.776us
                 -->kernel: 0:7 %5608 =  [] -> 7.776us
     %8205 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %5609 =  [] -> 1.728us
     %8206 = :aten::index [[8], [8]] -> 47.712us
       %8207 = :aten::nonzero [[8]] -> 47.712us
         %8208 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5610 =  [] -> 1.216us
         %8209 = CCCL:cub::DeviceSelect::Flagged [] -> 12.320us
                 -->kernel: 0:7 %5611 =  [] -> 992.000ns
                 -->kernel: 0:7 %5612 =  [] -> 2.080us
     %8210 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %5613 =  [] -> 1.728us
     %8211 = :aten::index [[8], [8]] -> 43.232us
       %8212 = :aten::nonzero [[8]] -> 43.232us
         %8213 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5614 =  [] -> 1.216us
         %8214 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %5615 =  [] -> 960.000ns
                 -->kernel: 0:7 %5616 =  [] -> 2.080us
     %8215 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %5617 =  [] -> 1.696us
     %8216 = :aten::index [[8], [8]] -> 43.136us
       %8217 = :aten::nonzero [[8]] -> 43.136us
         %8218 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5618 =  [] -> 1.216us
         %8219 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %5619 =  [] -> 992.000ns
                 -->kernel: 0:7 %5620 =  [] -> 2.048us
     %8220 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %5621 =  [] -> 1.728us
     %8221 = :aten::index [[8], [8]] -> 42.112us
       %8222 = :aten::nonzero [[8]] -> 42.112us
         %8223 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5622 =  [] -> 1.216us
         %8224 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5623 =  [] -> 992.000ns
                 -->kernel: 0:7 %5624 =  [] -> 2.080us
     %8225 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %5625 =  [] -> 1.696us
     %8226 = :aten::index [[8], [8]] -> 42.977us
       %8227 = :aten::nonzero [[8]] -> 42.977us
         %8228 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %5626 =  [] -> 1.248us
         %8229 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %5627 =  [] -> 992.000ns
                 -->kernel: 0:7 %5628 =  [] -> 2.048us
     %8230 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %5629 =  [] -> 1.728us
     %8231 = :aten::index [[8], [8]] -> 41.728us
       %8232 = :aten::nonzero [[8]] -> 41.728us
         %8233 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5630 =  [] -> 1.216us
         %8234 = CCCL:cub::DeviceSelect::Flagged [] -> 11.616us
                 -->kernel: 0:7 %5631 =  [] -> 960.000ns
                 -->kernel: 0:7 %5632 =  [] -> 2.080us
     %8235 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %5633 =  [] -> 1.696us
     %8236 = :aten::index [[8], [8]] -> 42.784us
       %8237 = :aten::nonzero [[8]] -> 42.784us
         %8238 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5634 =  [] -> 1.216us
         %8239 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %5635 =  [] -> 992.000ns
                 -->kernel: 0:7 %5636 =  [] -> 2.048us
     %8240 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %5637 =  [] -> 1.728us
     %8241 = :aten::index [[8], [8]] -> 41.921us
       %8242 = :aten::nonzero [[8]] -> 41.921us
         %8243 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5638 =  [] -> 1.216us
         %8244 = CCCL:cub::DeviceSelect::Flagged [] -> 11.649us
                 -->kernel: 0:7 %5639 =  [] -> 992.000ns
                 -->kernel: 0:7 %5640 =  [] -> 2.080us
     %8245 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %5641 =  [] -> 1.696us
     %8246 = :aten::index [[8], [8]] -> 43.968us
       %8247 = :aten::nonzero [[8]] -> 43.968us
         %8248 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5642 =  [] -> 1.216us
         %8249 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %5643 =  [] -> 992.000ns
                 -->kernel: 0:7 %5644 =  [] -> 2.016us
     %8250 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %5645 =  [] -> 1.728us
     %8251 = :aten::index [[8], [8]] -> 41.952us
       %8252 = :aten::nonzero [[8]] -> 41.952us
         %8253 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5646 =  [] -> 1.216us
         %8254 = CCCL:cub::DeviceSelect::Flagged [] -> 11.616us
                 -->kernel: 0:7 %5647 =  [] -> 960.000ns
                 -->kernel: 0:7 %5648 =  [] -> 2.080us
     %8255 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %5649 =  [] -> 1.696us
     %8256 = :aten::index [[8], [8]] -> 43.104us
       %8257 = :aten::nonzero [[8]] -> 43.104us
         %8258 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5650 =  [] -> 1.216us
         %8259 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5651 =  [] -> 1.088us
                 -->kernel: 0:7 %5652 =  [] -> 2.112us
     %8260 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5653 =  [] -> 1.792us
     %8261 = :aten::index [[8], [8]] -> 42.816us
       %8262 = :aten::nonzero [[8]] -> 42.816us
         %8263 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5654 =  [] -> 1.280us
         %8264 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %5655 =  [] -> 1.024us
                 -->kernel: 0:7 %5656 =  [] -> 2.144us
     %8265 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5657 =  [] -> 1.792us
     %8266 = :aten::index [[8], [8]] -> 46.368us
       %8267 = :aten::nonzero [[8]] -> 46.368us
         %8268 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5658 =  [] -> 1.280us
         %8269 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %5659 =  [] -> 1.056us
                 -->kernel: 0:7 %5660 =  [] -> 2.112us
     %8270 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5661 =  [] -> 1.792us
     %8271 = :aten::index [[8], [8]] -> 43.424us
       %8272 = :aten::nonzero [[8]] -> 43.424us
         %8273 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5662 =  [] -> 1.312us
         %8274 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %5663 =  [] -> 1.024us
                 -->kernel: 0:7 %5664 =  [] -> 2.176us
     %8275 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5665 =  [] -> 1.792us
     %8276 = :aten::index [[8], [8]] -> 42.240us
       %8277 = :aten::nonzero [[8]] -> 42.240us
         %8278 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5666 =  [] -> 1.312us
         %8279 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %5667 =  [] -> 1.056us
                 -->kernel: 0:7 %5668 =  [] -> 2.112us
     %8280 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5669 =  [] -> 1.792us
     %8281 = :aten::index [[8], [8]] -> 41.920us
       %8282 = :aten::nonzero [[8]] -> 41.920us
         %8283 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5670 =  [] -> 1.312us
         %8284 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5671 =  [] -> 1.024us
                 -->kernel: 0:7 %5672 =  [] -> 2.176us
     %8285 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5673 =  [] -> 1.792us
     %8286 = :aten::index [[8], [8]] -> 42.272us
       %8287 = :aten::nonzero [[8]] -> 42.272us
         %8288 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5674 =  [] -> 1.312us
         %8289 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %5675 =  [] -> 1.024us
                 -->kernel: 0:7 %5676 =  [] -> 2.112us
     %8290 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %5677 =  [] -> 1.824us
     %8291 = :aten::index [[8], [8]] -> 42.304us
       %8292 = :aten::nonzero [[8]] -> 42.304us
         %8293 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5678 =  [] -> 1.280us
         %8294 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %5679 =  [] -> 1.024us
                 -->kernel: 0:7 %5680 =  [] -> 2.176us
     %8295 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %5681 =  [] -> 1.760us
     %8296 = :aten::index [[8], [8]] -> 44.736us
       %8297 = :aten::nonzero [[8]] -> 44.736us
         %8298 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5682 =  [] -> 1.312us
         %8299 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %5683 =  [] -> 1.056us
                 -->kernel: 0:7 %5684 =  [] -> 2.112us
     %8300 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %5685 =  [] -> 1.824us
     %8301 = :aten::index [[8], [8]] -> 43.936us
       %8302 = :aten::nonzero [[8]] -> 43.936us
         %8303 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5686 =  [] -> 1.312us
         %8304 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5687 =  [] -> 1.056us
                 -->kernel: 0:7 %5688 =  [] -> 2.176us
     %8305 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5689 =  [] -> 1.792us
     %8306 = :aten::index [[8], [8]] -> 42.689us
       %8307 = :aten::nonzero [[8]] -> 42.689us
         %8308 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5690 =  [] -> 1.312us
         %8309 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %5691 =  [] -> 1.056us
                 -->kernel: 0:7 %5692 =  [] -> 2.144us
     %8310 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5693 =  [] -> 1.792us
     %8311 = :aten::index [[8], [8]] -> 41.504us
       %8312 = :aten::nonzero [[8]] -> 41.504us
         %8313 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5694 =  [] -> 1.312us
         %8314 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %5695 =  [] -> 1.024us
                 -->kernel: 0:7 %5696 =  [] -> 2.144us
     %8315 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5697 =  [] -> 1.792us
     %8316 = :aten::index [[8], [8]] -> 41.760us
       %8317 = :aten::nonzero [[8]] -> 41.760us
         %8318 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5698 =  [] -> 1.312us
         %8319 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %5699 =  [] -> 1.056us
                 -->kernel: 0:7 %5700 =  [] -> 2.144us
     %8320 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5701 =  [] -> 1.792us
     %8321 = :aten::index [[8], [8]] -> 41.697us
       %8322 = :aten::nonzero [[8]] -> 41.697us
         %8323 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5702 =  [] -> 1.312us
         %8324 = CCCL:cub::DeviceSelect::Flagged [] -> 11.841us
(1, '0:emb_fwd <0, 25, 25>-> 4.931ms')
     %0 = :aten::zero_ [[3002413056]] -> 1.807ms
       %1 = :aten::fill_ [[3002413056], []] -> 1.807ms
                 -->kernel: 0:7 %1 =  [] -> 441.473us
                 -->kernel: 0:7 %2 =  [] -> 441.473us
                 -->kernel: 0:7 %3 =  [] -> 441.537us
     %2 = :aten::zero_ [[352321536]] -> 207.872us
       %3 = :aten::fill_ [[352321536], []] -> 207.872us
                 -->kernel: 0:7 %4 =  [] -> 207.872us
     %4 = :aten::zeros [[], [], [], [], []] -> 1.312us
       %5 = :aten::zero_ [[]] -> 1.312us
         %6 = :aten::fill_ [[], []] -> 1.312us
                 -->kernel: 0:7 %5 =  [] -> 1.312us
     %7 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.200us
       %8 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.200us
         %9 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.200us
     %10 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.008us
       %11 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.008us
         %12 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.008us
     %13 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 1.504us
       %14 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 1.504us
         %15 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.504us
     %16 = :aten::to [[1, 1, 4096, 4096], [], [], [], [], [], [], []] -> 293.856us
       %17 = :aten::_to_copy [[1, 1, 4096, 4096], [], [], [], [], [], []] -> 293.856us
         %18 = :aten::copy_ [[1, 1, 4096, 4096], [1, 1, 4096, 4096], []] -> 293.856us
     %19 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.136us
       %20 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.136us
         %21 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.136us
     %22 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 270.209us
       %23 = :aten::index_select [[129280, 7168], [], [4096]] -> 270.209us
                 -->kernel: 0:7 %6 =  [] -> 270.209us
     %24 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 128.385us
(2, '0:emb_bwd <1242, 1245, 3>-> 113.249us')
       %0 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.088us
     %1 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %2 = :aten::add_ [[7168], [7168], []] -> 1.600us

gbs: -1 micro_bs: 1 data_parallel: 1 gradient_accumulation_steps: 1
gbs: -1 micro_bs: 1 data_parallel: 8 gradient_accumulation_steps: 1
----------------------hw_cfg--------------------------
{'hw': 'H20SXM', 'sw': 'nemo_24.04', 'n_nodes': 1, 'n_device': 8}
----------------------model_cfg--------------------------
run {'name': 'deepseek_v3'}
res {'nsys_steps': 5, 'nsys_ranks': [0, 1, 2, 3, 4, 5, 6, 7], 'gradient_accumulation_steps': 1, 'throughput': -1, 'train_step_timing': -1}
precision fp32
----------------------train_cfg--------------------------
{'gradient_accumulation_steps': 1}
----------------------res_cfg--------------------------
{'throughput': -1, 'gradient_accumulation_steps': 1, 'train_step_timing': -1, 'nsys_steps': 5, 'nsys_ranks': [0, 1, 2, 3, 4, 5, 6, 7]}
gbs: -1 micro_bs: 1 data_parallel: 8 gradient_accumulation_steps: 1
gbs: -1 micro_bs: 1 data_parallel: 8 gradient_accumulation_steps: 1
gbs: -1 micro_bs: 1 data_parallel: 8 gradient_accumulation_steps: 1
load: Namespace(d='/home/data/mount_data/code/libra/data/gpu/deepseek_v3_te2.8/timeline_H20SXMML_DEEPSEEK_V3_no_graph_nsys-shape.sqlite', nvtx='/home/data/mount_data/code/libra/data/gpu/deepseek_v3_te2.8/timeline_H20SXMML_DEEPSEEK_V3_no_graph_nsys-shape_aten_op_list.csv', nvtx_kern='/home/data/mount_data/code/libra/data/gpu/deepseek_v3_te2.8/timeline_H20SXMML_DEEPSEEK_V3_no_graph_nsys-shape_nvtx_kern_sum.csv', nvtx_proj='/home/data/mount_data/code/libra/data/gpu/deepseek_v3_te2.8/timeline_H20SXMML_DEEPSEEK_V3_no_graph_nsys-shape_nvtx_gpu_proj_trace.csv', input_dir='../Benchmarks/theory', output_dir='../Benchmarks', debug=False, hw='H20SXM', split_type='nvtx', model=<model_theory.core.backend.model.benchmark.ModelBenchmarkObject object at 0x7f1a72331e80>)
5779
31530
Args.n_device_per_node: 8
Args.total_steps: 5
Args.iters_per_step: 1
Args.num_layers: -1
Device ID: 35155 [0, 1, 2, 3, 4, 5, 6, 7] ['35155', '35156', '35157', '35158', '35159', '35160', '35161', '35162']
features: 499
args.num_block: 5
Err split_index_num: 99 4
block_start: [0, 1438, 3352, 5186, 7100, 9084, 9097]
block_end: [1438, 3352, 5186, 7100, 9084, 9097, 9570]
block_duration: [1438, 1914, 1834, 1914, 1984, 13, 473]
Err block_duration: [1438, 1914, 1834, 1914, 1984, 13, 473]
split_index_num: 12 0
block_start: [0, 1249, 3163, 5077, 6991, 8905]
block_end: [1249, 3163, 5077, 6991, 8905, 9570]
block_duration: [1249, 1914, 1914, 1914, 1914, 665]
emb_bwd: [3] {}
emb_bwd: [3] {}
check perf: 0 0 0 1245 1245 754325890
check perf: 1 0 1914 3159 1245 749879906
summary_modules: 0 9570 9570
num of kernel_trace: 45572
state.modules: 3
num of timeline: 5705
(0, '0:optim_step <1245, 9570, 8325>-> 7.246s')
     %0 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 2.998ms
       %1 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.396ms
         %2 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.396ms
           %3 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.396ms
             %4 = :aten::arange [[], [], [], [], []] -> 1.152us
               %5 = :aten::arange [[], [], [], [0]] -> 1.152us
             %6 = CCCL:cub::DeviceRadixSort [] -> 194.848us
                 -->kernel: 0:7 %649 =  [] -> 3.456us
                 -->kernel: 0:7 %650 =  [] -> 1.536us
                 -->kernel: 0:7 %651 =  [] -> 7.840us
                 -->kernel: 0:7 %652 =  [] -> 7.424us
                 -->kernel: 0:7 %653 =  [] -> 7.008us
                 -->kernel: 0:7 %654 =  [] -> 6.912us
                 -->kernel: 0:7 %655 =  [] -> 7.136us
                 -->kernel: 0:7 %656 =  [] -> 7.104us
                 -->kernel: 0:7 %657 =  [] -> 6.976us
                 -->kernel: 0:7 %658 =  [] -> 6.784us
             %7 = :aten::zeros [[], [], [], [], []] -> 544.706us
               %8 = :aten::zero_ [[129280, 7168]] -> 544.706us
                 %9 = :aten::fill_ [[129280, 7168], []] -> 544.706us
                 -->kernel: 0:7 %659 =  [] -> 544.706us
             %10 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 17.312us
                 -->kernel: 0:7 %660 =  [] -> 1.440us
                 -->kernel: 0:7 %661 =  [] -> 4.000us
                 -->kernel: 0:7 %662 =  [] -> 1.920us
             %11 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 19.360us
                 -->kernel: 0:7 %663 =  [] -> 1.440us
                 -->kernel: 0:7 %664 =  [] -> 2.944us
                 -->kernel: 0:7 %665 =  [] -> 1.376us
                 -->kernel: 0:7 %666 =  [] -> 2.144us
                 -->kernel: 0:7 %667 =  [] -> 224.673us
                 -->kernel: 0:7 %668 =  [] -> 166.144us
       %12 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.555ms
                 -->kernel: 0:35 %669 =  [] -> 1.555ms
     %13 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.557ms
       %14 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.557ms
                 -->kernel: 0:35 %670 =  [] -> 1.557ms
     %15 = :aten::linalg_vector_norm [[3002413056], [], [], [], []] -> 2.601ms
                 -->kernel: 0:7 %671 =  [] -> 615.745us
                 -->kernel: 0:7 %672 =  [] -> 610.401us
                 -->kernel: 0:7 %673 =  [] -> 607.266us
                 -->kernel: 0:7 %674 =  [] -> 609.217us
     %16 = :aten::isnan [[]] -> 1.664us
       %17 = :aten::ne [[], []] -> 1.664us
                 -->kernel: 0:7 %675 =  [] -> 1.664us
     %18 = :aten::is_nonzero [[]] -> 2.240us
       %19 = :aten::item [[]] -> 2.240us
         %20 = :aten::_local_scalar_dense [[]] -> 2.240us
     %21 = :aten::isinf [[]] -> 39.360us
       %22 = :aten::abs [[]] -> 1.376us
         %23 = :aten::abs [[], [0]] -> 1.376us
                 -->kernel: 0:7 %676 =  [] -> 1.376us
       %24 = :aten::eq [[], []] -> 1.504us
                 -->kernel: 0:7 %677 =  [] -> 1.504us
     %25 = :aten::is_nonzero [[]] -> 2.208us
       %26 = :aten::item [[]] -> 2.208us
         %27 = :aten::_local_scalar_dense [[]] -> 2.208us
     %28 = :aten::mul_ [[3002413056], []] -> 3.543ms
                 -->kernel: 0:7 %678 =  [] -> 864.578us
                 -->kernel: 0:7 %679 =  [] -> 901.506us
                 -->kernel: 0:7 %680 =  [] -> 873.218us
                 -->kernel: 0:7 %681 =  [] -> 868.834us
     %29 = :c10d::reduce_scatter_tensor_coalesced_ [[375301632], [3002413056], [], [], [], []] -> 14.438ms
       %30 = :record_param_comms [[3002413056], [], [], [], [], [], [], [], [], []] -> 14.438ms
         %31 = :nccl:reduce_scatter_tensor_coalesced [[3002413056]] -> 14.438ms
           %32 = NCCL:ncclGroupEnd [] -> 14.438ms
                 -->kernel: 0:7 %682 =  [] -> 14.438ms
     %33 = :aten::linalg_vector_norm [[352321536], [], [], [], []] -> 306.081us
                 -->kernel: 0:7 %683 =  [] -> 291.745us
     %34 = :aten::isnan [[]] -> 1.632us
       %35 = :aten::ne [[], []] -> 1.632us
                 -->kernel: 0:7 %684 =  [] -> 1.632us
     %36 = :aten::is_nonzero [[]] -> 2.240us
       %37 = :aten::item [[]] -> 2.240us
         %38 = :aten::_local_scalar_dense [[]] -> 2.240us
     %39 = :aten::isinf [[]] -> 28.129us
       %40 = :aten::abs [[]] -> 1.505us
         %41 = :aten::abs [[], [0]] -> 1.505us
                 -->kernel: 0:7 %685 =  [] -> 1.505us
       %42 = :aten::eq [[], []] -> 1.472us
                 -->kernel: 0:7 %686 =  [] -> 1.472us
     %43 = :aten::is_nonzero [[]] -> 2.464us
       %44 = :aten::item [[]] -> 2.464us
         %45 = :aten::_local_scalar_dense [[]] -> 2.464us
     %46 = :aten::mul_ [[352321536], []] -> 402.849us
                 -->kernel: 0:7 %687 =  [] -> 402.849us
     %47 = :aten::stack [[32], [32], []] -> 1.856us
       %48 = :aten::cat [[32], [32], []] -> 1.856us
                 -->kernel: 0:7 %688 =  [] -> 1.856us
     %49 = :aten::stack [[32], [32], []] -> 2.304us
       %50 = :aten::cat [[32], [32], []] -> 2.304us
                 -->kernel: 0:7 %689 =  [] -> 2.304us
     %51 = :c10d::allreduce_ [[2, 32], [], [], [], [], []] -> 16.736us
       %52 = :record_param_comms [[2, 32], [], [], [], [], [], [], [], [], []] -> 16.736us
         %53 = :nccl:all_reduce [[2, 32]] -> 16.736us
           %54 = NCCL:ncclAllReduce [] -> 16.736us
                 -->kernel: 0:7 %690 =  [] -> 16.736us
     %55 = :aten::sum [[2, 32], [], [], []] -> 2.656us
                 -->kernel: 0:7 %691 =  [] -> 2.656us
     %56 = :aten::div [[2, 1], []] -> 1.504us
                 -->kernel: 0:7 %692 =  [] -> 1.504us
     %57 = :aten::sub [[2, 1], [2, 32], []] -> 2.272us
                 -->kernel: 0:7 %693 =  [] -> 2.272us
     %58 = :aten::sign [[2, 32]] -> 1.600us
                 -->kernel: 0:7 %694 =  [] -> 1.600us
     %59 = :aten::mul [[2, 32], []] -> 1.280us
                 -->kernel: 0:7 %695 =  [] -> 1.280us
     %60 = :aten::add [[2, 32], [2, 32], []] -> 2.848us
                 -->kernel: 0:7 %696 =  [] -> 2.848us
     %61 = :aten::zero_ [[32]] -> 1.184us
       %62 = :aten::fill_ [[32], []] -> 1.184us
                 -->kernel: 0:7 %697 =  [] -> 1.184us
     %63 = :aten::copy_ [[32], [32], []] -> 1.216us
     %64 = :aten::zero_ [[32]] -> 960.000ns
       %65 = :aten::fill_ [[32], []] -> 960.000ns
                 -->kernel: 0:7 %698 =  [] -> 960.000ns
     %66 = :aten::copy_ [[32], [32], []] -> 1.024us
     %67 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %68 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %69 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %70 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 9.696us
       %71 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 9.696us
         %72 = :nccl:all_reduce [[1]] -> 9.696us
           %73 = NCCL:ncclAllReduce [] -> 9.696us
                 -->kernel: 0:7 %699 =  [] -> 9.696us
     %74 = :aten::item [[1]] -> 2.240us
       %75 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %76 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %77 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %78 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %79 = :aten::zeros [[], [], [], [], []] -> 1.216us
       %80 = :aten::zero_ [[320]] -> 1.216us
         %81 = :aten::fill_ [[320], []] -> 1.216us
                 -->kernel: 0:7 %700 =  [] -> 1.216us
     %82 = :nvte_multi_tensor_l2norm_cuda [] -> 1.386ms
                 -->kernel: 0:7 %701 =  [] -> 35.713us
                 -->kernel: 0:7 %702 =  [] -> 33.632us
                 -->kernel: 0:7 %703 =  [] -> 29.952us
                 -->kernel: 0:7 %704 =  [] -> 30.048us
                 -->kernel: 0:7 %705 =  [] -> 30.016us
                 -->kernel: 0:7 %706 =  [] -> 29.856us
                 -->kernel: 0:7 %707 =  [] -> 30.304us
                 -->kernel: 0:7 %708 =  [] -> 30.176us
                 -->kernel: 0:7 %709 =  [] -> 29.696us
                 -->kernel: 0:7 %710 =  [] -> 29.856us
                 -->kernel: 0:7 %711 =  [] -> 30.144us
                 -->kernel: 0:7 %712 =  [] -> 29.953us
                 -->kernel: 0:7 %713 =  [] -> 29.728us
                 -->kernel: 0:7 %714 =  [] -> 29.824us
                 -->kernel: 0:7 %715 =  [] -> 30.368us
                 -->kernel: 0:7 %716 =  [] -> 30.048us
                 -->kernel: 0:7 %717 =  [] -> 29.888us
                 -->kernel: 0:7 %718 =  [] -> 29.920us
                 -->kernel: 0:7 %719 =  [] -> 30.240us
                 -->kernel: 0:7 %720 =  [] -> 29.664us
                 -->kernel: 0:7 %721 =  [] -> 29.920us
                 -->kernel: 0:7 %722 =  [] -> 30.144us
                 -->kernel: 0:7 %723 =  [] -> 29.952us
                 -->kernel: 0:7 %724 =  [] -> 29.824us
                 -->kernel: 0:7 %725 =  [] -> 29.952us
                 -->kernel: 0:7 %726 =  [] -> 29.920us
                 -->kernel: 0:7 %727 =  [] -> 29.984us
                 -->kernel: 0:7 %728 =  [] -> 30.016us
                 -->kernel: 0:7 %729 =  [] -> 29.632us
                 -->kernel: 0:7 %730 =  [] -> 30.048us
                 -->kernel: 0:7 %731 =  [] -> 29.824us
                 -->kernel: 0:7 %732 =  [] -> 30.272us
                 -->kernel: 0:7 %733 =  [] -> 29.792us
                 -->kernel: 0:7 %734 =  [] -> 30.080us
                 -->kernel: 0:7 %735 =  [] -> 17.217us
                 -->kernel: 0:7 %736 =  [] -> 1.760us
     %83 = :aten::pow [[1], []] -> 1.568us
                 -->kernel: 0:7 %737 =  [] -> 1.568us
     %84 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 64.960us
       %85 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 64.960us
         %86 = :nccl:all_reduce [[1]] -> 64.960us
           %87 = NCCL:ncclAllReduce [] -> 64.960us
                 -->kernel: 0:7 %738 =  [] -> 64.960us
     %88 = :aten::item [[1]] -> 2.208us
       %89 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %90 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %91 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %92 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %93 = :nvte_multi_tensor_scale_cuda [] -> 928.131us
                 -->kernel: 0:7 %739 =  [] -> 35.681us
                 -->kernel: 0:7 %740 =  [] -> 44.096us
                 -->kernel: 0:7 %741 =  [] -> 42.560us
                 -->kernel: 0:7 %742 =  [] -> 43.456us
                 -->kernel: 0:7 %743 =  [] -> 43.072us
                 -->kernel: 0:7 %744 =  [] -> 44.064us
                 -->kernel: 0:7 %745 =  [] -> 42.880us
                 -->kernel: 0:7 %746 =  [] -> 44.288us
                 -->kernel: 0:7 %747 =  [] -> 42.784us
                 -->kernel: 0:7 %748 =  [] -> 44.192us
                 -->kernel: 0:7 %749 =  [] -> 42.976us
                 -->kernel: 0:7 %750 =  [] -> 43.296us
                 -->kernel: 0:7 %751 =  [] -> 43.136us
                 -->kernel: 0:7 %752 =  [] -> 43.200us
                 -->kernel: 0:7 %753 =  [] -> 42.848us
                 -->kernel: 0:7 %754 =  [] -> 42.240us
                 -->kernel: 0:7 %755 =  [] -> 42.944us
                 -->kernel: 0:7 %756 =  [] -> 29.633us
     %94 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %95 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %96 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %97 = :nvte_multi_tensor_scale_cuda [] -> 887.394us
                 -->kernel: 0:7 %757 =  [] -> 42.880us
                 -->kernel: 0:7 %758 =  [] -> 42.624us
                 -->kernel: 0:7 %759 =  [] -> 43.584us
                 -->kernel: 0:7 %760 =  [] -> 43.200us
                 -->kernel: 0:7 %761 =  [] -> 43.969us
                 -->kernel: 0:7 %762 =  [] -> 43.040us
                 -->kernel: 0:7 %763 =  [] -> 43.776us
                 -->kernel: 0:7 %764 =  [] -> 42.880us
                 -->kernel: 0:7 %765 =  [] -> 43.808us
                 -->kernel: 0:7 %766 =  [] -> 42.432us
                 -->kernel: 0:7 %767 =  [] -> 43.616us
                 -->kernel: 0:7 %768 =  [] -> 42.944us
                 -->kernel: 0:7 %769 =  [] -> 44.513us
                 -->kernel: 0:7 %770 =  [] -> 42.752us
                 -->kernel: 0:7 %771 =  [] -> 43.008us
                 -->kernel: 0:7 %772 =  [] -> 44.704us
                 -->kernel: 0:7 %773 =  [] -> 27.584us
     %98 = :Optimizer.step#HybridDeviceOptimizer.step None -> 318.498ms
       %99 = :aten::copy_ [[375301632], [375301632], []] -> 43.653ms
         %100 = :aten::to [[375301632], [], [], [], []] -> 2.227ms
           %101 = :aten::_to_copy [[375301632], [], [], [], [], [], []] -> 2.227ms
             %102 = :aten::copy_ [[375301632], [375301632], []] -> 2.227ms
                 -->kernel: 0:7 %774 =  [] -> 2.227ms
         %103 = :aten::copy_ [[375301632], [375301632], []] -> 41.370ms
       %104 = :Optimizer.step#AdamW.step None -> 72.148ms
         %105 = :aten::copy_ [[375301632], [375301632], []] -> 72.148ms
           %106 = :aten::copy_ [[375301632], [375301632], []] -> 71.433ms
           %107 = :aten::copy_ [[375301632], [375301632], []] -> 604.034us
                 -->kernel: 0:7 %775 =  [] -> 604.034us
     %108 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 341.408ms
       %109 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 341.408ms
         %110 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 341.408ms
           %111 = NCCL:ncclGroupEnd [] -> 341.408ms
                 -->kernel: 0:39 %776 =  [] -> 341.408ms
     %112 = :Optimizer.step#HybridDeviceOptimizer.step None -> 84.160ms
       %113 = :aten::to [[14680064], [], [], [], []] -> 89.504us
         %114 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.504us
           %115 = :aten::copy_ [[14680064], [14680064], []] -> 89.504us
                 -->kernel: 0:7 %777 =  [] -> 89.504us
       %116 = :aten::to [[29360128], [], [], [], []] -> 176.384us
         %117 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.384us
           %118 = :aten::copy_ [[29360128], [29360128], []] -> 176.384us
                 -->kernel: 0:7 %778 =  [] -> 176.384us
       %119 = :aten::to [[29360128], [], [], [], []] -> 176.384us
         %120 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.384us
           %121 = :aten::copy_ [[29360128], [29360128], []] -> 176.384us
                 -->kernel: 0:7 %779 =  [] -> 176.384us
       %122 = :aten::to [[29360128], [], [], [], []] -> 176.032us
         %123 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.032us
           %124 = :aten::copy_ [[29360128], [29360128], []] -> 176.032us
                 -->kernel: 0:7 %780 =  [] -> 176.032us
       %125 = :aten::to [[29360128], [], [], [], []] -> 176.032us
         %126 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.032us
           %127 = :aten::copy_ [[29360128], [29360128], []] -> 176.032us
                 -->kernel: 0:7 %781 =  [] -> 176.032us
       %128 = :aten::to [[14680064], [], [], [], []] -> 89.441us
         %129 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.441us
           %130 = :aten::copy_ [[14680064], [14680064], []] -> 89.441us
                 -->kernel: 0:7 %782 =  [] -> 89.441us
       %131 = :aten::to [[14680064], [], [], [], []] -> 89.440us
         %132 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.440us
           %133 = :aten::copy_ [[14680064], [14680064], []] -> 89.440us
                 -->kernel: 0:7 %783 =  [] -> 89.440us
       %134 = :aten::to [[14680064], [], [], [], []] -> 89.568us
         %135 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.568us
           %136 = :aten::copy_ [[14680064], [14680064], []] -> 89.568us
                 -->kernel: 0:7 %784 =  [] -> 89.568us
       %137 = :aten::to [[14680064], [], [], [], []] -> 89.600us
         %138 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.600us
           %139 = :aten::copy_ [[14680064], [14680064], []] -> 89.600us
                 -->kernel: 0:7 %785 =  [] -> 89.600us
       %140 = :aten::to [[29360128], [], [], [], []] -> 176.096us
         %141 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.096us
           %142 = :aten::copy_ [[29360128], [29360128], []] -> 176.096us
                 -->kernel: 0:7 %786 =  [] -> 176.096us
       %143 = :aten::to [[29360128], [], [], [], []] -> 176.256us
         %144 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.256us
           %145 = :aten::copy_ [[29360128], [29360128], []] -> 176.256us
                 -->kernel: 0:7 %787 =  [] -> 176.256us
       %146 = :aten::to [[29360128], [], [], [], []] -> 176.129us
         %147 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.129us
           %148 = :aten::copy_ [[29360128], [29360128], []] -> 176.129us
                 -->kernel: 0:7 %788 =  [] -> 176.129us
       %149 = :aten::to [[29360128], [], [], [], []] -> 176.512us
         %150 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.512us
           %151 = :aten::copy_ [[29360128], [29360128], []] -> 176.512us
                 -->kernel: 0:7 %789 =  [] -> 176.512us
       %152 = :aten::copy_ [[14680064], [14680064], []] -> 1.993ms
         %153 = :aten::to [[14680064], [], [], [], []] -> 89.441us
           %154 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.441us
             %155 = :aten::copy_ [[14680064], [14680064], []] -> 89.441us
                 -->kernel: 0:7 %790 =  [] -> 89.441us
         %156 = :aten::copy_ [[14680064], [14680064], []] -> 1.844ms
       %157 = :aten::copy_ [[14680064], [14680064], []] -> 1.841ms
         %158 = :aten::to [[14680064], [], [], [], []] -> 88.544us
           %159 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.544us
             %160 = :aten::copy_ [[14680064], [14680064], []] -> 88.544us
                 -->kernel: 0:7 %791 =  [] -> 88.544us
         %161 = :aten::copy_ [[14680064], [14680064], []] -> 1.720ms
       %162 = :aten::copy_ [[14680064], [14680064], []] -> 1.811ms
         %163 = :aten::to [[14680064], [], [], [], []] -> 87.520us
           %164 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 87.520us
             %165 = :aten::copy_ [[14680064], [14680064], []] -> 87.520us
                 -->kernel: 0:7 %792 =  [] -> 87.520us
         %166 = :aten::copy_ [[14680064], [14680064], []] -> 1.691ms
       %167 = :Optimizer.step#FusedAdam.step None -> 3.886ms
         %168 = :nvte_multi_tensor_adam_cuda [] -> 3.098ms
                 -->kernel: 0:7 %793 =  [] -> 201.121us
                 -->kernel: 0:7 %794 =  [] -> 199.872us
                 -->kernel: 0:7 %795 =  [] -> 200.321us
                 -->kernel: 0:7 %796 =  [] -> 198.080us
                 -->kernel: 0:7 %797 =  [] -> 198.657us
                 -->kernel: 0:7 %798 =  [] -> 199.232us
                 -->kernel: 0:7 %799 =  [] -> 200.609us
                 -->kernel: 0:7 %800 =  [] -> 200.032us
                 -->kernel: 0:7 %801 =  [] -> 199.776us
                 -->kernel: 0:7 %802 =  [] -> 209.057us
                 -->kernel: 0:7 %803 =  [] -> 199.136us
                 -->kernel: 0:7 %804 =  [] -> 197.473us
                 -->kernel: 0:7 %805 =  [] -> 198.624us
                 -->kernel: 0:7 %806 =  [] -> 199.713us
                 -->kernel: 0:7 %807 =  [] -> 141.184us
         %169 = :aten::copy_ [[14680064], [14680064], []] -> 27.072us
                 -->kernel: 0:7 %808 =  [] -> 27.072us
         %170 = :aten::copy_ [[29360128], [29360128], []] -> 48.993us
                 -->kernel: 0:7 %809 =  [] -> 48.993us
         %171 = :aten::copy_ [[29360128], [29360128], []] -> 49.536us
                 -->kernel: 0:7 %810 =  [] -> 49.536us
         %172 = :aten::copy_ [[29360128], [29360128], []] -> 49.568us
                 -->kernel: 0:7 %811 =  [] -> 49.568us
         %173 = :aten::copy_ [[29360128], [29360128], []] -> 48.320us
                 -->kernel: 0:7 %812 =  [] -> 48.320us
         %174 = :aten::copy_ [[14680064], [14680064], []] -> 26.464us
                 -->kernel: 0:7 %813 =  [] -> 26.464us
         %175 = :aten::copy_ [[14680064], [14680064], []] -> 24.896us
                 -->kernel: 0:7 %814 =  [] -> 24.896us
         %176 = :aten::copy_ [[14680064], [14680064], []] -> 25.120us
                 -->kernel: 0:7 %815 =  [] -> 25.120us
         %177 = :aten::copy_ [[14680064], [14680064], []] -> 24.896us
                 -->kernel: 0:7 %816 =  [] -> 24.896us
         %178 = :aten::copy_ [[29360128], [29360128], []] -> 48.033us
                 -->kernel: 0:7 %817 =  [] -> 48.033us
         %179 = :aten::copy_ [[29360128], [29360128], []] -> 48.128us
                 -->kernel: 0:7 %818 =  [] -> 48.128us
         %180 = :aten::copy_ [[29360128], [29360128], []] -> 49.408us
                 -->kernel: 0:7 %819 =  [] -> 49.408us
         %181 = :aten::copy_ [[29360128], [29360128], []] -> 48.128us
                 -->kernel: 0:7 %820 =  [] -> 48.128us
       %182 = :Optimizer.step#AdamW.step None -> 8.700ms
         %183 = :aten::copy_ [[14680064], [14680064], []] -> 2.915ms
           %184 = :aten::copy_ [[14680064], [14680064], []] -> 2.839ms
           %185 = :aten::copy_ [[14680064], [14680064], []] -> 24.352us
                 -->kernel: 0:7 %821 =  [] -> 24.352us
         %186 = :aten::copy_ [[14680064], [14680064], []] -> 2.768ms
           %187 = :aten::copy_ [[14680064], [14680064], []] -> 2.733ms
           %188 = :aten::copy_ [[14680064], [14680064], []] -> 24.384us
                 -->kernel: 0:7 %822 =  [] -> 24.384us
         %189 = :aten::copy_ [[14680064], [14680064], []] -> 2.746ms
           %190 = :aten::copy_ [[14680064], [14680064], []] -> 2.714ms
           %191 = :aten::copy_ [[14680064], [14680064], []] -> 24.288us
                 -->kernel: 0:7 %823 =  [] -> 24.288us
     %192 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 53.783ms
       %193 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 53.783ms
         %194 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 53.783ms
           %195 = NCCL:ncclGroupEnd [] -> 53.783ms
                 -->kernel: 0:39 %824 =  [] -> 53.783ms
     %196 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %197 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %198 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %199 = :aten::item [[1]] -> 3.520us
       %200 = :aten::_local_scalar_dense [[1]] -> 3.520us
     %201 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %202 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %203 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %204 = :aten::item [[1]] -> 2.240us
       %205 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %206 = :aten::item [[1]] -> 2.272us
       %207 = :aten::_local_scalar_dense [[1]] -> 2.272us
     %208 = :aten::cat [[1], []] -> 1.632us
     %209 = :aten::mean [[1], []] -> 2.816us
       %210 = :aten::mean [[1], [], [], []] -> 2.816us
                 -->kernel: 0:7 %825 =  [] -> 2.816us
     %211 = :aten::item [[1]] -> 2.816us
       %212 = :aten::_local_scalar_dense [[1]] -> 2.816us
     %213 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %214 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %215 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %216 = :aten::add [[1], [], []] -> 1.536us
                 -->kernel: 0:7 %826 =  [] -> 1.536us
     %217 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %218 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %219 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %220 = :aten::item [[1]] -> 2.240us
       %221 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %222 = :aten::item [[1]] -> 2.240us
       %223 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %224 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 2.025ms
       %225 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 2.025ms
         %226 = :nccl:all_reduce [[2]] -> 2.025ms
           %227 = NCCL:ncclAllReduce [] -> 2.025ms
                 -->kernel: 0:7 %827 =  [] -> 2.025ms
     %228 = :c10d::allreduce_ [[3], [], [], [], [], []] -> 9.312us
       %229 = :record_param_comms [[3], [], [], [], [], [], [], [], [], []] -> 9.312us
         %230 = :nccl:all_reduce [[3]] -> 9.312us
           %231 = NCCL:ncclAllReduce [] -> 9.312us
                 -->kernel: 0:7 %828 =  [] -> 9.312us
     %232 = :aten::mul [[3], []] -> 1.504us
                 -->kernel: 0:7 %829 =  [] -> 1.504us
     %233 = :aten::mul [[2], []] -> 1.184us
                 -->kernel: 0:7 %830 =  [] -> 1.184us
     %234 = :aten::sum [[3], []] -> 2.432us
       %235 = :aten::sum [[3], [], [], []] -> 2.432us
                 -->kernel: 0:7 %831 =  [] -> 2.432us
     %236 = :aten::div [[], []] -> 1.408us
                 -->kernel: 0:7 %832 =  [] -> 1.408us
     %237 = :aten::add_ [[1], [], []] -> 1.376us
                 -->kernel: 0:7 %833 =  [] -> 1.376us
     %238 = :aten::sum [[2], []] -> 2.208us
       %239 = :aten::sum [[2], [], [], []] -> 2.208us
                 -->kernel: 0:7 %834 =  [] -> 2.208us
     %240 = :aten::div [[], []] -> 1.056us
                 -->kernel: 0:7 %835 =  [] -> 1.056us
     %241 = :aten::add_ [[1], [], []] -> 1.376us
                 -->kernel: 0:7 %836 =  [] -> 1.376us
     %242 = :aten::zero_ [[3]] -> 1.184us
       %243 = :aten::fill_ [[3], []] -> 1.184us
                 -->kernel: 0:7 %837 =  [] -> 1.184us
     %244 = :aten::zero_ [[2]] -> 896.000ns
       %245 = :aten::fill_ [[2], []] -> 896.000ns
                 -->kernel: 0:7 %838 =  [] -> 896.000ns
     %246 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 319.169us
       %247 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 319.169us
         %248 = :nccl:all_reduce [[1]] -> 319.169us
           %249 = NCCL:ncclAllReduce [] -> 319.169us
                 -->kernel: 0:7 %839 =  [] -> 319.169us
     %250 = :aten::mul [[1], []] -> 1.280us
                 -->kernel: 0:7 %840 =  [] -> 1.280us
     %251 = :aten::add_ [[1], [], []] -> 1.376us
                 -->kernel: 0:7 %841 =  [] -> 1.376us
     %252 = :aten::zero_ [[1]] -> 928.000ns
       %253 = :aten::fill_ [[1], []] -> 928.000ns
                 -->kernel: 0:7 %842 =  [] -> 928.000ns
     %254 = :c10d::barrier [[1], [], [], [], []] -> 174.785us
       %255 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 174.785us
         %256 = :aten::zeros [[], [], [], [], []] -> 960.000ns
           %257 = :aten::zero_ [[1]] -> 960.000ns
             %258 = :aten::fill_ [[1], []] -> 960.000ns
                 -->kernel: 0:7 %843 =  [] -> 960.000ns
         %259 = :nccl:all_reduce_barrier [[1]] -> 140.129us
           %260 = NCCL:ncclAllReduce [] -> 140.129us
                 -->kernel: 0:7 %844 =  [] -> 140.129us
     %261 = :c10d::barrier [[1], [], [], [], []] -> 37.600us
       %262 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 37.600us
         %263 = :aten::zeros [[], [], [], [], []] -> 1.088us
           %264 = :aten::zero_ [[1]] -> 1.088us
             %265 = :aten::fill_ [[1], []] -> 1.088us
                 -->kernel: 0:7 %845 =  [] -> 1.088us
         %266 = :nccl:all_reduce_barrier [[1]] -> 7.808us
           %267 = NCCL:ncclAllReduce [] -> 7.808us
                 -->kernel: 0:7 %846 =  [] -> 7.808us
     %268 = :aten::item [[1]] -> 2.208us
       %269 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %270 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %271 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %272 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %273 = :aten::item [[1]] -> 2.208us
       %274 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %275 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %276 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %277 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %278 = :aten::item [[1]] -> 2.240us
       %279 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %280 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %281 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %282 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %283 = :aten::item [[1]] -> 2.240us
       %284 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %285 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %286 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %287 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %288 = :aten::zeros [[], [], [], [], []] -> 928.000ns
       %289 = :aten::zero_ [[8, 24]] -> 928.000ns
         %290 = :aten::fill_ [[8, 24], []] -> 928.000ns
                 -->kernel: 0:7 %847 =  [] -> 928.000ns
     %291 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 101.217us
       %292 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 101.217us
         %293 = :nccl:_all_gather_base [[24]] -> 101.217us
           %294 = NCCL:ncclAllGather [] -> 101.217us
                 -->kernel: 0:7 %848 =  [] -> 101.217us
     %295 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %849 =  [] -> 1.760us
     %296 = :aten::index [[8], [8]] -> 61.952us
       %297 = :aten::nonzero [[8]] -> 61.952us
         %298 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %850 =  [] -> 1.312us
         %299 = CCCL:cub::DeviceSelect::Flagged [] -> 15.040us
                 -->kernel: 0:7 %851 =  [] -> 1.024us
                 -->kernel: 0:7 %852 =  [] -> 2.176us
     %300 = :aten::gt [[8], []] -> 1.920us
                 -->kernel: 0:7 %853 =  [] -> 1.920us
     %301 = :aten::index [[8], [8]] -> 44.160us
       %302 = :aten::nonzero [[8]] -> 44.160us
         %303 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %854 =  [] -> 1.248us
         %304 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %855 =  [] -> 960.000ns
                 -->kernel: 0:7 %856 =  [] -> 2.112us
     %305 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %857 =  [] -> 1.728us
     %306 = :aten::index [[8], [8]] -> 47.104us
       %307 = :aten::nonzero [[8]] -> 47.104us
         %308 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %858 =  [] -> 1.248us
         %309 = CCCL:cub::DeviceSelect::Flagged [] -> 14.816us
                 -->kernel: 0:7 %859 =  [] -> 992.000ns
                 -->kernel: 0:7 %860 =  [] -> 2.048us
     %310 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %861 =  [] -> 1.760us
     %311 = :aten::index [[8], [8]] -> 44.416us
       %312 = :aten::nonzero [[8]] -> 44.416us
         %313 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %862 =  [] -> 1.216us
         %314 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %863 =  [] -> 960.000ns
                 -->kernel: 0:7 %864 =  [] -> 2.080us
     %315 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %865 =  [] -> 1.728us
     %316 = :aten::index [[8], [8]] -> 43.232us
       %317 = :aten::nonzero [[8]] -> 43.232us
         %318 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %866 =  [] -> 1.248us
         %319 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %867 =  [] -> 992.000ns
                 -->kernel: 0:7 %868 =  [] -> 2.080us
     %320 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %869 =  [] -> 1.728us
     %321 = :aten::index [[8], [8]] -> 42.624us
       %322 = :aten::nonzero [[8]] -> 42.624us
         %323 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %870 =  [] -> 1.248us
         %324 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %871 =  [] -> 992.000ns
                 -->kernel: 0:7 %872 =  [] -> 2.112us
     %325 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %873 =  [] -> 1.728us
     %326 = :aten::index [[8], [8]] -> 42.336us
       %327 = :aten::nonzero [[8]] -> 42.336us
         %328 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %874 =  [] -> 1.248us
         %329 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %875 =  [] -> 992.000ns
                 -->kernel: 0:7 %876 =  [] -> 2.080us
     %330 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %877 =  [] -> 1.760us
     %331 = :aten::index [[8], [8]] -> 42.528us
       %332 = :aten::nonzero [[8]] -> 42.528us
         %333 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %878 =  [] -> 1.248us
         %334 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %879 =  [] -> 960.000ns
                 -->kernel: 0:7 %880 =  [] -> 2.112us
     %335 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %881 =  [] -> 1.728us
     %336 = :aten::index [[8], [8]] -> 42.144us
       %337 = :aten::nonzero [[8]] -> 42.144us
         %338 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %882 =  [] -> 1.248us
         %339 = CCCL:cub::DeviceSelect::Flagged [] -> 11.680us
                 -->kernel: 0:7 %883 =  [] -> 992.000ns
                 -->kernel: 0:7 %884 =  [] -> 2.080us
     %340 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %885 =  [] -> 1.728us
     %341 = :aten::index [[8], [8]] -> 42.208us
       %342 = :aten::nonzero [[8]] -> 42.208us
         %343 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %886 =  [] -> 1.248us
         %344 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %887 =  [] -> 960.000ns
                 -->kernel: 0:7 %888 =  [] -> 2.112us
     %345 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %889 =  [] -> 1.728us
     %346 = :aten::index [[8], [8]] -> 43.584us
       %347 = :aten::nonzero [[8]] -> 43.584us
         %348 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %890 =  [] -> 1.248us
         %349 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %891 =  [] -> 992.000ns
                 -->kernel: 0:7 %892 =  [] -> 2.048us
     %350 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %893 =  [] -> 1.728us
     %351 = :aten::index [[8], [8]] -> 42.241us
       %352 = :aten::nonzero [[8]] -> 42.241us
         %353 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %894 =  [] -> 1.248us
         %354 = CCCL:cub::DeviceSelect::Flagged [] -> 11.777us
                 -->kernel: 0:7 %895 =  [] -> 960.000ns
                 -->kernel: 0:7 %896 =  [] -> 2.112us
     %355 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %897 =  [] -> 1.728us
     %356 = :aten::index [[8], [8]] -> 42.976us
       %357 = :aten::nonzero [[8]] -> 42.976us
         %358 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %898 =  [] -> 1.248us
         %359 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %899 =  [] -> 992.000ns
                 -->kernel: 0:7 %900 =  [] -> 2.080us
     %360 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %901 =  [] -> 1.728us
     %361 = :aten::index [[8], [8]] -> 42.816us
       %362 = :aten::nonzero [[8]] -> 42.816us
         %363 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %902 =  [] -> 1.248us
         %364 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %903 =  [] -> 960.000ns
                 -->kernel: 0:7 %904 =  [] -> 2.176us
     %365 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %905 =  [] -> 1.792us
     %366 = :aten::index [[8], [8]] -> 43.008us
       %367 = :aten::nonzero [[8]] -> 43.008us
         %368 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %906 =  [] -> 1.312us
         %369 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %907 =  [] -> 1.056us
                 -->kernel: 0:7 %908 =  [] -> 2.112us
     %370 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %909 =  [] -> 1.792us
     %371 = :aten::index [[8], [8]] -> 42.176us
       %372 = :aten::nonzero [[8]] -> 42.176us
         %373 = CCCL:cub::DeviceReduce::Sum [] -> 1.344us
                 -->kernel: 0:7 %910 =  [] -> 1.344us
         %374 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %911 =  [] -> 1.024us
                 -->kernel: 0:7 %912 =  [] -> 2.176us
     %375 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %913 =  [] -> 1.792us
     %376 = :aten::index [[8], [8]] -> 42.720us
       %377 = :aten::nonzero [[8]] -> 42.720us
         %378 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %914 =  [] -> 1.312us
         %379 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %915 =  [] -> 1.056us
                 -->kernel: 0:7 %916 =  [] -> 2.144us
     %380 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %917 =  [] -> 1.792us
     %381 = :aten::index [[8], [8]] -> 42.464us
       %382 = :aten::nonzero [[8]] -> 42.464us
         %383 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %918 =  [] -> 1.312us
         %384 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %919 =  [] -> 1.024us
                 -->kernel: 0:7 %920 =  [] -> 2.176us
     %385 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %921 =  [] -> 1.792us
     %386 = :aten::index [[8], [8]] -> 43.456us
       %387 = :aten::nonzero [[8]] -> 43.456us
         %388 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %922 =  [] -> 1.312us
         %389 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %923 =  [] -> 1.056us
                 -->kernel: 0:7 %924 =  [] -> 2.144us
     %390 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %925 =  [] -> 1.792us
     %391 = :aten::index [[8], [8]] -> 41.856us
       %392 = :aten::nonzero [[8]] -> 41.856us
         %393 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %926 =  [] -> 1.312us
         %394 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %927 =  [] -> 1.056us
                 -->kernel: 0:7 %928 =  [] -> 2.176us
     %395 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %929 =  [] -> 1.760us
     %396 = :aten::index [[8], [8]] -> 43.072us
       %397 = :aten::nonzero [[8]] -> 43.072us
         %398 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %930 =  [] -> 1.312us
         %399 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %931 =  [] -> 1.056us
                 -->kernel: 0:7 %932 =  [] -> 2.176us
     %400 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %933 =  [] -> 1.824us
     %401 = :aten::index [[8], [8]] -> 41.888us
       %402 = :aten::nonzero [[8]] -> 41.888us
         %403 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %934 =  [] -> 1.312us
         %404 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %935 =  [] -> 1.024us
                 -->kernel: 0:7 %936 =  [] -> 2.208us
     %405 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %937 =  [] -> 1.792us
     %406 = :aten::index [[8], [8]] -> 43.008us
       %407 = :aten::nonzero [[8]] -> 43.008us
         %408 = CCCL:cub::DeviceReduce::Sum [] -> 1.344us
                 -->kernel: 0:7 %938 =  [] -> 1.344us
         %409 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %939 =  [] -> 1.088us
                 -->kernel: 0:7 %940 =  [] -> 2.112us
     %410 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %941 =  [] -> 1.824us
     %411 = :aten::index [[8], [8]] -> 42.784us
       %412 = :aten::nonzero [[8]] -> 42.784us
         %413 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %942 =  [] -> 1.312us
         %414 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %943 =  [] -> 1.056us
                 -->kernel: 0:7 %944 =  [] -> 2.176us
     %415 = :aten::zeros [[], [], [], [], []] -> 1.216us
       %416 = :aten::zero_ [[8, 24]] -> 1.216us
         %417 = :aten::fill_ [[8, 24], []] -> 1.216us
                 -->kernel: 0:7 %945 =  [] -> 1.216us
     %418 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.584us
       %419 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.584us
         %420 = :nccl:_all_gather_base [[24]] -> 7.584us
           %421 = NCCL:ncclAllGather [] -> 7.584us
                 -->kernel: 0:7 %946 =  [] -> 7.584us
     %422 = :aten::gt [[8], []] -> 1.632us
                 -->kernel: 0:7 %947 =  [] -> 1.632us
     %423 = :aten::index [[8], [8]] -> 47.328us
       %424 = :aten::nonzero [[8]] -> 47.328us
         %425 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %948 =  [] -> 1.536us
         %426 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %949 =  [] -> 1.376us
                 -->kernel: 0:7 %950 =  [] -> 1.888us
     %427 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %951 =  [] -> 1.440us
     %428 = :aten::index [[8], [8]] -> 45.376us
       %429 = :aten::nonzero [[8]] -> 45.376us
         %430 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %952 =  [] -> 1.536us
         %431 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %953 =  [] -> 1.344us
                 -->kernel: 0:7 %954 =  [] -> 1.888us
     %432 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %955 =  [] -> 1.408us
     %433 = :aten::index [[8], [8]] -> 44.032us
       %434 = :aten::nonzero [[8]] -> 44.032us
         %435 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %956 =  [] -> 1.504us
         %436 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %957 =  [] -> 1.344us
                 -->kernel: 0:7 %958 =  [] -> 1.856us
     %437 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %959 =  [] -> 1.440us
     %438 = :aten::index [[8], [8]] -> 42.752us
       %439 = :aten::nonzero [[8]] -> 42.752us
         %440 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %960 =  [] -> 1.536us
         %441 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %961 =  [] -> 1.312us
                 -->kernel: 0:7 %962 =  [] -> 1.920us
     %442 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %963 =  [] -> 1.440us
     %443 = :aten::index [[8], [8]] -> 43.264us
       %444 = :aten::nonzero [[8]] -> 43.264us
         %445 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %964 =  [] -> 1.504us
         %446 = CCCL:cub::DeviceSelect::Flagged [] -> 12.416us
                 -->kernel: 0:7 %965 =  [] -> 1.376us
                 -->kernel: 0:7 %966 =  [] -> 1.888us
     %447 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %967 =  [] -> 1.408us
     %448 = :aten::index [[8], [8]] -> 44.000us
       %449 = :aten::nonzero [[8]] -> 44.000us
         %450 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %968 =  [] -> 1.504us
         %451 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %969 =  [] -> 1.344us
                 -->kernel: 0:7 %970 =  [] -> 1.920us
     %452 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %971 =  [] -> 1.440us
     %453 = :aten::index [[8], [8]] -> 43.040us
       %454 = :aten::nonzero [[8]] -> 43.040us
         %455 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %972 =  [] -> 1.504us
         %456 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %973 =  [] -> 1.344us
                 -->kernel: 0:7 %974 =  [] -> 1.888us
     %457 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %975 =  [] -> 1.440us
     %458 = :aten::index [[8], [8]] -> 41.792us
       %459 = :aten::nonzero [[8]] -> 41.792us
         %460 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %976 =  [] -> 1.504us
         %461 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %977 =  [] -> 1.344us
                 -->kernel: 0:7 %978 =  [] -> 1.888us
     %462 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %979 =  [] -> 1.440us
     %463 = :aten::index [[8], [8]] -> 42.720us
       %464 = :aten::nonzero [[8]] -> 42.720us
         %465 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %980 =  [] -> 1.504us
         %466 = CCCL:cub::DeviceSelect::Flagged [] -> 12.192us
                 -->kernel: 0:7 %981 =  [] -> 1.376us
                 -->kernel: 0:7 %982 =  [] -> 1.888us
     %467 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %983 =  [] -> 1.408us
     %468 = :aten::index [[8], [8]] -> 42.048us
       %469 = :aten::nonzero [[8]] -> 42.048us
         %470 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %984 =  [] -> 1.504us
         %471 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %985 =  [] -> 1.344us
                 -->kernel: 0:7 %986 =  [] -> 1.888us
     %472 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %987 =  [] -> 1.408us
     %473 = :aten::index [[8], [8]] -> 42.016us
       %474 = :aten::nonzero [[8]] -> 42.016us
         %475 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %988 =  [] -> 1.472us
         %476 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %989 =  [] -> 1.344us
                 -->kernel: 0:7 %990 =  [] -> 1.856us
     %477 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %991 =  [] -> 1.408us
     %478 = :aten::index [[8], [8]] -> 42.048us
       %479 = :aten::nonzero [[8]] -> 42.048us
         %480 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %992 =  [] -> 1.504us
         %481 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %993 =  [] -> 1.312us
                 -->kernel: 0:7 %994 =  [] -> 1.856us
     %482 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %995 =  [] -> 1.408us
     %483 = :aten::index [[8], [8]] -> 42.336us
       %484 = :aten::nonzero [[8]] -> 42.336us
         %485 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %996 =  [] -> 1.472us
         %486 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %997 =  [] -> 1.344us
                 -->kernel: 0:7 %998 =  [] -> 1.856us
     %487 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %999 =  [] -> 1.408us
     %488 = :aten::index [[8], [8]] -> 42.048us
       %489 = :aten::nonzero [[8]] -> 42.048us
         %490 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %1000 =  [] -> 1.536us
         %491 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %1001 =  [] -> 1.312us
                 -->kernel: 0:7 %1002 =  [] -> 1.856us
     %492 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %1003 =  [] -> 1.376us
     %493 = :aten::index [[8], [8]] -> 43.136us
       %494 = :aten::nonzero [[8]] -> 43.136us
         %495 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %1004 =  [] -> 1.472us
         %496 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %1005 =  [] -> 1.344us
                 -->kernel: 0:7 %1006 =  [] -> 1.856us
     %497 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %1007 =  [] -> 1.408us
     %498 = :aten::index [[8], [8]] -> 42.272us
       %499 = :aten::nonzero [[8]] -> 42.272us
         %500 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %1008 =  [] -> 1.536us
         %501 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %1009 =  [] -> 1.344us
                 -->kernel: 0:7 %1010 =  [] -> 1.920us
     %502 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %1011 =  [] -> 1.408us
     %503 = :aten::index [[8], [8]] -> 41.888us
       %504 = :aten::nonzero [[8]] -> 41.888us
         %505 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %1012 =  [] -> 1.504us
         %506 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %1013 =  [] -> 1.376us
                 -->kernel: 0:7 %1014 =  [] -> 1.888us
     %507 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %1015 =  [] -> 1.408us
     %508 = :aten::index [[8], [8]] -> 41.888us
       %509 = :aten::nonzero [[8]] -> 41.888us
         %510 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %1016 =  [] -> 1.504us
         %511 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %1017 =  [] -> 1.312us
                 -->kernel: 0:7 %1018 =  [] -> 1.888us
     %512 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %1019 =  [] -> 1.440us
     %513 = :aten::index [[8], [8]] -> 41.760us
       %514 = :aten::nonzero [[8]] -> 41.760us
         %515 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %1020 =  [] -> 1.504us
         %516 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %1021 =  [] -> 1.376us
                 -->kernel: 0:7 %1022 =  [] -> 1.888us
     %517 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %1023 =  [] -> 1.440us
     %518 = :aten::index [[8], [8]] -> 42.496us
       %519 = :aten::nonzero [[8]] -> 42.496us
         %520 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %1024 =  [] -> 1.504us
         %521 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %1025 =  [] -> 1.312us
                 -->kernel: 0:7 %1026 =  [] -> 1.888us
     %522 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %1027 =  [] -> 1.440us
     %523 = :aten::index [[8], [8]] -> 41.856us
       %524 = :aten::nonzero [[8]] -> 41.856us
         %525 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %1028 =  [] -> 1.504us
         %526 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %1029 =  [] -> 1.376us
                 -->kernel: 0:7 %1030 =  [] -> 1.856us
     %527 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %1031 =  [] -> 1.408us
     %528 = :aten::index [[8], [8]] -> 46.880us
       %529 = :aten::nonzero [[8]] -> 46.880us
         %530 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %1032 =  [] -> 1.504us
         %531 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %1033 =  [] -> 1.344us
                 -->kernel: 0:7 %1034 =  [] -> 1.856us
     %532 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %1035 =  [] -> 1.408us
     %533 = :aten::index [[8], [8]] -> 42.816us
       %534 = :aten::nonzero [[8]] -> 42.816us
         %535 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %1036 =  [] -> 1.472us
         %536 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %1037 =  [] -> 1.344us
                 -->kernel: 0:7 %1038 =  [] -> 1.856us
     %537 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %1039 =  [] -> 1.408us
     %538 = :aten::index [[8], [8]] -> 44.224us
       %539 = :aten::nonzero [[8]] -> 44.224us
         %540 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %1040 =  [] -> 1.504us
         %541 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %1041 =  [] -> 1.312us
                 -->kernel: 0:7 %1042 =  [] -> 1.888us
     %542 = :aten::zeros [[], [], [], [], []] -> 1.024us
       %543 = :aten::zero_ [[8, 24]] -> 1.024us
         %544 = :aten::fill_ [[8, 24], []] -> 1.024us
                 -->kernel: 0:7 %1043 =  [] -> 1.024us
     %545 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.744us
       %546 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.744us
         %547 = :nccl:_all_gather_base [[24]] -> 7.744us
           %548 = NCCL:ncclAllGather [] -> 7.744us
                 -->kernel: 0:7 %1044 =  [] -> 7.744us
     %549 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %1045 =  [] -> 1.824us
     %550 = :aten::index [[8], [8]] -> 47.488us
       %551 = :aten::nonzero [[8]] -> 47.488us
         %552 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1046 =  [] -> 1.312us
         %553 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %1047 =  [] -> 1.024us
                 -->kernel: 0:7 %1048 =  [] -> 2.208us
     %554 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %1049 =  [] -> 1.760us
     %555 = :aten::index [[8], [8]] -> 43.584us
       %556 = :aten::nonzero [[8]] -> 43.584us
         %557 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %1050 =  [] -> 1.280us
         %558 = CCCL:cub::DeviceSelect::Flagged [] -> 12.288us
                 -->kernel: 0:7 %1051 =  [] -> 1.088us
                 -->kernel: 0:7 %1052 =  [] -> 2.112us
     %559 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %1053 =  [] -> 1.792us
     %560 = :aten::index [[8], [8]] -> 43.424us
       %561 = :aten::nonzero [[8]] -> 43.424us
         %562 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %1054 =  [] -> 1.280us
         %563 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %1055 =  [] -> 1.024us
                 -->kernel: 0:7 %1056 =  [] -> 2.176us
     %564 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %1057 =  [] -> 1.760us
     %565 = :aten::index [[8], [8]] -> 46.752us
       %566 = :aten::nonzero [[8]] -> 46.752us
         %567 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1058 =  [] -> 1.312us
         %568 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %1059 =  [] -> 1.056us
                 -->kernel: 0:7 %1060 =  [] -> 2.112us
     %569 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %1061 =  [] -> 1.792us
     %570 = :aten::index [[8], [8]] -> 41.696us
       %571 = :aten::nonzero [[8]] -> 41.696us
         %572 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %1062 =  [] -> 1.280us
         %573 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %1063 =  [] -> 992.000ns
                 -->kernel: 0:7 %1064 =  [] -> 2.144us
     %574 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %1065 =  [] -> 1.792us
     %575 = :aten::index [[8], [8]] -> 42.016us
       %576 = :aten::nonzero [[8]] -> 42.016us
         %577 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1066 =  [] -> 1.312us
         %578 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %1067 =  [] -> 1.056us
                 -->kernel: 0:7 %1068 =  [] -> 2.144us
     %579 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %1069 =  [] -> 1.792us
     %580 = :aten::index [[8], [8]] -> 42.369us
       %581 = :aten::nonzero [[8]] -> 42.369us
         %582 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1070 =  [] -> 1.312us
         %583 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %1071 =  [] -> 1.024us
                 -->kernel: 0:7 %1072 =  [] -> 2.144us
     %584 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %1073 =  [] -> 1.760us
     %585 = :aten::index [[8], [8]] -> 42.880us
       %586 = :aten::nonzero [[8]] -> 42.880us
         %587 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %1074 =  [] -> 1.280us
         %588 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %1075 =  [] -> 1.024us
                 -->kernel: 0:7 %1076 =  [] -> 2.080us
     %589 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %1077 =  [] -> 1.760us
     %590 = :aten::index [[8], [8]] -> 42.240us
       %591 = :aten::nonzero [[8]] -> 42.240us
         %592 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1078 =  [] -> 1.312us
         %593 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %1079 =  [] -> 1.024us
                 -->kernel: 0:7 %1080 =  [] -> 2.176us
     %594 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %1081 =  [] -> 1.760us
     %595 = :aten::index [[8], [8]] -> 42.336us
       %596 = :aten::nonzero [[8]] -> 42.336us
         %597 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1082 =  [] -> 1.312us
         %598 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %1083 =  [] -> 1.056us
                 -->kernel: 0:7 %1084 =  [] -> 2.144us
     %599 = :aten::gt [[8], []] -> 1.856us
                 -->kernel: 0:7 %1085 =  [] -> 1.856us
     %600 = :aten::index [[8], [8]] -> 41.216us
       %601 = :aten::nonzero [[8]] -> 41.216us
         %602 = CCCL:cub::DeviceReduce::Sum [] -> 1.344us
                 -->kernel: 0:7 %1086 =  [] -> 1.344us
         %603 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %1087 =  [] -> 1.056us
                 -->kernel: 0:7 %1088 =  [] -> 2.208us
     %604 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %1089 =  [] -> 1.792us
     %605 = :aten::index [[8], [8]] -> 42.560us
       %606 = :aten::nonzero [[8]] -> 42.560us
         %607 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1090 =  [] -> 1.312us
         %608 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %1091 =  [] -> 1.088us
                 -->kernel: 0:7 %1092 =  [] -> 2.176us
     %609 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %1093 =  [] -> 1.824us
     %610 = :aten::index [[8], [8]] -> 42.208us
       %611 = :aten::nonzero [[8]] -> 42.208us
         %612 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1094 =  [] -> 1.312us
         %613 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %1095 =  [] -> 1.056us
                 -->kernel: 0:7 %1096 =  [] -> 2.208us
     %614 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %1097 =  [] -> 1.792us
     %615 = :aten::index [[8], [8]] -> 41.921us
       %616 = :aten::nonzero [[8]] -> 41.921us
         %617 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1098 =  [] -> 1.312us
         %618 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %1099 =  [] -> 1.056us
                 -->kernel: 0:7 %1100 =  [] -> 2.144us
     %619 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %1101 =  [] -> 1.824us
     %620 = :aten::index [[8], [8]] -> 41.600us
       %621 = :aten::nonzero [[8]] -> 41.600us
         %622 = CCCL:cub::DeviceReduce::Sum [] -> 1.344us
                 -->kernel: 0:7 %1102 =  [] -> 1.344us
         %623 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %1103 =  [] -> 1.056us
                 -->kernel: 0:7 %1104 =  [] -> 2.176us
     %624 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %1105 =  [] -> 1.792us
     %625 = :aten::index [[8], [8]] -> 45.120us
       %626 = :aten::nonzero [[8]] -> 45.120us
         %627 = CCCL:cub::DeviceReduce::Sum [] -> 1.344us
                 -->kernel: 0:7 %1106 =  [] -> 1.344us
         %628 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %1107 =  [] -> 1.088us
                 -->kernel: 0:7 %1108 =  [] -> 2.176us
     %629 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %1109 =  [] -> 1.824us
     %630 = :aten::index [[8], [8]] -> 41.952us
       %631 = :aten::nonzero [[8]] -> 41.952us
         %632 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %1110 =  [] -> 1.216us
         %633 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %1111 =  [] -> 992.000ns
                 -->kernel: 0:7 %1112 =  [] -> 2.112us
     %634 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %1113 =  [] -> 1.696us
     %635 = :aten::index [[8], [8]] -> 42.848us
       %636 = :aten::nonzero [[8]] -> 42.848us
         %637 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %1114 =  [] -> 1.248us
         %638 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %1115 =  [] -> 992.000ns
                 -->kernel: 0:7 %1116 =  [] -> 2.080us
     %639 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %1117 =  [] -> 1.728us
     %640 = :aten::index [[8], [8]] -> 42.304us
       %641 = :aten::nonzero [[8]] -> 42.304us
         %642 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %1118 =  [] -> 1.216us
         %643 = CCCL:cub::DeviceSelect::Flagged [] -> 11.616us
                 -->kernel: 0:7 %1119 =  [] -> 992.000ns
                 -->kernel: 0:7 %1120 =  [] -> 2.112us
     %644 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %1121 =  [] -> 1.728us
     %645 = :aten::index [[8], [8]] -> 41.600us
       %646 = :aten::nonzero [[8]] -> 41.600us
         %647 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %1122 =  [] -> 1.248us
         %648 = CCCL:cub::DeviceSelect::Flagged [] -> 11.584us
                 -->kernel: 0:7 %1123 =  [] -> 992.000ns
                 -->kernel: 0:7 %1124 =  [] -> 2.080us
     %649 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %1125 =  [] -> 1.728us
     %650 = :aten::index [[8], [8]] -> 41.120us
       %651 = :aten::nonzero [[8]] -> 41.120us
         %652 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %1126 =  [] -> 1.216us
         %653 = CCCL:cub::DeviceSelect::Flagged [] -> 11.584us
                 -->kernel: 0:7 %1127 =  [] -> 960.000ns
                 -->kernel: 0:7 %1128 =  [] -> 2.112us
     %654 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %1129 =  [] -> 1.728us
     %655 = :aten::index [[8], [8]] -> 41.920us
       %656 = :aten::nonzero [[8]] -> 41.920us
         %657 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %1130 =  [] -> 1.248us
         %658 = CCCL:cub::DeviceSelect::Flagged [] -> 11.680us
                 -->kernel: 0:7 %1131 =  [] -> 992.000ns
                 -->kernel: 0:7 %1132 =  [] -> 2.048us
     %659 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %1133 =  [] -> 1.760us
     %660 = :aten::index [[8], [8]] -> 40.896us
       %661 = :aten::nonzero [[8]] -> 40.896us
         %662 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %1134 =  [] -> 1.248us
         %663 = CCCL:cub::DeviceSelect::Flagged [] -> 11.520us
                 -->kernel: 0:7 %1135 =  [] -> 960.000ns
                 -->kernel: 0:7 %1136 =  [] -> 2.112us
     %664 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %1137 =  [] -> 1.728us
     %665 = :aten::index [[8], [8]] -> 41.600us
       %666 = :aten::nonzero [[8]] -> 41.600us
         %667 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %1138 =  [] -> 1.216us
         %668 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %1139 =  [] -> 992.000ns
                 -->kernel: 0:7 %1140 =  [] -> 2.048us
     %669 = :aten::zero_ [[3002413056]] -> 1.801ms
       %670 = :aten::fill_ [[3002413056], []] -> 1.801ms
                 -->kernel: 0:7 %1141 =  [] -> 441.409us
                 -->kernel: 0:7 %1142 =  [] -> 441.505us
                 -->kernel: 0:7 %1143 =  [] -> 441.505us
                 -->kernel: 0:7 %1144 =  [] -> 441.473us
     %671 = :aten::zero_ [[352321536]] -> 207.872us
       %672 = :aten::fill_ [[352321536], []] -> 207.872us
                 -->kernel: 0:7 %1145 =  [] -> 207.872us
     %673 = :aten::zeros [[], [], [], [], []] -> 1.088us
       %674 = :aten::zero_ [[]] -> 1.088us
         %675 = :aten::fill_ [[], []] -> 1.088us
                 -->kernel: 0:7 %1146 =  [] -> 1.088us
     %676 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.264us
       %677 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.264us
         %678 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.264us
     %679 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.296us
       %680 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.296us
         %681 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.296us
     %682 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 1.472us
       %683 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 1.472us
         %684 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.472us
     %685 = :aten::to [[1, 1, 4096, 4096], [], [], [], [], [], [], []] -> 293.920us
       %686 = :aten::_to_copy [[1, 1, 4096, 4096], [], [], [], [], [], []] -> 293.920us
         %687 = :aten::copy_ [[1, 1, 4096, 4096], [1, 1, 4096, 4096], []] -> 293.920us
     %688 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.168us
       %689 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.168us
         %690 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.168us
     %691 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 271.424us
       %692 = :aten::index_select [[129280, 7168], [], [4096]] -> 271.424us
                 -->kernel: 0:7 %1147 =  [] -> 271.424us
     %693 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 128.064us
       %694 = :nvte_rmsnorm_fwd [] -> 128.064us
                 -->kernel: 0:7 %1148 =  [] -> 128.064us
     %695 = :TELinear forward [] -> 658.657us
       %696 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 658.657us
         %697 = :nvte_quantize_v2 [] -> 73.088us
           %698 = :quantize_transpose_vector_blockwise [] -> 73.088us
                 -->kernel: 0:7 %1149 =  [] -> 73.088us
         %699 = :nvte_quantize_v2 [] -> 20.352us
           %700 = :quantize_transpose_square_blockwise [] -> 20.352us
                 -->kernel: 0:7 %1150 =  [] -> 20.352us
         %701 = :nvte_cublas_gemm_scaled [] -> 337.345us
                 -->kernel: 0:7 %1151 =  [] -> 328.417us
     %702 = :TELinear forward [] -> 409.441us
       %703 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 409.441us
         %704 = :nvte_quantize_v2 [] -> 72.672us
           %705 = :quantize_transpose_vector_blockwise [] -> 72.672us
                 -->kernel: 0:7 %1152 =  [] -> 72.672us
         %706 = :nvte_quantize_v2 [] -> 11.712us
           %707 = :quantize_transpose_square_blockwise [] -> 11.712us
                 -->kernel: 0:7 %1153 =  [] -> 11.712us
         %708 = :nvte_cublas_gemm_scaled [] -> 203.553us
                 -->kernel: 0:7 %1154 =  [] -> 197.153us
     %709 = :TELayerNormColumnParallelLinear forward [] -> 1.380ms
       %710 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.380ms
         %711 = :nvte_rmsnorm_fwd [] -> 30.400us
                 -->kernel: 0:7 %1155 =  [] -> 30.400us
         %712 = :nvte_quantize_v2 [] -> 16.960us
           %713 = :quantize_transpose_vector_blockwise [] -> 16.960us
                 -->kernel: 0:7 %1156 =  [] -> 16.960us
         %714 = :nvte_quantize_v2 [] -> 58.080us
           %715 = :quantize_transpose_square_blockwise [] -> 58.080us
                 -->kernel: 0:7 %1157 =  [] -> 58.080us
         %716 = :nvte_cublas_gemm_scaled [] -> 1.134ms
                 -->kernel: 0:7 %1158 =  [] -> 1.128ms
     %717 = :TELayerNormColumnParallelLinear forward [] -> 897.186us
       %718 = :aten::contiguous [[4096, 1, 512], []] -> 11.616us
         %719 = :aten::clone [[4096, 1, 512], []] -> 11.616us
           %720 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.616us
                 -->kernel: 0:7 %1159 =  [] -> 11.616us
       %721 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 694.721us
         %722 = :nvte_rmsnorm_fwd [] -> 4.192us
                 -->kernel: 0:7 %1160 =  [] -> 4.192us
         %723 = :nvte_quantize_v2 [] -> 7.680us
           %724 = :quantize_transpose_vector_blockwise [] -> 7.680us
                 -->kernel: 0:7 %1161 =  [] -> 7.680us
         %725 = :nvte_quantize_v2 [] -> 28.032us
           %726 = :quantize_transpose_square_blockwise [] -> 28.032us
                 -->kernel: 0:7 %1162 =  [] -> 28.032us
         %727 = :nvte_cublas_gemm_scaled [] -> 523.681us
                 -->kernel: 0:7 %1163 =  [] -> 517.601us
     %728 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.624us
                 -->kernel: 0:7 %1164 =  [] -> 114.624us
     %729 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 172.704us
                 -->kernel: 0:7 %1165 =  [] -> 172.704us
     %730 = :TEDotProductAttention forward [] -> 22.475ms
       %731 = :aten::arange [[], [], [], [], []] -> 1.184us
         %732 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %1166 =  [] -> 1.184us
       %733 = :aten::arange [[], [], [], [], []] -> 1.312us
         %734 = :aten::arange [[], [], [], [0]] -> 1.312us
                 -->kernel: 0:7 %1167 =  [] -> 1.312us
       %735 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 60.800us
                 -->kernel: 0:7 %1168 =  [] -> 60.800us
       %736 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 39.872us
                 -->kernel: 0:7 %1169 =  [] -> 39.872us
       %737 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.208us
                 -->kernel: 0:7 %1170 =  [] -> 38.208us
       %738 = :aten::le [[1, 1, 4096, 4096], []] -> 28.128us
                 -->kernel: 0:7 %1171 =  [] -> 28.128us
       %739 = :aten::lt [[1, 1, 4096, 4096], []] -> 26.048us
                 -->kernel: 0:7 %1172 =  [] -> 26.048us
       %740 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.240us
                 -->kernel: 0:7 %1173 =  [] -> 14.240us
       %741 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.456us
         %742 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.456us
                 -->kernel: 0:7 %1174 =  [] -> 19.456us
       %743 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.864us
         %744 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.864us
                 -->kernel: 0:7 %1175 =  [] -> 12.864us
       %745 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.432us
         %746 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.432us
                 -->kernel: 0:7 %1176 =  [] -> 18.432us
       %747 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.817ms
                 -->kernel: 0:7 %1177 =  [] -> 5.807ms
       %748 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 10.999ms
         %749 = :nvte_scaled_masked_softmax_forward [] -> 10.999ms
                 -->kernel: 0:7 %1178 =  [] -> 10.999ms
       %750 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.991ms
                 -->kernel: 0:7 %1179 =  [] -> 3.974ms
       %751 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.976us
         %752 = :aten::clone [[4096, 1, 128, 128], []] -> 278.976us
           %753 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.976us
                 -->kernel: 0:7 %1180 =  [] -> 278.976us
     %754 = :TERowParallelLinear forward [] -> 3.847ms
       %755 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.847ms
         %756 = :nvte_quantize_v2 [] -> 97.088us
           %757 = :quantize_transpose_vector_blockwise [] -> 97.088us
                 -->kernel: 0:7 %1181 =  [] -> 97.088us
         %758 = :nvte_quantize_v2 [] -> 169.921us
           %759 = :quantize_transpose_square_blockwise [] -> 169.921us
                 -->kernel: 0:7 %1182 =  [] -> 169.921us
         %760 = :nvte_cublas_gemm_scaled [] -> 3.428ms
                 -->kernel: 0:7 %1183 =  [] -> 3.421ms
     %761 = :Torch-Compiled Region: 1/2 None -> 45.025us
       %762 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 45.025us
         %763 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 45.025us
                 -->kernel: 0:7 %1184 =  [] -> 45.025us
     %764 = :TELayerNormColumnParallelLinear forward [] -> 8.449ms
       %765 = :_LayerNormLinear [[4096, 1, 7168], [7168], [], [36864, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 8.449ms
         %766 = :nvte_rmsnorm_fwd [] -> 126.145us
                 -->kernel: 0:7 %1185 =  [] -> 126.145us
         %767 = :nvte_quantize_v2 [] -> 73.888us
           %768 = :quantize_transpose_vector_blockwise [] -> 73.888us
                 -->kernel: 0:7 %1186 =  [] -> 73.888us
         %769 = :nvte_quantize_v2 [] -> 388.225us
           %770 = :quantize_transpose_square_blockwise [] -> 388.225us
                 -->kernel: 0:7 %1187 =  [] -> 388.225us
         %771 = :nvte_cublas_gemm_scaled [] -> 7.703ms
                 -->kernel: 0:7 %1188 =  [] -> 7.697ms
     %772 = :SwiGLUFunction [[4096, 36864], [], []] -> 129.952us
       %773 = :Torch-Compiled Region: 2/0 None -> 129.952us
         %774 = :triton_poi_fused_mul_silu_0 [[4096, 36864], [4096, 18432], [], []] -> 129.952us
                 -->kernel: 0:7 %1189 =  [] -> 129.952us
     %775 = :TERowParallelLinear forward [] -> 4.374ms
       %776 = :_Linear [[7168, 18432], [4096, 1, 18432], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 4.374ms
         %777 = :nvte_quantize_v2 [] -> 183.520us
           %778 = :quantize_transpose_vector_blockwise [] -> 183.520us
                 -->kernel: 0:7 %1190 =  [] -> 183.520us
         %779 = :nvte_quantize_v2 [] -> 193.633us
           %780 = :quantize_transpose_square_blockwise [] -> 193.633us
                 -->kernel: 0:7 %1191 =  [] -> 193.633us
         %781 = :nvte_cublas_gemm_scaled [] -> 3.854ms
                 -->kernel: 0:7 %1192 =  [] -> 3.847ms
     %782 = :Torch-Compiled Region: 1/2 None -> 44.768us
       %783 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.768us
         %784 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.768us
                 -->kernel: 0:7 %1193 =  [] -> 44.768us
     %785 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.656us
       %786 = :nvte_rmsnorm_fwd [] -> 126.656us
                 -->kernel: 0:7 %1194 =  [] -> 126.656us
     %787 = :TELinear forward [] -> 558.049us
       %788 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 558.049us
         %789 = :nvte_quantize_v2 [] -> 73.920us
           %790 = :quantize_transpose_vector_blockwise [] -> 73.920us
                 -->kernel: 0:7 %1195 =  [] -> 73.920us
         %791 = :nvte_quantize_v2 [] -> 20.928us
           %792 = :quantize_transpose_square_blockwise [] -> 20.928us
                 -->kernel: 0:7 %1196 =  [] -> 20.928us
         %793 = :nvte_cublas_gemm_scaled [] -> 334.464us
                 -->kernel: 0:7 %1197 =  [] -> 328.000us
     %794 = :TELinear forward [] -> 402.465us
       %795 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 402.465us
         %796 = :nvte_quantize_v2 [] -> 72.928us
           %797 = :quantize_transpose_vector_blockwise [] -> 72.928us
                 -->kernel: 0:7 %1198 =  [] -> 72.928us
         %798 = :nvte_quantize_v2 [] -> 11.456us
           %799 = :quantize_transpose_square_blockwise [] -> 11.456us
                 -->kernel: 0:7 %1199 =  [] -> 11.456us
         %800 = :nvte_cublas_gemm_scaled [] -> 203.457us
                 -->kernel: 0:7 %1200 =  [] -> 197.217us
     %801 = :TELayerNormColumnParallelLinear forward [] -> 1.370ms
       %802 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.370ms
         %803 = :nvte_rmsnorm_fwd [] -> 30.688us
                 -->kernel: 0:7 %1201 =  [] -> 30.688us
         %804 = :nvte_quantize_v2 [] -> 16.896us
           %805 = :quantize_transpose_vector_blockwise [] -> 16.896us
                 -->kernel: 0:7 %1202 =  [] -> 16.896us
         %806 = :nvte_quantize_v2 [] -> 57.792us
           %807 = :quantize_transpose_square_blockwise [] -> 57.792us
                 -->kernel: 0:7 %1203 =  [] -> 57.792us
         %808 = :nvte_cublas_gemm_scaled [] -> 1.130ms
                 -->kernel: 0:7 %1204 =  [] -> 1.124ms
     %809 = :TELayerNormColumnParallelLinear forward [] -> 899.298us
       %810 = :aten::contiguous [[4096, 1, 512], []] -> 11.648us
         %811 = :aten::clone [[4096, 1, 512], []] -> 11.648us
           %812 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.648us
                 -->kernel: 0:7 %1205 =  [] -> 11.648us
       %813 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 696.833us
         %814 = :nvte_rmsnorm_fwd [] -> 4.192us
                 -->kernel: 0:7 %1206 =  [] -> 4.192us
         %815 = :nvte_quantize_v2 [] -> 7.648us
           %816 = :quantize_transpose_vector_blockwise [] -> 7.648us
                 -->kernel: 0:7 %1207 =  [] -> 7.648us
         %817 = :nvte_quantize_v2 [] -> 28.672us
           %818 = :quantize_transpose_square_blockwise [] -> 28.672us
                 -->kernel: 0:7 %1208 =  [] -> 28.672us
         %819 = :nvte_cublas_gemm_scaled [] -> 521.697us
                 -->kernel: 0:7 %1209 =  [] -> 515.553us
     %820 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 113.984us
                 -->kernel: 0:7 %1210 =  [] -> 113.984us
     %821 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 172.545us
                 -->kernel: 0:7 %1211 =  [] -> 172.545us
     %822 = :TEDotProductAttention forward [] -> 22.403ms
       %823 = :aten::arange [[], [], [], [], []] -> 1.184us
         %824 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %1212 =  [] -> 1.184us
       %825 = :aten::arange [[], [], [], [], []] -> 1.152us
         %826 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %1213 =  [] -> 1.152us
       %827 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 61.056us
                 -->kernel: 0:7 %1214 =  [] -> 61.056us
       %828 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 38.848us
                 -->kernel: 0:7 %1215 =  [] -> 38.848us
       %829 = :aten::add [[1, 1, 4096, 4096], [], []] -> 39.168us
                 -->kernel: 0:7 %1216 =  [] -> 39.168us
       %830 = :aten::le [[1, 1, 4096, 4096], []] -> 28.288us
                 -->kernel: 0:7 %1217 =  [] -> 28.288us
       %831 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.736us
                 -->kernel: 0:7 %1218 =  [] -> 24.736us
       %832 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.304us
                 -->kernel: 0:7 %1219 =  [] -> 14.304us
       %833 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.104us
         %834 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.104us
                 -->kernel: 0:7 %1220 =  [] -> 19.104us
       %835 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.960us
         %836 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.960us
                 -->kernel: 0:7 %1221 =  [] -> 12.960us
       %837 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.112us
         %838 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.112us
                 -->kernel: 0:7 %1222 =  [] -> 18.112us
       %839 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.813ms
                 -->kernel: 0:7 %1223 =  [] -> 5.805ms
       %840 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.003ms
         %841 = :nvte_scaled_masked_softmax_forward [] -> 11.003ms
                 -->kernel: 0:7 %1224 =  [] -> 11.003ms
       %842 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.981ms
                 -->kernel: 0:7 %1225 =  [] -> 3.969ms
       %843 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.817us
         %844 = :aten::clone [[4096, 1, 128, 128], []] -> 278.817us
           %845 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.817us
                 -->kernel: 0:7 %1226 =  [] -> 278.817us
     %846 = :TERowParallelLinear forward [] -> 3.838ms
       %847 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.838ms
         %848 = :nvte_quantize_v2 [] -> 96.736us
           %849 = :quantize_transpose_vector_blockwise [] -> 96.736us
                 -->kernel: 0:7 %1227 =  [] -> 96.736us
         %850 = :nvte_quantize_v2 [] -> 168.832us
           %851 = :quantize_transpose_square_blockwise [] -> 168.832us
                 -->kernel: 0:7 %1228 =  [] -> 168.832us
         %852 = :nvte_cublas_gemm_scaled [] -> 3.428ms
                 -->kernel: 0:7 %1229 =  [] -> 3.421ms
     %853 = :Torch-Compiled Region: 1/2 None -> 44.064us
       %854 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.064us
         %855 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.064us
                 -->kernel: 0:7 %1230 =  [] -> 44.064us
     %856 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.464us
       %857 = :nvte_rmsnorm_fwd [] -> 126.464us
                 -->kernel: 0:7 %1231 =  [] -> 126.464us
     %858 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 42.880us
       %859 = :nvte_cublas_gemm_scaled [] -> 42.880us
                 -->kernel: 0:7 %1232 =  [] -> 22.208us
                 -->kernel: 0:7 %1233 =  [] -> 2.656us
     %860 = :RandomSTE [[4096, 1, 32]] -> 47.200us
       %861 = :aten::clone [[4096, 1, 32], []] -> 1.568us
         %862 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.568us
       %863 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.672us
                 -->kernel: 0:7 %1234 =  [] -> 4.672us
     %864 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 69.952us
       %865 = :nvte_fused_topk_with_score_function_forward [] -> 69.952us
                 -->kernel: 0:7 %1235 =  [] -> 69.952us
     %866 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 27.200us
       %867 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 27.200us
                 -->kernel: 0:7 %1236 =  [] -> 27.200us
     %868 = :aten::sum [[4096, 32], [], [], []] -> 46.656us
       %869 = :aten::to [[4096, 32], [], [], [], []] -> 4.672us
         %870 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.672us
           %871 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.672us
                 -->kernel: 0:7 %1237 =  [] -> 4.672us
                 -->kernel: 0:7 %1238 =  [] -> 9.824us
     %872 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.288us
       %873 = :nvte_fused_moe_aux_loss_forward [] -> 12.288us
                 -->kernel: 0:7 %1239 =  [] -> 12.288us
     %874 = :aten::div [[], []] -> 1.248us
                 -->kernel: 0:7 %1240 =  [] -> 1.248us
     %875 = :aten::div [[], []] -> 1.184us
                 -->kernel: 0:7 %1241 =  [] -> 1.184us
     %876 = :aten::add_ [[], [], []] -> 1.344us
                 -->kernel: 0:7 %1242 =  [] -> 1.344us
     %877 = :aten::sum [[4096, 32], [], [], []] -> 37.537us
       %878 = :aten::to [[4096, 32], [], [], [], []] -> 4.896us
         %879 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.896us
           %880 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.896us
                 -->kernel: 0:7 %1243 =  [] -> 4.896us
                 -->kernel: 0:7 %1244 =  [] -> 7.713us
     %881 = :aten::add_ [[32], [32], []] -> 4.192us
                 -->kernel: 0:7 %1245 =  [] -> 4.192us
     %882 = :aten::topk [[4096, 32], [], [], [], []] -> 54.880us
                 -->kernel: 0:7 %1246 =  [] -> 14.240us
                 -->kernel: 0:7 %1247 =  [] -> 7.776us
     %883 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 1.274ms
                 -->kernel: 0:26 %1248 =  [] -> 43.520us
                 -->kernel: 0:26 %1249 =  [] -> 372.161us
                 -->kernel: 0:26 %1250 =  [] -> 732.417us
     %884 = :TEColumnParallelLinear forward [] -> 1.141ms
       %885 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.141ms
         %886 = :nvte_quantize_v2 [] -> 45.504us
           %887 = :quantize_transpose_vector_blockwise [] -> 45.504us
                 -->kernel: 0:7 %1251 =  [] -> 45.504us
         %888 = :nvte_quantize_v2 [] -> 45.120us
           %889 = :quantize_transpose_square_blockwise [] -> 45.120us
                 -->kernel: 0:7 %1252 =  [] -> 45.120us
         %890 = :nvte_cublas_gemm_scaled [] -> 916.354us
                 -->kernel: 0:7 %1253 =  [] -> 909.794us
     %891 = :SwiGLUFunction [[4096, 4096], [], []] -> 27.457us
       %892 = :Torch-Compiled Region: 2/1 None -> 27.457us
         %893 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 27.457us
                 -->kernel: 0:7 %1254 =  [] -> 27.457us
     %894 = :TERowParallelLinear forward [] -> 608.193us
       %895 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 608.193us
         %896 = :nvte_quantize_v2 [] -> 23.104us
           %897 = :quantize_transpose_vector_blockwise [] -> 23.104us
                 -->kernel: 0:7 %1255 =  [] -> 23.104us
         %898 = :nvte_quantize_v2 [] -> 24.416us
           %899 = :quantize_transpose_square_blockwise [] -> 24.416us
                 -->kernel: 0:7 %1256 =  [] -> 24.416us
         %900 = :nvte_cublas_gemm_scaled [] -> 444.225us
                 -->kernel: 0:7 %1257 =  [] -> 438.209us
     %901 = :IndicesToMultihot [[15641, 8], [15641, 8], []] -> 11.168us
                 -->kernel: 0:7 %1258 =  [] -> 11.168us
     %902 = :aten::contiguous [[4, 15641], []] -> 3.008us
       %903 = :aten::clone [[4, 15641], []] -> 3.008us
         %904 = :aten::copy_ [[4, 15641], [4, 15641], []] -> 3.008us
                 -->kernel: 0:7 %1259 =  [] -> 3.008us
     %905 = :aten::to [[4, 15641], [], [], [], []] -> 4.960us
       %906 = :aten::_to_copy [[4, 15641], [], [], [], [], [], []] -> 4.960us
         %907 = :aten::copy_ [[4, 15641], [4, 15641], []] -> 4.960us
                 -->kernel: 0:7 %1260 =  [] -> 4.960us
                 -->kernel: 0:7 %1261 =  [] -> 23.104us
     %908 = :_moe_permute_mask_map [[15641, 7168], [15641, 4], [], [15641, 4]] -> 397.697us
                 -->kernel: 0:7 %1262 =  [] -> 2.240us
                 -->kernel: 0:7 %1263 =  [] -> 2.560us
                 -->kernel: 0:7 %1264 =  [] -> 13.152us
                 -->kernel: 0:7 %1265 =  [] -> 199.104us
     %909 = :TEColumnParallelGroupedLinear forward [] -> 8.413ms
       %910 = :_GroupedLinear [[32384, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.413ms
         %911 = :nvte_quantize_v2 [] -> 218.176us
           %912 = :quantize_transpose_vector_blockwise [] -> 218.176us
                 -->kernel: 0:7 %1266 =  [] -> 218.176us
         %913 = :nvte_quantize_v2 [] -> 220.321us
           %914 = :quantize_transpose_vector_blockwise [] -> 220.321us
                 -->kernel: 0:7 %1267 =  [] -> 220.321us
         %915 = :nvte_quantize_v2 [] -> 219.104us
           %916 = :quantize_transpose_vector_blockwise [] -> 219.104us
                 -->kernel: 0:7 %1268 =  [] -> 219.104us
         %917 = :nvte_quantize_v2 [] -> 218.369us
           %918 = :quantize_transpose_vector_blockwise [] -> 218.369us
                 -->kernel: 0:7 %1269 =  [] -> 218.369us
         %919 = :nvte_quantize_v2 [] -> 46.208us
           %920 = :quantize_transpose_square_blockwise [] -> 46.208us
                 -->kernel: 0:7 %1270 =  [] -> 46.208us
         %921 = :nvte_quantize_v2 [] -> 45.632us
           %922 = :quantize_transpose_square_blockwise [] -> 45.632us
                 -->kernel: 0:7 %1271 =  [] -> 45.632us
         %923 = :nvte_quantize_v2 [] -> 46.593us
           %924 = :quantize_transpose_square_blockwise [] -> 46.593us
                 -->kernel: 0:7 %1272 =  [] -> 46.593us
         %925 = :nvte_quantize_v2 [] -> 46.016us
           %926 = :quantize_transpose_square_blockwise [] -> 46.016us
                 -->kernel: 0:7 %1273 =  [] -> 46.016us
         %927 = :nvte_multi_stream_cublas_gemm [] -> 7.045ms
           %928 = :nvte_cublas_gemm [] -> 1.706ms
                 -->kernel: 0:159 %1274 =  [] -> 1.697ms
           %929 = :nvte_cublas_gemm [] -> 1.758ms
                 -->kernel: 0:160 %1275 =  [] -> 1.752ms
           %930 = :nvte_cublas_gemm [] -> 1.756ms
                 -->kernel: 0:161 %1276 =  [] -> 1.752ms
           %931 = :nvte_cublas_gemm [] -> 1.758ms
                 -->kernel: 0:162 %1277 =  [] -> 1.753ms
     %932 = :WeightedSwiGLUFunction [[32384, 4096], [32384, 1], []] -> 119.712us
       %933 = :Torch-Compiled Region: 3/1 None -> 119.712us
         %934 = :triton_poi_fused__to_copy_mul_silu_0 [[32384, 4096], [32384, 1], [32384, 2048], [], []] -> 119.712us
                 -->kernel: 0:7 %1278 =  [] -> 119.712us
     %935 = :TERowParallelGroupedLinear forward [] -> 4.214ms
       %936 = :_GroupedLinear [[32384, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.214ms
         %937 = :nvte_quantize_v2 [] -> 66.209us
           %938 = :quantize_transpose_vector_blockwise [] -> 66.209us
                 -->kernel: 0:7 %1279 =  [] -> 66.209us
         %939 = :nvte_quantize_v2 [] -> 68.800us
           %940 = :quantize_transpose_vector_blockwise [] -> 68.800us
                 -->kernel: 0:7 %1280 =  [] -> 68.800us
         %941 = :nvte_quantize_v2 [] -> 67.520us
           %942 = :quantize_transpose_vector_blockwise [] -> 67.520us
                 -->kernel: 0:7 %1281 =  [] -> 67.520us
         %943 = :nvte_quantize_v2 [] -> 67.904us
           %944 = :quantize_transpose_vector_blockwise [] -> 67.904us
                 -->kernel: 0:7 %1282 =  [] -> 67.904us
         %945 = :nvte_quantize_v2 [] -> 24.416us
           %946 = :quantize_transpose_square_blockwise [] -> 24.416us
                 -->kernel: 0:7 %1283 =  [] -> 24.416us
         %947 = :nvte_quantize_v2 [] -> 24.352us
           %948 = :quantize_transpose_square_blockwise [] -> 24.352us
                 -->kernel: 0:7 %1284 =  [] -> 24.352us
         %949 = :nvte_quantize_v2 [] -> 24.576us
           %950 = :quantize_transpose_square_blockwise [] -> 24.576us
                 -->kernel: 0:7 %1285 =  [] -> 24.576us
         %951 = :nvte_quantize_v2 [] -> 24.672us
           %952 = :quantize_transpose_square_blockwise [] -> 24.672us
                 -->kernel: 0:7 %1286 =  [] -> 24.672us
         %953 = :nvte_multi_stream_cublas_gemm [] -> 3.562ms
           %954 = :nvte_cublas_gemm [] -> 870.562us
                 -->kernel: 0:159 %1287 =  [] -> 863.106us
           %955 = :nvte_cublas_gemm [] -> 877.602us
                 -->kernel: 0:160 %1288 =  [] -> 873.090us
           %956 = :nvte_cublas_gemm [] -> 876.290us
                 -->kernel: 0:161 %1289 =  [] -> 872.674us
           %957 = :nvte_cublas_gemm [] -> 876.514us
                 -->kernel: 0:162 %1290 =  [] -> 873.058us
     %958 = :_moe_unpermute_mask_map [[32384, 7168], [15641, 9], [], []] -> 224.192us
                 -->kernel: 0:7 %1291 =  [] -> 224.192us
     %959 = :FusedCombine [[15641, 7168], [], []] -> 746.082us
                 -->kernel: 0:26 %1292 =  [] -> 13.984us
                 -->kernel: 0:26 %1293 =  [] -> 702.466us
     %960 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.384us
                 -->kernel: 0:7 %1294 =  [] -> 52.384us
     %961 = :Torch-Compiled Region: 1/2 None -> 47.776us
       %962 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 47.776us
         %963 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 47.776us
                 -->kernel: 0:7 %1295 =  [] -> 47.776us
     %964 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 125.984us
       %965 = :nvte_rmsnorm_fwd [] -> 125.984us
                 -->kernel: 0:7 %1296 =  [] -> 125.984us
     %966 = :aten::roll [[1, 4096], [], []] -> 2.208us
                 -->kernel: 0:7 %1297 =  [] -> 2.208us
     %967 = :aten::fill_ [[1], []] -> 1.024us
                 -->kernel: 0:7 %1298 =  [] -> 1.024us
     %968 = :aten::sum [[1, 4096], []] -> 3.264us
       %969 = :aten::sum [[1, 4096], [], [], []] -> 3.264us
                 -->kernel: 0:7 %1299 =  [] -> 3.264us
     %970 = :aten::roll [[1, 4096], [], []] -> 2.304us
                 -->kernel: 0:7 %1300 =  [] -> 2.304us
     %971 = :aten::fill_ [[1], []] -> 1.248us
                 -->kernel: 0:7 %1301 =  [] -> 1.248us
     %972 = :aten::sum [[1, 4096], []] -> 3.008us
       %973 = :aten::sum [[1, 4096], [], [], []] -> 3.008us
                 -->kernel: 0:7 %1302 =  [] -> 3.008us
     %974 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 276.608us
       %975 = :aten::index_select [[129280, 7168], [], [4096]] -> 276.608us
                 -->kernel: 0:7 %1303 =  [] -> 276.608us
     %976 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 128.769us
       %977 = :nvte_rmsnorm_fwd [] -> 128.769us
                 -->kernel: 0:7 %1304 =  [] -> 128.769us
     %978 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.560us
       %979 = :nvte_rmsnorm_fwd [] -> 126.560us
                 -->kernel: 0:7 %1305 =  [] -> 126.560us
     %980 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 163.776us
                 -->kernel: 0:7 %1306 =  [] -> 163.776us
     %981 = :TEColumnParallelLinear forward [] -> 3.445ms
       %982 = :_Linear [[7168, 14336], [4096, 1, 14336], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.445ms
         %983 = :nvte_quantize_v2 [] -> 145.505us
           %984 = :quantize_transpose_vector_blockwise [] -> 145.505us
                 -->kernel: 0:7 %1307 =  [] -> 145.505us
         %985 = :nvte_quantize_v2 [] -> 153.888us
           %986 = :quantize_transpose_square_blockwise [] -> 153.888us
                 -->kernel: 0:7 %1308 =  [] -> 153.888us
         %987 = :nvte_cublas_gemm_scaled [] -> 3.019ms
                 -->kernel: 0:7 %1309 =  [] -> 3.012ms
     %988 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 121.184us
       %989 = :nvte_rmsnorm_fwd [] -> 121.184us
                 -->kernel: 0:7 %1310 =  [] -> 121.184us
     %990 = :TELinear forward [] -> 563.361us
       %991 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 563.361us
         %992 = :nvte_quantize_v2 [] -> 73.280us
           %993 = :quantize_transpose_vector_blockwise [] -> 73.280us
                 -->kernel: 0:7 %1311 =  [] -> 73.280us
         %994 = :nvte_quantize_v2 [] -> 20.032us
           %995 = :quantize_transpose_square_blockwise [] -> 20.032us
                 -->kernel: 0:7 %1312 =  [] -> 20.032us
         %996 = :nvte_cublas_gemm_scaled [] -> 336.897us
                 -->kernel: 0:7 %1313 =  [] -> 329.505us
     %997 = :TELinear forward [] -> 397.664us
       %998 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 397.664us
         %999 = :nvte_quantize_v2 [] -> 73.248us
           %1000 = :quantize_transpose_vector_blockwise [] -> 73.248us
                 -->kernel: 0:7 %1314 =  [] -> 73.248us
         %1001 = :nvte_quantize_v2 [] -> 11.584us
           %1002 = :quantize_transpose_square_blockwise [] -> 11.584us
                 -->kernel: 0:7 %1315 =  [] -> 11.584us
         %1003 = :nvte_cublas_gemm_scaled [] -> 203.424us
                 -->kernel: 0:7 %1316 =  [] -> 197.152us
     %1004 = :TELayerNormColumnParallelLinear forward [] -> 1.377ms
       %1005 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.377ms
         %1006 = :nvte_rmsnorm_fwd [] -> 30.176us
                 -->kernel: 0:7 %1317 =  [] -> 30.176us
         %1007 = :nvte_quantize_v2 [] -> 17.184us
           %1008 = :quantize_transpose_vector_blockwise [] -> 17.184us
                 -->kernel: 0:7 %1318 =  [] -> 17.184us
         %1009 = :nvte_quantize_v2 [] -> 58.913us
           %1010 = :quantize_transpose_square_blockwise [] -> 58.913us
                 -->kernel: 0:7 %1319 =  [] -> 58.913us
         %1011 = :nvte_cublas_gemm_scaled [] -> 1.138ms
                 -->kernel: 0:7 %1320 =  [] -> 1.132ms
     %1012 = :TELayerNormColumnParallelLinear forward [] -> 892.546us
       %1013 = :aten::contiguous [[4096, 1, 512], []] -> 11.584us
         %1014 = :aten::clone [[4096, 1, 512], []] -> 11.584us
           %1015 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.584us
                 -->kernel: 0:7 %1321 =  [] -> 11.584us
       %1016 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 694.466us
         %1017 = :nvte_rmsnorm_fwd [] -> 4.288us
                 -->kernel: 0:7 %1322 =  [] -> 4.288us
         %1018 = :nvte_quantize_v2 [] -> 7.808us
           %1019 = :quantize_transpose_vector_blockwise [] -> 7.808us
                 -->kernel: 0:7 %1323 =  [] -> 7.808us
         %1020 = :nvte_quantize_v2 [] -> 28.544us
           %1021 = :quantize_transpose_square_blockwise [] -> 28.544us
                 -->kernel: 0:7 %1324 =  [] -> 28.544us
         %1022 = :nvte_cublas_gemm_scaled [] -> 525.185us
                 -->kernel: 0:7 %1325 =  [] -> 519.073us
     %1023 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.881us
                 -->kernel: 0:7 %1326 =  [] -> 114.881us
     %1024 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 173.857us
                 -->kernel: 0:7 %1327 =  [] -> 173.857us
     %1025 = :TEDotProductAttention forward [] -> 22.381ms
       %1026 = :aten::arange [[], [], [], [], []] -> 1.184us
         %1027 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %1328 =  [] -> 1.184us
       %1028 = :aten::arange [[], [], [], [], []] -> 1.152us
         %1029 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %1329 =  [] -> 1.152us
       %1030 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 61.697us
                 -->kernel: 0:7 %1330 =  [] -> 61.697us
       %1031 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 38.976us
                 -->kernel: 0:7 %1331 =  [] -> 38.976us
       %1032 = :aten::add [[1, 1, 4096, 4096], [], []] -> 39.264us
                 -->kernel: 0:7 %1332 =  [] -> 39.264us
       %1033 = :aten::le [[1, 1, 4096, 4096], []] -> 28.032us
                 -->kernel: 0:7 %1333 =  [] -> 28.032us
       %1034 = :aten::lt [[1, 1, 4096, 4096], []] -> 25.184us
                 -->kernel: 0:7 %1334 =  [] -> 25.184us
       %1035 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.400us
                 -->kernel: 0:7 %1335 =  [] -> 14.400us
       %1036 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.232us
         %1037 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.232us
                 -->kernel: 0:7 %1336 =  [] -> 19.232us
       %1038 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.992us
         %1039 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.992us
                 -->kernel: 0:7 %1337 =  [] -> 12.992us
       %1040 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.400us
         %1041 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.400us
                 -->kernel: 0:7 %1338 =  [] -> 18.400us
       %1042 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.838ms
                 -->kernel: 0:7 %1339 =  [] -> 5.830ms
       %1043 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.003ms
         %1044 = :nvte_scaled_masked_softmax_forward [] -> 11.003ms
                 -->kernel: 0:7 %1340 =  [] -> 11.003ms
       %1045 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.993ms
                 -->kernel: 0:7 %1341 =  [] -> 3.980ms
       %1046 = :aten::contiguous [[4096, 1, 128, 128], []] -> 279.489us
         %1047 = :aten::clone [[4096, 1, 128, 128], []] -> 279.489us
           %1048 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 279.489us
                 -->kernel: 0:7 %1342 =  [] -> 279.489us
     %1049 = :TERowParallelLinear forward [] -> 3.855ms
       %1050 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.855ms
         %1051 = :nvte_quantize_v2 [] -> 97.217us
           %1052 = :quantize_transpose_vector_blockwise [] -> 97.217us
                 -->kernel: 0:7 %1343 =  [] -> 97.217us
         %1053 = :nvte_quantize_v2 [] -> 171.872us
           %1054 = :quantize_transpose_square_blockwise [] -> 171.872us
                 -->kernel: 0:7 %1344 =  [] -> 171.872us
         %1055 = :nvte_cublas_gemm_scaled [] -> 3.436ms
                 -->kernel: 0:7 %1345 =  [] -> 3.429ms
     %1056 = :Torch-Compiled Region: 1/2 None -> 44.960us
       %1057 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.960us
         %1058 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.960us
                 -->kernel: 0:7 %1346 =  [] -> 44.960us
     %1059 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.689us
       %1060 = :nvte_rmsnorm_fwd [] -> 126.689us
                 -->kernel: 0:7 %1347 =  [] -> 126.689us
     %1061 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 42.176us
       %1062 = :nvte_cublas_gemm_scaled [] -> 42.176us
                 -->kernel: 0:7 %1348 =  [] -> 22.336us
                 -->kernel: 0:7 %1349 =  [] -> 2.592us
     %1063 = :RandomSTE [[4096, 1, 32]] -> 41.088us
       %1064 = :aten::clone [[4096, 1, 32], []] -> 1.600us
         %1065 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.600us
       %1066 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.864us
                 -->kernel: 0:7 %1350 =  [] -> 4.864us
     %1067 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 69.856us
       %1068 = :nvte_fused_topk_with_score_function_forward [] -> 69.856us
                 -->kernel: 0:7 %1351 =  [] -> 69.856us
     %1069 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 27.232us
       %1070 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 27.232us
                 -->kernel: 0:7 %1352 =  [] -> 27.232us
     %1071 = :aten::sum [[4096, 32], [], [], []] -> 45.440us
       %1072 = :aten::to [[4096, 32], [], [], [], []] -> 4.928us
         %1073 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.928us
           %1074 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.928us
                 -->kernel: 0:7 %1353 =  [] -> 4.928us
                 -->kernel: 0:7 %1354 =  [] -> 10.048us
     %1075 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.513us
       %1076 = :nvte_fused_moe_aux_loss_forward [] -> 12.513us
                 -->kernel: 0:7 %1355 =  [] -> 12.513us
     %1077 = :aten::div [[], []] -> 1.600us
                 -->kernel: 0:7 %1356 =  [] -> 1.600us
     %1078 = :aten::div [[], []] -> 1.280us
                 -->kernel: 0:7 %1357 =  [] -> 1.280us
     %1079 = :aten::add_ [[], [], []] -> 1.408us
                 -->kernel: 0:7 %1358 =  [] -> 1.408us
     %1080 = :aten::sum [[4096, 32], [], [], []] -> 37.248us
       %1081 = :aten::to [[4096, 32], [], [], [], []] -> 4.768us
         %1082 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.768us
           %1083 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.768us
                 -->kernel: 0:7 %1359 =  [] -> 4.768us
                 -->kernel: 0:7 %1360 =  [] -> 7.712us
     %1084 = :aten::add_ [[32], [32], []] -> 4.384us
                 -->kernel: 0:7 %1361 =  [] -> 4.384us
     %1085 = :aten::topk [[4096, 32], [], [], [], []] -> 51.200us
                 -->kernel: 0:7 %1362 =  [] -> 13.984us
                 -->kernel: 0:7 %1363 =  [] -> 7.776us
     %1086 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 850.210us
                 -->kernel: 0:26 %1364 =  [] -> 44.064us
                 -->kernel: 0:26 %1365 =  [] -> 12.640us
                 -->kernel: 0:26 %1366 =  [] -> 670.817us
     %1087 = :TEColumnParallelLinear forward [] -> 1.166ms
       %1088 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.166ms
         %1089 = :nvte_quantize_v2 [] -> 46.048us
           %1090 = :quantize_transpose_vector_blockwise [] -> 46.048us
                 -->kernel: 0:7 %1367 =  [] -> 46.048us
         %1091 = :nvte_quantize_v2 [] -> 44.832us
           %1092 = :quantize_transpose_square_blockwise [] -> 44.832us
                 -->kernel: 0:7 %1368 =  [] -> 44.832us
         %1093 = :nvte_cublas_gemm_scaled [] -> 921.954us
                 -->kernel: 0:7 %1369 =  [] -> 915.298us
     %1094 = :SwiGLUFunction [[4096, 4096], [], []] -> 27.552us
       %1095 = :Torch-Compiled Region: 2/1 None -> 27.552us
         %1096 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 27.552us
                 -->kernel: 0:7 %1370 =  [] -> 27.552us
     %1097 = :TERowParallelLinear forward [] -> 610.978us
       %1098 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 610.978us
         %1099 = :nvte_quantize_v2 [] -> 23.264us
           %1100 = :quantize_transpose_vector_blockwise [] -> 23.264us
                 -->kernel: 0:7 %1371 =  [] -> 23.264us
         %1101 = :nvte_quantize_v2 [] -> 24.448us
           %1102 = :quantize_transpose_square_blockwise [] -> 24.448us
                 -->kernel: 0:7 %1372 =  [] -> 24.448us
         %1103 = :nvte_cublas_gemm_scaled [] -> 446.657us
                 -->kernel: 0:7 %1373 =  [] -> 440.641us
     %1104 = :IndicesToMultihot [[15831, 8], [15831, 8], []] -> 11.360us
                 -->kernel: 0:7 %1374 =  [] -> 11.360us
     %1105 = :aten::contiguous [[4, 15831], []] -> 3.008us
       %1106 = :aten::clone [[4, 15831], []] -> 3.008us
         %1107 = :aten::copy_ [[4, 15831], [4, 15831], []] -> 3.008us
                 -->kernel: 0:7 %1375 =  [] -> 3.008us
     %1108 = :aten::to [[4, 15831], [], [], [], []] -> 5.120us
       %1109 = :aten::_to_copy [[4, 15831], [], [], [], [], [], []] -> 5.120us
         %1110 = :aten::copy_ [[4, 15831], [4, 15831], []] -> 5.120us
                 -->kernel: 0:7 %1376 =  [] -> 5.120us
                 -->kernel: 0:7 %1377 =  [] -> 22.784us
     %1111 = :_moe_permute_mask_map [[15831, 7168], [15831, 4], [], [15831, 4]] -> 400.960us
                 -->kernel: 0:7 %1378 =  [] -> 1.984us
                 -->kernel: 0:7 %1379 =  [] -> 2.528us
                 -->kernel: 0:7 %1380 =  [] -> 13.504us
                 -->kernel: 0:7 %1381 =  [] -> 201.792us
     %1112 = :TEColumnParallelGroupedLinear forward [] -> 8.480ms
       %1113 = :_GroupedLinear [[32880, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.480ms
         %1114 = :nvte_quantize_v2 [] -> 224.193us
           %1115 = :quantize_transpose_vector_blockwise [] -> 224.193us
                 -->kernel: 0:7 %1382 =  [] -> 224.193us
         %1116 = :nvte_quantize_v2 [] -> 226.688us
           %1117 = :quantize_transpose_vector_blockwise [] -> 226.688us
                 -->kernel: 0:7 %1383 =  [] -> 226.688us
         %1118 = :nvte_quantize_v2 [] -> 219.873us
           %1119 = :quantize_transpose_vector_blockwise [] -> 219.873us
                 -->kernel: 0:7 %1384 =  [] -> 219.873us
         %1120 = :nvte_quantize_v2 [] -> 216.288us
           %1121 = :quantize_transpose_vector_blockwise [] -> 216.288us
                 -->kernel: 0:7 %1385 =  [] -> 216.288us
         %1122 = :nvte_quantize_v2 [] -> 45.472us
           %1123 = :quantize_transpose_square_blockwise [] -> 45.472us
                 -->kernel: 0:7 %1386 =  [] -> 45.472us
         %1124 = :nvte_quantize_v2 [] -> 45.344us
           %1125 = :quantize_transpose_square_blockwise [] -> 45.344us
                 -->kernel: 0:7 %1387 =  [] -> 45.344us
         %1126 = :nvte_quantize_v2 [] -> 45.984us
           %1127 = :quantize_transpose_square_blockwise [] -> 45.984us
                 -->kernel: 0:7 %1388 =  [] -> 45.984us
         %1128 = :nvte_quantize_v2 [] -> 46.112us
           %1129 = :quantize_transpose_square_blockwise [] -> 46.112us
                 -->kernel: 0:7 %1389 =  [] -> 46.112us
         %1130 = :nvte_multi_stream_cublas_gemm [] -> 7.110ms
           %1131 = :nvte_cublas_gemm [] -> 1.768ms
                 -->kernel: 0:159 %1390 =  [] -> 1.760ms
           %1132 = :nvte_cublas_gemm [] -> 1.817ms
                 -->kernel: 0:160 %1391 =  [] -> 1.812ms
           %1133 = :nvte_cublas_gemm [] -> 1.758ms
                 -->kernel: 0:161 %1392 =  [] -> 1.753ms
           %1134 = :nvte_cublas_gemm [] -> 1.701ms
                 -->kernel: 0:162 %1393 =  [] -> 1.697ms
     %1135 = :WeightedSwiGLUFunction [[32880, 4096], [32880, 1], []] -> 120.768us
       %1136 = :Torch-Compiled Region: 3/1 None -> 120.768us
         %1137 = :triton_poi_fused__to_copy_mul_silu_0 [[32880, 4096], [32880, 1], [32880, 2048], [], []] -> 120.768us
                 -->kernel: 0:7 %1394 =  [] -> 120.768us
     %1138 = :TERowParallelGroupedLinear forward [] -> 4.251ms
       %1139 = :_GroupedLinear [[32880, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.251ms
         %1140 = :nvte_quantize_v2 [] -> 68.096us
           %1141 = :quantize_transpose_vector_blockwise [] -> 68.096us
                 -->kernel: 0:7 %1395 =  [] -> 68.096us
         %1142 = :nvte_quantize_v2 [] -> 69.280us
           %1143 = :quantize_transpose_vector_blockwise [] -> 69.280us
                 -->kernel: 0:7 %1396 =  [] -> 69.280us
         %1144 = :nvte_quantize_v2 [] -> 68.480us
           %1145 = :quantize_transpose_vector_blockwise [] -> 68.480us
                 -->kernel: 0:7 %1397 =  [] -> 68.480us
         %1146 = :nvte_quantize_v2 [] -> 66.688us
           %1147 = :quantize_transpose_vector_blockwise [] -> 66.688us
                 -->kernel: 0:7 %1398 =  [] -> 66.688us
         %1148 = :nvte_quantize_v2 [] -> 23.936us
           %1149 = :quantize_transpose_square_blockwise [] -> 23.936us
                 -->kernel: 0:7 %1399 =  [] -> 23.936us
         %1150 = :nvte_quantize_v2 [] -> 24.896us
           %1151 = :quantize_transpose_square_blockwise [] -> 24.896us
                 -->kernel: 0:7 %1400 =  [] -> 24.896us
         %1152 = :nvte_quantize_v2 [] -> 24.992us
           %1153 = :quantize_transpose_square_blockwise [] -> 24.992us
                 -->kernel: 0:7 %1401 =  [] -> 24.992us
         %1154 = :nvte_quantize_v2 [] -> 24.192us
           %1155 = :quantize_transpose_square_blockwise [] -> 24.192us
                 -->kernel: 0:7 %1402 =  [] -> 24.192us
         %1156 = :nvte_multi_stream_cublas_gemm [] -> 3.601ms
           %1157 = :nvte_cublas_gemm [] -> 893.314us
                 -->kernel: 0:159 %1403 =  [] -> 886.210us
           %1158 = :nvte_cublas_gemm [] -> 903.778us
                 -->kernel: 0:160 %1404 =  [] -> 899.874us
           %1159 = :nvte_cublas_gemm [] -> 877.218us
                 -->kernel: 0:161 %1405 =  [] -> 872.866us
           %1160 = :nvte_cublas_gemm [] -> 865.090us
                 -->kernel: 0:162 %1406 =  [] -> 860.866us
     %1161 = :_moe_unpermute_mask_map [[32880, 7168], [15831, 9], [], []] -> 227.104us
                 -->kernel: 0:7 %1407 =  [] -> 227.104us
     %1162 = :FusedCombine [[15831, 7168], [], []] -> 734.849us
                 -->kernel: 0:26 %1408 =  [] -> 13.920us
                 -->kernel: 0:26 %1409 =  [] -> 694.017us
     %1163 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.224us
                 -->kernel: 0:7 %1410 =  [] -> 52.224us
     %1164 = :Torch-Compiled Region: 1/2 None -> 47.904us
       %1165 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 47.904us
         %1166 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 47.904us
                 -->kernel: 0:7 %1411 =  [] -> 47.904us
     %1167 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.816us
       %1168 = :nvte_rmsnorm_fwd [] -> 126.816us
                 -->kernel: 0:7 %1412 =  [] -> 126.816us
     %1169 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 164.609us
                 -->kernel: 0:7 %1413 =  [] -> 164.609us
     %1170 = :aten::clone [[1, 4096], []] -> 1.568us
       %1171 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.568us
     %1172 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.833ms
       %1173 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.833ms
         %1174 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.833ms
                 -->kernel: 0:7 %1414 =  [] -> 53.823ms
     %1175 = :aten::roll [[1, 4096], [], []] -> 2.240us
                 -->kernel: 0:7 %1415 =  [] -> 2.240us
     %1176 = :aten::fill_ [[1], []] -> 1.280us
                 -->kernel: 0:7 %1416 =  [] -> 1.280us
     %1177 = :aten::sum [[1, 4096], []] -> 3.232us
       %1178 = :aten::sum [[1, 4096], [], [], []] -> 3.232us
                 -->kernel: 0:7 %1417 =  [] -> 3.232us
     %1179 = :aten::roll [[1, 4096], [], []] -> 2.048us
                 -->kernel: 0:7 %1418 =  [] -> 2.048us
     %1180 = :aten::fill_ [[1], []] -> 1.280us
                 -->kernel: 0:7 %1419 =  [] -> 1.280us
     %1181 = :aten::sum [[1, 4096], []] -> 3.488us
       %1182 = :aten::sum [[1, 4096], [], [], []] -> 3.488us
                 -->kernel: 0:7 %1420 =  [] -> 3.488us
     %1183 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.478ms
       %1184 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %1185 = :aten::zero_ [[4096]] -> 1.120us
           %1186 = :aten::fill_ [[4096], []] -> 1.120us
                 -->kernel: 0:7 %1421 =  [] -> 1.120us
       %1187 = :aten::zeros [[], [], [], [], []] -> 1.216us
         %1188 = :aten::zero_ [[12288]] -> 1.216us
           %1189 = :aten::fill_ [[12288], []] -> 1.216us
                 -->kernel: 0:7 %1422 =  [] -> 1.216us
                 -->kernel: 0:7 %1423 =  [] -> 658.658us
                 -->kernel: 0:7 %1424 =  [] -> 601.281us
     %1190 = :aten::mul [[1, 4096], [1, 4096]] -> 1.600us
                 -->kernel: 0:7 %1425 =  [] -> 1.600us
     %1191 = :aten::sum [[1, 4096], []] -> 2.848us
       %1192 = :aten::sum [[1, 4096], [], [], []] -> 2.848us
                 -->kernel: 0:7 %1426 =  [] -> 2.848us
     %1193 = :aten::div [[], []] -> 1.920us
                 -->kernel: 0:7 %1427 =  [] -> 1.920us
     %1194 = :aten::add_ [[], [], []] -> 1.664us
                 -->kernel: 0:7 %1428 =  [] -> 1.664us
     %1195 = :aten::mul [[1, 4096], []] -> 1.280us
                 -->kernel: 0:7 %1429 =  [] -> 1.280us
     %1196 = :aten::div [[1, 4096], []] -> 2.304us
                 -->kernel: 0:7 %1430 =  [] -> 2.304us
     %1197 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.550ms
       %1198 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.550ms
         %1199 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.550ms
                 -->kernel: 0:7 %1431 =  [] -> 53.539ms
     %1200 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.486ms
       %1201 = :aten::zeros [[], [], [], [], []] -> 1.152us
         %1202 = :aten::zero_ [[4096]] -> 1.152us
           %1203 = :aten::fill_ [[4096], []] -> 1.152us
                 -->kernel: 0:7 %1432 =  [] -> 1.152us
       %1204 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %1205 = :aten::zero_ [[12288]] -> 1.120us
           %1206 = :aten::fill_ [[12288], []] -> 1.120us
                 -->kernel: 0:7 %1433 =  [] -> 1.120us
                 -->kernel: 0:7 %1434 =  [] -> 661.793us
                 -->kernel: 0:7 %1435 =  [] -> 599.234us
     %1207 = :aten::mul [[4096], [4096]] -> 1.792us
                 -->kernel: 0:7 %1436 =  [] -> 1.792us
     %1208 = :aten::sum [[4096], []] -> 3.040us
       %1209 = :aten::sum [[4096], [], [], []] -> 3.040us
                 -->kernel: 0:7 %1437 =  [] -> 3.040us
     %1210 = :aten::sum [[4096], []] -> 2.816us
       %1211 = :aten::sum [[4096], [], [], []] -> 2.816us
                 -->kernel: 0:7 %1438 =  [] -> 2.816us
     %1212 = :aten::stack [[], [], []] -> 2.400us
       %1213 = :aten::cat [[1], [1], []] -> 2.400us
                 -->kernel: 0:7 %1439 =  [] -> 2.400us
     %1214 = :aten::isnan [[2]] -> 1.888us
       %1215 = :aten::ne [[2], [2]] -> 1.888us
                 -->kernel: 0:7 %1440 =  [] -> 1.888us
     %1216 = :aten::any [[2]] -> 2.592us
                 -->kernel: 0:7 %1441 =  [] -> 2.592us
     %1217 = :aten::is_nonzero [[]] -> 3.232us
       %1218 = :aten::item [[]] -> 3.232us
         %1219 = :aten::_local_scalar_dense [[]] -> 3.232us
     %1220 = :aten::clone [[], []] -> 1.184us
       %1221 = :aten::copy_ [[], [], []] -> 1.184us
     %1222 = :aten::clone [[], []] -> 1.376us
       %1223 = :aten::copy_ [[], [], []] -> 1.376us
     %1224 = :aten::cat [[1], [1], []] -> 2.112us
                 -->kernel: 0:7 %1442 =  [] -> 2.112us
     %1225 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 336.000us
       %1226 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 336.000us
         %1227 = :nccl:all_reduce [[2]] -> 336.000us
           %1228 = NCCL:ncclAllReduce [] -> 336.000us
                 -->kernel: 0:7 %1443 =  [] -> 336.000us
     %1229 = :aten::div [[2], []] -> 1.152us
                 -->kernel: 0:7 %1444 =  [] -> 1.152us
     %1230 = :aten::div [[], []] -> 1.504us
                 -->kernel: 0:7 %1445 =  [] -> 1.504us
     %1231 = :aten::mul [[], []] -> 1.344us
                 -->kernel: 0:7 %1446 =  [] -> 1.344us
     %1232 = :aten::mul_ [[], []] -> 1.120us
                 -->kernel: 0:7 %1447 =  [] -> 1.120us
     %1233 = :aten::div_ [[], []] -> 1.120us
                 -->kernel: 0:7 %1448 =  [] -> 1.120us
     %1234 = :aten::ones [[], [], [], [], []] -> 1.152us
       %1235 = :aten::fill_ [[1], []] -> 1.152us
                 -->kernel: 0:7 %1449 =  [] -> 1.152us
     %1236 = :aten::mul [[1], [1]] -> 1.632us
                 -->kernel: 0:7 %1450 =  [] -> 1.632us
     %1237 = :aten::div [[1], []] -> 1.152us
                 -->kernel: 0:7 %1451 =  [] -> 1.152us
     %1238 = :aten::copy_ [[1], [1], []] -> 1.024us
     %1239 = :aten::ones [[], [], [], [], []] -> 1.184us
       %1240 = :aten::fill_ [[1], []] -> 1.184us
                 -->kernel: 0:7 %1452 =  [] -> 1.184us
     %1241 = :aten::mul [[1], [1]] -> 1.312us
                 -->kernel: 0:7 %1453 =  [] -> 1.312us
     %1242 = :aten::div [[1], []] -> 1.280us
                 -->kernel: 0:7 %1454 =  [] -> 1.280us
     %1243 = :aten::add_ [[], [], []] -> 1.312us
                 -->kernel: 0:7 %1455 =  [] -> 1.312us
     %1244 = :aten::mul [[1], []] -> 1.344us
                 -->kernel: 0:7 %1456 =  [] -> 1.344us
     %1245 = :aten::ones_like [[1], [], [], [], [], []] -> 1.184us
       %1246 = :aten::fill_ [[1], []] -> 1.184us
                 -->kernel: 0:7 %1457 =  [] -> 1.184us
     %1247 = :autograd::engine::evaluate_function: MulBackward0 None -> 107.041us
       %1248 = :MulBackward0 [[1]] -> 1.408us
         %1249 = :aten::mul [[1], [1]] -> 1.408us
                 -->kernel: 0:7 %1458 =  [] -> 1.408us
       %1250 = :aten::sum [[1], []] -> 2.464us
         %1251 = :aten::sum [[1], [], [], []] -> 2.464us
                 -->kernel: 0:7 %1459 =  [] -> 2.464us
     %1252 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.504us
       %1253 = :DivBackward0 [[]] -> 1.504us
         %1254 = :aten::div [[], []] -> 1.504us
                 -->kernel: 0:7 %1460 =  [] -> 1.504us
     %1255 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.344us
       %1256 = :MulBackward0 [[]] -> 1.344us
         %1257 = :aten::mul [[], []] -> 1.344us
                 -->kernel: 0:7 %1461 =  [] -> 1.344us
     %1258 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.120us
       %1259 = :MulBackward0 [[]] -> 1.120us
         %1260 = :aten::mul [[], []] -> 1.120us
                 -->kernel: 0:7 %1462 =  [] -> 1.120us
     %1261 = :autograd::engine::evaluate_function: SelectBackward0 None -> 59.584us
       %1262 = :SelectBackward0 [[]] -> 59.584us
         %1263 = :aten::select_backward [[], [], [], []] -> 59.584us
           %1264 = :aten::zeros [[], [], [], [], []] -> 992.000ns
             %1265 = :aten::zero_ [[2]] -> 992.000ns
               %1266 = :aten::fill_ [[2], []] -> 992.000ns
                 -->kernel: 0:7 %1463 =  [] -> 992.000ns
           %1267 = :aten::copy_ [[], [], []] -> 1.216us
     %1268 = :autograd::engine::evaluate_function: MulBackward0 None -> 2.048us
       %1269 = :MulBackward0 [[4096]] -> 2.048us
         %1270 = :aten::mul [[4096], [4096]] -> 2.048us
                 -->kernel: 0:7 %1464 =  [] -> 2.048us
     %1271 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 765.250us
       %1272 = :CrossEntropyFunctionBackward [[4096, 1]] -> 765.250us
         %1273 = :aten::to [[], [], [], [], [], []] -> 800.000ns
           %1274 = :aten::_to_copy [[], [], [], [], [], [], []] -> 800.000ns
             %1275 = :aten::copy_ [[], [], []] -> 800.000ns
                 -->kernel: 0:7 %1465 =  [] -> 598.402us
     %1276 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 109.439ms
       %1277 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.439ms
         %1278 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.792ms
           %1279 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.792ms
                 -->kernel: 0:7 %1466 =  [] -> 55.779ms
                 -->kernel: 0:7 %1467 =  [] -> 53.401ms
     %1280 = :autograd::engine::evaluate_function: MTPLossAutoScalerBackward None -> 66.881us
       %1281 = :MTPLossAutoScalerBackward [[4096, 1, 7168]] -> 66.881us
         %1282 = :aten::ones_like [[1, 4096], [], [], [], [], []] -> 1.120us
           %1283 = :aten::fill_ [[1, 4096], []] -> 1.120us
                 -->kernel: 0:7 %1468 =  [] -> 1.120us
         %1284 = :aten::mul [[1, 4096], [1]] -> 2.176us
                 -->kernel: 0:7 %1469 =  [] -> 2.176us
     %1285 = :autograd::engine::evaluate_function: DivBackward0 None -> 2.208us
       %1286 = :DivBackward0 [[1, 4096]] -> 2.208us
         %1287 = :aten::div [[1, 4096], []] -> 2.208us
                 -->kernel: 0:7 %1470 =  [] -> 2.208us
     %1288 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.376us
       %1289 = :MulBackward0 [[1, 4096]] -> 1.376us
         %1290 = :aten::mul [[1, 4096], []] -> 1.376us
                 -->kernel: 0:7 %1471 =  [] -> 1.376us
     %1291 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.792us
       %1292 = :MulBackward0 [[1, 4096]] -> 1.792us
         %1293 = :aten::mul [[1, 4096], [1, 4096]] -> 1.792us
                 -->kernel: 0:7 %1472 =  [] -> 1.792us
     %1294 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 756.322us
       %1295 = :CrossEntropyFunctionBackward [[4096, 1]] -> 756.322us
         %1296 = :aten::to [[], [], [], [], [], []] -> 832.000ns
           %1297 = :aten::_to_copy [[], [], [], [], [], [], []] -> 832.000ns
             %1298 = :aten::copy_ [[], [], []] -> 832.000ns
                 -->kernel: 0:7 %1473 =  [] -> 592.993us
     %1299 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 110.670ms
       %1300 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.179ms
         %1301 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.600ms
           %1302 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.600ms
                 -->kernel: 0:7 %1474 =  [] -> 55.589ms
                 -->kernel: 0:7 %1475 =  [] -> 53.344ms
       %1303 = :aten::add [[129280, 7168], [129280, 7168], []] -> 1.158ms
                 -->kernel: 0:35 %1476 =  [] -> 1.158ms
     %1304 = :autograd::engine::evaluate_function: SplitBackward0 None -> 164.192us
       %1305 = :SplitBackward0 [[4096, 1, 7168], [4096, 1, 7168]] -> 164.192us
         %1306 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 164.192us
                 -->kernel: 0:7 %1477 =  [] -> 164.192us
     %1307 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 206.016us
       %1308 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 206.016us
         %1309 = :nvte_rmsnorm_bwd [] -> 206.016us
                 -->kernel: 0:7 %1478 =  [] -> 166.784us
                 -->kernel: 0:7 %1479 =  [] -> 7.616us
     %1310 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %1311 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %1480 =  [] -> 1.600us
     %1312 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 957.155us
       %1313 = :FusedCombineBackward [[4096, 7168], []] -> 957.155us
                 -->kernel: 0:26 %1481 =  [] -> 117.441us
                 -->kernel: 0:26 %1482 =  [] -> 779.202us
     %1314 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 200.545us
       %1315 = :_moe_unpermute_mask_mapBackward [[15831, 7168]] -> 200.545us
                 -->kernel: 0:7 %1483 =  [] -> 200.545us
     %1316 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.579ms
       %1317 = :_GroupedLinearBackward [[32880, 7168]] -> 8.579ms
         %1318 = :_GroupedLinear_backward [] -> 8.579ms
           %1319 = :nvte_quantize_v2 [] -> 224.097us
             %1320 = :quantize_transpose_vector_blockwise [] -> 224.097us
                 -->kernel: 0:7 %1484 =  [] -> 224.097us
           %1321 = :nvte_quantize_v2 [] -> 225.953us
             %1322 = :quantize_transpose_vector_blockwise [] -> 225.953us
                 -->kernel: 0:7 %1485 =  [] -> 225.953us
           %1323 = :nvte_quantize_v2 [] -> 219.392us
             %1324 = :quantize_transpose_vector_blockwise [] -> 219.392us
                 -->kernel: 0:7 %1486 =  [] -> 219.392us
           %1325 = :nvte_quantize_v2 [] -> 216.065us
             %1326 = :quantize_transpose_vector_blockwise [] -> 216.065us
                 -->kernel: 0:7 %1487 =  [] -> 216.065us
           %1327 = :nvte_multi_stream_cublas_gemm [] -> 3.669ms
             %1328 = :nvte_cublas_gemm [] -> 920.546us
                 -->kernel: 0:159 %1488 =  [] -> 908.802us
             %1329 = :nvte_cublas_gemm [] -> 916.738us
                 -->kernel: 0:160 %1489 =  [] -> 910.562us
             %1330 = :nvte_cublas_gemm [] -> 913.250us
                 -->kernel: 0:161 %1490 =  [] -> 907.106us
             %1331 = :nvte_cublas_gemm [] -> 852.226us
                 -->kernel: 0:162 %1491 =  [] -> 847.681us
           %1332 = :nvte_multi_stream_cublas_gemm [] -> 3.671ms
             %1333 = :nvte_cublas_gemm [] -> 913.698us
                 -->kernel: 0:159 %1492 =  [] -> 905.186us
             %1334 = :nvte_cublas_gemm [] -> 921.762us
                 -->kernel: 0:160 %1493 =  [] -> 918.402us
             %1335 = :nvte_cublas_gemm [] -> 894.978us
                 -->kernel: 0:161 %1494 =  [] -> 891.810us
             %1336 = :nvte_cublas_gemm [] -> 881.762us
                 -->kernel: 0:162 %1495 =  [] -> 877.442us
     %1337 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 598.081us
       %1338 = :WeightedSwiGLUFunctionBackward [[32880, 2048]] -> 598.081us
         %1339 = :Torch-Compiled Region: 4/1 None -> 598.081us
           %1340 = :triton_poi_fused__to_copy_cat_0 [[32880, 2048], [32880, 1], [32880, 4096], [32880, 4096], [], []] -> 403.392us
                 -->kernel: 0:7 %1496 =  [] -> 403.392us
           %1341 = :triton_red_fused__to_copy_mul_silu_sum_1 [[32880, 4096], [32880, 2048], [32880, 1], [], [], [], []] -> 130.592us
                 -->kernel: 0:7 %1497 =  [] -> 130.592us
     %1342 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.821ms
       %1343 = :_GroupedLinearBackward [[32880, 4096]] -> 14.821ms
         %1344 = :_GroupedLinear_backward [] -> 14.821ms
           %1345 = :nvte_quantize_v2 [] -> 128.385us
             %1346 = :quantize_transpose_vector_blockwise [] -> 128.385us
                 -->kernel: 0:7 %1498 =  [] -> 128.385us
           %1347 = :nvte_quantize_v2 [] -> 134.080us
             %1348 = :quantize_transpose_vector_blockwise [] -> 134.080us
                 -->kernel: 0:7 %1499 =  [] -> 134.080us
           %1349 = :nvte_quantize_v2 [] -> 130.880us
             %1350 = :quantize_transpose_vector_blockwise [] -> 130.880us
                 -->kernel: 0:7 %1500 =  [] -> 130.880us
           %1351 = :nvte_quantize_v2 [] -> 127.009us
             %1352 = :quantize_transpose_vector_blockwise [] -> 127.009us
                 -->kernel: 0:7 %1501 =  [] -> 127.009us
           %1353 = :nvte_multi_stream_cublas_gemm [] -> 7.046ms
             %1354 = :nvte_cublas_gemm [] -> 1.759ms
                 -->kernel: 0:159 %1502 =  [] -> 1.752ms
             %1355 = :nvte_cublas_gemm [] -> 1.785ms
                 -->kernel: 0:160 %1503 =  [] -> 1.781ms
             %1356 = :nvte_cublas_gemm [] -> 1.722ms
                 -->kernel: 0:161 %1504 =  [] -> 1.719ms
             %1357 = :nvte_cublas_gemm [] -> 1.712ms
                 -->kernel: 0:162 %1505 =  [] -> 1.705ms
           %1358 = :nvte_multi_stream_cublas_gemm [] -> 6.984ms
             %1359 = :nvte_cublas_gemm [] -> 1.746ms
                 -->kernel: 0:159 %1506 =  [] -> 1.737ms
             %1360 = :nvte_cublas_gemm [] -> 1.769ms
                 -->kernel: 0:160 %1507 =  [] -> 1.765ms
             %1361 = :nvte_cublas_gemm [] -> 1.716ms
                 -->kernel: 0:161 %1508 =  [] -> 1.712ms
             %1362 = :nvte_cublas_gemm [] -> 1.687ms
                 -->kernel: 0:162 %1509 =  [] -> 1.683ms
     %1363 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 391.393us
       %1364 = :_moe_permute_mask_mapBackward [[32880, 7168], [], [32880]] -> 391.393us
         %1365 = :aten::zeros [[], [], [], [], []] -> 1.472us
           %1366 = :aten::zero_ [[15831, 9]] -> 1.472us
             %1367 = :aten::fill_ [[15831, 9], []] -> 1.472us
                 -->kernel: 0:7 %1510 =  [] -> 1.472us
                 -->kernel: 0:7 %1511 =  [] -> 213.632us
     %1368 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 99.713us
       %1369 = :IndicesToMultihotBackward [[], [15831, 4]] -> 99.713us
         %1370 = :aten::zeros [[], [], [], [], []] -> 1.568us
           %1371 = :aten::zero_ [[15831, 4]] -> 1.568us
             %1372 = :aten::fill_ [[15831, 4], []] -> 1.568us
                 -->kernel: 0:7 %1512 =  [] -> 1.568us
                 -->kernel: 0:7 %1513 =  [] -> 11.424us
     %1373 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.184ms
       %1374 = :_LinearBackward [[4096, 1, 7168]] -> 1.184ms
         %1375 = :_Linear_backward [] -> 1.184ms
           %1376 = :nvte_quantize_v2 [] -> 74.016us
             %1377 = :quantize_transpose_vector_blockwise [] -> 74.016us
                 -->kernel: 0:7 %1514 =  [] -> 74.016us
           %1378 = :nvte_cublas_gemm_scaled [] -> 470.113us
                 -->kernel: 0:7 %1515 =  [] -> 459.809us
           %1379 = :nvte_cublas_gemm_scaled [] -> 456.161us
                 -->kernel: 0:7 %1516 =  [] -> 450.433us
     %1380 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 47.392us
       %1381 = :SwiGLUFunctionBackward [[4096, 2048]] -> 47.392us
         %1382 = :Torch-Compiled Region: 5/0 None -> 47.392us
           %1383 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 47.392us
                 -->kernel: 0:7 %1517 =  [] -> 47.392us
     %1384 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.018ms
       %1385 = :_LinearBackward [[4096, 1, 4096]] -> 2.018ms
         %1386 = :_Linear_backward [] -> 2.018ms
           %1387 = :nvte_quantize_v2 [] -> 44.960us
             %1388 = :quantize_transpose_vector_blockwise [] -> 44.960us
                 -->kernel: 0:7 %1518 =  [] -> 44.960us
           %1389 = :nvte_quantize_v2 [] -> 52.672us
             %1390 = :quantize_transpose_vector_blockwise [] -> 52.672us
                 -->kernel: 0:7 %1519 =  [] -> 52.672us
           %1391 = :nvte_cublas_gemm_scaled [] -> 870.402us
                 -->kernel: 0:7 %1520 =  [] -> 864.642us
           %1392 = :nvte_cublas_gemm_scaled [] -> 869.026us
                 -->kernel: 0:7 %1521 =  [] -> 863.841us
     %1393 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 890.338us
       %1394 = :FusedDispatchBackward [[15831, 7168], [], [15831, 8], [], []] -> 890.338us
         %1395 = :aten::zeros [[], [], [], [], []] -> 1.536us
           %1396 = :aten::zero_ [[15831, 8]] -> 1.536us
             %1397 = :aten::fill_ [[15831, 8], []] -> 1.536us
                 -->kernel: 0:7 %1522 =  [] -> 1.536us
                 -->kernel: 0:26 %1523 =  [] -> 13.952us
                 -->kernel: 0:26 %1524 =  [] -> 676.354us
     %1398 = :autograd::engine::evaluate_function: TopkBackward0 None -> 63.008us
       %1399 = :TopkBackward0 [[4096, 8]] -> 63.008us
         %1400 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 63.008us
           %1401 = :aten::zeros [[], [], [], [], []] -> 992.000ns
             %1402 = :aten::zero_ [[4096, 32]] -> 992.000ns
               %1403 = :aten::fill_ [[4096, 32], []] -> 992.000ns
                 -->kernel: 0:7 %1525 =  [] -> 992.000ns
           %1404 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 8.928us
                 -->kernel: 0:7 %1526 =  [] -> 8.928us
     %1405 = :autograd::engine::evaluate_function: ViewBackward0 None -> 53.056us
       %1406 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 53.056us
                 -->kernel: 0:7 %1527 =  [] -> 53.056us
     %1407 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 88.832us
       %1408 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 37.824us
         %1409 = :aten::ones_like [[], [], [], [], [], []] -> 1.024us
           %1410 = :aten::fill_ [[], []] -> 1.024us
                 -->kernel: 0:7 %1528 =  [] -> 1.024us
         %1411 = :aten::mul [[], [1]] -> 1.856us
                 -->kernel: 0:7 %1529 =  [] -> 1.856us
       %1412 = :aten::sum [[1], []] -> 2.880us
         %1413 = :aten::sum [[1], [], [], []] -> 2.880us
                 -->kernel: 0:7 %1530 =  [] -> 2.880us
     %1414 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.248us
       %1415 = :DivBackward0 [[]] -> 1.248us
         %1416 = :aten::div [[], []] -> 1.248us
                 -->kernel: 0:7 %1531 =  [] -> 1.248us
     %1417 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.240us
       %1418 = :FusedAuxLossBackward [[]] -> 2.240us
         %1419 = :nvte_fused_moe_aux_loss_backward [] -> 2.240us
                 -->kernel: 0:7 %1532 =  [] -> 2.240us
     %1420 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 62.977us
       %1421 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 62.977us
         %1422 = :aten::zeros [[], [], [], [], []] -> 1.216us
           %1423 = :aten::zero_ [[4096, 32]] -> 1.216us
             %1424 = :aten::fill_ [[4096, 32], []] -> 1.216us
                 -->kernel: 0:7 %1533 =  [] -> 1.216us
         %1425 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.928us
                 -->kernel: 0:7 %1534 =  [] -> 12.928us
     %1426 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 98.816us
       %1427 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 56.896us
         %1428 = :aten::zeros [[], [], [], [], []] -> 1.184us
           %1429 = :aten::zero_ [[4096, 32]] -> 1.184us
             %1430 = :aten::fill_ [[4096, 32], []] -> 1.184us
                 -->kernel: 0:7 %1535 =  [] -> 1.184us
         %1431 = :nvte_fused_topk_with_score_function_backward [] -> 13.664us
                 -->kernel: 0:7 %1536 =  [] -> 13.664us
       %1432 = :aten::add [[4096, 32], [4096, 32], []] -> 1.632us
                 -->kernel: 0:7 %1537 =  [] -> 1.632us
     %1433 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 802.082us
       %1434 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 703.938us
         %1435 = :aten::to [[32, 7168], [], [], [], []] -> 6.592us
           %1436 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.592us
             %1437 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.592us
                 -->kernel: 0:7 %1538 =  [] -> 6.592us
         %1438 = :nvte_cublas_gemm_scaled [] -> 84.160us
                 -->kernel: 0:7 %1539 =  [] -> 67.840us
         %1439 = :aten::to [[4096, 7168], [], [], [], []] -> 176.480us
           %1440 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 176.480us
             %1441 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 176.480us
                 -->kernel: 0:7 %1540 =  [] -> 176.480us
         %1442 = :nvte_cublas_gemm_scaled [] -> 82.689us
                 -->kernel: 0:7 %1541 =  [] -> 82.689us
         %1443 = :aten::to [[4096, 7168], [], [], [], []] -> 43.680us
           %1444 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.680us
             %1445 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.680us
                 -->kernel: 0:7 %1542 =  [] -> 43.680us
         %1446 = :aten::to [[32, 7168], [], [], [], []] -> 2.144us
           %1447 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.144us
             %1448 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.144us
                 -->kernel: 0:7 %1543 =  [] -> 2.144us
       %1449 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.720us
                 -->kernel: 0:7 %1544 =  [] -> 50.720us
     %1450 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.112us
       %1451 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.112us
                 -->kernel: 0:35 %1545 =  [] -> 2.112us
     %1452 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 319.488us
       %1453 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 196.192us
         %1454 = :nvte_rmsnorm_bwd [] -> 196.192us
                 -->kernel: 0:7 %1546 =  [] -> 166.368us
                 -->kernel: 0:7 %1547 =  [] -> 7.968us
       %1455 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.232us
                 -->kernel: 0:7 %1548 =  [] -> 51.232us
     %1456 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.728us
       %1457 = :aten::add_ [[7168], [7168], []] -> 1.728us
                 -->kernel: 0:35 %1549 =  [] -> 1.728us
     %1458 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.281ms
       %1459 = :_LinearBackward [[4096, 1, 7168]] -> 7.281ms
         %1460 = :_Linear_backward [] -> 7.281ms
           %1461 = :nvte_quantize_v2 [] -> 73.280us
             %1462 = :quantize_transpose_vector_blockwise [] -> 73.280us
                 -->kernel: 0:7 %1550 =  [] -> 73.280us
           %1463 = :nvte_quantize_v2 [] -> 110.752us
             %1464 = :quantize_transpose_vector_blockwise [] -> 110.752us
                 -->kernel: 0:7 %1551 =  [] -> 110.752us
           %1465 = :nvte_cublas_gemm_scaled [] -> 3.442ms
                 -->kernel: 0:7 %1552 =  [] -> 3.436ms
           %1466 = :nvte_cublas_gemm_scaled [] -> 3.439ms
                 -->kernel: 0:7 %1553 =  [] -> 3.433ms
     %1467 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.914ms
       %1468 = :BmmBackward0 [[128, 4096, 128]] -> 7.914ms
         %1469 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.979ms
                 -->kernel: 0:7 %1554 =  [] -> 3.968ms
         %1470 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.881ms
                 -->kernel: 0:7 %1555 =  [] -> 3.873ms
     %1471 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.951ms
       %1472 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.951ms
         %1473 = :nvte_scaled_softmax_backward [] -> 6.951ms
                 -->kernel: 0:7 %1556 =  [] -> 6.951ms
     %1474 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.218ms
       %1475 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.218ms
         %1476 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.948ms
                 -->kernel: 0:7 %1557 =  [] -> 5.938ms
         %1477 = :aten::mul [[128, 4096, 192], []] -> 114.912us
           %1478 = :aten::mul [[128, 4096, 192], []] -> 114.912us
                 -->kernel: 0:7 %1558 =  [] -> 114.912us
         %1479 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.884ms
                 -->kernel: 0:7 %1559 =  [] -> 5.878ms
         %1480 = :aten::mul [[128, 192, 4096], []] -> 115.137us
           %1481 = :aten::mul [[128, 192, 4096], []] -> 115.137us
                 -->kernel: 0:7 %1560 =  [] -> 115.137us
     %1482 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.465ms
       %1483 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.465ms
         %1484 = :aten::contiguous [[4096, 1, 128, 192], []] -> 745.122us
           %1485 = :aten::clone [[4096, 1, 128, 192], []] -> 745.122us
             %1486 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 745.122us
                 -->kernel: 0:7 %1561 =  [] -> 745.122us
         %1487 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.801us
           %1488 = :aten::clone [[4096, 1, 128, 128], []] -> 280.801us
             %1489 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.801us
                 -->kernel: 0:7 %1562 =  [] -> 280.801us
                 -->kernel: 0:7 %1563 =  [] -> 173.057us
     %1490 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 643.777us
       %1491 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 643.777us
         %1492 = :aten::contiguous [[4096, 1, 128, 192], []] -> 422.689us
           %1493 = :aten::clone [[4096, 1, 128, 192], []] -> 422.689us
             %1494 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 422.689us
                 -->kernel: 0:7 %1564 =  [] -> 422.689us
                 -->kernel: 0:7 %1565 =  [] -> 118.592us
     %1495 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.738ms
       %1496 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.738ms
         %1497 = :_LayerNormLinear_backward [] -> 1.738ms
           %1498 = :nvte_quantize_v2 [] -> 323.905us
             %1499 = :quantize_transpose_vector_blockwise [] -> 323.905us
                 -->kernel: 0:7 %1566 =  [] -> 323.905us
           %1500 = :nvte_cublas_gemm_scaled [] -> 566.273us
                 -->kernel: 0:7 %1567 =  [] -> 519.201us
                 -->kernel: 0:7 %1568 =  [] -> 19.168us
           %1501 = :nvte_cublas_gemm_scaled [] -> 527.362us
                 -->kernel: 0:7 %1569 =  [] -> 521.218us
           %1502 = :nvte_rmsnorm_bwd [] -> 21.824us
                 -->kernel: 0:7 %1570 =  [] -> 6.496us
                 -->kernel: 0:7 %1571 =  [] -> 3.072us
     %1503 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.016us
       %1504 = :aten::add_ [[512], [512], []] -> 2.016us
                 -->kernel: 0:35 %1572 =  [] -> 2.016us
     %1505 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.804ms
       %1506 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.804ms
         %1507 = :_LayerNormLinear_backward [] -> 2.804ms
           %1508 = :nvte_quantize_v2 [] -> 243.104us
             %1509 = :quantize_transpose_vector_blockwise [] -> 243.104us
                 -->kernel: 0:7 %1573 =  [] -> 243.104us
           %1510 = :nvte_cublas_gemm_scaled [] -> 1.120ms
                 -->kernel: 0:7 %1574 =  [] -> 1.111ms
           %1511 = :nvte_cublas_gemm_scaled [] -> 1.121ms
                 -->kernel: 0:7 %1575 =  [] -> 1.116ms
           %1512 = :nvte_rmsnorm_bwd [] -> 55.552us
                 -->kernel: 0:7 %1576 =  [] -> 23.328us
                 -->kernel: 0:7 %1577 =  [] -> 20.672us
     %1513 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.048us
       %1514 = :aten::add_ [[1536], [1536], []] -> 2.048us
                 -->kernel: 0:35 %1578 =  [] -> 2.048us
     %1515 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 9.920us
       %1516 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 9.920us
         %1517 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 9.920us
                 -->kernel: 0:7 %1579 =  [] -> 9.920us
     %1518 = :autograd::engine::evaluate_function: _LinearBackward None -> 437.281us
       %1519 = :_LinearBackward [[4096, 1, 576]] -> 437.281us
         %1520 = :_Linear_backward [] -> 437.281us
           %1521 = :nvte_quantize_v2 [] -> 14.496us
             %1522 = :quantize_transpose_vector_blockwise [] -> 14.496us
                 -->kernel: 0:7 %1580 =  [] -> 14.496us
           %1523 = :nvte_cublas_gemm_scaled [] -> 147.776us
                 -->kernel: 0:7 %1581 =  [] -> 140.992us
           %1524 = :nvte_cublas_gemm_scaled [] -> 138.592us
                 -->kernel: 0:7 %1582 =  [] -> 133.280us
     %1525 = :autograd::engine::evaluate_function: _LinearBackward None -> 985.059us
       %1526 = :_LinearBackward [[4096, 1, 1536]] -> 819.970us
         %1527 = :_Linear_backward [] -> 819.970us
           %1528 = :nvte_quantize_v2 [] -> 18.496us
             %1529 = :quantize_transpose_vector_blockwise [] -> 18.496us
                 -->kernel: 0:7 %1583 =  [] -> 18.496us
           %1530 = :nvte_cublas_gemm_scaled [] -> 334.400us
                 -->kernel: 0:7 %1584 =  [] -> 328.448us
           %1531 = :nvte_cublas_gemm_scaled [] -> 342.496us
                 -->kernel: 0:7 %1585 =  [] -> 337.312us
       %1532 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.568us
                 -->kernel: 0:7 %1586 =  [] -> 49.568us
     %1533 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 324.705us
       %1534 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 195.905us
         %1535 = :nvte_rmsnorm_bwd [] -> 195.905us
                 -->kernel: 0:7 %1587 =  [] -> 164.416us
                 -->kernel: 0:7 %1588 =  [] -> 8.064us
       %1536 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.344us
                 -->kernel: 0:7 %1589 =  [] -> 49.344us
     %1537 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.536us
       %1538 = :aten::add_ [[7168], [7168], []] -> 1.536us
                 -->kernel: 0:35 %1590 =  [] -> 1.536us
     %1539 = :autograd::engine::evaluate_function: _LinearBackward None -> 6.205ms
       %1540 = :_LinearBackward [[4096, 1, 7168]] -> 6.205ms
         %1541 = :_Linear_backward [] -> 6.205ms
           %1542 = :nvte_quantize_v2 [] -> 72.545us
             %1543 = :quantize_transpose_vector_blockwise [] -> 72.545us
                 -->kernel: 0:7 %1591 =  [] -> 72.545us
           %1544 = :nvte_cublas_gemm_scaled [] -> 2.986ms
                 -->kernel: 0:7 %1592 =  [] -> 2.980ms
           %1545 = :nvte_cublas_gemm_scaled [] -> 3.001ms
                 -->kernel: 0:7 %1593 =  [] -> 2.995ms
     %1546 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 383.649us
       %1547 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 383.649us
         %1548 = :aten::contiguous [[4096, 1, 7168], []] -> 114.144us
           %1549 = :aten::clone [[4096, 1, 7168], []] -> 114.144us
             %1550 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 114.144us
                 -->kernel: 0:7 %1594 =  [] -> 114.144us
         %1551 = :nvte_rmsnorm_bwd [] -> 192.000us
                 -->kernel: 0:7 %1595 =  [] -> 165.728us
                 -->kernel: 0:7 %1596 =  [] -> 7.776us
     %1552 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.632us
       %1553 = :aten::add_ [[7168], [7168], []] -> 1.632us
                 -->kernel: 0:35 %1597 =  [] -> 1.632us
     %1554 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 373.344us
       %1555 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 373.344us
         %1556 = :aten::contiguous [[4096, 1, 7168], []] -> 115.744us
           %1557 = :aten::clone [[4096, 1, 7168], []] -> 115.744us
             %1558 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 115.744us
                 -->kernel: 0:7 %1598 =  [] -> 115.744us
         %1559 = :nvte_rmsnorm_bwd [] -> 190.912us
                 -->kernel: 0:7 %1599 =  [] -> 167.104us
                 -->kernel: 0:7 %1600 =  [] -> 7.712us
     %1560 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.536us
       %1561 = :aten::add_ [[7168], [7168], []] -> 1.536us
                 -->kernel: 0:35 %1601 =  [] -> 1.536us
     %1562 = :autograd::engine::evaluate_function: MakeViewlessTensorBackward None -> 51.104us
       %1563 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.104us
                 -->kernel: 0:7 %1602 =  [] -> 51.104us
     %1564 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 1.417ms
       %1565 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.417ms
         %1566 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.417ms
           %1567 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.417ms
             %1568 = :aten::arange [[], [], [], [], []] -> 1.184us
               %1569 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %1603 =  [] -> 1.184us
             %1570 = CCCL:cub::DeviceRadixSort [] -> 188.289us
                 -->kernel: 0:7 %1604 =  [] -> 3.584us
                 -->kernel: 0:7 %1605 =  [] -> 1.568us
                 -->kernel: 0:7 %1606 =  [] -> 7.648us
                 -->kernel: 0:7 %1607 =  [] -> 7.424us
                 -->kernel: 0:7 %1608 =  [] -> 7.232us
                 -->kernel: 0:7 %1609 =  [] -> 7.040us
                 -->kernel: 0:7 %1610 =  [] -> 6.880us
                 -->kernel: 0:7 %1611 =  [] -> 7.072us
                 -->kernel: 0:7 %1612 =  [] -> 7.008us
                 -->kernel: 0:7 %1613 =  [] -> 6.784us
             %1571 = :aten::zeros [[], [], [], [], []] -> 544.673us
               %1572 = :aten::zero_ [[129280, 7168]] -> 544.673us
                 %1573 = :aten::fill_ [[129280, 7168], []] -> 544.673us
                 -->kernel: 0:7 %1614 =  [] -> 544.673us
             %1574 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 17.280us
                 -->kernel: 0:7 %1615 =  [] -> 1.472us
                 -->kernel: 0:7 %1616 =  [] -> 4.256us
                 -->kernel: 0:7 %1617 =  [] -> 1.664us
             %1575 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 17.728us
                 -->kernel: 0:7 %1618 =  [] -> 1.184us
                 -->kernel: 0:7 %1619 =  [] -> 3.008us
                 -->kernel: 0:7 %1620 =  [] -> 1.568us
                 -->kernel: 0:7 %1621 =  [] -> 1.728us
                 -->kernel: 0:7 %1622 =  [] -> 239.713us
                 -->kernel: 0:7 %1623 =  [] -> 192.064us
     %1576 = :autograd::engine::evaluate_function: SplitBackward0 None -> 34.368us
       %1577 = :SplitBackward0 [[4096, 1, 7168]] -> 34.368us
         %1578 = :aten::cat [[4096, 1, 7168], []] -> 34.368us
     %1579 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 193.889us
       %1580 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 193.889us
         %1581 = :nvte_rmsnorm_bwd [] -> 193.889us
                 -->kernel: 0:7 %1624 =  [] -> 167.072us
                 -->kernel: 0:7 %1625 =  [] -> 7.777us
     %1582 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %1583 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %1626 =  [] -> 1.600us
     %1584 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 931.395us
       %1585 = :FusedCombineBackward [[4096, 7168], []] -> 931.395us
                 -->kernel: 0:26 %1627 =  [] -> 118.273us
                 -->kernel: 0:26 %1628 =  [] -> 761.314us
     %1586 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 197.825us
       %1587 = :_moe_unpermute_mask_mapBackward [[15641, 7168]] -> 197.825us
                 -->kernel: 0:7 %1629 =  [] -> 197.825us
     %1588 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.420ms
       %1589 = :_GroupedLinearBackward [[32384, 7168]] -> 8.420ms
         %1590 = :_GroupedLinear_backward [] -> 8.420ms
           %1591 = :nvte_quantize_v2 [] -> 216.577us
             %1592 = :quantize_transpose_vector_blockwise [] -> 216.577us
                 -->kernel: 0:7 %1630 =  [] -> 216.577us
           %1593 = :nvte_quantize_v2 [] -> 218.944us
             %1594 = :quantize_transpose_vector_blockwise [] -> 218.944us
                 -->kernel: 0:7 %1631 =  [] -> 218.944us
           %1595 = :nvte_quantize_v2 [] -> 218.017us
             %1596 = :quantize_transpose_vector_blockwise [] -> 218.017us
                 -->kernel: 0:7 %1632 =  [] -> 218.017us
           %1597 = :nvte_quantize_v2 [] -> 217.952us
             %1598 = :quantize_transpose_vector_blockwise [] -> 217.952us
                 -->kernel: 0:7 %1633 =  [] -> 217.952us
           %1599 = :nvte_multi_stream_cublas_gemm [] -> 3.644ms
             %1600 = :nvte_cublas_gemm [] -> 853.217us
                 -->kernel: 0:159 %1634 =  [] -> 843.553us
             %1601 = :nvte_cublas_gemm [] -> 909.346us
                 -->kernel: 0:160 %1635 =  [] -> 904.258us
             %1602 = :nvte_cublas_gemm [] -> 908.866us
                 -->kernel: 0:161 %1636 =  [] -> 904.098us
             %1603 = :nvte_cublas_gemm [] -> 910.370us
                 -->kernel: 0:162 %1637 =  [] -> 904.482us
           %1604 = :nvte_multi_stream_cublas_gemm [] -> 3.613ms
             %1605 = :nvte_cublas_gemm [] -> 881.506us
                 -->kernel: 0:159 %1638 =  [] -> 874.594us
             %1606 = :nvte_cublas_gemm [] -> 892.290us
                 -->kernel: 0:160 %1639 =  [] -> 888.290us
             %1607 = :nvte_cublas_gemm [] -> 891.970us
                 -->kernel: 0:161 %1640 =  [] -> 888.450us
             %1608 = :nvte_cublas_gemm [] -> 891.202us
                 -->kernel: 0:162 %1641 =  [] -> 888.066us
     %1609 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 583.009us
       %1610 = :WeightedSwiGLUFunctionBackward [[32384, 2048]] -> 583.009us
         %1611 = :Torch-Compiled Region: 4/1 None -> 583.009us
           %1612 = :triton_poi_fused__to_copy_cat_0 [[32384, 2048], [32384, 1], [32384, 4096], [32384, 4096], [], []] -> 395.521us
                 -->kernel: 0:7 %1642 =  [] -> 395.521us
           %1613 = :triton_red_fused__to_copy_mul_silu_sum_1 [[32384, 4096], [32384, 2048], [32384, 1], [], [], [], []] -> 128.448us
                 -->kernel: 0:7 %1643 =  [] -> 128.448us
     %1614 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.569ms
       %1615 = :_GroupedLinearBackward [[32384, 4096]] -> 14.569ms
         %1616 = :_GroupedLinear_backward [] -> 14.569ms
           %1617 = :nvte_quantize_v2 [] -> 122.336us
             %1618 = :quantize_transpose_vector_blockwise [] -> 122.336us
                 -->kernel: 0:7 %1644 =  [] -> 122.336us
           %1619 = :nvte_quantize_v2 [] -> 129.376us
             %1620 = :quantize_transpose_vector_blockwise [] -> 129.376us
                 -->kernel: 0:7 %1645 =  [] -> 129.376us
           %1621 = :nvte_quantize_v2 [] -> 128.640us
             %1622 = :quantize_transpose_vector_blockwise [] -> 128.640us
                 -->kernel: 0:7 %1646 =  [] -> 128.640us
           %1623 = :nvte_quantize_v2 [] -> 128.800us
             %1624 = :quantize_transpose_vector_blockwise [] -> 128.800us
                 -->kernel: 0:7 %1647 =  [] -> 128.800us
           %1625 = :nvte_multi_stream_cublas_gemm [] -> 6.920ms
             %1626 = :nvte_cublas_gemm [] -> 1.710ms
                 -->kernel: 0:159 %1648 =  [] -> 1.702ms
             %1627 = :nvte_cublas_gemm [] -> 1.714ms
                 -->kernel: 0:160 %1649 =  [] -> 1.710ms
             %1628 = :nvte_cublas_gemm [] -> 1.713ms
                 -->kernel: 0:161 %1650 =  [] -> 1.709ms
             %1629 = :nvte_cublas_gemm [] -> 1.714ms
                 -->kernel: 0:162 %1651 =  [] -> 1.709ms
           %1630 = :nvte_multi_stream_cublas_gemm [] -> 6.868ms
             %1631 = :nvte_cublas_gemm [] -> 1.683ms
                 -->kernel: 0:159 %1652 =  [] -> 1.676ms
             %1632 = :nvte_cublas_gemm [] -> 1.711ms
                 -->kernel: 0:160 %1653 =  [] -> 1.707ms
             %1633 = :nvte_cublas_gemm [] -> 1.706ms
                 -->kernel: 0:161 %1654 =  [] -> 1.703ms
             %1634 = :nvte_cublas_gemm [] -> 1.708ms
                 -->kernel: 0:162 %1655 =  [] -> 1.704ms
     %1635 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 384.417us
       %1636 = :_moe_permute_mask_mapBackward [[32384, 7168], [], [32384]] -> 384.417us
         %1637 = :aten::zeros [[], [], [], [], []] -> 1.376us
           %1638 = :aten::zero_ [[15641, 9]] -> 1.376us
             %1639 = :aten::fill_ [[15641, 9], []] -> 1.376us
                 -->kernel: 0:7 %1656 =  [] -> 1.376us
                 -->kernel: 0:7 %1657 =  [] -> 210.337us
     %1640 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 98.208us
       %1641 = :IndicesToMultihotBackward [[], [15641, 4]] -> 98.208us
         %1642 = :aten::zeros [[], [], [], [], []] -> 1.408us
           %1643 = :aten::zero_ [[15641, 4]] -> 1.408us
             %1644 = :aten::fill_ [[15641, 4], []] -> 1.408us
                 -->kernel: 0:7 %1658 =  [] -> 1.408us
                 -->kernel: 0:7 %1659 =  [] -> 11.520us
     %1645 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.157ms
       %1646 = :_LinearBackward [[4096, 1, 7168]] -> 1.157ms
         %1647 = :_Linear_backward [] -> 1.157ms
           %1648 = :nvte_quantize_v2 [] -> 73.089us
             %1649 = :quantize_transpose_vector_blockwise [] -> 73.089us
                 -->kernel: 0:7 %1660 =  [] -> 73.089us
           %1650 = :nvte_cublas_gemm_scaled [] -> 464.161us
                 -->kernel: 0:7 %1661 =  [] -> 455.393us
           %1651 = :nvte_cublas_gemm_scaled [] -> 453.633us
                 -->kernel: 0:7 %1662 =  [] -> 447.425us
     %1652 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 46.752us
       %1653 = :SwiGLUFunctionBackward [[4096, 2048]] -> 46.752us
         %1654 = :Torch-Compiled Region: 5/0 None -> 46.752us
           %1655 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 46.752us
                 -->kernel: 0:7 %1663 =  [] -> 46.752us
     %1656 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.007ms
       %1657 = :_LinearBackward [[4096, 1, 4096]] -> 2.007ms
         %1658 = :_Linear_backward [] -> 2.007ms
           %1659 = :nvte_quantize_v2 [] -> 44.096us
             %1660 = :quantize_transpose_vector_blockwise [] -> 44.096us
                 -->kernel: 0:7 %1664 =  [] -> 44.096us
           %1661 = :nvte_quantize_v2 [] -> 52.193us
             %1662 = :quantize_transpose_vector_blockwise [] -> 52.193us
                 -->kernel: 0:7 %1665 =  [] -> 52.193us
           %1663 = :nvte_cublas_gemm_scaled [] -> 862.978us
                 -->kernel: 0:7 %1666 =  [] -> 857.058us
           %1664 = :nvte_cublas_gemm_scaled [] -> 863.266us
                 -->kernel: 0:7 %1667 =  [] -> 857.442us
     %1665 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 854.434us
       %1666 = :FusedDispatchBackward [[15641, 7168], [], [15641, 8], [], []] -> 854.434us
         %1667 = :aten::zeros [[], [], [], [], []] -> 1.376us
           %1668 = :aten::zero_ [[15641, 8]] -> 1.376us
             %1669 = :aten::fill_ [[15641, 8], []] -> 1.376us
                 -->kernel: 0:7 %1668 =  [] -> 1.376us
                 -->kernel: 0:26 %1669 =  [] -> 13.920us
                 -->kernel: 0:26 %1670 =  [] -> 680.001us
     %1670 = :autograd::engine::evaluate_function: TopkBackward0 None -> 57.537us
       %1671 = :TopkBackward0 [[4096, 8]] -> 57.537us
         %1672 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 57.537us
           %1673 = :aten::zeros [[], [], [], [], []] -> 960.000ns
             %1674 = :aten::zero_ [[4096, 32]] -> 960.000ns
               %1675 = :aten::fill_ [[4096, 32], []] -> 960.000ns
                 -->kernel: 0:7 %1671 =  [] -> 960.000ns
           %1676 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 9.088us
                 -->kernel: 0:7 %1672 =  [] -> 9.088us
     %1677 = :autograd::engine::evaluate_function: ViewBackward0 None -> 53.024us
       %1678 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 53.024us
                 -->kernel: 0:7 %1673 =  [] -> 53.024us
     %1679 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 91.104us
       %1680 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 39.776us
         %1681 = :aten::ones_like [[], [], [], [], [], []] -> 1.312us
           %1682 = :aten::fill_ [[], []] -> 1.312us
                 -->kernel: 0:7 %1674 =  [] -> 1.312us
         %1683 = :aten::mul [[], [1]] -> 1.760us
                 -->kernel: 0:7 %1675 =  [] -> 1.760us
       %1684 = :aten::sum [[1], []] -> 2.976us
         %1685 = :aten::sum [[1], [], [], []] -> 2.976us
                 -->kernel: 0:7 %1676 =  [] -> 2.976us
     %1686 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.280us
       %1687 = :DivBackward0 [[]] -> 1.280us
         %1688 = :aten::div [[], []] -> 1.280us
                 -->kernel: 0:7 %1677 =  [] -> 1.280us
     %1689 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.176us
       %1690 = :FusedAuxLossBackward [[]] -> 2.176us
         %1691 = :nvte_fused_moe_aux_loss_backward [] -> 2.176us
                 -->kernel: 0:7 %1678 =  [] -> 2.176us
     %1692 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 62.208us
       %1693 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 62.208us
         %1694 = :aten::zeros [[], [], [], [], []] -> 1.216us
           %1695 = :aten::zero_ [[4096, 32]] -> 1.216us
             %1696 = :aten::fill_ [[4096, 32], []] -> 1.216us
                 -->kernel: 0:7 %1679 =  [] -> 1.216us
         %1697 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.960us
                 -->kernel: 0:7 %1680 =  [] -> 12.960us
     %1698 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 100.544us
       %1699 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 58.144us
         %1700 = :aten::zeros [[], [], [], [], []] -> 1.152us
           %1701 = :aten::zero_ [[4096, 32]] -> 1.152us
             %1702 = :aten::fill_ [[4096, 32], []] -> 1.152us
                 -->kernel: 0:7 %1681 =  [] -> 1.152us
         %1703 = :nvte_fused_topk_with_score_function_backward [] -> 13.728us
                 -->kernel: 0:7 %1682 =  [] -> 13.728us
       %1704 = :aten::add [[4096, 32], [4096, 32], []] -> 1.664us
                 -->kernel: 0:7 %1683 =  [] -> 1.664us
     %1705 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 797.570us
       %1706 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 701.442us
         %1707 = :aten::to [[32, 7168], [], [], [], []] -> 6.528us
           %1708 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.528us
             %1709 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.528us
                 -->kernel: 0:7 %1684 =  [] -> 6.528us
         %1710 = :nvte_cublas_gemm_scaled [] -> 83.584us
                 -->kernel: 0:7 %1685 =  [] -> 67.808us
         %1711 = :aten::to [[4096, 7168], [], [], [], []] -> 176.320us
           %1712 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 176.320us
             %1713 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 176.320us
                 -->kernel: 0:7 %1686 =  [] -> 176.320us
         %1714 = :nvte_cublas_gemm_scaled [] -> 82.080us
                 -->kernel: 0:7 %1687 =  [] -> 82.080us
         %1715 = :aten::to [[4096, 7168], [], [], [], []] -> 43.648us
           %1716 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.648us
             %1717 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.648us
                 -->kernel: 0:7 %1688 =  [] -> 43.648us
         %1718 = :aten::to [[32, 7168], [], [], [], []] -> 2.048us
           %1719 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.048us
             %1720 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.048us
                 -->kernel: 0:7 %1689 =  [] -> 2.048us
       %1721 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.632us
                 -->kernel: 0:7 %1690 =  [] -> 49.632us
     %1722 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.176us
       %1723 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.176us
                 -->kernel: 0:35 %1691 =  [] -> 2.176us
     %1724 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 323.009us
       %1725 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 196.672us
         %1726 = :nvte_rmsnorm_bwd [] -> 196.672us
                 -->kernel: 0:7 %1692 =  [] -> 166.624us
                 -->kernel: 0:7 %1693 =  [] -> 7.840us
       %1727 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.073us
                 -->kernel: 0:7 %1694 =  [] -> 51.073us
     %1728 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %1729 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %1695 =  [] -> 1.600us
     %1730 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.248ms
       %1731 = :_LinearBackward [[4096, 1, 7168]] -> 7.248ms
         %1732 = :_Linear_backward [] -> 7.248ms
           %1733 = :nvte_quantize_v2 [] -> 73.376us
             %1734 = :quantize_transpose_vector_blockwise [] -> 73.376us
                 -->kernel: 0:7 %1696 =  [] -> 73.376us
           %1735 = :nvte_quantize_v2 [] -> 111.297us
             %1736 = :quantize_transpose_vector_blockwise [] -> 111.297us
                 -->kernel: 0:7 %1697 =  [] -> 111.297us
           %1737 = :nvte_cublas_gemm_scaled [] -> 3.427ms
                 -->kernel: 0:7 %1698 =  [] -> 3.421ms
           %1738 = :nvte_cublas_gemm_scaled [] -> 3.429ms
                 -->kernel: 0:7 %1699 =  [] -> 3.418ms
     %1739 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.896ms
       %1740 = :BmmBackward0 [[128, 4096, 128]] -> 7.896ms
         %1741 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.974ms
                 -->kernel: 0:7 %1700 =  [] -> 3.962ms
         %1742 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.867ms
                 -->kernel: 0:7 %1701 =  [] -> 3.859ms
     %1743 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 7.014ms
       %1744 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 7.014ms
         %1745 = :nvte_scaled_softmax_backward [] -> 7.014ms
                 -->kernel: 0:7 %1702 =  [] -> 7.014ms
     %1746 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.184ms
       %1747 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.184ms
         %1748 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.929ms
                 -->kernel: 0:7 %1703 =  [] -> 5.919ms
         %1749 = :aten::mul [[128, 4096, 192], []] -> 114.880us
           %1750 = :aten::mul [[128, 4096, 192], []] -> 114.880us
                 -->kernel: 0:7 %1704 =  [] -> 114.880us
         %1751 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.861ms
                 -->kernel: 0:7 %1705 =  [] -> 5.854ms
         %1752 = :aten::mul [[128, 192, 4096], []] -> 115.168us
           %1753 = :aten::mul [[128, 192, 4096], []] -> 115.168us
                 -->kernel: 0:7 %1706 =  [] -> 115.168us
     %1754 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.472ms
       %1755 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.472ms
         %1756 = :aten::contiguous [[4096, 1, 128, 192], []] -> 743.490us
           %1757 = :aten::clone [[4096, 1, 128, 192], []] -> 743.490us
             %1758 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 743.490us
                 -->kernel: 0:7 %1707 =  [] -> 743.490us
         %1759 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.449us
           %1760 = :aten::clone [[4096, 1, 128, 128], []] -> 280.449us
             %1761 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.449us
                 -->kernel: 0:7 %1708 =  [] -> 280.449us
                 -->kernel: 0:7 %1709 =  [] -> 172.577us
     %1762 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 638.562us
       %1763 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 638.562us
         %1764 = :aten::contiguous [[4096, 1, 128, 192], []] -> 422.497us
           %1765 = :aten::clone [[4096, 1, 128, 192], []] -> 422.497us
             %1766 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 422.497us
                 -->kernel: 0:7 %1710 =  [] -> 422.497us
                 -->kernel: 0:7 %1711 =  [] -> 118.401us
     %1767 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.736ms
       %1768 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.736ms
         %1769 = :_LayerNormLinear_backward [] -> 1.736ms
           %1770 = :nvte_quantize_v2 [] -> 323.905us
             %1771 = :quantize_transpose_vector_blockwise [] -> 323.905us
                 -->kernel: 0:7 %1712 =  [] -> 323.905us
           %1772 = :nvte_cublas_gemm_scaled [] -> 566.497us
                 -->kernel: 0:7 %1713 =  [] -> 518.209us
                 -->kernel: 0:7 %1714 =  [] -> 19.136us
           %1773 = :nvte_cublas_gemm_scaled [] -> 526.465us
                 -->kernel: 0:7 %1715 =  [] -> 521.249us
           %1774 = :nvte_rmsnorm_bwd [] -> 21.344us
                 -->kernel: 0:7 %1716 =  [] -> 6.240us
                 -->kernel: 0:7 %1717 =  [] -> 3.168us
     %1775 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.856us
       %1776 = :aten::add_ [[512], [512], []] -> 1.856us
                 -->kernel: 0:35 %1718 =  [] -> 1.856us
     %1777 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.777ms
       %1778 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.777ms
         %1779 = :_LayerNormLinear_backward [] -> 2.777ms
           %1780 = :nvte_quantize_v2 [] -> 243.392us
             %1781 = :quantize_transpose_vector_blockwise [] -> 243.392us
                 -->kernel: 0:7 %1719 =  [] -> 243.392us
           %1782 = :nvte_cublas_gemm_scaled [] -> 1.116ms
                 -->kernel: 0:7 %1720 =  [] -> 1.107ms
           %1783 = :nvte_cublas_gemm_scaled [] -> 1.119ms
                 -->kernel: 0:7 %1721 =  [] -> 1.113ms
           %1784 = :nvte_rmsnorm_bwd [] -> 55.648us
                 -->kernel: 0:7 %1722 =  [] -> 23.040us
                 -->kernel: 0:7 %1723 =  [] -> 20.576us
     %1785 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.920us
       %1786 = :aten::add_ [[1536], [1536], []] -> 1.920us
                 -->kernel: 0:35 %1724 =  [] -> 1.920us
     %1787 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 9.952us
       %1788 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 9.952us
         %1789 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 9.952us
                 -->kernel: 0:7 %1725 =  [] -> 9.952us
     %1790 = :autograd::engine::evaluate_function: _LinearBackward None -> 433.473us
       %1791 = :_LinearBackward [[4096, 1, 576]] -> 433.473us
         %1792 = :_Linear_backward [] -> 433.473us
           %1793 = :nvte_quantize_v2 [] -> 14.528us
             %1794 = :quantize_transpose_vector_blockwise [] -> 14.528us
                 -->kernel: 0:7 %1726 =  [] -> 14.528us
           %1795 = :nvte_cublas_gemm_scaled [] -> 147.489us
                 -->kernel: 0:7 %1727 =  [] -> 140.865us
           %1796 = :nvte_cublas_gemm_scaled [] -> 139.296us
                 -->kernel: 0:7 %1728 =  [] -> 133.376us
     %1797 = :autograd::engine::evaluate_function: _LinearBackward None -> 983.202us
       %1798 = :_LinearBackward [[4096, 1, 1536]] -> 820.961us
         %1799 = :_Linear_backward [] -> 820.961us
           %1800 = :nvte_quantize_v2 [] -> 18.432us
             %1801 = :quantize_transpose_vector_blockwise [] -> 18.432us
                 -->kernel: 0:7 %1729 =  [] -> 18.432us
           %1802 = :nvte_cublas_gemm_scaled [] -> 335.233us
                 -->kernel: 0:7 %1730 =  [] -> 328.321us
           %1803 = :nvte_cublas_gemm_scaled [] -> 342.912us
                 -->kernel: 0:7 %1731 =  [] -> 337.536us
       %1804 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.728us
                 -->kernel: 0:7 %1732 =  [] -> 49.728us
     %1805 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 319.713us
       %1806 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 195.585us
         %1807 = :nvte_rmsnorm_bwd [] -> 195.585us
                 -->kernel: 0:7 %1733 =  [] -> 164.705us
                 -->kernel: 0:7 %1734 =  [] -> 7.744us
       %1808 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.152us
                 -->kernel: 0:7 %1735 =  [] -> 49.152us
     %1809 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.696us
       %1810 = :aten::add_ [[7168], [7168], []] -> 1.696us
                 -->kernel: 0:35 %1736 =  [] -> 1.696us
     %1811 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.984ms
       %1812 = :_LinearBackward [[4096, 1, 7168]] -> 7.984ms
         %1813 = :_Linear_backward [] -> 7.984ms
           %1814 = :nvte_quantize_v2 [] -> 73.056us
             %1815 = :quantize_transpose_vector_blockwise [] -> 73.056us
                 -->kernel: 0:7 %1737 =  [] -> 73.056us
           %1816 = :nvte_cublas_gemm_scaled [] -> 3.882ms
                 -->kernel: 0:7 %1738 =  [] -> 3.875ms
           %1817 = :nvte_cublas_gemm_scaled [] -> 3.874ms
                 -->kernel: 0:7 %1739 =  [] -> 3.866ms
     %1818 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 845.730us
       %1819 = :SwiGLUFunctionBackward [[4096, 18432]] -> 845.730us
         %1820 = :Torch-Compiled Region: 5/1 None -> 845.730us
           %1821 = :triton_poi_fused_cat_0 [[4096, 18432], [4096, 36864], [4096, 36864], [], [], [], [], []] -> 845.730us
                 -->kernel: 0:7 %1740 =  [] -> 845.730us
     %1822 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 16.439ms
       %1823 = :_LayerNormLinearBackward [[4096, 1, 36864]] -> 16.267ms
         %1824 = :_LayerNormLinear_backward [] -> 16.267ms
           %1825 = :nvte_quantize_v2 [] -> 361.857us
             %1826 = :quantize_transpose_vector_blockwise [] -> 361.857us
                 -->kernel: 0:7 %1741 =  [] -> 361.857us
           %1827 = :nvte_cublas_gemm_scaled [] -> 7.666ms
                 -->kernel: 0:7 %1742 =  [] -> 7.658ms
           %1828 = :nvte_cublas_gemm_scaled [] -> 7.720ms
                 -->kernel: 0:7 %1743 =  [] -> 7.710ms
           %1829 = :nvte_rmsnorm_bwd [] -> 196.544us
                 -->kernel: 0:7 %1744 =  [] -> 165.280us
                 -->kernel: 0:7 %1745 =  [] -> 8.224us
       %1830 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.536us
                 -->kernel: 0:7 %1746 =  [] -> 49.536us
     %1831 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.696us
       %1832 = :aten::add_ [[7168], [7168], []] -> 1.696us
                 -->kernel: 0:35 %1747 =  [] -> 1.696us
     %1833 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.286ms
       %1834 = :_LinearBackward [[4096, 1, 7168]] -> 7.286ms
         %1835 = :_Linear_backward [] -> 7.286ms
           %1836 = :nvte_quantize_v2 [] -> 73.792us
             %1837 = :quantize_transpose_vector_blockwise [] -> 73.792us
                 -->kernel: 0:7 %1748 =  [] -> 73.792us
           %1838 = :nvte_quantize_v2 [] -> 110.272us
             %1839 = :quantize_transpose_vector_blockwise [] -> 110.272us
                 -->kernel: 0:7 %1749 =  [] -> 110.272us
           %1840 = :nvte_cublas_gemm_scaled [] -> 3.441ms
                 -->kernel: 0:7 %1750 =  [] -> 3.434ms
           %1841 = :nvte_cublas_gemm_scaled [] -> 3.443ms
                 -->kernel: 0:7 %1751 =  [] -> 3.437ms
     %1842 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.918ms
       %1843 = :BmmBackward0 [[128, 4096, 128]] -> 7.918ms
         %1844 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.980ms
                 -->kernel: 0:7 %1752 =  [] -> 3.968ms
         %1845 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.883ms
                 -->kernel: 0:7 %1753 =  [] -> 3.874ms
     %1846 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.968ms
       %1847 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.968ms
         %1848 = :nvte_scaled_softmax_backward [] -> 6.968ms
                 -->kernel: 0:7 %1754 =  [] -> 6.968ms
     %1849 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.207ms
       %1850 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.207ms
         %1851 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.949ms
                 -->kernel: 0:7 %1755 =  [] -> 5.938ms
         %1852 = :aten::mul [[128, 4096, 192], []] -> 115.296us
           %1853 = :aten::mul [[128, 4096, 192], []] -> 115.296us
                 -->kernel: 0:7 %1756 =  [] -> 115.296us
         %1854 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.871ms
                 -->kernel: 0:7 %1757 =  [] -> 5.866ms
         %1855 = :aten::mul [[128, 192, 4096], []] -> 115.840us
           %1856 = :aten::mul [[128, 192, 4096], []] -> 115.840us
                 -->kernel: 0:7 %1758 =  [] -> 115.840us
     %1857 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.476ms
       %1858 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.476ms
         %1859 = :aten::contiguous [[4096, 1, 128, 192], []] -> 745.154us
           %1860 = :aten::clone [[4096, 1, 128, 192], []] -> 745.154us
             %1861 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 745.154us
                 -->kernel: 0:7 %1759 =  [] -> 745.154us
         %1862 = :aten::contiguous [[4096, 1, 128, 128], []] -> 281.120us
           %1863 = :aten::clone [[4096, 1, 128, 128], []] -> 281.120us
             %1864 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 281.120us
                 -->kernel: 0:7 %1760 =  [] -> 281.120us
                 -->kernel: 0:7 %1761 =  [] -> 171.648us
     %1865 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 642.754us
       %1866 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 642.754us
         %1867 = :aten::contiguous [[4096, 1, 128, 192], []] -> 424.225us
           %1868 = :aten::clone [[4096, 1, 128, 192], []] -> 424.225us
             %1869 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 424.225us
                 -->kernel: 0:7 %1762 =  [] -> 424.225us
                 -->kernel: 0:7 %1763 =  [] -> 118.976us
     %1870 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.729ms
       %1871 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.729ms
         %1872 = :_LayerNormLinear_backward [] -> 1.729ms
           %1873 = :nvte_quantize_v2 [] -> 323.137us
             %1874 = :quantize_transpose_vector_blockwise [] -> 323.137us
                 -->kernel: 0:7 %1764 =  [] -> 323.137us
           %1875 = :nvte_cublas_gemm_scaled [] -> 567.202us
                 -->kernel: 0:7 %1765 =  [] -> 521.410us
                 -->kernel: 0:7 %1766 =  [] -> 19.328us
           %1876 = :nvte_cublas_gemm_scaled [] -> 529.633us
                 -->kernel: 0:7 %1767 =  [] -> 523.265us
           %1877 = :nvte_rmsnorm_bwd [] -> 20.832us
                 -->kernel: 0:7 %1768 =  [] -> 6.528us
                 -->kernel: 0:7 %1769 =  [] -> 3.168us
     %1878 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.016us
       %1879 = :aten::add_ [[512], [512], []] -> 2.016us
                 -->kernel: 0:35 %1770 =  [] -> 2.016us
     %1880 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.805ms
       %1881 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.805ms
         %1882 = :_LayerNormLinear_backward [] -> 2.805ms
           %1883 = :nvte_quantize_v2 [] -> 243.425us
             %1884 = :quantize_transpose_vector_blockwise [] -> 243.425us
                 -->kernel: 0:7 %1771 =  [] -> 243.425us
           %1885 = :nvte_cublas_gemm_scaled [] -> 1.121ms
                 -->kernel: 0:7 %1772 =  [] -> 1.113ms
           %1886 = :nvte_cublas_gemm_scaled [] -> 1.124ms
                 -->kernel: 0:7 %1773 =  [] -> 1.118ms
           %1887 = :nvte_rmsnorm_bwd [] -> 55.329us
                 -->kernel: 0:7 %1774 =  [] -> 23.137us
                 -->kernel: 0:7 %1775 =  [] -> 20.480us
     %1888 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.016us
       %1889 = :aten::add_ [[1536], [1536], []] -> 2.016us
                 -->kernel: 0:35 %1776 =  [] -> 2.016us
     %1890 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.016us
       %1891 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.016us
         %1892 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.016us
                 -->kernel: 0:7 %1777 =  [] -> 10.016us
     %1893 = :autograd::engine::evaluate_function: _LinearBackward None -> 444.545us
       %1894 = :_LinearBackward [[4096, 1, 576]] -> 444.545us
         %1895 = :_Linear_backward [] -> 444.545us
           %1896 = :nvte_quantize_v2 [] -> 14.369us
             %1897 = :quantize_transpose_vector_blockwise [] -> 14.369us
                 -->kernel: 0:7 %1778 =  [] -> 14.369us
           %1898 = :nvte_cublas_gemm_scaled [] -> 148.768us
                 -->kernel: 0:7 %1779 =  [] -> 141.728us
           %1899 = :nvte_cublas_gemm_scaled [] -> 139.232us
                 -->kernel: 0:7 %1780 =  [] -> 133.952us
     %1900 = :autograd::engine::evaluate_function: _LinearBackward None -> 989.506us
       %1901 = :_LinearBackward [[4096, 1, 1536]] -> 824.002us
         %1902 = :_Linear_backward [] -> 824.002us
           %1903 = :nvte_quantize_v2 [] -> 18.432us
             %1904 = :quantize_transpose_vector_blockwise [] -> 18.432us
                 -->kernel: 0:7 %1781 =  [] -> 18.432us
           %1905 = :nvte_cublas_gemm_scaled [] -> 336.545us
                 -->kernel: 0:7 %1782 =  [] -> 330.113us
           %1906 = :nvte_cublas_gemm_scaled [] -> 342.753us
                 -->kernel: 0:7 %1783 =  [] -> 338.465us
       %1907 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.720us
                 -->kernel: 0:7 %1784 =  [] -> 50.720us
     %1908 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 321.408us
       %1909 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 196.352us
         %1910 = :nvte_rmsnorm_bwd [] -> 196.352us
                 -->kernel: 0:7 %1785 =  [] -> 165.088us
                 -->kernel: 0:7 %1786 =  [] -> 8.128us
       %1911 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.824us
                 -->kernel: 0:7 %1787 =  [] -> 49.824us
     %1912 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %1913 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %1788 =  [] -> 1.600us
     %1914 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 3.034ms
       %1915 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.429ms
         %1916 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.429ms
           %1917 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.429ms
             %1918 = :aten::arange [[], [], [], [], []] -> 1.152us
               %1919 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %1789 =  [] -> 1.152us
             %1920 = CCCL:cub::DeviceRadixSort [] -> 188.192us
                 -->kernel: 0:7 %1790 =  [] -> 3.616us
                 -->kernel: 0:7 %1791 =  [] -> 1.536us
                 -->kernel: 0:7 %1792 =  [] -> 7.872us
                 -->kernel: 0:7 %1793 =  [] -> 7.200us
                 -->kernel: 0:7 %1794 =  [] -> 7.072us
                 -->kernel: 0:7 %1795 =  [] -> 7.232us
                 -->kernel: 0:7 %1796 =  [] -> 7.008us
                 -->kernel: 0:7 %1797 =  [] -> 6.880us
                 -->kernel: 0:7 %1798 =  [] -> 6.848us
                 -->kernel: 0:7 %1799 =  [] -> 7.040us
             %1921 = :aten::zeros [[], [], [], [], []] -> 544.705us
               %1922 = :aten::zero_ [[129280, 7168]] -> 544.705us
                 %1923 = :aten::fill_ [[129280, 7168], []] -> 544.705us
                 -->kernel: 0:7 %1800 =  [] -> 544.705us
             %1924 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 16.608us
                 -->kernel: 0:7 %1801 =  [] -> 1.184us
                 -->kernel: 0:7 %1802 =  [] -> 3.968us
                 -->kernel: 0:7 %1803 =  [] -> 1.792us
             %1925 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 18.528us
                 -->kernel: 0:7 %1804 =  [] -> 1.440us
                 -->kernel: 0:7 %1805 =  [] -> 3.296us
                 -->kernel: 0:7 %1806 =  [] -> 1.376us
                 -->kernel: 0:7 %1807 =  [] -> 1.760us
                 -->kernel: 0:7 %1808 =  [] -> 239.969us
                 -->kernel: 0:7 %1809 =  [] -> 192.096us
       %1926 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.556ms
                 -->kernel: 0:35 %1810 =  [] -> 1.556ms
     %1927 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.557ms
       %1928 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.557ms
                 -->kernel: 0:35 %1811 =  [] -> 1.557ms
     %1929 = :aten::linalg_vector_norm [[3002413056], [], [], [], []] -> 2.546ms
                 -->kernel: 0:7 %1812 =  [] -> 614.978us
                 -->kernel: 0:7 %1813 =  [] -> 609.793us
                 -->kernel: 0:7 %1814 =  [] -> 607.553us
                 -->kernel: 0:7 %1815 =  [] -> 608.162us
     %1930 = :aten::isnan [[]] -> 1.472us
       %1931 = :aten::ne [[], []] -> 1.472us
                 -->kernel: 0:7 %1816 =  [] -> 1.472us
     %1932 = :aten::is_nonzero [[]] -> 2.240us
       %1933 = :aten::item [[]] -> 2.240us
         %1934 = :aten::_local_scalar_dense [[]] -> 2.240us
     %1935 = :aten::isinf [[]] -> 39.328us
       %1936 = :aten::abs [[]] -> 1.408us
         %1937 = :aten::abs [[], [0]] -> 1.408us
                 -->kernel: 0:7 %1817 =  [] -> 1.408us
       %1938 = :aten::eq [[], []] -> 1.504us
                 -->kernel: 0:7 %1818 =  [] -> 1.504us
     %1939 = :aten::is_nonzero [[]] -> 2.208us
       %1940 = :aten::item [[]] -> 2.208us
         %1941 = :aten::_local_scalar_dense [[]] -> 2.208us
     %1942 = :aten::mul_ [[3002413056], []] -> 3.544ms
                 -->kernel: 0:7 %1819 =  [] -> 863.426us
                 -->kernel: 0:7 %1820 =  [] -> 902.082us
                 -->kernel: 0:7 %1821 =  [] -> 871.426us
                 -->kernel: 0:7 %1822 =  [] -> 869.186us
     %1943 = :c10d::reduce_scatter_tensor_coalesced_ [[375301632], [3002413056], [], [], [], []] -> 14.553ms
       %1944 = :record_param_comms [[3002413056], [], [], [], [], [], [], [], [], []] -> 14.553ms
         %1945 = :nccl:reduce_scatter_tensor_coalesced [[3002413056]] -> 14.553ms
           %1946 = NCCL:ncclGroupEnd [] -> 14.553ms
                 -->kernel: 0:7 %1823 =  [] -> 14.553ms
     %1947 = :aten::linalg_vector_norm [[352321536], [], [], [], []] -> 307.328us
                 -->kernel: 0:7 %1824 =  [] -> 292.064us
     %1948 = :aten::isnan [[]] -> 1.600us
       %1949 = :aten::ne [[], []] -> 1.600us
                 -->kernel: 0:7 %1825 =  [] -> 1.600us
     %1950 = :aten::is_nonzero [[]] -> 2.368us
       %1951 = :aten::item [[]] -> 2.368us
         %1952 = :aten::_local_scalar_dense [[]] -> 2.368us
     %1953 = :aten::isinf [[]] -> 25.920us
       %1954 = :aten::abs [[]] -> 1.408us
         %1955 = :aten::abs [[], [0]] -> 1.408us
                 -->kernel: 0:7 %1826 =  [] -> 1.408us
       %1956 = :aten::eq [[], []] -> 1.280us
                 -->kernel: 0:7 %1827 =  [] -> 1.280us
     %1957 = :aten::is_nonzero [[]] -> 2.368us
       %1958 = :aten::item [[]] -> 2.368us
         %1959 = :aten::_local_scalar_dense [[]] -> 2.368us
     %1960 = :aten::mul_ [[352321536], []] -> 404.033us
                 -->kernel: 0:7 %1828 =  [] -> 404.033us
     %1961 = :aten::stack [[32], [32], []] -> 2.336us
       %1962 = :aten::cat [[32], [32], []] -> 2.336us
                 -->kernel: 0:7 %1829 =  [] -> 2.336us
     %1963 = :aten::stack [[32], [32], []] -> 2.272us
       %1964 = :aten::cat [[32], [32], []] -> 2.272us
                 -->kernel: 0:7 %1830 =  [] -> 2.272us
     %1965 = :c10d::allreduce_ [[2, 32], [], [], [], [], []] -> 15.776us
       %1966 = :record_param_comms [[2, 32], [], [], [], [], [], [], [], [], []] -> 15.776us
         %1967 = :nccl:all_reduce [[2, 32]] -> 15.776us
           %1968 = NCCL:ncclAllReduce [] -> 15.776us
                 -->kernel: 0:7 %1831 =  [] -> 15.776us
     %1969 = :aten::sum [[2, 32], [], [], []] -> 2.560us
                 -->kernel: 0:7 %1832 =  [] -> 2.560us
     %1970 = :aten::div [[2, 1], []] -> 1.600us
                 -->kernel: 0:7 %1833 =  [] -> 1.600us
     %1971 = :aten::sub [[2, 1], [2, 32], []] -> 2.048us
                 -->kernel: 0:7 %1834 =  [] -> 2.048us
     %1972 = :aten::sign [[2, 32]] -> 1.376us
                 -->kernel: 0:7 %1835 =  [] -> 1.376us
     %1973 = :aten::mul [[2, 32], []] -> 1.280us
                 -->kernel: 0:7 %1836 =  [] -> 1.280us
     %1974 = :aten::add [[2, 32], [2, 32], []] -> 2.944us
                 -->kernel: 0:7 %1837 =  [] -> 2.944us
     %1975 = :aten::zero_ [[32]] -> 1.184us
       %1976 = :aten::fill_ [[32], []] -> 1.184us
                 -->kernel: 0:7 %1838 =  [] -> 1.184us
     %1977 = :aten::copy_ [[32], [32], []] -> 1.024us
     %1978 = :aten::zero_ [[32]] -> 896.000ns
       %1979 = :aten::fill_ [[32], []] -> 896.000ns
                 -->kernel: 0:7 %1839 =  [] -> 896.000ns
     %1980 = :aten::copy_ [[32], [32], []] -> 1.120us
     %1981 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %1982 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %1983 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %1984 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 9.888us
       %1985 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 9.888us
         %1986 = :nccl:all_reduce [[1]] -> 9.888us
           %1987 = NCCL:ncclAllReduce [] -> 9.888us
                 -->kernel: 0:7 %1840 =  [] -> 9.888us
     %1988 = :aten::item [[1]] -> 2.240us
       %1989 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %1990 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %1991 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %1992 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %1993 = :aten::zeros [[], [], [], [], []] -> 960.000ns
       %1994 = :aten::zero_ [[320]] -> 960.000ns
         %1995 = :aten::fill_ [[320], []] -> 960.000ns
                 -->kernel: 0:7 %1841 =  [] -> 960.000ns
     %1996 = :nvte_multi_tensor_l2norm_cuda [] -> 1.385ms
                 -->kernel: 0:7 %1842 =  [] -> 35.616us
                 -->kernel: 0:7 %1843 =  [] -> 33.760us
                 -->kernel: 0:7 %1844 =  [] -> 29.856us
                 -->kernel: 0:7 %1845 =  [] -> 29.664us
                 -->kernel: 0:7 %1846 =  [] -> 29.888us
                 -->kernel: 0:7 %1847 =  [] -> 29.952us
                 -->kernel: 0:7 %1848 =  [] -> 30.528us
                 -->kernel: 0:7 %1849 =  [] -> 30.240us
                 -->kernel: 0:7 %1850 =  [] -> 30.080us
                 -->kernel: 0:7 %1851 =  [] -> 29.856us
                 -->kernel: 0:7 %1852 =  [] -> 29.984us
                 -->kernel: 0:7 %1853 =  [] -> 30.528us
                 -->kernel: 0:7 %1854 =  [] -> 29.600us
                 -->kernel: 0:7 %1855 =  [] -> 29.984us
                 -->kernel: 0:7 %1856 =  [] -> 30.496us
                 -->kernel: 0:7 %1857 =  [] -> 29.856us
                 -->kernel: 0:7 %1858 =  [] -> 30.336us
                 -->kernel: 0:7 %1859 =  [] -> 29.856us
                 -->kernel: 0:7 %1860 =  [] -> 29.920us
                 -->kernel: 0:7 %1861 =  [] -> 29.569us
                 -->kernel: 0:7 %1862 =  [] -> 29.824us
                 -->kernel: 0:7 %1863 =  [] -> 30.240us
                 -->kernel: 0:7 %1864 =  [] -> 30.080us
                 -->kernel: 0:7 %1865 =  [] -> 29.760us
                 -->kernel: 0:7 %1866 =  [] -> 29.568us
                 -->kernel: 0:7 %1867 =  [] -> 30.112us
                 -->kernel: 0:7 %1868 =  [] -> 29.984us
                 -->kernel: 0:7 %1869 =  [] -> 29.856us
                 -->kernel: 0:7 %1870 =  [] -> 30.048us
                 -->kernel: 0:7 %1871 =  [] -> 30.592us
                 -->kernel: 0:7 %1872 =  [] -> 29.921us
                 -->kernel: 0:7 %1873 =  [] -> 30.112us
                 -->kernel: 0:7 %1874 =  [] -> 30.080us
                 -->kernel: 0:7 %1875 =  [] -> 29.920us
                 -->kernel: 0:7 %1876 =  [] -> 17.216us
                 -->kernel: 0:7 %1877 =  [] -> 1.504us
     %1997 = :aten::pow [[1], []] -> 1.344us
                 -->kernel: 0:7 %1878 =  [] -> 1.344us
     %1998 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 61.824us
       %1999 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 61.824us
         %2000 = :nccl:all_reduce [[1]] -> 61.824us
           %2001 = NCCL:ncclAllReduce [] -> 61.824us
                 -->kernel: 0:7 %1879 =  [] -> 61.824us
     %2002 = :aten::item [[1]] -> 2.240us
       %2003 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %2004 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2005 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2006 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2007 = :nvte_multi_tensor_scale_cuda [] -> 931.202us
                 -->kernel: 0:7 %1880 =  [] -> 35.680us
                 -->kernel: 0:7 %1881 =  [] -> 43.200us
                 -->kernel: 0:7 %1882 =  [] -> 42.976us
                 -->kernel: 0:7 %1883 =  [] -> 43.392us
                 -->kernel: 0:7 %1884 =  [] -> 42.720us
                 -->kernel: 0:7 %1885 =  [] -> 43.584us
                 -->kernel: 0:7 %1886 =  [] -> 43.264us
                 -->kernel: 0:7 %1887 =  [] -> 43.904us
                 -->kernel: 0:7 %1888 =  [] -> 42.944us
                 -->kernel: 0:7 %1889 =  [] -> 43.904us
                 -->kernel: 0:7 %1890 =  [] -> 42.880us
                 -->kernel: 0:7 %1891 =  [] -> 43.744us
                 -->kernel: 0:7 %1892 =  [] -> 42.848us
                 -->kernel: 0:7 %1893 =  [] -> 43.552us
                 -->kernel: 0:7 %1894 =  [] -> 42.785us
                 -->kernel: 0:7 %1895 =  [] -> 42.880us
                 -->kernel: 0:7 %1896 =  [] -> 43.008us
                 -->kernel: 0:7 %1897 =  [] -> 29.088us
     %2008 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2009 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2010 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2011 = :nvte_multi_tensor_scale_cuda [] -> 880.226us
                 -->kernel: 0:7 %1898 =  [] -> 43.008us
                 -->kernel: 0:7 %1899 =  [] -> 43.072us
                 -->kernel: 0:7 %1900 =  [] -> 43.040us
                 -->kernel: 0:7 %1901 =  [] -> 43.168us
                 -->kernel: 0:7 %1902 =  [] -> 43.904us
                 -->kernel: 0:7 %1903 =  [] -> 42.816us
                 -->kernel: 0:7 %1904 =  [] -> 43.648us
                 -->kernel: 0:7 %1905 =  [] -> 42.592us
                 -->kernel: 0:7 %1906 =  [] -> 43.264us
                 -->kernel: 0:7 %1907 =  [] -> 42.785us
                 -->kernel: 0:7 %1908 =  [] -> 44.320us
                 -->kernel: 0:7 %1909 =  [] -> 42.976us
                 -->kernel: 0:7 %1910 =  [] -> 43.840us
                 -->kernel: 0:7 %1911 =  [] -> 42.784us
                 -->kernel: 0:7 %1912 =  [] -> 44.576us
                 -->kernel: 0:7 %1913 =  [] -> 43.296us
                 -->kernel: 0:7 %1914 =  [] -> 28.192us
     %2012 = :Optimizer.step#HybridDeviceOptimizer.step None -> 318.716ms
       %2013 = :aten::copy_ [[375301632], [375301632], []] -> 43.768ms
         %2014 = :aten::to [[375301632], [], [], [], []] -> 2.226ms
           %2015 = :aten::_to_copy [[375301632], [], [], [], [], [], []] -> 2.226ms
             %2016 = :aten::copy_ [[375301632], [375301632], []] -> 2.226ms
                 -->kernel: 0:7 %1915 =  [] -> 2.226ms
         %2017 = :aten::copy_ [[375301632], [375301632], []] -> 41.491ms
       %2018 = :Optimizer.step#AdamW.step None -> 72.260ms
         %2019 = :aten::copy_ [[375301632], [375301632], []] -> 72.260ms
           %2020 = :aten::copy_ [[375301632], [375301632], []] -> 71.539ms
           %2021 = :aten::copy_ [[375301632], [375301632], []] -> 604.257us
                 -->kernel: 0:7 %1916 =  [] -> 604.257us
     %2022 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 340.800ms
       %2023 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 340.800ms
         %2024 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 340.800ms
           %2025 = NCCL:ncclGroupEnd [] -> 340.800ms
                 -->kernel: 0:39 %1917 =  [] -> 340.800ms
     %2026 = :Optimizer.step#HybridDeviceOptimizer.step None -> 84.159ms
       %2027 = :aten::to [[14680064], [], [], [], []] -> 89.089us
         %2028 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.089us
           %2029 = :aten::copy_ [[14680064], [14680064], []] -> 89.089us
                 -->kernel: 0:7 %1918 =  [] -> 89.089us
       %2030 = :aten::to [[29360128], [], [], [], []] -> 176.224us
         %2031 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.224us
           %2032 = :aten::copy_ [[29360128], [29360128], []] -> 176.224us
                 -->kernel: 0:7 %1919 =  [] -> 176.224us
       %2033 = :aten::to [[29360128], [], [], [], []] -> 176.417us
         %2034 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.417us
           %2035 = :aten::copy_ [[29360128], [29360128], []] -> 176.417us
                 -->kernel: 0:7 %1920 =  [] -> 176.417us
       %2036 = :aten::to [[29360128], [], [], [], []] -> 176.000us
         %2037 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.000us
           %2038 = :aten::copy_ [[29360128], [29360128], []] -> 176.000us
                 -->kernel: 0:7 %1921 =  [] -> 176.000us
       %2039 = :aten::to [[29360128], [], [], [], []] -> 176.097us
         %2040 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.097us
           %2041 = :aten::copy_ [[29360128], [29360128], []] -> 176.097us
                 -->kernel: 0:7 %1922 =  [] -> 176.097us
       %2042 = :aten::to [[14680064], [], [], [], []] -> 89.184us
         %2043 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.184us
           %2044 = :aten::copy_ [[14680064], [14680064], []] -> 89.184us
                 -->kernel: 0:7 %1923 =  [] -> 89.184us
       %2045 = :aten::to [[14680064], [], [], [], []] -> 89.568us
         %2046 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.568us
           %2047 = :aten::copy_ [[14680064], [14680064], []] -> 89.568us
                 -->kernel: 0:7 %1924 =  [] -> 89.568us
       %2048 = :aten::to [[14680064], [], [], [], []] -> 89.632us
         %2049 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.632us
           %2050 = :aten::copy_ [[14680064], [14680064], []] -> 89.632us
                 -->kernel: 0:7 %1925 =  [] -> 89.632us
       %2051 = :aten::to [[14680064], [], [], [], []] -> 89.633us
         %2052 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.633us
           %2053 = :aten::copy_ [[14680064], [14680064], []] -> 89.633us
                 -->kernel: 0:7 %1926 =  [] -> 89.633us
       %2054 = :aten::to [[29360128], [], [], [], []] -> 176.256us
         %2055 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.256us
           %2056 = :aten::copy_ [[29360128], [29360128], []] -> 176.256us
                 -->kernel: 0:7 %1927 =  [] -> 176.256us
       %2057 = :aten::to [[29360128], [], [], [], []] -> 176.257us
         %2058 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.257us
           %2059 = :aten::copy_ [[29360128], [29360128], []] -> 176.257us
                 -->kernel: 0:7 %1928 =  [] -> 176.257us
       %2060 = :aten::to [[29360128], [], [], [], []] -> 175.968us
         %2061 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 175.968us
           %2062 = :aten::copy_ [[29360128], [29360128], []] -> 175.968us
                 -->kernel: 0:7 %1929 =  [] -> 175.968us
       %2063 = :aten::to [[29360128], [], [], [], []] -> 175.521us
         %2064 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 175.521us
           %2065 = :aten::copy_ [[29360128], [29360128], []] -> 175.521us
                 -->kernel: 0:7 %1930 =  [] -> 175.521us
       %2066 = :aten::copy_ [[14680064], [14680064], []] -> 2.001ms
         %2067 = :aten::to [[14680064], [], [], [], []] -> 89.152us
           %2068 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.152us
             %2069 = :aten::copy_ [[14680064], [14680064], []] -> 89.152us
                 -->kernel: 0:7 %1931 =  [] -> 89.152us
         %2070 = :aten::copy_ [[14680064], [14680064], []] -> 1.854ms
       %2071 = :aten::copy_ [[14680064], [14680064], []] -> 1.838ms
         %2072 = :aten::to [[14680064], [], [], [], []] -> 88.192us
           %2073 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.192us
             %2074 = :aten::copy_ [[14680064], [14680064], []] -> 88.192us
                 -->kernel: 0:7 %1932 =  [] -> 88.192us
         %2075 = :aten::copy_ [[14680064], [14680064], []] -> 1.717ms
       %2076 = :aten::copy_ [[14680064], [14680064], []] -> 1.795ms
         %2077 = :aten::to [[14680064], [], [], [], []] -> 88.161us
           %2078 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.161us
             %2079 = :aten::copy_ [[14680064], [14680064], []] -> 88.161us
                 -->kernel: 0:7 %1933 =  [] -> 88.161us
         %2080 = :aten::copy_ [[14680064], [14680064], []] -> 1.677ms
       %2081 = :Optimizer.step#FusedAdam.step None -> 3.870ms
         %2082 = :nvte_multi_tensor_adam_cuda [] -> 3.081ms
                 -->kernel: 0:7 %1934 =  [] -> 198.080us
                 -->kernel: 0:7 %1935 =  [] -> 200.097us
                 -->kernel: 0:7 %1936 =  [] -> 199.008us
                 -->kernel: 0:7 %1937 =  [] -> 197.697us
                 -->kernel: 0:7 %1938 =  [] -> 199.520us
                 -->kernel: 0:7 %1939 =  [] -> 198.976us
                 -->kernel: 0:7 %1940 =  [] -> 200.449us
                 -->kernel: 0:7 %1941 =  [] -> 199.488us
                 -->kernel: 0:7 %1942 =  [] -> 197.953us
                 -->kernel: 0:7 %1943 =  [] -> 199.488us
                 -->kernel: 0:7 %1944 =  [] -> 199.457us
                 -->kernel: 0:7 %1945 =  [] -> 199.424us
                 -->kernel: 0:7 %1946 =  [] -> 197.889us
                 -->kernel: 0:7 %1947 =  [] -> 200.032us
                 -->kernel: 0:7 %1948 =  [] -> 140.321us
         %2083 = :aten::copy_ [[14680064], [14680064], []] -> 27.264us
                 -->kernel: 0:7 %1949 =  [] -> 27.264us
         %2084 = :aten::copy_ [[29360128], [29360128], []] -> 50.016us
                 -->kernel: 0:7 %1950 =  [] -> 50.016us
         %2085 = :aten::copy_ [[29360128], [29360128], []] -> 48.064us
                 -->kernel: 0:7 %1951 =  [] -> 48.064us
         %2086 = :aten::copy_ [[29360128], [29360128], []] -> 48.128us
                 -->kernel: 0:7 %1952 =  [] -> 48.128us
         %2087 = :aten::copy_ [[29360128], [29360128], []] -> 49.664us
                 -->kernel: 0:7 %1953 =  [] -> 49.664us
         %2088 = :aten::copy_ [[14680064], [14680064], []] -> 25.249us
                 -->kernel: 0:7 %1954 =  [] -> 25.249us
         %2089 = :aten::copy_ [[14680064], [14680064], []] -> 25.152us
                 -->kernel: 0:7 %1955 =  [] -> 25.152us
         %2090 = :aten::copy_ [[14680064], [14680064], []] -> 25.056us
                 -->kernel: 0:7 %1956 =  [] -> 25.056us
         %2091 = :aten::copy_ [[14680064], [14680064], []] -> 25.056us
                 -->kernel: 0:7 %1957 =  [] -> 25.056us
         %2092 = :aten::copy_ [[29360128], [29360128], []] -> 48.800us
                 -->kernel: 0:7 %1958 =  [] -> 48.800us
         %2093 = :aten::copy_ [[29360128], [29360128], []] -> 49.472us
                 -->kernel: 0:7 %1959 =  [] -> 49.472us
         %2094 = :aten::copy_ [[29360128], [29360128], []] -> 48.096us
                 -->kernel: 0:7 %1960 =  [] -> 48.096us
         %2095 = :aten::copy_ [[29360128], [29360128], []] -> 49.600us
                 -->kernel: 0:7 %1961 =  [] -> 49.600us
       %2096 = :Optimizer.step#AdamW.step None -> 8.744ms
         %2097 = :aten::copy_ [[14680064], [14680064], []] -> 2.927ms
           %2098 = :aten::copy_ [[14680064], [14680064], []] -> 2.849ms
           %2099 = :aten::copy_ [[14680064], [14680064], []] -> 24.576us
                 -->kernel: 0:7 %1962 =  [] -> 24.576us
         %2100 = :aten::copy_ [[14680064], [14680064], []] -> 2.780ms
           %2101 = :aten::copy_ [[14680064], [14680064], []] -> 2.742ms
           %2102 = :aten::copy_ [[14680064], [14680064], []] -> 23.808us
                 -->kernel: 0:7 %1963 =  [] -> 23.808us
         %2103 = :aten::copy_ [[14680064], [14680064], []] -> 2.764ms
           %2104 = :aten::copy_ [[14680064], [14680064], []] -> 2.730ms
           %2105 = :aten::copy_ [[14680064], [14680064], []] -> 24.256us
                 -->kernel: 0:7 %1964 =  [] -> 24.256us
     %2106 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 53.551ms
       %2107 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 53.551ms
         %2108 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 53.551ms
           %2109 = NCCL:ncclGroupEnd [] -> 53.551ms
                 -->kernel: 0:39 %1965 =  [] -> 53.551ms
     %2110 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2111 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2112 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2113 = :aten::item [[1]] -> 3.040us
       %2114 = :aten::_local_scalar_dense [[1]] -> 3.040us
     %2115 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2116 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2117 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2118 = :aten::item [[1]] -> 2.240us
       %2119 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %2120 = :aten::item [[1]] -> 2.240us
       %2121 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %2122 = :aten::cat [[1], []] -> 1.728us
     %2123 = :aten::mean [[1], []] -> 2.528us
       %2124 = :aten::mean [[1], [], [], []] -> 2.528us
                 -->kernel: 0:7 %1966 =  [] -> 2.528us
     %2125 = :aten::item [[1]] -> 2.720us
       %2126 = :aten::_local_scalar_dense [[1]] -> 2.720us
     %2127 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2128 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2129 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2130 = :aten::add [[1], [], []] -> 1.472us
                 -->kernel: 0:7 %1967 =  [] -> 1.472us
     %2131 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %2132 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %2133 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %2134 = :aten::item [[1]] -> 2.240us
       %2135 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %2136 = :aten::item [[1]] -> 2.240us
       %2137 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %2138 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 1.917ms
       %2139 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 1.917ms
         %2140 = :nccl:all_reduce [[2]] -> 1.917ms
           %2141 = NCCL:ncclAllReduce [] -> 1.917ms
                 -->kernel: 0:7 %1968 =  [] -> 1.917ms
     %2142 = :c10d::allreduce_ [[3], [], [], [], [], []] -> 9.344us
       %2143 = :record_param_comms [[3], [], [], [], [], [], [], [], [], []] -> 9.344us
         %2144 = :nccl:all_reduce [[3]] -> 9.344us
           %2145 = NCCL:ncclAllReduce [] -> 9.344us
                 -->kernel: 0:7 %1969 =  [] -> 9.344us
     %2146 = :aten::mul [[3], []] -> 1.312us
                 -->kernel: 0:7 %1970 =  [] -> 1.312us
     %2147 = :aten::mul [[2], []] -> 1.376us
                 -->kernel: 0:7 %1971 =  [] -> 1.376us
     %2148 = :aten::sum [[3], []] -> 3.040us
       %2149 = :aten::sum [[3], [], [], []] -> 3.040us
                 -->kernel: 0:7 %1972 =  [] -> 3.040us
     %2150 = :aten::div [[], []] -> 1.504us
                 -->kernel: 0:7 %1973 =  [] -> 1.504us
     %2151 = :aten::add_ [[1], [], []] -> 1.600us
                 -->kernel: 0:7 %1974 =  [] -> 1.600us
     %2152 = :aten::sum [[2], []] -> 2.144us
       %2153 = :aten::sum [[2], [], [], []] -> 2.144us
                 -->kernel: 0:7 %1975 =  [] -> 2.144us
     %2154 = :aten::div [[], []] -> 1.280us
                 -->kernel: 0:7 %1976 =  [] -> 1.280us
     %2155 = :aten::add_ [[1], [], []] -> 1.472us
                 -->kernel: 0:7 %1977 =  [] -> 1.472us
     %2156 = :aten::zero_ [[3]] -> 992.000ns
       %2157 = :aten::fill_ [[3], []] -> 992.000ns
                 -->kernel: 0:7 %1978 =  [] -> 992.000ns
     %2158 = :aten::zero_ [[2]] -> 960.000ns
       %2159 = :aten::fill_ [[2], []] -> 960.000ns
                 -->kernel: 0:7 %1979 =  [] -> 960.000ns
     %2160 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 304.961us
       %2161 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 304.961us
         %2162 = :nccl:all_reduce [[1]] -> 304.961us
           %2163 = NCCL:ncclAllReduce [] -> 304.961us
                 -->kernel: 0:7 %1980 =  [] -> 304.961us
     %2164 = :aten::mul [[1], []] -> 1.344us
                 -->kernel: 0:7 %1981 =  [] -> 1.344us
     %2165 = :aten::add_ [[1], [], []] -> 1.280us
                 -->kernel: 0:7 %1982 =  [] -> 1.280us
     %2166 = :aten::zero_ [[1]] -> 992.000ns
       %2167 = :aten::fill_ [[1], []] -> 992.000ns
                 -->kernel: 0:7 %1983 =  [] -> 992.000ns
     %2168 = :c10d::barrier [[1], [], [], [], []] -> 139.104us
       %2169 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 139.104us
         %2170 = :aten::zeros [[], [], [], [], []] -> 1.152us
           %2171 = :aten::zero_ [[1]] -> 1.152us
             %2172 = :aten::fill_ [[1], []] -> 1.152us
                 -->kernel: 0:7 %1984 =  [] -> 1.152us
         %2173 = :nccl:all_reduce_barrier [[1]] -> 103.232us
           %2174 = NCCL:ncclAllReduce [] -> 103.232us
                 -->kernel: 0:7 %1985 =  [] -> 103.232us
     %2175 = :c10d::barrier [[1], [], [], [], []] -> 37.696us
       %2176 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 37.696us
         %2177 = :aten::zeros [[], [], [], [], []] -> 992.000ns
           %2178 = :aten::zero_ [[1]] -> 992.000ns
             %2179 = :aten::fill_ [[1], []] -> 992.000ns
                 -->kernel: 0:7 %1986 =  [] -> 992.000ns
         %2180 = :nccl:all_reduce_barrier [[1]] -> 7.552us
           %2181 = NCCL:ncclAllReduce [] -> 7.552us
                 -->kernel: 0:7 %1987 =  [] -> 7.552us
     %2182 = :aten::item [[1]] -> 2.208us
       %2183 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %2184 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2185 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2186 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2187 = :aten::item [[1]] -> 2.208us
       %2188 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %2189 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2190 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2191 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2192 = :aten::item [[1]] -> 2.240us
       %2193 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %2194 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2195 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2196 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2197 = :aten::item [[1]] -> 2.240us
       %2198 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %2199 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %2200 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %2201 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %2202 = :aten::zeros [[], [], [], [], []] -> 1.184us
       %2203 = :aten::zero_ [[8, 24]] -> 1.184us
         %2204 = :aten::fill_ [[8, 24], []] -> 1.184us
                 -->kernel: 0:7 %1988 =  [] -> 1.184us
     %2205 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 65.408us
       %2206 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 65.408us
         %2207 = :nccl:_all_gather_base [[24]] -> 65.408us
           %2208 = NCCL:ncclAllGather [] -> 65.408us
                 -->kernel: 0:7 %1989 =  [] -> 65.408us
     %2209 = :aten::gt [[8], []] -> 1.536us
                 -->kernel: 0:7 %1990 =  [] -> 1.536us
     %2210 = :aten::index [[8], [8]] -> 62.272us
       %2211 = :aten::nonzero [[8]] -> 62.272us
         %2212 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %1991 =  [] -> 1.472us
         %2213 = CCCL:cub::DeviceSelect::Flagged [] -> 15.808us
                 -->kernel: 0:7 %1992 =  [] -> 1.312us
                 -->kernel: 0:7 %1993 =  [] -> 2.240us
     %2214 = :aten::gt [[8], []] -> 1.568us
                 -->kernel: 0:7 %1994 =  [] -> 1.568us
     %2215 = :aten::index [[8], [8]] -> 44.800us
       %2216 = :aten::nonzero [[8]] -> 44.800us
         %2217 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %1995 =  [] -> 1.280us
         %2218 = CCCL:cub::DeviceSelect::Flagged [] -> 12.640us
                 -->kernel: 0:7 %1996 =  [] -> 1.344us
                 -->kernel: 0:7 %1997 =  [] -> 2.112us
     %2219 = :aten::gt [[8], []] -> 1.472us
                 -->kernel: 0:7 %1998 =  [] -> 1.472us
     %2220 = :aten::index [[8], [8]] -> 43.521us
       %2221 = :aten::nonzero [[8]] -> 43.521us
         %2222 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %1999 =  [] -> 1.312us
         %2223 = CCCL:cub::DeviceSelect::Flagged [] -> 12.321us
                 -->kernel: 0:7 %2000 =  [] -> 1.312us
                 -->kernel: 0:7 %2001 =  [] -> 2.145us
     %2224 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2002 =  [] -> 1.408us
     %2225 = :aten::index [[8], [8]] -> 43.104us
       %2226 = :aten::nonzero [[8]] -> 43.104us
         %2227 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2003 =  [] -> 1.280us
         %2228 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2004 =  [] -> 1.344us
                 -->kernel: 0:7 %2005 =  [] -> 2.112us
     %2229 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2006 =  [] -> 1.408us
     %2230 = :aten::index [[8], [8]] -> 43.104us
       %2231 = :aten::nonzero [[8]] -> 43.104us
         %2232 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2007 =  [] -> 1.280us
         %2233 = CCCL:cub::DeviceSelect::Flagged [] -> 12.192us
                 -->kernel: 0:7 %2008 =  [] -> 1.312us
                 -->kernel: 0:7 %2009 =  [] -> 2.176us
     %2234 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2010 =  [] -> 1.408us
     %2235 = :aten::index [[8], [8]] -> 43.552us
       %2236 = :aten::nonzero [[8]] -> 43.552us
         %2237 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2011 =  [] -> 1.280us
         %2238 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %2012 =  [] -> 1.376us
                 -->kernel: 0:7 %2013 =  [] -> 2.112us
     %2239 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2014 =  [] -> 1.440us
     %2240 = :aten::index [[8], [8]] -> 42.976us
       %2241 = :aten::nonzero [[8]] -> 42.976us
         %2242 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2015 =  [] -> 1.280us
         %2243 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %2016 =  [] -> 1.312us
                 -->kernel: 0:7 %2017 =  [] -> 2.176us
     %2244 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2018 =  [] -> 1.440us
     %2245 = :aten::index [[8], [8]] -> 44.224us
       %2246 = :aten::nonzero [[8]] -> 44.224us
         %2247 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2019 =  [] -> 1.280us
         %2248 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2020 =  [] -> 1.344us
                 -->kernel: 0:7 %2021 =  [] -> 2.112us
     %2249 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2022 =  [] -> 1.408us
     %2250 = :aten::index [[8], [8]] -> 43.136us
       %2251 = :aten::nonzero [[8]] -> 43.136us
         %2252 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2023 =  [] -> 1.280us
         %2253 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2024 =  [] -> 1.312us
                 -->kernel: 0:7 %2025 =  [] -> 2.144us
     %2254 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2026 =  [] -> 1.408us
     %2255 = :aten::index [[8], [8]] -> 42.432us
       %2256 = :aten::nonzero [[8]] -> 42.432us
         %2257 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2027 =  [] -> 1.280us
         %2258 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %2028 =  [] -> 1.344us
                 -->kernel: 0:7 %2029 =  [] -> 2.112us
     %2259 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2030 =  [] -> 1.440us
     %2260 = :aten::index [[8], [8]] -> 44.128us
       %2261 = :aten::nonzero [[8]] -> 44.128us
         %2262 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2031 =  [] -> 1.280us
         %2263 = CCCL:cub::DeviceSelect::Flagged [] -> 12.384us
                 -->kernel: 0:7 %2032 =  [] -> 1.344us
                 -->kernel: 0:7 %2033 =  [] -> 2.144us
     %2264 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2034 =  [] -> 1.408us
     %2265 = :aten::index [[8], [8]] -> 49.088us
       %2266 = :aten::nonzero [[8]] -> 49.088us
         %2267 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2035 =  [] -> 1.280us
         %2268 = CCCL:cub::DeviceSelect::Flagged [] -> 13.536us
                 -->kernel: 0:7 %2036 =  [] -> 1.344us
                 -->kernel: 0:7 %2037 =  [] -> 2.080us
     %2269 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2038 =  [] -> 1.440us
     %2270 = :aten::index [[8], [8]] -> 44.736us
       %2271 = :aten::nonzero [[8]] -> 44.736us
         %2272 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2039 =  [] -> 1.280us
         %2273 = CCCL:cub::DeviceSelect::Flagged [] -> 12.384us
                 -->kernel: 0:7 %2040 =  [] -> 1.344us
                 -->kernel: 0:7 %2041 =  [] -> 2.144us
     %2274 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2042 =  [] -> 1.440us
     %2275 = :aten::index [[8], [8]] -> 43.104us
       %2276 = :aten::nonzero [[8]] -> 43.104us
         %2277 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2043 =  [] -> 1.312us
         %2278 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %2044 =  [] -> 1.344us
                 -->kernel: 0:7 %2045 =  [] -> 2.144us
     %2279 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2046 =  [] -> 1.440us
     %2280 = :aten::index [[8], [8]] -> 44.448us
       %2281 = :aten::nonzero [[8]] -> 44.448us
         %2282 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2047 =  [] -> 1.312us
         %2283 = CCCL:cub::DeviceSelect::Flagged [] -> 12.512us
                 -->kernel: 0:7 %2048 =  [] -> 1.344us
                 -->kernel: 0:7 %2049 =  [] -> 2.176us
     %2284 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2050 =  [] -> 1.440us
     %2285 = :aten::index [[8], [8]] -> 42.721us
       %2286 = :aten::nonzero [[8]] -> 42.721us
         %2287 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2051 =  [] -> 1.280us
         %2288 = CCCL:cub::DeviceSelect::Flagged [] -> 12.320us
                 -->kernel: 0:7 %2052 =  [] -> 1.344us
                 -->kernel: 0:7 %2053 =  [] -> 2.144us
     %2289 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2054 =  [] -> 1.440us
     %2290 = :aten::index [[8], [8]] -> 43.360us
       %2291 = :aten::nonzero [[8]] -> 43.360us
         %2292 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2055 =  [] -> 1.312us
         %2293 = CCCL:cub::DeviceSelect::Flagged [] -> 12.192us
                 -->kernel: 0:7 %2056 =  [] -> 1.312us
                 -->kernel: 0:7 %2057 =  [] -> 2.144us
     %2294 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2058 =  [] -> 1.408us
     %2295 = :aten::index [[8], [8]] -> 42.336us
       %2296 = :aten::nonzero [[8]] -> 42.336us
         %2297 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2059 =  [] -> 1.280us
         %2298 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2060 =  [] -> 1.376us
                 -->kernel: 0:7 %2061 =  [] -> 2.144us
     %2299 = :aten::gt [[8], []] -> 1.472us
                 -->kernel: 0:7 %2062 =  [] -> 1.472us
     %2300 = :aten::index [[8], [8]] -> 42.880us
       %2301 = :aten::nonzero [[8]] -> 42.880us
         %2302 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2063 =  [] -> 1.312us
         %2303 = CCCL:cub::DeviceSelect::Flagged [] -> 12.384us
                 -->kernel: 0:7 %2064 =  [] -> 1.344us
                 -->kernel: 0:7 %2065 =  [] -> 2.176us
     %2304 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2066 =  [] -> 1.440us
     %2305 = :aten::index [[8], [8]] -> 42.560us
       %2306 = :aten::nonzero [[8]] -> 42.560us
         %2307 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %2067 =  [] -> 1.280us
         %2308 = CCCL:cub::DeviceSelect::Flagged [] -> 12.416us
                 -->kernel: 0:7 %2068 =  [] -> 1.376us
                 -->kernel: 0:7 %2069 =  [] -> 2.144us
     %2309 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2070 =  [] -> 1.440us
     %2310 = :aten::index [[8], [8]] -> 43.296us
       %2311 = :aten::nonzero [[8]] -> 43.296us
         %2312 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2071 =  [] -> 1.312us
         %2313 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2072 =  [] -> 1.344us
                 -->kernel: 0:7 %2073 =  [] -> 2.176us
     %2314 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %2074 =  [] -> 1.408us
     %2315 = :aten::index [[8], [8]] -> 47.808us
       %2316 = :aten::nonzero [[8]] -> 47.808us
         %2317 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2075 =  [] -> 1.312us
         %2318 = CCCL:cub::DeviceSelect::Flagged [] -> 17.152us
                 -->kernel: 0:7 %2076 =  [] -> 1.376us
                 -->kernel: 0:7 %2077 =  [] -> 2.144us
     %2319 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2078 =  [] -> 1.440us
     %2320 = :aten::index [[8], [8]] -> 43.072us
       %2321 = :aten::nonzero [[8]] -> 43.072us
         %2322 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2079 =  [] -> 1.312us
         %2323 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2080 =  [] -> 1.312us
                 -->kernel: 0:7 %2081 =  [] -> 2.176us
     %2324 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %2082 =  [] -> 1.440us
     %2325 = :aten::index [[8], [8]] -> 42.336us
       %2326 = :aten::nonzero [[8]] -> 42.336us
         %2327 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %2083 =  [] -> 1.312us
         %2328 = CCCL:cub::DeviceSelect::Flagged [] -> 12.288us
                 -->kernel: 0:7 %2084 =  [] -> 1.376us
                 -->kernel: 0:7 %2085 =  [] -> 2.144us
     %2329 = :aten::zeros [[], [], [], [], []] -> 1.024us
       %2330 = :aten::zero_ [[8, 24]] -> 1.024us
         %2331 = :aten::fill_ [[8, 24], []] -> 1.024us
                 -->kernel: 0:7 %2086 =  [] -> 1.024us
     %2332 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.488us
       %2333 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.488us
         %2334 = :nccl:_all_gather_base [[24]] -> 7.488us
           %2335 = NCCL:ncclAllGather [] -> 7.488us
                 -->kernel: 0:7 %2087 =  [] -> 7.488us
     %2336 = :aten::gt [[8], []] -> 1.984us
                 -->kernel: 0:7 %2088 =  [] -> 1.984us
     %2337 = :aten::index [[8], [8]] -> 49.216us
       %2338 = :aten::nonzero [[8]] -> 49.216us
         %2339 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %2089 =  [] -> 1.536us
         %2340 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2090 =  [] -> 1.088us
                 -->kernel: 0:7 %2091 =  [] -> 1.856us
     %2341 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %2092 =  [] -> 1.792us
     %2342 = :aten::index [[8], [8]] -> 43.840us
       %2343 = :aten::nonzero [[8]] -> 43.840us
         %2344 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %2093 =  [] -> 1.440us
         %2345 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %2094 =  [] -> 1.088us
                 -->kernel: 0:7 %2095 =  [] -> 1.856us
     %2346 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %2096 =  [] -> 1.760us
     %2347 = :aten::index [[8], [8]] -> 43.968us
       %2348 = :aten::nonzero [[8]] -> 43.968us
         %2349 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %2097 =  [] -> 1.504us
         %2350 = CCCL:cub::DeviceSelect::Flagged [] -> 11.616us
                 -->kernel: 0:7 %2098 =  [] -> 1.056us
                 -->kernel: 0:7 %2099 =  [] -> 1.824us
     %2351 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %2100 =  [] -> 1.824us
     %2352 = :aten::index [[8], [8]] -> 47.296us
       %2353 = :aten::nonzero [[8]] -> 47.296us
         %2354 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %2101 =  [] -> 1.440us
         %2355 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %2102 =  [] -> 1.088us
                 -->kernel: 0:7 %2103 =  [] -> 1.856us
     %2356 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %2104 =  [] -> 1.760us
     %2357 = :aten::index [[8], [8]] -> 42.752us
       %2358 = :aten::nonzero [[8]] -> 42.752us
         %2359 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %2105 =  [] -> 1.504us
         %2360 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %2106 =  [] -> 1.056us
                 -->kernel: 0:7 %2107 =  [] -> 1.824us
     %2361 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %2108 =  [] -> 1.792us
     %2362 = :aten::index [[8], [8]] -> 42.464us
       %2363 = :aten::nonzero [[8]] -> 42.464us
         %2364 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %2109 =  [] -> 1.472us
         %2365 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %2110 =  [] -> 1.056us
                 -->kernel: 0:7 %2111 =  [] -> 1.856us
     %2366 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %2112 =  [] -> 1.792us
     %2367 = :aten::index [[8], [8]] -> 42.016us
       %2368 = :aten::nonzero [[8]] -> 42.016us
         %2369 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %2113 =  [] -> 1.472us
         %2370 = CCCL:cub::DeviceSelect::Flagged [] -> 11.456us
                 -->kernel: 0:7 %2114 =  [] -> 1.056us
                 -->kernel: 0:7 %2115 =  [] -> 1.824us
     %2371 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %2116 =  [] -> 1.824us
     %2372 = :aten::index [[8], [8]] -> 41.888us
       %2373 = :aten::nonzero [[8]] -> 41.888us
         %2374 = CCCL:cub::DeviceReduce::Sum [] -> 1.376us
                 -->kernel: 0:7 %2117 =  [] -> 1.376us
         %2375 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %2118 =  [] -> 992.000ns
                 -->kernel: 0:7 %2119 =  [] -> 1.792us
     %2376 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2120 =  [] -> 1.728us
     %2377 = :aten::index [[8], [8]] -> 41.504us
       %2378 = :aten::nonzero [[8]] -> 41.504us
         %2379 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2121 =  [] -> 1.408us
         %2380 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %2122 =  [] -> 992.000ns
                 -->kernel: 0:7 %2123 =  [] -> 1.760us
     %2381 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %2124 =  [] -> 1.760us
     %2382 = :aten::index [[8], [8]] -> 43.521us
       %2383 = :aten::nonzero [[8]] -> 43.521us
         %2384 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2125 =  [] -> 1.408us
         %2385 = CCCL:cub::DeviceSelect::Flagged [] -> 11.616us
                 -->kernel: 0:7 %2126 =  [] -> 992.000ns
                 -->kernel: 0:7 %2127 =  [] -> 1.792us
     %2386 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %2128 =  [] -> 1.696us
     %2387 = :aten::index [[8], [8]] -> 41.536us
       %2388 = :aten::nonzero [[8]] -> 41.536us
         %2389 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2129 =  [] -> 1.408us
         %2390 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %2130 =  [] -> 992.000ns
                 -->kernel: 0:7 %2131 =  [] -> 1.760us
     %2391 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2132 =  [] -> 1.728us
     %2392 = :aten::index [[8], [8]] -> 42.752us
       %2393 = :aten::nonzero [[8]] -> 42.752us
         %2394 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2133 =  [] -> 1.408us
         %2395 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %2134 =  [] -> 992.000ns
                 -->kernel: 0:7 %2135 =  [] -> 1.792us
     %2396 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2136 =  [] -> 1.728us
     %2397 = :aten::index [[8], [8]] -> 41.568us
       %2398 = :aten::nonzero [[8]] -> 41.568us
         %2399 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %2137 =  [] -> 1.440us
         %2400 = CCCL:cub::DeviceSelect::Flagged [] -> 11.328us
                 -->kernel: 0:7 %2138 =  [] -> 992.000ns
                 -->kernel: 0:7 %2139 =  [] -> 1.760us
     %2401 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %2140 =  [] -> 1.760us
     %2402 = :aten::index [[8], [8]] -> 41.728us
       %2403 = :aten::nonzero [[8]] -> 41.728us
         %2404 = CCCL:cub::DeviceReduce::Sum [] -> 1.376us
                 -->kernel: 0:7 %2141 =  [] -> 1.376us
         %2405 = CCCL:cub::DeviceSelect::Flagged [] -> 11.680us
                 -->kernel: 0:7 %2142 =  [] -> 1.024us
                 -->kernel: 0:7 %2143 =  [] -> 1.824us
     %2406 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2144 =  [] -> 1.728us
     %2407 = :aten::index [[8], [8]] -> 42.720us
       %2408 = :aten::nonzero [[8]] -> 42.720us
         %2409 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2145 =  [] -> 1.408us
         %2410 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %2146 =  [] -> 992.000ns
                 -->kernel: 0:7 %2147 =  [] -> 1.760us
     %2411 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2148 =  [] -> 1.728us
     %2412 = :aten::index [[8], [8]] -> 42.720us
       %2413 = :aten::nonzero [[8]] -> 42.720us
         %2414 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2149 =  [] -> 1.408us
         %2415 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %2150 =  [] -> 1.024us
                 -->kernel: 0:7 %2151 =  [] -> 1.792us
     %2416 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2152 =  [] -> 1.728us
     %2417 = :aten::index [[8], [8]] -> 41.984us
       %2418 = :aten::nonzero [[8]] -> 41.984us
         %2419 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2153 =  [] -> 1.408us
         %2420 = CCCL:cub::DeviceSelect::Flagged [] -> 11.264us
                 -->kernel: 0:7 %2154 =  [] -> 992.000ns
                 -->kernel: 0:7 %2155 =  [] -> 1.760us
     %2421 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2156 =  [] -> 1.728us
     %2422 = :aten::index [[8], [8]] -> 41.984us
       %2423 = :aten::nonzero [[8]] -> 41.984us
         %2424 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2157 =  [] -> 1.408us
         %2425 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %2158 =  [] -> 992.000ns
                 -->kernel: 0:7 %2159 =  [] -> 1.792us
     %2426 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2160 =  [] -> 1.728us
     %2427 = :aten::index [[8], [8]] -> 42.464us
       %2428 = :aten::nonzero [[8]] -> 42.464us
         %2429 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %2161 =  [] -> 1.440us
         %2430 = CCCL:cub::DeviceSelect::Flagged [] -> 11.360us
                 -->kernel: 0:7 %2162 =  [] -> 992.000ns
                 -->kernel: 0:7 %2163 =  [] -> 1.760us
     %2431 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %2164 =  [] -> 1.760us
     %2432 = :aten::index [[8], [8]] -> 41.921us
       %2433 = :aten::nonzero [[8]] -> 41.921us
         %2434 = CCCL:cub::DeviceReduce::Sum [] -> 1.376us
                 -->kernel: 0:7 %2165 =  [] -> 1.376us
         %2435 = CCCL:cub::DeviceSelect::Flagged [] -> 11.616us
                 -->kernel: 0:7 %2166 =  [] -> 992.000ns
                 -->kernel: 0:7 %2167 =  [] -> 1.792us
     %2436 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %2168 =  [] -> 1.696us
     %2437 = :aten::index [[8], [8]] -> 42.304us
       %2438 = :aten::nonzero [[8]] -> 42.304us
         %2439 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %2169 =  [] -> 1.440us
         %2440 = CCCL:cub::DeviceSelect::Flagged [] -> 11.424us
                 -->kernel: 0:7 %2170 =  [] -> 992.000ns
                 -->kernel: 0:7 %2171 =  [] -> 1.792us
     %2441 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %2172 =  [] -> 1.760us
     %2442 = :aten::index [[8], [8]] -> 41.760us
       %2443 = :aten::nonzero [[8]] -> 41.760us
         %2444 = CCCL:cub::DeviceReduce::Sum [] -> 1.376us
                 -->kernel: 0:7 %2173 =  [] -> 1.376us
         %2445 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %2174 =  [] -> 992.000ns
                 -->kernel: 0:7 %2175 =  [] -> 1.792us
     %2446 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %2176 =  [] -> 1.728us
     %2447 = :aten::index [[8], [8]] -> 41.472us
       %2448 = :aten::nonzero [[8]] -> 41.472us
         %2449 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %2177 =  [] -> 1.440us
         %2450 = CCCL:cub::DeviceSelect::Flagged [] -> 11.520us
                 -->kernel: 0:7 %2178 =  [] -> 992.000ns
                 -->kernel: 0:7 %2179 =  [] -> 1.760us
     %2451 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %2180 =  [] -> 1.760us
     %2452 = :aten::index [[8], [8]] -> 41.696us
       %2453 = :aten::nonzero [[8]] -> 41.696us
         %2454 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %2181 =  [] -> 1.408us
         %2455 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %2182 =  [] -> 992.000ns
                 -->kernel: 0:7 %2183 =  [] -> 1.824us
     %2456 = :aten::zeros [[], [], [], [], []] -> 1.120us
       %2457 = :aten::zero_ [[8, 24]] -> 1.120us
         %2458 = :aten::fill_ [[8, 24], []] -> 1.120us
                 -->kernel: 0:7 %2184 =  [] -> 1.120us
     %2459 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.744us
       %2460 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.744us
         %2461 = :nccl:_all_gather_base [[24]] -> 7.744us
           %2462 = NCCL:ncclAllGather [] -> 7.744us
                 -->kernel: 0:7 %2185 =  [] -> 7.744us
     %2463 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2186 =  [] -> 1.376us
     %2464 = :aten::index [[8], [8]] -> 52.481us
       %2465 = :aten::nonzero [[8]] -> 52.481us
         %2466 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2187 =  [] -> 1.216us
         %2467 = CCCL:cub::DeviceSelect::Flagged [] -> 17.857us
                 -->kernel: 0:7 %2188 =  [] -> 1.281us
                 -->kernel: 0:7 %2189 =  [] -> 2.080us
     %2468 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2190 =  [] -> 1.376us
     %2469 = :aten::index [[8], [8]] -> 43.296us
       %2470 = :aten::nonzero [[8]] -> 43.296us
         %2471 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2191 =  [] -> 1.216us
         %2472 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %2192 =  [] -> 1.248us
                 -->kernel: 0:7 %2193 =  [] -> 2.080us
     %2473 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2194 =  [] -> 1.376us
     %2474 = :aten::index [[8], [8]] -> 42.880us
       %2475 = :aten::nonzero [[8]] -> 42.880us
         %2476 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2195 =  [] -> 1.216us
         %2477 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %2196 =  [] -> 1.280us
                 -->kernel: 0:7 %2197 =  [] -> 2.048us
     %2478 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2198 =  [] -> 1.376us
     %2479 = :aten::index [[8], [8]] -> 42.464us
       %2480 = :aten::nonzero [[8]] -> 42.464us
         %2481 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %2199 =  [] -> 1.248us
         %2482 = CCCL:cub::DeviceSelect::Flagged [] -> 12.192us
                 -->kernel: 0:7 %2200 =  [] -> 1.280us
                 -->kernel: 0:7 %2201 =  [] -> 2.080us
     %2483 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2202 =  [] -> 1.344us
     %2484 = :aten::index [[8], [8]] -> 42.784us
       %2485 = :aten::nonzero [[8]] -> 42.784us
         %2486 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2203 =  [] -> 1.216us
         %2487 = CCCL:cub::DeviceSelect::Flagged [] -> 12.352us
                 -->kernel: 0:7 %2204 =  [] -> 1.280us
                 -->kernel: 0:7 %2205 =  [] -> 2.048us
     %2488 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2206 =  [] -> 1.344us
     %2489 = :aten::index [[8], [8]] -> 41.920us
       %2490 = :aten::nonzero [[8]] -> 41.920us
         %2491 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2207 =  [] -> 1.216us
         %2492 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %2208 =  [] -> 1.248us
                 -->kernel: 0:7 %2209 =  [] -> 2.112us
     %2493 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2210 =  [] -> 1.376us
     %2494 = :aten::index [[8], [8]] -> 43.648us
       %2495 = :aten::nonzero [[8]] -> 43.648us
         %2496 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2211 =  [] -> 1.216us
         %2497 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %2212 =  [] -> 1.280us
                 -->kernel: 0:7 %2213 =  [] -> 2.048us
     %2498 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2214 =  [] -> 1.376us
     %2499 = :aten::index [[8], [8]] -> 42.176us
       %2500 = :aten::nonzero [[8]] -> 42.176us
         %2501 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2215 =  [] -> 1.216us
         %2502 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %2216 =  [] -> 1.248us
                 -->kernel: 0:7 %2217 =  [] -> 2.080us
     %2503 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2218 =  [] -> 1.344us
     %2504 = :aten::index [[8], [8]] -> 43.584us
       %2505 = :aten::nonzero [[8]] -> 43.584us
         %2506 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2219 =  [] -> 1.216us
         %2507 = CCCL:cub::DeviceSelect::Flagged [] -> 12.384us
                 -->kernel: 0:7 %2220 =  [] -> 1.280us
                 -->kernel: 0:7 %2221 =  [] -> 2.048us
     %2508 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2222 =  [] -> 1.376us
     %2509 = :aten::index [[8], [8]] -> 42.272us
       %2510 = :aten::nonzero [[8]] -> 42.272us
         %2511 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2223 =  [] -> 1.216us
         %2512 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %2224 =  [] -> 1.248us
                 -->kernel: 0:7 %2225 =  [] -> 2.112us
     %2513 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2226 =  [] -> 1.344us
     %2514 = :aten::index [[8], [8]] -> 42.273us
       %2515 = :aten::nonzero [[8]] -> 42.273us
         %2516 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2227 =  [] -> 1.216us
         %2517 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %2228 =  [] -> 1.280us
                 -->kernel: 0:7 %2229 =  [] -> 2.048us
     %2518 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2230 =  [] -> 1.376us
     %2519 = :aten::index [[8], [8]] -> 47.648us
       %2520 = :aten::nonzero [[8]] -> 47.648us
         %2521 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2231 =  [] -> 1.216us
         %2522 = CCCL:cub::DeviceSelect::Flagged [] -> 12.608us
                 -->kernel: 0:7 %2232 =  [] -> 1.248us
                 -->kernel: 0:7 %2233 =  [] -> 2.112us
     %2523 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2234 =  [] -> 1.376us
     %2524 = :aten::index [[8], [8]] -> 42.848us
       %2525 = :aten::nonzero [[8]] -> 42.848us
         %2526 = CCCL:cub::DeviceReduce::Sum [] -> 1.184us
                 -->kernel: 0:7 %2235 =  [] -> 1.184us
         %2527 = CCCL:cub::DeviceSelect::Flagged [] -> 12.544us
                 -->kernel: 0:7 %2236 =  [] -> 1.280us
                 -->kernel: 0:7 %2237 =  [] -> 2.048us
     %2528 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2238 =  [] -> 1.376us
     %2529 = :aten::index [[8], [8]] -> 42.465us
       %2530 = :aten::nonzero [[8]] -> 42.465us
         %2531 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2239 =  [] -> 1.216us
         %2532 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %2240 =  [] -> 1.280us
                 -->kernel: 0:7 %2241 =  [] -> 2.080us
     %2533 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2242 =  [] -> 1.344us
     %2534 = :aten::index [[8], [8]] -> 43.008us
       %2535 = :aten::nonzero [[8]] -> 43.008us
         %2536 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2243 =  [] -> 1.216us
         %2537 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %2244 =  [] -> 1.280us
                 -->kernel: 0:7 %2245 =  [] -> 2.080us
     %2538 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2246 =  [] -> 1.376us
     %2539 = :aten::index [[8], [8]] -> 47.296us
       %2540 = :aten::nonzero [[8]] -> 47.296us
         %2541 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %2247 =  [] -> 1.248us
         %2542 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %2248 =  [] -> 1.248us
                 -->kernel: 0:7 %2249 =  [] -> 2.080us
     %2543 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2250 =  [] -> 1.344us
     %2544 = :aten::index [[8], [8]] -> 42.880us
       %2545 = :aten::nonzero [[8]] -> 42.880us
         %2546 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2251 =  [] -> 1.216us
         %2547 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %2252 =  [] -> 1.280us
                 -->kernel: 0:7 %2253 =  [] -> 2.048us
     %2548 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2254 =  [] -> 1.376us
     %2549 = :aten::index [[8], [8]] -> 42.720us
       %2550 = :aten::nonzero [[8]] -> 42.720us
         %2551 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2255 =  [] -> 1.216us
         %2552 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %2256 =  [] -> 1.248us
                 -->kernel: 0:7 %2257 =  [] -> 2.080us
     %2553 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2258 =  [] -> 1.344us
     %2554 = :aten::index [[8], [8]] -> 43.360us
       %2555 = :aten::nonzero [[8]] -> 43.360us
         %2556 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %2259 =  [] -> 1.248us
         %2557 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %2260 =  [] -> 1.312us
                 -->kernel: 0:7 %2261 =  [] -> 2.048us
     %2558 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2262 =  [] -> 1.376us
     %2559 = :aten::index [[8], [8]] -> 41.952us
       %2560 = :aten::nonzero [[8]] -> 41.952us
         %2561 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2263 =  [] -> 1.216us
         %2562 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %2264 =  [] -> 1.248us
                 -->kernel: 0:7 %2265 =  [] -> 2.080us
     %2563 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2266 =  [] -> 1.376us
     %2564 = :aten::index [[8], [8]] -> 42.432us
       %2565 = :aten::nonzero [[8]] -> 42.432us
         %2566 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %2267 =  [] -> 1.216us
         %2567 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2268 =  [] -> 1.312us
                 -->kernel: 0:7 %2269 =  [] -> 2.048us
     %2568 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2270 =  [] -> 1.376us
     %2569 = :aten::index [[8], [8]] -> 43.072us
       %2570 = :aten::nonzero [[8]] -> 43.072us
         %2571 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %2271 =  [] -> 1.248us
         %2572 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %2272 =  [] -> 1.248us
                 -->kernel: 0:7 %2273 =  [] -> 2.080us
     %2573 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %2274 =  [] -> 1.344us
     %2574 = :aten::index [[8], [8]] -> 41.856us
       %2575 = :aten::nonzero [[8]] -> 41.856us
         %2576 = CCCL:cub::DeviceReduce::Sum [] -> 1.184us
                 -->kernel: 0:7 %2275 =  [] -> 1.184us
         %2577 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %2276 =  [] -> 1.280us
                 -->kernel: 0:7 %2277 =  [] -> 2.048us
     %2578 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %2278 =  [] -> 1.376us
     %2579 = :aten::index [[8], [8]] -> 43.137us
       %2580 = :aten::nonzero [[8]] -> 43.137us
         %2581 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %2279 =  [] -> 1.248us
         %2582 = CCCL:cub::DeviceSelect::Flagged [] -> 12.640us
                 -->kernel: 0:7 %2280 =  [] -> 1.248us
                 -->kernel: 0:7 %2281 =  [] -> 2.080us
     %2583 = :aten::zero_ [[3002413056]] -> 1.802ms
       %2584 = :aten::fill_ [[3002413056], []] -> 1.802ms
                 -->kernel: 0:7 %2282 =  [] -> 441.409us
                 -->kernel: 0:7 %2283 =  [] -> 441.505us
                 -->kernel: 0:7 %2284 =  [] -> 441.665us
                 -->kernel: 0:7 %2285 =  [] -> 441.473us
     %2585 = :aten::zero_ [[352321536]] -> 207.873us
       %2586 = :aten::fill_ [[352321536], []] -> 207.873us
                 -->kernel: 0:7 %2286 =  [] -> 207.873us
     %2587 = :aten::zeros [[], [], [], [], []] -> 1.088us
       %2588 = :aten::zero_ [[]] -> 1.088us
         %2589 = :aten::fill_ [[], []] -> 1.088us
                 -->kernel: 0:7 %2287 =  [] -> 1.088us
     %2590 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.328us
       %2591 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.328us
         %2592 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.328us
     %2593 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 2.848us
       %2594 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 2.848us
         %2595 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 2.848us
     %2596 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 1.472us
       %2597 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 1.472us
         %2598 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.472us
     %2599 = :aten::to [[1, 1, 4096, 4096], [], [], [], [], [], [], []] -> 294.113us
       %2600 = :aten::_to_copy [[1, 1, 4096, 4096], [], [], [], [], [], []] -> 294.113us
         %2601 = :aten::copy_ [[1, 1, 4096, 4096], [1, 1, 4096, 4096], []] -> 294.113us
     %2602 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.264us
       %2603 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.264us
         %2604 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.264us
     %2605 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 270.529us
       %2606 = :aten::index_select [[129280, 7168], [], [4096]] -> 270.529us
                 -->kernel: 0:7 %2288 =  [] -> 270.529us
     %2607 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 127.456us
       %2608 = :nvte_rmsnorm_fwd [] -> 127.456us
                 -->kernel: 0:7 %2289 =  [] -> 127.456us
     %2609 = :TELinear forward [] -> 657.026us
       %2610 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 657.026us
         %2611 = :nvte_quantize_v2 [] -> 73.505us
           %2612 = :quantize_transpose_vector_blockwise [] -> 73.505us
                 -->kernel: 0:7 %2290 =  [] -> 73.505us
         %2613 = :nvte_quantize_v2 [] -> 20.352us
           %2614 = :quantize_transpose_square_blockwise [] -> 20.352us
                 -->kernel: 0:7 %2291 =  [] -> 20.352us
         %2615 = :nvte_cublas_gemm_scaled [] -> 337.185us
                 -->kernel: 0:7 %2292 =  [] -> 327.457us
     %2616 = :TELinear forward [] -> 407.840us
       %2617 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 407.840us
         %2618 = :nvte_quantize_v2 [] -> 72.640us
           %2619 = :quantize_transpose_vector_blockwise [] -> 72.640us
                 -->kernel: 0:7 %2293 =  [] -> 72.640us
         %2620 = :nvte_quantize_v2 [] -> 11.776us
           %2621 = :quantize_transpose_square_blockwise [] -> 11.776us
                 -->kernel: 0:7 %2294 =  [] -> 11.776us
         %2622 = :nvte_cublas_gemm_scaled [] -> 203.136us
                 -->kernel: 0:7 %2295 =  [] -> 196.896us
     %2623 = :TELayerNormColumnParallelLinear forward [] -> 1.381ms
       %2624 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.381ms
         %2625 = :nvte_rmsnorm_fwd [] -> 30.080us
                 -->kernel: 0:7 %2296 =  [] -> 30.080us
         %2626 = :nvte_quantize_v2 [] -> 16.864us
           %2627 = :quantize_transpose_vector_blockwise [] -> 16.864us
                 -->kernel: 0:7 %2297 =  [] -> 16.864us
         %2628 = :nvte_quantize_v2 [] -> 58.112us
           %2629 = :quantize_transpose_square_blockwise [] -> 58.112us
                 -->kernel: 0:7 %2298 =  [] -> 58.112us
         %2630 = :nvte_cublas_gemm_scaled [] -> 1.128ms
                 -->kernel: 0:7 %2299 =  [] -> 1.121ms
     %2631 = :TELayerNormColumnParallelLinear forward [] -> 896.098us
       %2632 = :aten::contiguous [[4096, 1, 512], []] -> 11.584us
         %2633 = :aten::clone [[4096, 1, 512], []] -> 11.584us
           %2634 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.584us
                 -->kernel: 0:7 %2300 =  [] -> 11.584us
       %2635 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 690.658us
         %2636 = :nvte_rmsnorm_fwd [] -> 4.224us
                 -->kernel: 0:7 %2301 =  [] -> 4.224us
         %2637 = :nvte_quantize_v2 [] -> 7.776us
           %2638 = :quantize_transpose_vector_blockwise [] -> 7.776us
                 -->kernel: 0:7 %2302 =  [] -> 7.776us
         %2639 = :nvte_quantize_v2 [] -> 28.640us
           %2640 = :quantize_transpose_square_blockwise [] -> 28.640us
                 -->kernel: 0:7 %2303 =  [] -> 28.640us
         %2641 = :nvte_cublas_gemm_scaled [] -> 521.249us
                 -->kernel: 0:7 %2304 =  [] -> 514.849us
     %2642 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.208us
                 -->kernel: 0:7 %2305 =  [] -> 114.208us
     %2643 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 173.281us
                 -->kernel: 0:7 %2306 =  [] -> 173.281us
     %2644 = :TEDotProductAttention forward [] -> 22.481ms
       %2645 = :aten::arange [[], [], [], [], []] -> 1.152us
         %2646 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %2307 =  [] -> 1.152us
       %2647 = :aten::arange [[], [], [], [], []] -> 1.120us
         %2648 = :aten::arange [[], [], [], [0]] -> 1.120us
                 -->kernel: 0:7 %2308 =  [] -> 1.120us
       %2649 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 61.376us
                 -->kernel: 0:7 %2309 =  [] -> 61.376us
       %2650 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 38.624us
                 -->kernel: 0:7 %2310 =  [] -> 38.624us
       %2651 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.688us
                 -->kernel: 0:7 %2311 =  [] -> 38.688us
       %2652 = :aten::le [[1, 1, 4096, 4096], []] -> 29.536us
                 -->kernel: 0:7 %2312 =  [] -> 29.536us
       %2653 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.352us
                 -->kernel: 0:7 %2313 =  [] -> 24.352us
       %2654 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.336us
                 -->kernel: 0:7 %2314 =  [] -> 14.336us
       %2655 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.816us
         %2656 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.816us
                 -->kernel: 0:7 %2315 =  [] -> 18.816us
       %2657 = :aten::logical_not [[1, 1, 4096, 4096]] -> 13.024us
         %2658 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 13.024us
                 -->kernel: 0:7 %2316 =  [] -> 13.024us
       %2659 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.336us
         %2660 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.336us
                 -->kernel: 0:7 %2317 =  [] -> 18.336us
       %2661 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.809ms
                 -->kernel: 0:7 %2318 =  [] -> 5.801ms
       %2662 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 10.999ms
         %2663 = :nvte_scaled_masked_softmax_forward [] -> 10.999ms
                 -->kernel: 0:7 %2319 =  [] -> 10.999ms
       %2664 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.981ms
                 -->kernel: 0:7 %2320 =  [] -> 3.967ms
       %2665 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.657us
         %2666 = :aten::clone [[4096, 1, 128, 128], []] -> 278.657us
           %2667 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.657us
                 -->kernel: 0:7 %2321 =  [] -> 278.657us
     %2668 = :TERowParallelLinear forward [] -> 3.825ms
       %2669 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.825ms
         %2670 = :nvte_quantize_v2 [] -> 97.312us
           %2671 = :quantize_transpose_vector_blockwise [] -> 97.312us
                 -->kernel: 0:7 %2322 =  [] -> 97.312us
         %2672 = :nvte_quantize_v2 [] -> 169.184us
           %2673 = :quantize_transpose_square_blockwise [] -> 169.184us
                 -->kernel: 0:7 %2323 =  [] -> 169.184us
         %2674 = :nvte_cublas_gemm_scaled [] -> 3.404ms
                 -->kernel: 0:7 %2324 =  [] -> 3.397ms
     %2675 = :Torch-Compiled Region: 1/2 None -> 44.128us
       %2676 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.128us
         %2677 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.128us
                 -->kernel: 0:7 %2325 =  [] -> 44.128us
     %2678 = :TELayerNormColumnParallelLinear forward [] -> 8.426ms
       %2679 = :_LayerNormLinear [[4096, 1, 7168], [7168], [], [36864, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 8.426ms
         %2680 = :nvte_rmsnorm_fwd [] -> 126.752us
                 -->kernel: 0:7 %2326 =  [] -> 126.752us
         %2681 = :nvte_quantize_v2 [] -> 73.793us
           %2682 = :quantize_transpose_vector_blockwise [] -> 73.793us
                 -->kernel: 0:7 %2327 =  [] -> 73.793us
         %2683 = :nvte_quantize_v2 [] -> 388.833us
           %2684 = :quantize_transpose_square_blockwise [] -> 388.833us
                 -->kernel: 0:7 %2328 =  [] -> 388.833us
         %2685 = :nvte_cublas_gemm_scaled [] -> 7.679ms
                 -->kernel: 0:7 %2329 =  [] -> 7.672ms
     %2686 = :SwiGLUFunction [[4096, 36864], [], []] -> 131.776us
       %2687 = :Torch-Compiled Region: 2/0 None -> 131.776us
         %2688 = :triton_poi_fused_mul_silu_0 [[4096, 36864], [4096, 18432], [], []] -> 131.776us
                 -->kernel: 0:7 %2330 =  [] -> 131.776us
     %2689 = :TERowParallelLinear forward [] -> 4.344ms
       %2690 = :_Linear [[7168, 18432], [4096, 1, 18432], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 4.344ms
         %2691 = :nvte_quantize_v2 [] -> 185.056us
           %2692 = :quantize_transpose_vector_blockwise [] -> 185.056us
                 -->kernel: 0:7 %2331 =  [] -> 185.056us
         %2693 = :nvte_quantize_v2 [] -> 193.697us
           %2694 = :quantize_transpose_square_blockwise [] -> 193.697us
                 -->kernel: 0:7 %2332 =  [] -> 193.697us
         %2695 = :nvte_cublas_gemm_scaled [] -> 3.833ms
                 -->kernel: 0:7 %2333 =  [] -> 3.826ms
     %2696 = :Torch-Compiled Region: 1/2 None -> 44.992us
       %2697 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.992us
         %2698 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.992us
                 -->kernel: 0:7 %2334 =  [] -> 44.992us
     %2699 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 125.921us
       %2700 = :nvte_rmsnorm_fwd [] -> 125.921us
                 -->kernel: 0:7 %2335 =  [] -> 125.921us
     %2701 = :TELinear forward [] -> 561.570us
       %2702 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 561.570us
         %2703 = :nvte_quantize_v2 [] -> 73.024us
           %2704 = :quantize_transpose_vector_blockwise [] -> 73.024us
                 -->kernel: 0:7 %2336 =  [] -> 73.024us
         %2705 = :nvte_quantize_v2 [] -> 20.352us
           %2706 = :quantize_transpose_square_blockwise [] -> 20.352us
                 -->kernel: 0:7 %2337 =  [] -> 20.352us
         %2707 = :nvte_cublas_gemm_scaled [] -> 333.377us
                 -->kernel: 0:7 %2338 =  [] -> 327.169us
     %2708 = :TELinear forward [] -> 404.033us
       %2709 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 404.033us
         %2710 = :nvte_quantize_v2 [] -> 73.088us
           %2711 = :quantize_transpose_vector_blockwise [] -> 73.088us
                 -->kernel: 0:7 %2339 =  [] -> 73.088us
         %2712 = :nvte_quantize_v2 [] -> 11.488us
           %2713 = :quantize_transpose_square_blockwise [] -> 11.488us
                 -->kernel: 0:7 %2340 =  [] -> 11.488us
         %2714 = :nvte_cublas_gemm_scaled [] -> 202.784us
                 -->kernel: 0:7 %2341 =  [] -> 196.544us
     %2715 = :TELayerNormColumnParallelLinear forward [] -> 1.364ms
       %2716 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.364ms
         %2717 = :nvte_rmsnorm_fwd [] -> 31.200us
                 -->kernel: 0:7 %2342 =  [] -> 31.200us
         %2718 = :nvte_quantize_v2 [] -> 16.992us
           %2719 = :quantize_transpose_vector_blockwise [] -> 16.992us
                 -->kernel: 0:7 %2343 =  [] -> 16.992us
         %2720 = :nvte_quantize_v2 [] -> 57.824us
           %2721 = :quantize_transpose_square_blockwise [] -> 57.824us
                 -->kernel: 0:7 %2344 =  [] -> 57.824us
         %2722 = :nvte_cublas_gemm_scaled [] -> 1.126ms
                 -->kernel: 0:7 %2345 =  [] -> 1.120ms
     %2723 = :TELayerNormColumnParallelLinear forward [] -> 901.922us
       %2724 = :aten::contiguous [[4096, 1, 512], []] -> 11.840us
         %2725 = :aten::clone [[4096, 1, 512], []] -> 11.840us
           %2726 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.840us
                 -->kernel: 0:7 %2346 =  [] -> 11.840us
       %2727 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 699.361us
         %2728 = :nvte_rmsnorm_fwd [] -> 4.192us
                 -->kernel: 0:7 %2347 =  [] -> 4.192us
         %2729 = :nvte_quantize_v2 [] -> 7.648us
           %2730 = :quantize_transpose_vector_blockwise [] -> 7.648us
                 -->kernel: 0:7 %2348 =  [] -> 7.648us
         %2731 = :nvte_quantize_v2 [] -> 28.480us
           %2732 = :quantize_transpose_square_blockwise [] -> 28.480us
                 -->kernel: 0:7 %2349 =  [] -> 28.480us
         %2733 = :nvte_cublas_gemm_scaled [] -> 520.321us
                 -->kernel: 0:7 %2350 =  [] -> 514.209us
     %2734 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 113.728us
                 -->kernel: 0:7 %2351 =  [] -> 113.728us
     %2735 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 172.960us
                 -->kernel: 0:7 %2352 =  [] -> 172.960us
     %2736 = :TEDotProductAttention forward [] -> 22.402ms
       %2737 = :aten::arange [[], [], [], [], []] -> 1.184us
         %2738 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %2353 =  [] -> 1.184us
       %2739 = :aten::arange [[], [], [], [], []] -> 1.152us
         %2740 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %2354 =  [] -> 1.152us
       %2741 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 60.928us
                 -->kernel: 0:7 %2355 =  [] -> 60.928us
       %2742 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 38.880us
                 -->kernel: 0:7 %2356 =  [] -> 38.880us
       %2743 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.880us
                 -->kernel: 0:7 %2357 =  [] -> 38.880us
       %2744 = :aten::le [[1, 1, 4096, 4096], []] -> 28.128us
                 -->kernel: 0:7 %2358 =  [] -> 28.128us
       %2745 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.864us
                 -->kernel: 0:7 %2359 =  [] -> 24.864us
       %2746 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.208us
                 -->kernel: 0:7 %2360 =  [] -> 14.208us
       %2747 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.752us
         %2748 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.752us
                 -->kernel: 0:7 %2361 =  [] -> 18.752us
       %2749 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.736us
         %2750 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.736us
                 -->kernel: 0:7 %2362 =  [] -> 12.736us
       %2751 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.240us
         %2752 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.240us
                 -->kernel: 0:7 %2363 =  [] -> 18.240us
       %2753 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.800ms
                 -->kernel: 0:7 %2364 =  [] -> 5.792ms
       %2754 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.002ms
         %2755 = :nvte_scaled_masked_softmax_forward [] -> 11.002ms
                 -->kernel: 0:7 %2365 =  [] -> 11.002ms
       %2756 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.979ms
                 -->kernel: 0:7 %2366 =  [] -> 3.966ms
       %2757 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.817us
         %2758 = :aten::clone [[4096, 1, 128, 128], []] -> 278.817us
           %2759 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.817us
                 -->kernel: 0:7 %2367 =  [] -> 278.817us
     %2760 = :TERowParallelLinear forward [] -> 3.830ms
       %2761 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.830ms
         %2762 = :nvte_quantize_v2 [] -> 96.448us
           %2763 = :quantize_transpose_vector_blockwise [] -> 96.448us
                 -->kernel: 0:7 %2368 =  [] -> 96.448us
         %2764 = :nvte_quantize_v2 [] -> 168.033us
           %2765 = :quantize_transpose_square_blockwise [] -> 168.033us
                 -->kernel: 0:7 %2369 =  [] -> 168.033us
         %2766 = :nvte_cublas_gemm_scaled [] -> 3.415ms
                 -->kernel: 0:7 %2370 =  [] -> 3.408ms
     %2767 = :Torch-Compiled Region: 1/2 None -> 44.000us
       %2768 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.000us
         %2769 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.000us
                 -->kernel: 0:7 %2371 =  [] -> 44.000us
     %2770 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.368us
       %2771 = :nvte_rmsnorm_fwd [] -> 126.368us
                 -->kernel: 0:7 %2372 =  [] -> 126.368us
     %2772 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 43.040us
       %2773 = :nvte_cublas_gemm_scaled [] -> 43.040us
                 -->kernel: 0:7 %2373 =  [] -> 22.080us
                 -->kernel: 0:7 %2374 =  [] -> 2.592us
     %2774 = :RandomSTE [[4096, 1, 32]] -> 45.760us
       %2775 = :aten::clone [[4096, 1, 32], []] -> 1.568us
         %2776 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.568us
       %2777 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.704us
                 -->kernel: 0:7 %2375 =  [] -> 4.704us
     %2778 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 70.560us
       %2779 = :nvte_fused_topk_with_score_function_forward [] -> 70.560us
                 -->kernel: 0:7 %2376 =  [] -> 70.560us
     %2780 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 26.976us
       %2781 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 26.976us
                 -->kernel: 0:7 %2377 =  [] -> 26.976us
     %2782 = :aten::sum [[4096, 32], [], [], []] -> 46.944us
       %2783 = :aten::to [[4096, 32], [], [], [], []] -> 4.864us
         %2784 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.864us
           %2785 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.864us
                 -->kernel: 0:7 %2378 =  [] -> 4.864us
                 -->kernel: 0:7 %2379 =  [] -> 9.856us
     %2786 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.128us
       %2787 = :nvte_fused_moe_aux_loss_forward [] -> 12.128us
                 -->kernel: 0:7 %2380 =  [] -> 12.128us
     %2788 = :aten::div [[], []] -> 1.152us
                 -->kernel: 0:7 %2381 =  [] -> 1.152us
     %2789 = :aten::div [[], []] -> 1.216us
                 -->kernel: 0:7 %2382 =  [] -> 1.216us
     %2790 = :aten::add_ [[], [], []] -> 1.536us
                 -->kernel: 0:7 %2383 =  [] -> 1.536us
     %2791 = :aten::sum [[4096, 32], [], [], []] -> 36.576us
       %2792 = :aten::to [[4096, 32], [], [], [], []] -> 4.640us
         %2793 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.640us
           %2794 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.640us
                 -->kernel: 0:7 %2384 =  [] -> 4.640us
                 -->kernel: 0:7 %2385 =  [] -> 7.680us
     %2795 = :aten::add_ [[32], [32], []] -> 4.384us
                 -->kernel: 0:7 %2386 =  [] -> 4.384us
     %2796 = :aten::topk [[4096, 32], [], [], [], []] -> 54.241us
                 -->kernel: 0:7 %2387 =  [] -> 14.176us
                 -->kernel: 0:7 %2388 =  [] -> 7.680us
     %2797 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 1.088ms
                 -->kernel: 0:26 %2389 =  [] -> 44.448us
                 -->kernel: 0:26 %2390 =  [] -> 161.601us
                 -->kernel: 0:26 %2391 =  [] -> 754.561us
     %2798 = :TEColumnParallelLinear forward [] -> 1.140ms
       %2799 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.140ms
         %2800 = :nvte_quantize_v2 [] -> 45.472us
           %2801 = :quantize_transpose_vector_blockwise [] -> 45.472us
                 -->kernel: 0:7 %2392 =  [] -> 45.472us
         %2802 = :nvte_quantize_v2 [] -> 44.512us
           %2803 = :quantize_transpose_square_blockwise [] -> 44.512us
                 -->kernel: 0:7 %2393 =  [] -> 44.512us
         %2804 = :nvte_cublas_gemm_scaled [] -> 916.642us
                 -->kernel: 0:7 %2394 =  [] -> 909.538us
     %2805 = :SwiGLUFunction [[4096, 4096], [], []] -> 27.105us
       %2806 = :Torch-Compiled Region: 2/1 None -> 27.105us
         %2807 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 27.105us
                 -->kernel: 0:7 %2395 =  [] -> 27.105us
     %2808 = :TERowParallelLinear forward [] -> 610.017us
       %2809 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 610.017us
         %2810 = :nvte_quantize_v2 [] -> 22.912us
           %2811 = :quantize_transpose_vector_blockwise [] -> 22.912us
                 -->kernel: 0:7 %2396 =  [] -> 22.912us
         %2812 = :nvte_quantize_v2 [] -> 24.576us
           %2813 = :quantize_transpose_square_blockwise [] -> 24.576us
                 -->kernel: 0:7 %2397 =  [] -> 24.576us
         %2814 = :nvte_cublas_gemm_scaled [] -> 442.945us
                 -->kernel: 0:7 %2398 =  [] -> 437.121us
     %2815 = :IndicesToMultihot [[15753, 8], [15753, 8], []] -> 11.200us
                 -->kernel: 0:7 %2399 =  [] -> 11.200us
     %2816 = :aten::contiguous [[4, 15753], []] -> 2.944us
       %2817 = :aten::clone [[4, 15753], []] -> 2.944us
         %2818 = :aten::copy_ [[4, 15753], [4, 15753], []] -> 2.944us
                 -->kernel: 0:7 %2400 =  [] -> 2.944us
     %2819 = :aten::to [[4, 15753], [], [], [], []] -> 4.896us
       %2820 = :aten::_to_copy [[4, 15753], [], [], [], [], [], []] -> 4.896us
         %2821 = :aten::copy_ [[4, 15753], [4, 15753], []] -> 4.896us
                 -->kernel: 0:7 %2401 =  [] -> 4.896us
                 -->kernel: 0:7 %2402 =  [] -> 23.264us
     %2822 = :_moe_permute_mask_map [[15753, 7168], [15753, 4], [], [15753, 4]] -> 407.649us
                 -->kernel: 0:7 %2403 =  [] -> 2.112us
                 -->kernel: 0:7 %2404 =  [] -> 2.528us
                 -->kernel: 0:7 %2405 =  [] -> 13.280us
                 -->kernel: 0:7 %2406 =  [] -> 201.856us
     %2823 = :TEColumnParallelGroupedLinear forward [] -> 8.468ms
       %2824 = :_GroupedLinear [[32928, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.468ms
         %2825 = :nvte_quantize_v2 [] -> 220.833us
           %2826 = :quantize_transpose_vector_blockwise [] -> 220.833us
                 -->kernel: 0:7 %2407 =  [] -> 220.833us
         %2827 = :nvte_quantize_v2 [] -> 220.000us
           %2828 = :quantize_transpose_vector_blockwise [] -> 220.000us
                 -->kernel: 0:7 %2408 =  [] -> 220.000us
         %2829 = :nvte_quantize_v2 [] -> 223.041us
           %2830 = :quantize_transpose_vector_blockwise [] -> 223.041us
                 -->kernel: 0:7 %2409 =  [] -> 223.041us
         %2831 = :nvte_quantize_v2 [] -> 223.104us
           %2832 = :quantize_transpose_vector_blockwise [] -> 223.104us
                 -->kernel: 0:7 %2410 =  [] -> 223.104us
         %2833 = :nvte_quantize_v2 [] -> 45.600us
           %2834 = :quantize_transpose_square_blockwise [] -> 45.600us
                 -->kernel: 0:7 %2411 =  [] -> 45.600us
         %2835 = :nvte_quantize_v2 [] -> 46.337us
           %2836 = :quantize_transpose_square_blockwise [] -> 46.337us
                 -->kernel: 0:7 %2412 =  [] -> 46.337us
         %2837 = :nvte_quantize_v2 [] -> 46.048us
           %2838 = :quantize_transpose_square_blockwise [] -> 46.048us
                 -->kernel: 0:7 %2413 =  [] -> 46.048us
         %2839 = :nvte_quantize_v2 [] -> 45.472us
           %2840 = :quantize_transpose_square_blockwise [] -> 45.472us
                 -->kernel: 0:7 %2414 =  [] -> 45.472us
         %2841 = :nvte_multi_stream_cublas_gemm [] -> 7.087ms
           %2842 = :nvte_cublas_gemm [] -> 1.756ms
                 -->kernel: 0:159 %2415 =  [] -> 1.747ms
           %2843 = :nvte_cublas_gemm [] -> 1.752ms
                 -->kernel: 0:160 %2416 =  [] -> 1.745ms
           %2844 = :nvte_cublas_gemm [] -> 1.752ms
                 -->kernel: 0:161 %2417 =  [] -> 1.748ms
           %2845 = :nvte_cublas_gemm [] -> 1.753ms
                 -->kernel: 0:162 %2418 =  [] -> 1.747ms
     %2846 = :WeightedSwiGLUFunction [[32928, 4096], [32928, 1], []] -> 120.640us
       %2847 = :Torch-Compiled Region: 3/1 None -> 120.640us
         %2848 = :triton_poi_fused__to_copy_mul_silu_0 [[32928, 4096], [32928, 1], [32928, 2048], [], []] -> 120.640us
                 -->kernel: 0:7 %2419 =  [] -> 120.640us
     %2849 = :TERowParallelGroupedLinear forward [] -> 4.234ms
       %2850 = :_GroupedLinear [[32928, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.234ms
         %2851 = :nvte_quantize_v2 [] -> 68.160us
           %2852 = :quantize_transpose_vector_blockwise [] -> 68.160us
                 -->kernel: 0:7 %2420 =  [] -> 68.160us
         %2853 = :nvte_quantize_v2 [] -> 69.024us
           %2854 = :quantize_transpose_vector_blockwise [] -> 69.024us
                 -->kernel: 0:7 %2421 =  [] -> 69.024us
         %2855 = :nvte_quantize_v2 [] -> 69.569us
           %2856 = :quantize_transpose_vector_blockwise [] -> 69.569us
                 -->kernel: 0:7 %2422 =  [] -> 69.569us
         %2857 = :nvte_quantize_v2 [] -> 69.792us
           %2858 = :quantize_transpose_vector_blockwise [] -> 69.792us
                 -->kernel: 0:7 %2423 =  [] -> 69.792us
         %2859 = :nvte_quantize_v2 [] -> 24.736us
           %2860 = :quantize_transpose_square_blockwise [] -> 24.736us
                 -->kernel: 0:7 %2424 =  [] -> 24.736us
         %2861 = :nvte_quantize_v2 [] -> 24.640us
           %2862 = :quantize_transpose_square_blockwise [] -> 24.640us
                 -->kernel: 0:7 %2425 =  [] -> 24.640us
         %2863 = :nvte_quantize_v2 [] -> 24.864us
           %2864 = :quantize_transpose_square_blockwise [] -> 24.864us
                 -->kernel: 0:7 %2426 =  [] -> 24.864us
         %2865 = :nvte_quantize_v2 [] -> 24.096us
           %2866 = :quantize_transpose_square_blockwise [] -> 24.096us
                 -->kernel: 0:7 %2427 =  [] -> 24.096us
         %2867 = :nvte_multi_stream_cublas_gemm [] -> 3.577ms
           %2868 = :nvte_cublas_gemm [] -> 876.930us
                 -->kernel: 0:159 %2428 =  [] -> 869.378us
           %2869 = :nvte_cublas_gemm [] -> 873.794us
                 -->kernel: 0:160 %2429 =  [] -> 868.738us
           %2870 = :nvte_cublas_gemm [] -> 883.362us
                 -->kernel: 0:161 %2430 =  [] -> 879.938us
           %2871 = :nvte_cublas_gemm [] -> 884.098us
                 -->kernel: 0:162 %2431 =  [] -> 880.066us
     %2872 = :_moe_unpermute_mask_map [[32928, 7168], [15753, 9], [], []] -> 226.401us
                 -->kernel: 0:7 %2432 =  [] -> 226.401us
     %2873 = :FusedCombine [[15753, 7168], [], []] -> 746.754us
                 -->kernel: 0:26 %2433 =  [] -> 13.856us
                 -->kernel: 0:26 %2434 =  [] -> 698.530us
     %2874 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.256us
                 -->kernel: 0:7 %2435 =  [] -> 52.256us
     %2875 = :Torch-Compiled Region: 1/2 None -> 47.296us
       %2876 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 47.296us
         %2877 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 47.296us
                 -->kernel: 0:7 %2436 =  [] -> 47.296us
     %2878 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.177us
       %2879 = :nvte_rmsnorm_fwd [] -> 126.177us
                 -->kernel: 0:7 %2437 =  [] -> 126.177us
     %2880 = :aten::roll [[1, 4096], [], []] -> 2.112us
                 -->kernel: 0:7 %2438 =  [] -> 2.112us
     %2881 = :aten::fill_ [[1], []] -> 1.024us
                 -->kernel: 0:7 %2439 =  [] -> 1.024us
     %2882 = :aten::sum [[1, 4096], []] -> 3.776us
       %2883 = :aten::sum [[1, 4096], [], [], []] -> 3.776us
                 -->kernel: 0:7 %2440 =  [] -> 3.776us
     %2884 = :aten::roll [[1, 4096], [], []] -> 2.112us
                 -->kernel: 0:7 %2441 =  [] -> 2.112us
     %2885 = :aten::fill_ [[1], []] -> 1.088us
                 -->kernel: 0:7 %2442 =  [] -> 1.088us
     %2886 = :aten::sum [[1, 4096], []] -> 3.040us
       %2887 = :aten::sum [[1, 4096], [], [], []] -> 3.040us
                 -->kernel: 0:7 %2443 =  [] -> 3.040us
     %2888 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 272.512us
       %2889 = :aten::index_select [[129280, 7168], [], [4096]] -> 272.512us
                 -->kernel: 0:7 %2444 =  [] -> 272.512us
     %2890 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 127.009us
       %2891 = :nvte_rmsnorm_fwd [] -> 127.009us
                 -->kernel: 0:7 %2445 =  [] -> 127.009us
     %2892 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 127.232us
       %2893 = :nvte_rmsnorm_fwd [] -> 127.232us
                 -->kernel: 0:7 %2446 =  [] -> 127.232us
     %2894 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 161.889us
                 -->kernel: 0:7 %2447 =  [] -> 161.889us
     %2895 = :TEColumnParallelLinear forward [] -> 3.409ms
       %2896 = :_Linear [[7168, 14336], [4096, 1, 14336], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.409ms
         %2897 = :nvte_quantize_v2 [] -> 145.345us
           %2898 = :quantize_transpose_vector_blockwise [] -> 145.345us
                 -->kernel: 0:7 %2448 =  [] -> 145.345us
         %2899 = :nvte_quantize_v2 [] -> 153.184us
           %2900 = :quantize_transpose_square_blockwise [] -> 153.184us
                 -->kernel: 0:7 %2449 =  [] -> 153.184us
         %2901 = :nvte_cublas_gemm_scaled [] -> 2.982ms
                 -->kernel: 0:7 %2450 =  [] -> 2.975ms
     %2902 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 121.312us
       %2903 = :nvte_rmsnorm_fwd [] -> 121.312us
                 -->kernel: 0:7 %2451 =  [] -> 121.312us
     %2904 = :TELinear forward [] -> 549.025us
       %2905 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 549.025us
         %2906 = :nvte_quantize_v2 [] -> 73.632us
           %2907 = :quantize_transpose_vector_blockwise [] -> 73.632us
                 -->kernel: 0:7 %2452 =  [] -> 73.632us
         %2908 = :nvte_quantize_v2 [] -> 20.480us
           %2909 = :quantize_transpose_square_blockwise [] -> 20.480us
                 -->kernel: 0:7 %2453 =  [] -> 20.480us
         %2910 = :nvte_cublas_gemm_scaled [] -> 334.465us
                 -->kernel: 0:7 %2454 =  [] -> 327.585us
     %2911 = :TELinear forward [] -> 399.328us
       %2912 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 399.328us
         %2913 = :nvte_quantize_v2 [] -> 73.440us
           %2914 = :quantize_transpose_vector_blockwise [] -> 73.440us
                 -->kernel: 0:7 %2455 =  [] -> 73.440us
         %2915 = :nvte_quantize_v2 [] -> 11.552us
           %2916 = :quantize_transpose_square_blockwise [] -> 11.552us
                 -->kernel: 0:7 %2456 =  [] -> 11.552us
         %2917 = :nvte_cublas_gemm_scaled [] -> 203.456us
                 -->kernel: 0:7 %2457 =  [] -> 196.896us
     %2918 = :TELayerNormColumnParallelLinear forward [] -> 1.366ms
       %2919 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.366ms
         %2920 = :nvte_rmsnorm_fwd [] -> 30.432us
                 -->kernel: 0:7 %2458 =  [] -> 30.432us
         %2921 = :nvte_quantize_v2 [] -> 16.896us
           %2922 = :quantize_transpose_vector_blockwise [] -> 16.896us
                 -->kernel: 0:7 %2459 =  [] -> 16.896us
         %2923 = :nvte_quantize_v2 [] -> 58.337us
           %2924 = :quantize_transpose_square_blockwise [] -> 58.337us
                 -->kernel: 0:7 %2460 =  [] -> 58.337us
         %2925 = :nvte_cublas_gemm_scaled [] -> 1.130ms
                 -->kernel: 0:7 %2461 =  [] -> 1.123ms
     %2926 = :TELayerNormColumnParallelLinear forward [] -> 882.178us
       %2927 = :aten::contiguous [[4096, 1, 512], []] -> 11.680us
         %2928 = :aten::clone [[4096, 1, 512], []] -> 11.680us
           %2929 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.680us
                 -->kernel: 0:7 %2462 =  [] -> 11.680us
       %2930 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 691.394us
         %2931 = :nvte_rmsnorm_fwd [] -> 4.192us
                 -->kernel: 0:7 %2463 =  [] -> 4.192us
         %2932 = :nvte_quantize_v2 [] -> 7.648us
           %2933 = :quantize_transpose_vector_blockwise [] -> 7.648us
                 -->kernel: 0:7 %2464 =  [] -> 7.648us
         %2934 = :nvte_quantize_v2 [] -> 28.800us
           %2935 = :quantize_transpose_square_blockwise [] -> 28.800us
                 -->kernel: 0:7 %2465 =  [] -> 28.800us
         %2936 = :nvte_cublas_gemm_scaled [] -> 521.601us
                 -->kernel: 0:7 %2466 =  [] -> 515.489us
     %2937 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.081us
                 -->kernel: 0:7 %2467 =  [] -> 114.081us
     %2938 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 171.841us
                 -->kernel: 0:7 %2468 =  [] -> 171.841us
     %2939 = :TEDotProductAttention forward [] -> 22.349ms
       %2940 = :aten::arange [[], [], [], [], []] -> 1.152us
         %2941 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %2469 =  [] -> 1.152us
       %2942 = :aten::arange [[], [], [], [], []] -> 1.152us
         %2943 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %2470 =  [] -> 1.152us
       %2944 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 60.897us
                 -->kernel: 0:7 %2471 =  [] -> 60.897us
       %2945 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 38.624us
                 -->kernel: 0:7 %2472 =  [] -> 38.624us
       %2946 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.176us
                 -->kernel: 0:7 %2473 =  [] -> 38.176us
       %2947 = :aten::le [[1, 1, 4096, 4096], []] -> 29.088us
                 -->kernel: 0:7 %2474 =  [] -> 29.088us
       %2948 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.832us
                 -->kernel: 0:7 %2475 =  [] -> 24.832us
       %2949 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.240us
                 -->kernel: 0:7 %2476 =  [] -> 14.240us
       %2950 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.784us
         %2951 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.784us
                 -->kernel: 0:7 %2477 =  [] -> 18.784us
       %2952 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.896us
         %2953 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.896us
                 -->kernel: 0:7 %2478 =  [] -> 12.896us
       %2954 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.272us
         %2955 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.272us
                 -->kernel: 0:7 %2479 =  [] -> 18.272us
       %2956 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.804ms
                 -->kernel: 0:7 %2480 =  [] -> 5.796ms
       %2957 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.000ms
         %2958 = :nvte_scaled_masked_softmax_forward [] -> 11.000ms
                 -->kernel: 0:7 %2481 =  [] -> 11.000ms
       %2959 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.981ms
                 -->kernel: 0:7 %2482 =  [] -> 3.966ms
       %2960 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.528us
         %2961 = :aten::clone [[4096, 1, 128, 128], []] -> 278.528us
           %2962 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.528us
                 -->kernel: 0:7 %2483 =  [] -> 278.528us
     %2963 = :TERowParallelLinear forward [] -> 3.819ms
       %2964 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.819ms
         %2965 = :nvte_quantize_v2 [] -> 97.344us
           %2966 = :quantize_transpose_vector_blockwise [] -> 97.344us
                 -->kernel: 0:7 %2484 =  [] -> 97.344us
         %2967 = :nvte_quantize_v2 [] -> 169.793us
           %2968 = :quantize_transpose_square_blockwise [] -> 169.793us
                 -->kernel: 0:7 %2485 =  [] -> 169.793us
         %2969 = :nvte_cublas_gemm_scaled [] -> 3.404ms
                 -->kernel: 0:7 %2486 =  [] -> 3.397ms
     %2970 = :Torch-Compiled Region: 1/2 None -> 44.288us
       %2971 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.288us
         %2972 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.288us
                 -->kernel: 0:7 %2487 =  [] -> 44.288us
     %2973 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.816us
       %2974 = :nvte_rmsnorm_fwd [] -> 126.816us
                 -->kernel: 0:7 %2488 =  [] -> 126.816us
     %2975 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 41.920us
       %2976 = :nvte_cublas_gemm_scaled [] -> 41.920us
                 -->kernel: 0:7 %2489 =  [] -> 22.080us
                 -->kernel: 0:7 %2490 =  [] -> 2.624us
     %2977 = :RandomSTE [[4096, 1, 32]] -> 40.320us
       %2978 = :aten::clone [[4096, 1, 32], []] -> 1.568us
         %2979 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.568us
       %2980 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.672us
                 -->kernel: 0:7 %2491 =  [] -> 4.672us
     %2981 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 69.760us
       %2982 = :nvte_fused_topk_with_score_function_forward [] -> 69.760us
                 -->kernel: 0:7 %2492 =  [] -> 69.760us
     %2983 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 27.200us
       %2984 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 27.200us
                 -->kernel: 0:7 %2493 =  [] -> 27.200us
     %2985 = :aten::sum [[4096, 32], [], [], []] -> 45.440us
       %2986 = :aten::to [[4096, 32], [], [], [], []] -> 4.672us
         %2987 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.672us
           %2988 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.672us
                 -->kernel: 0:7 %2494 =  [] -> 4.672us
                 -->kernel: 0:7 %2495 =  [] -> 10.240us
     %2989 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.160us
       %2990 = :nvte_fused_moe_aux_loss_forward [] -> 12.160us
                 -->kernel: 0:7 %2496 =  [] -> 12.160us
     %2991 = :aten::div [[], []] -> 1.056us
                 -->kernel: 0:7 %2497 =  [] -> 1.056us
     %2992 = :aten::div [[], []] -> 1.376us
                 -->kernel: 0:7 %2498 =  [] -> 1.376us
     %2993 = :aten::add_ [[], [], []] -> 1.536us
                 -->kernel: 0:7 %2499 =  [] -> 1.536us
     %2994 = :aten::sum [[4096, 32], [], [], []] -> 34.944us
       %2995 = :aten::to [[4096, 32], [], [], [], []] -> 4.672us
         %2996 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.672us
           %2997 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.672us
                 -->kernel: 0:7 %2500 =  [] -> 4.672us
                 -->kernel: 0:7 %2501 =  [] -> 7.616us
     %2998 = :aten::add_ [[32], [32], []] -> 4.000us
                 -->kernel: 0:7 %2502 =  [] -> 4.000us
     %2999 = :aten::topk [[4096, 32], [], [], [], []] -> 51.104us
                 -->kernel: 0:7 %2503 =  [] -> 14.528us
                 -->kernel: 0:7 %2504 =  [] -> 7.712us
     %3000 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 856.258us
                 -->kernel: 0:26 %2505 =  [] -> 43.552us
                 -->kernel: 0:26 %2506 =  [] -> 12.512us
                 -->kernel: 0:26 %2507 =  [] -> 678.242us
     %3001 = :TEColumnParallelLinear forward [] -> 1.154ms
       %3002 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.154ms
         %3003 = :nvte_quantize_v2 [] -> 45.152us
           %3004 = :quantize_transpose_vector_blockwise [] -> 45.152us
                 -->kernel: 0:7 %2508 =  [] -> 45.152us
         %3005 = :nvte_quantize_v2 [] -> 44.672us
           %3006 = :quantize_transpose_square_blockwise [] -> 44.672us
                 -->kernel: 0:7 %2509 =  [] -> 44.672us
         %3007 = :nvte_cublas_gemm_scaled [] -> 913.890us
                 -->kernel: 0:7 %2510 =  [] -> 906.818us
     %3008 = :SwiGLUFunction [[4096, 4096], [], []] -> 27.105us
       %3009 = :Torch-Compiled Region: 2/1 None -> 27.105us
         %3010 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 27.105us
                 -->kernel: 0:7 %2511 =  [] -> 27.105us
     %3011 = :TERowParallelLinear forward [] -> 601.921us
       %3012 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 601.921us
         %3013 = :nvte_quantize_v2 [] -> 22.912us
           %3014 = :quantize_transpose_vector_blockwise [] -> 22.912us
                 -->kernel: 0:7 %2512 =  [] -> 22.912us
         %3015 = :nvte_quantize_v2 [] -> 24.384us
           %3016 = :quantize_transpose_square_blockwise [] -> 24.384us
                 -->kernel: 0:7 %2513 =  [] -> 24.384us
         %3017 = :nvte_cublas_gemm_scaled [] -> 441.377us
                 -->kernel: 0:7 %2514 =  [] -> 435.201us
     %3018 = :IndicesToMultihot [[15764, 8], [15764, 8], []] -> 11.040us
                 -->kernel: 0:7 %2515 =  [] -> 11.040us
     %3019 = :aten::contiguous [[4, 15764], []] -> 2.912us
       %3020 = :aten::clone [[4, 15764], []] -> 2.912us
         %3021 = :aten::copy_ [[4, 15764], [4, 15764], []] -> 2.912us
                 -->kernel: 0:7 %2516 =  [] -> 2.912us
     %3022 = :aten::to [[4, 15764], [], [], [], []] -> 4.992us
       %3023 = :aten::_to_copy [[4, 15764], [], [], [], [], [], []] -> 4.992us
         %3024 = :aten::copy_ [[4, 15764], [4, 15764], []] -> 4.992us
                 -->kernel: 0:7 %2517 =  [] -> 4.992us
                 -->kernel: 0:7 %2518 =  [] -> 22.112us
     %3025 = :_moe_permute_mask_map [[15764, 7168], [15764, 4], [], [15764, 4]] -> 399.937us
                 -->kernel: 0:7 %2519 =  [] -> 2.464us
                 -->kernel: 0:7 %2520 =  [] -> 2.400us
                 -->kernel: 0:7 %2521 =  [] -> 13.088us
                 -->kernel: 0:7 %2522 =  [] -> 201.408us
     %3026 = :TEColumnParallelGroupedLinear forward [] -> 8.458ms
       %3027 = :_GroupedLinear [[32864, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.458ms
         %3028 = :nvte_quantize_v2 [] -> 222.400us
           %3029 = :quantize_transpose_vector_blockwise [] -> 222.400us
                 -->kernel: 0:7 %2523 =  [] -> 222.400us
         %3030 = :nvte_quantize_v2 [] -> 224.193us
           %3031 = :quantize_transpose_vector_blockwise [] -> 224.193us
                 -->kernel: 0:7 %2524 =  [] -> 224.193us
         %3032 = :nvte_quantize_v2 [] -> 218.689us
           %3033 = :quantize_transpose_vector_blockwise [] -> 218.689us
                 -->kernel: 0:7 %2525 =  [] -> 218.689us
         %3034 = :nvte_quantize_v2 [] -> 221.792us
           %3035 = :quantize_transpose_vector_blockwise [] -> 221.792us
                 -->kernel: 0:7 %2526 =  [] -> 221.792us
         %3036 = :nvte_quantize_v2 [] -> 45.632us
           %3037 = :quantize_transpose_square_blockwise [] -> 45.632us
                 -->kernel: 0:7 %2527 =  [] -> 45.632us
         %3038 = :nvte_quantize_v2 [] -> 45.792us
           %3039 = :quantize_transpose_square_blockwise [] -> 45.792us
                 -->kernel: 0:7 %2528 =  [] -> 45.792us
         %3040 = :nvte_quantize_v2 [] -> 45.537us
           %3041 = :quantize_transpose_square_blockwise [] -> 45.537us
                 -->kernel: 0:7 %2529 =  [] -> 45.537us
         %3042 = :nvte_quantize_v2 [] -> 45.824us
           %3043 = :quantize_transpose_square_blockwise [] -> 45.824us
                 -->kernel: 0:7 %2530 =  [] -> 45.824us
         %3044 = :nvte_multi_stream_cublas_gemm [] -> 7.081ms
           %3045 = :nvte_cublas_gemm [] -> 1.758ms
                 -->kernel: 0:159 %2531 =  [] -> 1.749ms
           %3046 = :nvte_cublas_gemm [] -> 1.753ms
                 -->kernel: 0:160 %2532 =  [] -> 1.748ms
           %3047 = :nvte_cublas_gemm [] -> 1.749ms
                 -->kernel: 0:161 %2533 =  [] -> 1.744ms
           %3048 = :nvte_cublas_gemm [] -> 1.753ms
                 -->kernel: 0:162 %2534 =  [] -> 1.748ms
     %3049 = :WeightedSwiGLUFunction [[32864, 4096], [32864, 1], []] -> 120.000us
       %3050 = :Torch-Compiled Region: 3/1 None -> 120.000us
         %3051 = :triton_poi_fused__to_copy_mul_silu_0 [[32864, 4096], [32864, 1], [32864, 2048], [], []] -> 120.000us
                 -->kernel: 0:7 %2535 =  [] -> 120.000us
     %3052 = :TERowParallelGroupedLinear forward [] -> 4.239ms
       %3053 = :_GroupedLinear [[32864, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.239ms
         %3054 = :nvte_quantize_v2 [] -> 68.576us
           %3055 = :quantize_transpose_vector_blockwise [] -> 68.576us
                 -->kernel: 0:7 %2536 =  [] -> 68.576us
         %3056 = :nvte_quantize_v2 [] -> 69.056us
           %3057 = :quantize_transpose_vector_blockwise [] -> 69.056us
                 -->kernel: 0:7 %2537 =  [] -> 69.056us
         %3058 = :nvte_quantize_v2 [] -> 67.232us
           %3059 = :quantize_transpose_vector_blockwise [] -> 67.232us
                 -->kernel: 0:7 %2538 =  [] -> 67.232us
         %3060 = :nvte_quantize_v2 [] -> 68.737us
           %3061 = :quantize_transpose_vector_blockwise [] -> 68.737us
                 -->kernel: 0:7 %2539 =  [] -> 68.737us
         %3062 = :nvte_quantize_v2 [] -> 25.440us
           %3063 = :quantize_transpose_square_blockwise [] -> 25.440us
                 -->kernel: 0:7 %2540 =  [] -> 25.440us
         %3064 = :nvte_quantize_v2 [] -> 24.256us
           %3065 = :quantize_transpose_square_blockwise [] -> 24.256us
                 -->kernel: 0:7 %2541 =  [] -> 24.256us
         %3066 = :nvte_quantize_v2 [] -> 24.512us
           %3067 = :quantize_transpose_square_blockwise [] -> 24.512us
                 -->kernel: 0:7 %2542 =  [] -> 24.512us
         %3068 = :nvte_quantize_v2 [] -> 24.320us
           %3069 = :quantize_transpose_square_blockwise [] -> 24.320us
                 -->kernel: 0:7 %2543 =  [] -> 24.320us
         %3070 = :nvte_multi_stream_cublas_gemm [] -> 3.588ms
           %3071 = :nvte_cublas_gemm [] -> 889.122us
                 -->kernel: 0:159 %2544 =  [] -> 879.746us
           %3072 = :nvte_cublas_gemm [] -> 883.682us
                 -->kernel: 0:160 %2545 =  [] -> 879.426us
           %3073 = :nvte_cublas_gemm [] -> 870.690us
                 -->kernel: 0:161 %2546 =  [] -> 866.850us
           %3074 = :nvte_cublas_gemm [] -> 883.587us
                 -->kernel: 0:162 %2547 =  [] -> 879.330us
     %3075 = :_moe_unpermute_mask_map [[32864, 7168], [15764, 9], [], []] -> 227.137us
                 -->kernel: 0:7 %2548 =  [] -> 227.137us
     %3076 = :FusedCombine [[15764, 7168], [], []] -> 741.154us
                 -->kernel: 0:26 %2549 =  [] -> 14.016us
                 -->kernel: 0:26 %2550 =  [] -> 700.194us
     %3077 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.320us
                 -->kernel: 0:7 %2551 =  [] -> 52.320us
     %3078 = :Torch-Compiled Region: 1/2 None -> 47.328us
       %3079 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 47.328us
         %3080 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 47.328us
                 -->kernel: 0:7 %2552 =  [] -> 47.328us
     %3081 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.272us
       %3082 = :nvte_rmsnorm_fwd [] -> 126.272us
                 -->kernel: 0:7 %2553 =  [] -> 126.272us
     %3083 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 162.048us
                 -->kernel: 0:7 %2554 =  [] -> 162.048us
     %3084 = :aten::clone [[1, 4096], []] -> 1.536us
       %3085 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.536us
     %3086 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.682ms
       %3087 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.682ms
         %3088 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.682ms
                 -->kernel: 0:7 %2555 =  [] -> 53.672ms
     %3089 = :aten::roll [[1, 4096], [], []] -> 2.176us
                 -->kernel: 0:7 %2556 =  [] -> 2.176us
     %3090 = :aten::fill_ [[1], []] -> 1.120us
                 -->kernel: 0:7 %2557 =  [] -> 1.120us
     %3091 = :aten::sum [[1, 4096], []] -> 3.232us
       %3092 = :aten::sum [[1, 4096], [], [], []] -> 3.232us
                 -->kernel: 0:7 %2558 =  [] -> 3.232us
     %3093 = :aten::roll [[1, 4096], [], []] -> 2.112us
                 -->kernel: 0:7 %2559 =  [] -> 2.112us
     %3094 = :aten::fill_ [[1], []] -> 1.312us
                 -->kernel: 0:7 %2560 =  [] -> 1.312us
     %3095 = :aten::sum [[1, 4096], []] -> 3.072us
       %3096 = :aten::sum [[1, 4096], [], [], []] -> 3.072us
                 -->kernel: 0:7 %2561 =  [] -> 3.072us
     %3097 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.483ms
       %3098 = :aten::zeros [[], [], [], [], []] -> 1.152us
         %3099 = :aten::zero_ [[4096]] -> 1.152us
           %3100 = :aten::fill_ [[4096], []] -> 1.152us
                 -->kernel: 0:7 %2562 =  [] -> 1.152us
       %3101 = :aten::zeros [[], [], [], [], []] -> 1.344us
         %3102 = :aten::zero_ [[12288]] -> 1.344us
           %3103 = :aten::fill_ [[12288], []] -> 1.344us
                 -->kernel: 0:7 %2563 =  [] -> 1.344us
                 -->kernel: 0:7 %2564 =  [] -> 659.010us
                 -->kernel: 0:7 %2565 =  [] -> 601.025us
     %3104 = :aten::mul [[1, 4096], [1, 4096]] -> 1.664us
                 -->kernel: 0:7 %2566 =  [] -> 1.664us
     %3105 = :aten::sum [[1, 4096], []] -> 3.296us
       %3106 = :aten::sum [[1, 4096], [], [], []] -> 3.296us
                 -->kernel: 0:7 %2567 =  [] -> 3.296us
     %3107 = :aten::div [[], []] -> 2.080us
                 -->kernel: 0:7 %2568 =  [] -> 2.080us
     %3108 = :aten::add_ [[], [], []] -> 1.760us
                 -->kernel: 0:7 %2569 =  [] -> 1.760us
     %3109 = :aten::mul [[1, 4096], []] -> 1.280us
                 -->kernel: 0:7 %2570 =  [] -> 1.280us
     %3110 = :aten::div [[1, 4096], []] -> 2.432us
                 -->kernel: 0:7 %2571 =  [] -> 2.432us
     %3111 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.691ms
       %3112 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.691ms
         %3113 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.691ms
                 -->kernel: 0:7 %2572 =  [] -> 53.680ms
     %3114 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.483ms
       %3115 = :aten::zeros [[], [], [], [], []] -> 1.184us
         %3116 = :aten::zero_ [[4096]] -> 1.184us
           %3117 = :aten::fill_ [[4096], []] -> 1.184us
                 -->kernel: 0:7 %2573 =  [] -> 1.184us
       %3118 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %3119 = :aten::zero_ [[12288]] -> 1.120us
           %3120 = :aten::fill_ [[12288], []] -> 1.120us
                 -->kernel: 0:7 %2574 =  [] -> 1.120us
                 -->kernel: 0:7 %2575 =  [] -> 660.738us
                 -->kernel: 0:7 %2576 =  [] -> 599.969us
     %3121 = :aten::mul [[4096], [4096]] -> 1.760us
                 -->kernel: 0:7 %2577 =  [] -> 1.760us
     %3122 = :aten::sum [[4096], []] -> 3.072us
       %3123 = :aten::sum [[4096], [], [], []] -> 3.072us
                 -->kernel: 0:7 %2578 =  [] -> 3.072us
     %3124 = :aten::sum [[4096], []] -> 3.296us
       %3125 = :aten::sum [[4096], [], [], []] -> 3.296us
                 -->kernel: 0:7 %2579 =  [] -> 3.296us
     %3126 = :aten::stack [[], [], []] -> 2.240us
       %3127 = :aten::cat [[1], [1], []] -> 2.240us
                 -->kernel: 0:7 %2580 =  [] -> 2.240us
     %3128 = :aten::isnan [[2]] -> 1.792us
       %3129 = :aten::ne [[2], [2]] -> 1.792us
                 -->kernel: 0:7 %2581 =  [] -> 1.792us
     %3130 = :aten::any [[2]] -> 2.624us
                 -->kernel: 0:7 %2582 =  [] -> 2.624us
     %3131 = :aten::is_nonzero [[]] -> 2.880us
       %3132 = :aten::item [[]] -> 2.880us
         %3133 = :aten::_local_scalar_dense [[]] -> 2.880us
     %3134 = :aten::clone [[], []] -> 1.440us
       %3135 = :aten::copy_ [[], [], []] -> 1.440us
     %3136 = :aten::clone [[], []] -> 1.408us
       %3137 = :aten::copy_ [[], [], []] -> 1.408us
     %3138 = :aten::cat [[1], [1], []] -> 1.600us
                 -->kernel: 0:7 %2583 =  [] -> 1.600us
     %3139 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 134.881us
       %3140 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 134.881us
         %3141 = :nccl:all_reduce [[2]] -> 134.881us
           %3142 = NCCL:ncclAllReduce [] -> 134.881us
                 -->kernel: 0:7 %2584 =  [] -> 134.881us
     %3143 = :aten::div [[2], []] -> 1.344us
                 -->kernel: 0:7 %2585 =  [] -> 1.344us
     %3144 = :aten::div [[], []] -> 1.440us
                 -->kernel: 0:7 %2586 =  [] -> 1.440us
     %3145 = :aten::mul [[], []] -> 1.184us
                 -->kernel: 0:7 %2587 =  [] -> 1.184us
     %3146 = :aten::mul_ [[], []] -> 1.120us
                 -->kernel: 0:7 %2588 =  [] -> 1.120us
     %3147 = :aten::div_ [[], []] -> 1.280us
                 -->kernel: 0:7 %2589 =  [] -> 1.280us
     %3148 = :aten::ones [[], [], [], [], []] -> 1.184us
       %3149 = :aten::fill_ [[1], []] -> 1.184us
                 -->kernel: 0:7 %2590 =  [] -> 1.184us
     %3150 = :aten::mul [[1], [1]] -> 1.376us
                 -->kernel: 0:7 %2591 =  [] -> 1.376us
     %3151 = :aten::div [[1], []] -> 1.152us
                 -->kernel: 0:7 %2592 =  [] -> 1.152us
     %3152 = :aten::copy_ [[1], [1], []] -> 1.248us
     %3153 = :aten::ones [[], [], [], [], []] -> 1.152us
       %3154 = :aten::fill_ [[1], []] -> 1.152us
                 -->kernel: 0:7 %2593 =  [] -> 1.152us
     %3155 = :aten::mul [[1], [1]] -> 1.152us
                 -->kernel: 0:7 %2594 =  [] -> 1.152us
     %3156 = :aten::div [[1], []] -> 1.344us
                 -->kernel: 0:7 %2595 =  [] -> 1.344us
     %3157 = :aten::add_ [[], [], []] -> 1.440us
                 -->kernel: 0:7 %2596 =  [] -> 1.440us
     %3158 = :aten::mul [[1], []] -> 1.280us
                 -->kernel: 0:7 %2597 =  [] -> 1.280us
     %3159 = :aten::ones_like [[1], [], [], [], [], []] -> 960.000ns
       %3160 = :aten::fill_ [[1], []] -> 960.000ns
                 -->kernel: 0:7 %2598 =  [] -> 960.000ns
     %3161 = :autograd::engine::evaluate_function: MulBackward0 None -> 108.192us
       %3162 = :MulBackward0 [[1]] -> 1.120us
         %3163 = :aten::mul [[1], [1]] -> 1.120us
                 -->kernel: 0:7 %2599 =  [] -> 1.120us
       %3164 = :aten::sum [[1], []] -> 2.784us
         %3165 = :aten::sum [[1], [], [], []] -> 2.784us
                 -->kernel: 0:7 %2600 =  [] -> 2.784us
     %3166 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.568us
       %3167 = :DivBackward0 [[]] -> 1.568us
         %3168 = :aten::div [[], []] -> 1.568us
                 -->kernel: 0:7 %2601 =  [] -> 1.568us
     %3169 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.184us
       %3170 = :MulBackward0 [[]] -> 1.184us
         %3171 = :aten::mul [[], []] -> 1.184us
                 -->kernel: 0:7 %2602 =  [] -> 1.184us
     %3172 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.152us
       %3173 = :MulBackward0 [[]] -> 1.152us
         %3174 = :aten::mul [[], []] -> 1.152us
                 -->kernel: 0:7 %2603 =  [] -> 1.152us
     %3175 = :autograd::engine::evaluate_function: SelectBackward0 None -> 60.833us
       %3176 = :SelectBackward0 [[]] -> 60.833us
         %3177 = :aten::select_backward [[], [], [], []] -> 60.833us
           %3178 = :aten::zeros [[], [], [], [], []] -> 1.152us
             %3179 = :aten::zero_ [[2]] -> 1.152us
               %3180 = :aten::fill_ [[2], []] -> 1.152us
                 -->kernel: 0:7 %2604 =  [] -> 1.152us
           %3181 = :aten::copy_ [[], [], []] -> 1.248us
     %3182 = :autograd::engine::evaluate_function: MulBackward0 None -> 2.208us
       %3183 = :MulBackward0 [[4096]] -> 2.208us
         %3184 = :aten::mul [[4096], [4096]] -> 2.208us
                 -->kernel: 0:7 %2605 =  [] -> 2.208us
     %3185 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 769.858us
       %3186 = :CrossEntropyFunctionBackward [[4096, 1]] -> 769.858us
         %3187 = :aten::to [[], [], [], [], [], []] -> 832.000ns
           %3188 = :aten::_to_copy [[], [], [], [], [], [], []] -> 832.000ns
             %3189 = :aten::copy_ [[], [], []] -> 832.000ns
                 -->kernel: 0:7 %2606 =  [] -> 598.433us
     %3190 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 109.171ms
       %3191 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.171ms
         %3192 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.610ms
           %3193 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.610ms
                 -->kernel: 0:7 %2607 =  [] -> 55.598ms
                 -->kernel: 0:7 %2608 =  [] -> 53.315ms
     %3194 = :autograd::engine::evaluate_function: MTPLossAutoScalerBackward None -> 75.872us
       %3195 = :MTPLossAutoScalerBackward [[4096, 1, 7168]] -> 75.872us
         %3196 = :aten::ones_like [[1, 4096], [], [], [], [], []] -> 1.120us
           %3197 = :aten::fill_ [[1, 4096], []] -> 1.120us
                 -->kernel: 0:7 %2609 =  [] -> 1.120us
         %3198 = :aten::mul [[1, 4096], [1]] -> 2.176us
                 -->kernel: 0:7 %2610 =  [] -> 2.176us
     %3199 = :autograd::engine::evaluate_function: DivBackward0 None -> 2.272us
       %3200 = :DivBackward0 [[1, 4096]] -> 2.272us
         %3201 = :aten::div [[1, 4096], []] -> 2.272us
                 -->kernel: 0:7 %2611 =  [] -> 2.272us
     %3202 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.376us
       %3203 = :MulBackward0 [[1, 4096]] -> 1.376us
         %3204 = :aten::mul [[1, 4096], []] -> 1.376us
                 -->kernel: 0:7 %2612 =  [] -> 1.376us
     %3205 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.536us
       %3206 = :MulBackward0 [[1, 4096]] -> 1.536us
         %3207 = :aten::mul [[1, 4096], [1, 4096]] -> 1.536us
                 -->kernel: 0:7 %2613 =  [] -> 1.536us
     %3208 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 752.001us
       %3209 = :CrossEntropyFunctionBackward [[4096, 1]] -> 752.001us
         %3210 = :aten::to [[], [], [], [], [], []] -> 832.000ns
           %3211 = :aten::_to_copy [[], [], [], [], [], [], []] -> 832.000ns
             %3212 = :aten::copy_ [[], [], []] -> 832.000ns
                 -->kernel: 0:7 %2614 =  [] -> 592.545us
     %3213 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 110.969ms
       %3214 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.508ms
         %3215 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.818ms
           %3216 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.818ms
                 -->kernel: 0:7 %2615 =  [] -> 55.806ms
                 -->kernel: 0:7 %2616 =  [] -> 53.452ms
       %3217 = :aten::add [[129280, 7168], [129280, 7168], []] -> 1.157ms
                 -->kernel: 0:35 %2617 =  [] -> 1.157ms
     %3218 = :autograd::engine::evaluate_function: SplitBackward0 None -> 163.296us
       %3219 = :SplitBackward0 [[4096, 1, 7168], [4096, 1, 7168]] -> 163.296us
         %3220 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 163.296us
                 -->kernel: 0:7 %2618 =  [] -> 163.296us
     %3221 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 207.616us
       %3222 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 207.616us
         %3223 = :nvte_rmsnorm_bwd [] -> 207.616us
                 -->kernel: 0:7 %2619 =  [] -> 167.040us
                 -->kernel: 0:7 %2620 =  [] -> 7.936us
     %3224 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.760us
       %3225 = :aten::add_ [[7168], [7168], []] -> 1.760us
                 -->kernel: 0:35 %2621 =  [] -> 1.760us
     %3226 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 868.354us
       %3227 = :FusedCombineBackward [[4096, 7168], []] -> 868.354us
                 -->kernel: 0:26 %2622 =  [] -> 8.032us
                 -->kernel: 0:26 %2623 =  [] -> 803.233us
     %3228 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 200.417us
       %3229 = :_moe_unpermute_mask_mapBackward [[15764, 7168]] -> 200.417us
                 -->kernel: 0:7 %2624 =  [] -> 200.417us
     %3230 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.650ms
       %3231 = :_GroupedLinearBackward [[32864, 7168]] -> 8.650ms
         %3232 = :_GroupedLinear_backward [] -> 8.650ms
           %3233 = :nvte_quantize_v2 [] -> 221.601us
             %3234 = :quantize_transpose_vector_blockwise [] -> 221.601us
                 -->kernel: 0:7 %2625 =  [] -> 221.601us
           %3235 = :nvte_quantize_v2 [] -> 223.200us
             %3236 = :quantize_transpose_vector_blockwise [] -> 223.200us
                 -->kernel: 0:7 %2626 =  [] -> 223.200us
           %3237 = :nvte_quantize_v2 [] -> 218.209us
             %3238 = :quantize_transpose_vector_blockwise [] -> 218.209us
                 -->kernel: 0:7 %2627 =  [] -> 218.209us
           %3239 = :nvte_quantize_v2 [] -> 220.384us
             %3240 = :quantize_transpose_vector_blockwise [] -> 220.384us
                 -->kernel: 0:7 %2628 =  [] -> 220.384us
           %3241 = :nvte_multi_stream_cublas_gemm [] -> 3.723ms
             %3242 = :nvte_cublas_gemm [] -> 919.586us
                 -->kernel: 0:159 %2629 =  [] -> 908.130us
             %3243 = :nvte_cublas_gemm [] -> 914.178us
                 -->kernel: 0:160 %2630 =  [] -> 908.482us
             %3244 = :nvte_cublas_gemm [] -> 911.682us
                 -->kernel: 0:161 %2631 =  [] -> 906.498us
             %3245 = :nvte_cublas_gemm [] -> 912.994us
                 -->kernel: 0:162 %2632 =  [] -> 908.194us
           %3246 = :nvte_multi_stream_cublas_gemm [] -> 3.692ms
             %3247 = :nvte_cublas_gemm [] -> 914.498us
                 -->kernel: 0:159 %2633 =  [] -> 905.794us
             %3248 = :nvte_cublas_gemm [] -> 909.250us
                 -->kernel: 0:160 %2634 =  [] -> 905.762us
             %3249 = :nvte_cublas_gemm [] -> 896.098us
                 -->kernel: 0:161 %2635 =  [] -> 892.034us
             %3250 = :nvte_cublas_gemm [] -> 909.186us
                 -->kernel: 0:162 %2636 =  [] -> 905.602us
     %3251 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 599.682us
       %3252 = :WeightedSwiGLUFunctionBackward [[32864, 2048]] -> 599.682us
         %3253 = :Torch-Compiled Region: 4/1 None -> 599.682us
           %3254 = :triton_poi_fused__to_copy_cat_0 [[32864, 2048], [32864, 1], [32864, 4096], [32864, 4096], [], []] -> 404.385us
                 -->kernel: 0:7 %2637 =  [] -> 404.385us
           %3255 = :triton_red_fused__to_copy_mul_silu_sum_1 [[32864, 4096], [32864, 2048], [32864, 1], [], [], [], []] -> 131.104us
                 -->kernel: 0:7 %2638 =  [] -> 131.104us
     %3256 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.859ms
       %3257 = :_GroupedLinearBackward [[32864, 4096]] -> 14.859ms
         %3258 = :_GroupedLinear_backward [] -> 14.859ms
           %3259 = :nvte_quantize_v2 [] -> 126.529us
             %3260 = :quantize_transpose_vector_blockwise [] -> 126.529us
                 -->kernel: 0:7 %2639 =  [] -> 126.529us
           %3261 = :nvte_quantize_v2 [] -> 131.520us
             %3262 = :quantize_transpose_vector_blockwise [] -> 131.520us
                 -->kernel: 0:7 %2640 =  [] -> 131.520us
           %3263 = :nvte_quantize_v2 [] -> 128.896us
             %3264 = :quantize_transpose_vector_blockwise [] -> 128.896us
                 -->kernel: 0:7 %2641 =  [] -> 128.896us
           %3265 = :nvte_quantize_v2 [] -> 129.985us
             %3266 = :quantize_transpose_vector_blockwise [] -> 129.985us
                 -->kernel: 0:7 %2642 =  [] -> 129.985us
           %3267 = :nvte_multi_stream_cublas_gemm [] -> 7.062ms
             %3268 = :nvte_cublas_gemm [] -> 1.760ms
                 -->kernel: 0:159 %2643 =  [] -> 1.752ms
             %3269 = :nvte_cublas_gemm [] -> 1.757ms
                 -->kernel: 0:160 %2644 =  [] -> 1.750ms
             %3270 = :nvte_cublas_gemm [] -> 1.723ms
                 -->kernel: 0:161 %2645 =  [] -> 1.719ms
             %3271 = :nvte_cublas_gemm [] -> 1.754ms
                 -->kernel: 0:162 %2646 =  [] -> 1.750ms
           %3272 = :nvte_multi_stream_cublas_gemm [] -> 7.005ms
             %3273 = :nvte_cublas_gemm [] -> 1.744ms
                 -->kernel: 0:159 %2647 =  [] -> 1.737ms
             %3274 = :nvte_cublas_gemm [] -> 1.742ms
                 -->kernel: 0:160 %2648 =  [] -> 1.737ms
             %3275 = :nvte_cublas_gemm [] -> 1.716ms
                 -->kernel: 0:161 %2649 =  [] -> 1.713ms
             %3276 = :nvte_cublas_gemm [] -> 1.741ms
                 -->kernel: 0:162 %2650 =  [] -> 1.737ms
     %3277 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 395.713us
       %3278 = :_moe_permute_mask_mapBackward [[32864, 7168], [], [32864]] -> 395.713us
         %3279 = :aten::zeros [[], [], [], [], []] -> 1.280us
           %3280 = :aten::zero_ [[15764, 9]] -> 1.280us
             %3281 = :aten::fill_ [[15764, 9], []] -> 1.280us
                 -->kernel: 0:7 %2651 =  [] -> 1.280us
                 -->kernel: 0:7 %2652 =  [] -> 213.152us
     %3282 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 98.849us
       %3283 = :IndicesToMultihotBackward [[], [15764, 4]] -> 98.849us
         %3284 = :aten::zeros [[], [], [], [], []] -> 1.440us
           %3285 = :aten::zero_ [[15764, 4]] -> 1.440us
             %3286 = :aten::fill_ [[15764, 4], []] -> 1.440us
                 -->kernel: 0:7 %2653 =  [] -> 1.440us
                 -->kernel: 0:7 %2654 =  [] -> 11.392us
     %3287 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.176ms
       %3288 = :_LinearBackward [[4096, 1, 7168]] -> 1.176ms
         %3289 = :_Linear_backward [] -> 1.176ms
           %3290 = :nvte_quantize_v2 [] -> 73.536us
             %3291 = :quantize_transpose_vector_blockwise [] -> 73.536us
                 -->kernel: 0:7 %2655 =  [] -> 73.536us
           %3292 = :nvte_cublas_gemm_scaled [] -> 468.001us
                 -->kernel: 0:7 %2656 =  [] -> 458.241us
           %3293 = :nvte_cublas_gemm_scaled [] -> 455.265us
                 -->kernel: 0:7 %2657 =  [] -> 450.273us
     %3294 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 47.297us
       %3295 = :SwiGLUFunctionBackward [[4096, 2048]] -> 47.297us
         %3296 = :Torch-Compiled Region: 5/0 None -> 47.297us
           %3297 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 47.297us
                 -->kernel: 0:7 %2658 =  [] -> 47.297us
     %3298 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.014ms
       %3299 = :_LinearBackward [[4096, 1, 4096]] -> 2.014ms
         %3300 = :_Linear_backward [] -> 2.014ms
           %3301 = :nvte_quantize_v2 [] -> 44.064us
             %3302 = :quantize_transpose_vector_blockwise [] -> 44.064us
                 -->kernel: 0:7 %2659 =  [] -> 44.064us
           %3303 = :nvte_quantize_v2 [] -> 52.512us
             %3304 = :quantize_transpose_vector_blockwise [] -> 52.512us
                 -->kernel: 0:7 %2660 =  [] -> 52.512us
           %3305 = :nvte_cublas_gemm_scaled [] -> 867.330us
                 -->kernel: 0:7 %2661 =  [] -> 861.378us
           %3306 = :nvte_cublas_gemm_scaled [] -> 868.258us
                 -->kernel: 0:7 %2662 =  [] -> 862.562us
     %3307 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 872.610us
       %3308 = :FusedDispatchBackward [[15764, 7168], [], [15764, 8], [], []] -> 872.610us
         %3309 = :aten::zeros [[], [], [], [], []] -> 1.472us
           %3310 = :aten::zero_ [[15764, 8]] -> 1.472us
             %3311 = :aten::fill_ [[15764, 8], []] -> 1.472us
                 -->kernel: 0:7 %2663 =  [] -> 1.472us
                 -->kernel: 0:26 %2664 =  [] -> 13.600us
                 -->kernel: 0:26 %2665 =  [] -> 685.570us
     %3312 = :autograd::engine::evaluate_function: TopkBackward0 None -> 62.752us
       %3313 = :TopkBackward0 [[4096, 8]] -> 62.752us
         %3314 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 62.752us
           %3315 = :aten::zeros [[], [], [], [], []] -> 960.000ns
             %3316 = :aten::zero_ [[4096, 32]] -> 960.000ns
               %3317 = :aten::fill_ [[4096, 32], []] -> 960.000ns
                 -->kernel: 0:7 %2666 =  [] -> 960.000ns
           %3318 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 9.024us
                 -->kernel: 0:7 %2667 =  [] -> 9.024us
     %3319 = :autograd::engine::evaluate_function: ViewBackward0 None -> 53.504us
       %3320 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 53.504us
                 -->kernel: 0:7 %2668 =  [] -> 53.504us
     %3321 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 87.808us
       %3322 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 37.824us
         %3323 = :aten::ones_like [[], [], [], [], [], []] -> 1.312us
           %3324 = :aten::fill_ [[], []] -> 1.312us
                 -->kernel: 0:7 %2669 =  [] -> 1.312us
         %3325 = :aten::mul [[], [1]] -> 1.696us
                 -->kernel: 0:7 %2670 =  [] -> 1.696us
       %3326 = :aten::sum [[1], []] -> 2.656us
         %3327 = :aten::sum [[1], [], [], []] -> 2.656us
                 -->kernel: 0:7 %2671 =  [] -> 2.656us
     %3328 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.280us
       %3329 = :DivBackward0 [[]] -> 1.280us
         %3330 = :aten::div [[], []] -> 1.280us
                 -->kernel: 0:7 %2672 =  [] -> 1.280us
     %3331 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.144us
       %3332 = :FusedAuxLossBackward [[]] -> 2.144us
         %3333 = :nvte_fused_moe_aux_loss_backward [] -> 2.144us
                 -->kernel: 0:7 %2673 =  [] -> 2.144us
     %3334 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 60.321us
       %3335 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 60.321us
         %3336 = :aten::zeros [[], [], [], [], []] -> 1.248us
           %3337 = :aten::zero_ [[4096, 32]] -> 1.248us
             %3338 = :aten::fill_ [[4096, 32], []] -> 1.248us
                 -->kernel: 0:7 %2674 =  [] -> 1.248us
         %3339 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.832us
                 -->kernel: 0:7 %2675 =  [] -> 12.832us
     %3340 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 96.256us
       %3341 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 55.200us
         %3342 = :aten::zeros [[], [], [], [], []] -> 1.152us
           %3343 = :aten::zero_ [[4096, 32]] -> 1.152us
             %3344 = :aten::fill_ [[4096, 32], []] -> 1.152us
                 -->kernel: 0:7 %2676 =  [] -> 1.152us
         %3345 = :nvte_fused_topk_with_score_function_backward [] -> 13.984us
                 -->kernel: 0:7 %2677 =  [] -> 13.984us
       %3346 = :aten::add [[4096, 32], [4096, 32], []] -> 1.664us
                 -->kernel: 0:7 %2678 =  [] -> 1.664us
     %3347 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 799.330us
       %3348 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 704.674us
         %3349 = :aten::to [[32, 7168], [], [], [], []] -> 6.400us
           %3350 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.400us
             %3351 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.400us
                 -->kernel: 0:7 %2679 =  [] -> 6.400us
         %3352 = :nvte_cublas_gemm_scaled [] -> 83.297us
                 -->kernel: 0:7 %2680 =  [] -> 67.520us
         %3353 = :aten::to [[4096, 7168], [], [], [], []] -> 175.968us
           %3354 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 175.968us
             %3355 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 175.968us
                 -->kernel: 0:7 %2681 =  [] -> 175.968us
         %3356 = :nvte_cublas_gemm_scaled [] -> 82.465us
                 -->kernel: 0:7 %2682 =  [] -> 82.465us
         %3357 = :aten::to [[4096, 7168], [], [], [], []] -> 43.936us
           %3358 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.936us
             %3359 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.936us
                 -->kernel: 0:7 %2683 =  [] -> 43.936us
         %3360 = :aten::to [[32, 7168], [], [], [], []] -> 2.112us
           %3361 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.112us
             %3362 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.112us
                 -->kernel: 0:7 %2684 =  [] -> 2.112us
       %3363 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.856us
                 -->kernel: 0:7 %2685 =  [] -> 49.856us
     %3364 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.144us
       %3365 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.144us
                 -->kernel: 0:35 %2686 =  [] -> 2.144us
     %3366 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 319.840us
       %3367 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 196.736us
         %3368 = :nvte_rmsnorm_bwd [] -> 196.736us
                 -->kernel: 0:7 %2687 =  [] -> 166.400us
                 -->kernel: 0:7 %2688 =  [] -> 7.904us
       %3369 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.872us
                 -->kernel: 0:7 %2689 =  [] -> 51.872us
     %3370 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %3371 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %2690 =  [] -> 1.600us
     %3372 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.289ms
       %3373 = :_LinearBackward [[4096, 1, 7168]] -> 7.289ms
         %3374 = :_Linear_backward [] -> 7.289ms
           %3375 = :nvte_quantize_v2 [] -> 73.152us
             %3376 = :quantize_transpose_vector_blockwise [] -> 73.152us
                 -->kernel: 0:7 %2691 =  [] -> 73.152us
           %3377 = :nvte_quantize_v2 [] -> 111.264us
             %3378 = :quantize_transpose_vector_blockwise [] -> 111.264us
                 -->kernel: 0:7 %2692 =  [] -> 111.264us
           %3379 = :nvte_cublas_gemm_scaled [] -> 3.441ms
                 -->kernel: 0:7 %2693 =  [] -> 3.434ms
           %3380 = :nvte_cublas_gemm_scaled [] -> 3.443ms
                 -->kernel: 0:7 %2694 =  [] -> 3.437ms
     %3381 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.918ms
       %3382 = :BmmBackward0 [[128, 4096, 128]] -> 7.918ms
         %3383 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.981ms
                 -->kernel: 0:7 %2695 =  [] -> 3.970ms
         %3384 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.882ms
                 -->kernel: 0:7 %2696 =  [] -> 3.872ms
     %3385 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.949ms
       %3386 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.949ms
         %3387 = :nvte_scaled_softmax_backward [] -> 6.949ms
                 -->kernel: 0:7 %2697 =  [] -> 6.949ms
     %3388 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.210ms
       %3389 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.210ms
         %3390 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.948ms
                 -->kernel: 0:7 %2698 =  [] -> 5.938ms
         %3391 = :aten::mul [[128, 4096, 192], []] -> 115.264us
           %3392 = :aten::mul [[128, 4096, 192], []] -> 115.264us
                 -->kernel: 0:7 %2699 =  [] -> 115.264us
         %3393 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.875ms
                 -->kernel: 0:7 %2700 =  [] -> 5.868ms
         %3394 = :aten::mul [[128, 192, 4096], []] -> 115.777us
           %3395 = :aten::mul [[128, 192, 4096], []] -> 115.777us
                 -->kernel: 0:7 %2701 =  [] -> 115.777us
     %3396 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.470ms
       %3397 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.470ms
         %3398 = :aten::contiguous [[4096, 1, 128, 192], []] -> 744.834us
           %3399 = :aten::clone [[4096, 1, 128, 192], []] -> 744.834us
             %3400 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 744.834us
                 -->kernel: 0:7 %2702 =  [] -> 744.834us
         %3401 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.993us
           %3402 = :aten::clone [[4096, 1, 128, 128], []] -> 280.993us
             %3403 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.993us
                 -->kernel: 0:7 %2703 =  [] -> 280.993us
                 -->kernel: 0:7 %2704 =  [] -> 171.617us
     %3404 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 642.241us
       %3405 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 642.241us
         %3406 = :aten::contiguous [[4096, 1, 128, 192], []] -> 423.041us
           %3407 = :aten::clone [[4096, 1, 128, 192], []] -> 423.041us
             %3408 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 423.041us
                 -->kernel: 0:7 %2705 =  [] -> 423.041us
                 -->kernel: 0:7 %2706 =  [] -> 118.848us
     %3409 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.731ms
       %3410 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.731ms
         %3411 = :_LayerNormLinear_backward [] -> 1.731ms
           %3412 = :nvte_quantize_v2 [] -> 323.905us
             %3413 = :quantize_transpose_vector_blockwise [] -> 323.905us
                 -->kernel: 0:7 %2707 =  [] -> 323.905us
           %3414 = :nvte_cublas_gemm_scaled [] -> 565.985us
                 -->kernel: 0:7 %2708 =  [] -> 519.745us
                 -->kernel: 0:7 %2709 =  [] -> 19.456us
           %3415 = :nvte_cublas_gemm_scaled [] -> 526.754us
                 -->kernel: 0:7 %2710 =  [] -> 521.442us
           %3416 = :nvte_rmsnorm_bwd [] -> 20.768us
                 -->kernel: 0:7 %2711 =  [] -> 6.368us
                 -->kernel: 0:7 %2712 =  [] -> 3.168us
     %3417 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.208us
       %3418 = :aten::add_ [[512], [512], []] -> 2.208us
                 -->kernel: 0:35 %2713 =  [] -> 2.208us
     %3419 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.812ms
       %3420 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.812ms
         %3421 = :_LayerNormLinear_backward [] -> 2.812ms
           %3422 = :nvte_quantize_v2 [] -> 244.480us
             %3423 = :quantize_transpose_vector_blockwise [] -> 244.480us
                 -->kernel: 0:7 %2714 =  [] -> 244.480us
           %3424 = :nvte_cublas_gemm_scaled [] -> 1.119ms
                 -->kernel: 0:7 %2715 =  [] -> 1.110ms
           %3425 = :nvte_cublas_gemm_scaled [] -> 1.122ms
                 -->kernel: 0:7 %2716 =  [] -> 1.116ms
           %3426 = :nvte_rmsnorm_bwd [] -> 55.968us
                 -->kernel: 0:7 %2717 =  [] -> 23.264us
                 -->kernel: 0:7 %2718 =  [] -> 20.800us
     %3427 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.984us
       %3428 = :aten::add_ [[1536], [1536], []] -> 1.984us
                 -->kernel: 0:35 %2719 =  [] -> 1.984us
     %3429 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.016us
       %3430 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.016us
         %3431 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.016us
                 -->kernel: 0:7 %2720 =  [] -> 10.016us
     %3432 = :autograd::engine::evaluate_function: _LinearBackward None -> 434.849us
       %3433 = :_LinearBackward [[4096, 1, 576]] -> 434.849us
         %3434 = :_Linear_backward [] -> 434.849us
           %3435 = :nvte_quantize_v2 [] -> 14.272us
             %3436 = :quantize_transpose_vector_blockwise [] -> 14.272us
                 -->kernel: 0:7 %2721 =  [] -> 14.272us
           %3437 = :nvte_cublas_gemm_scaled [] -> 148.097us
                 -->kernel: 0:7 %2722 =  [] -> 141.569us
           %3438 = :nvte_cublas_gemm_scaled [] -> 138.912us
                 -->kernel: 0:7 %2723 =  [] -> 133.152us
     %3439 = :autograd::engine::evaluate_function: _LinearBackward None -> 986.755us
       %3440 = :_LinearBackward [[4096, 1, 1536]] -> 822.786us
         %3441 = :_Linear_backward [] -> 822.786us
           %3442 = :nvte_quantize_v2 [] -> 18.560us
             %3443 = :quantize_transpose_vector_blockwise [] -> 18.560us
                 -->kernel: 0:7 %2724 =  [] -> 18.560us
           %3444 = :nvte_cublas_gemm_scaled [] -> 335.392us
                 -->kernel: 0:7 %2725 =  [] -> 329.312us
           %3445 = :nvte_cublas_gemm_scaled [] -> 343.104us
                 -->kernel: 0:7 %2726 =  [] -> 337.984us
       %3446 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.176us
                 -->kernel: 0:7 %2727 =  [] -> 50.176us
     %3447 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 324.897us
       %3448 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 196.001us
         %3449 = :nvte_rmsnorm_bwd [] -> 196.001us
                 -->kernel: 0:7 %2728 =  [] -> 165.536us
                 -->kernel: 0:7 %2729 =  [] -> 7.904us
       %3450 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.856us
                 -->kernel: 0:7 %2730 =  [] -> 49.856us
     %3451 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %3452 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %2731 =  [] -> 1.600us
     %3453 = :autograd::engine::evaluate_function: _LinearBackward None -> 6.226ms
       %3454 = :_LinearBackward [[4096, 1, 7168]] -> 6.226ms
         %3455 = :_Linear_backward [] -> 6.226ms
           %3456 = :nvte_quantize_v2 [] -> 74.337us
             %3457 = :quantize_transpose_vector_blockwise [] -> 74.337us
                 -->kernel: 0:7 %2732 =  [] -> 74.337us
           %3458 = :nvte_cublas_gemm_scaled [] -> 2.998ms
                 -->kernel: 0:7 %2733 =  [] -> 2.992ms
           %3459 = :nvte_cublas_gemm_scaled [] -> 3.010ms
                 -->kernel: 0:7 %2734 =  [] -> 3.004ms
     %3460 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 387.873us
       %3461 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 387.873us
         %3462 = :aten::contiguous [[4096, 1, 7168], []] -> 114.688us
           %3463 = :aten::clone [[4096, 1, 7168], []] -> 114.688us
             %3464 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 114.688us
                 -->kernel: 0:7 %2735 =  [] -> 114.688us
         %3465 = :nvte_rmsnorm_bwd [] -> 190.112us
                 -->kernel: 0:7 %2736 =  [] -> 166.496us
                 -->kernel: 0:7 %2737 =  [] -> 7.680us
     %3466 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.792us
       %3467 = :aten::add_ [[7168], [7168], []] -> 1.792us
                 -->kernel: 0:35 %2738 =  [] -> 1.792us
     %3468 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 375.232us
       %3469 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 375.232us
         %3470 = :aten::contiguous [[4096, 1, 7168], []] -> 115.968us
           %3471 = :aten::clone [[4096, 1, 7168], []] -> 115.968us
             %3472 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 115.968us
                 -->kernel: 0:7 %2739 =  [] -> 115.968us
         %3473 = :nvte_rmsnorm_bwd [] -> 189.248us
                 -->kernel: 0:7 %2740 =  [] -> 165.856us
                 -->kernel: 0:7 %2741 =  [] -> 7.744us
     %3474 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.760us
       %3475 = :aten::add_ [[7168], [7168], []] -> 1.760us
                 -->kernel: 0:35 %2742 =  [] -> 1.760us
     %3476 = :autograd::engine::evaluate_function: MakeViewlessTensorBackward None -> 50.816us
       %3477 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.816us
                 -->kernel: 0:7 %2743 =  [] -> 50.816us
     %3478 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 1.436ms
       %3479 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.436ms
         %3480 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.436ms
           %3481 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.436ms
             %3482 = :aten::arange [[], [], [], [], []] -> 1.184us
               %3483 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %2744 =  [] -> 1.184us
             %3484 = CCCL:cub::DeviceRadixSort [] -> 189.313us
                 -->kernel: 0:7 %2745 =  [] -> 3.552us
                 -->kernel: 0:7 %2746 =  [] -> 1.536us
                 -->kernel: 0:7 %2747 =  [] -> 7.776us
                 -->kernel: 0:7 %2748 =  [] -> 7.488us
                 -->kernel: 0:7 %2749 =  [] -> 7.072us
                 -->kernel: 0:7 %2750 =  [] -> 7.008us
                 -->kernel: 0:7 %2751 =  [] -> 7.104us
                 -->kernel: 0:7 %2752 =  [] -> 7.008us
                 -->kernel: 0:7 %2753 =  [] -> 6.912us
                 -->kernel: 0:7 %2754 =  [] -> 6.816us
             %3485 = :aten::zeros [[], [], [], [], []] -> 544.705us
               %3486 = :aten::zero_ [[129280, 7168]] -> 544.705us
                 %3487 = :aten::fill_ [[129280, 7168], []] -> 544.705us
                 -->kernel: 0:7 %2755 =  [] -> 544.705us
             %3488 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 17.408us
                 -->kernel: 0:7 %2756 =  [] -> 1.440us
                 -->kernel: 0:7 %2757 =  [] -> 4.064us
                 -->kernel: 0:7 %2758 =  [] -> 1.760us
             %3489 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 19.232us
                 -->kernel: 0:7 %2759 =  [] -> 1.440us
                 -->kernel: 0:7 %2760 =  [] -> 2.912us
                 -->kernel: 0:7 %2761 =  [] -> 1.312us
                 -->kernel: 0:7 %2762 =  [] -> 1.792us
                 -->kernel: 0:7 %2763 =  [] -> 244.064us
                 -->kernel: 0:7 %2764 =  [] -> 199.969us
     %3490 = :autograd::engine::evaluate_function: SplitBackward0 None -> 34.112us
       %3491 = :SplitBackward0 [[4096, 1, 7168]] -> 34.112us
         %3492 = :aten::cat [[4096, 1, 7168], []] -> 34.112us
     %3493 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 193.825us
       %3494 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 193.825us
         %3495 = :nvte_rmsnorm_bwd [] -> 193.825us
                 -->kernel: 0:7 %2765 =  [] -> 166.561us
                 -->kernel: 0:7 %2766 =  [] -> 7.808us
     %3496 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %3497 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %2767 =  [] -> 1.568us
     %3498 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 852.161us
       %3499 = :FusedCombineBackward [[4096, 7168], []] -> 852.161us
                 -->kernel: 0:26 %2768 =  [] -> 7.936us
                 -->kernel: 0:26 %2769 =  [] -> 793.249us
     %3500 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 200.993us
       %3501 = :_moe_unpermute_mask_mapBackward [[15753, 7168]] -> 200.993us
                 -->kernel: 0:7 %2770 =  [] -> 200.993us
     %3502 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.560ms
       %3503 = :_GroupedLinearBackward [[32928, 7168]] -> 8.560ms
         %3504 = :_GroupedLinear_backward [] -> 8.560ms
           %3505 = :nvte_quantize_v2 [] -> 221.185us
             %3506 = :quantize_transpose_vector_blockwise [] -> 221.185us
                 -->kernel: 0:7 %2771 =  [] -> 221.185us
           %3507 = :nvte_quantize_v2 [] -> 220.672us
             %3508 = :quantize_transpose_vector_blockwise [] -> 220.672us
                 -->kernel: 0:7 %2772 =  [] -> 220.672us
           %3509 = :nvte_quantize_v2 [] -> 222.753us
             %3510 = :quantize_transpose_vector_blockwise [] -> 222.753us
                 -->kernel: 0:7 %2773 =  [] -> 222.753us
           %3511 = :nvte_quantize_v2 [] -> 221.920us
             %3512 = :quantize_transpose_vector_blockwise [] -> 221.920us
                 -->kernel: 0:7 %2774 =  [] -> 221.920us
           %3513 = :nvte_multi_stream_cublas_gemm [] -> 3.709ms
             %3514 = :nvte_cublas_gemm [] -> 916.386us
                 -->kernel: 0:159 %2775 =  [] -> 906.274us
             %3515 = :nvte_cublas_gemm [] -> 910.274us
                 -->kernel: 0:160 %2776 =  [] -> 905.314us
             %3516 = :nvte_cublas_gemm [] -> 910.722us
                 -->kernel: 0:161 %2777 =  [] -> 906.658us
             %3517 = :nvte_cublas_gemm [] -> 911.554us
                 -->kernel: 0:162 %2778 =  [] -> 906.658us
           %3518 = :nvte_multi_stream_cublas_gemm [] -> 3.668ms
             %3519 = :nvte_cublas_gemm [] -> 897.762us
                 -->kernel: 0:159 %2779 =  [] -> 890.146us
             %3520 = :nvte_cublas_gemm [] -> 898.306us
                 -->kernel: 0:160 %2780 =  [] -> 889.378us
             %3521 = :nvte_cublas_gemm [] -> 905.955us
                 -->kernel: 0:161 %2781 =  [] -> 902.787us
             %3522 = :nvte_cublas_gemm [] -> 907.778us
                 -->kernel: 0:162 %2782 =  [] -> 903.362us
     %3523 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 590.977us
       %3524 = :WeightedSwiGLUFunctionBackward [[32928, 2048]] -> 590.977us
         %3525 = :Torch-Compiled Region: 4/1 None -> 590.977us
           %3526 = :triton_poi_fused__to_copy_cat_0 [[32928, 2048], [32928, 1], [32928, 4096], [32928, 4096], [], []] -> 403.201us
                 -->kernel: 0:7 %2783 =  [] -> 403.201us
           %3527 = :triton_red_fused__to_copy_mul_silu_sum_1 [[32928, 4096], [32928, 2048], [32928, 1], [], [], [], []] -> 130.560us
                 -->kernel: 0:7 %2784 =  [] -> 130.560us
     %3528 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.742ms
       %3529 = :_GroupedLinearBackward [[32928, 4096]] -> 14.742ms
         %3530 = :_GroupedLinear_backward [] -> 14.742ms
           %3531 = :nvte_quantize_v2 [] -> 126.240us
             %3532 = :quantize_transpose_vector_blockwise [] -> 126.240us
                 -->kernel: 0:7 %2785 =  [] -> 126.240us
           %3533 = :nvte_quantize_v2 [] -> 130.144us
             %3534 = :quantize_transpose_vector_blockwise [] -> 130.144us
                 -->kernel: 0:7 %2786 =  [] -> 130.144us
           %3535 = :nvte_quantize_v2 [] -> 131.680us
             %3536 = :quantize_transpose_vector_blockwise [] -> 131.680us
                 -->kernel: 0:7 %2787 =  [] -> 131.680us
           %3537 = :nvte_quantize_v2 [] -> 131.808us
             %3538 = :quantize_transpose_vector_blockwise [] -> 131.808us
                 -->kernel: 0:7 %2788 =  [] -> 131.808us
           %3539 = :nvte_multi_stream_cublas_gemm [] -> 7.001ms
             %3540 = :nvte_cublas_gemm [] -> 1.723ms
                 -->kernel: 0:159 %2789 =  [] -> 1.715ms
             %3541 = :nvte_cublas_gemm [] -> 1.718ms
                 -->kernel: 0:160 %2790 =  [] -> 1.713ms
             %3542 = :nvte_cublas_gemm [] -> 1.747ms
                 -->kernel: 0:161 %2791 =  [] -> 1.743ms
             %3543 = :nvte_cublas_gemm [] -> 1.747ms
                 -->kernel: 0:162 %2792 =  [] -> 1.744ms
           %3544 = :nvte_multi_stream_cublas_gemm [] -> 6.956ms
             %3545 = :nvte_cublas_gemm [] -> 1.713ms
                 -->kernel: 0:159 %2793 =  [] -> 1.707ms
             %3546 = :nvte_cublas_gemm [] -> 1.712ms
                 -->kernel: 0:160 %2794 =  [] -> 1.707ms
             %3547 = :nvte_cublas_gemm [] -> 1.735ms
                 -->kernel: 0:161 %2795 =  [] -> 1.730ms
             %3548 = :nvte_cublas_gemm [] -> 1.733ms
                 -->kernel: 0:162 %2796 =  [] -> 1.730ms
     %3549 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 386.848us
       %3550 = :_moe_permute_mask_mapBackward [[32928, 7168], [], [32928]] -> 386.848us
         %3551 = :aten::zeros [[], [], [], [], []] -> 1.248us
           %3552 = :aten::zero_ [[15753, 9]] -> 1.248us
             %3553 = :aten::fill_ [[15753, 9], []] -> 1.248us
                 -->kernel: 0:7 %2797 =  [] -> 1.248us
                 -->kernel: 0:7 %2798 =  [] -> 213.088us
     %3554 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 95.904us
       %3555 = :IndicesToMultihotBackward [[], [15753, 4]] -> 95.904us
         %3556 = :aten::zeros [[], [], [], [], []] -> 1.440us
           %3557 = :aten::zero_ [[15753, 4]] -> 1.440us
             %3558 = :aten::fill_ [[15753, 4], []] -> 1.440us
                 -->kernel: 0:7 %2799 =  [] -> 1.440us
                 -->kernel: 0:7 %2800 =  [] -> 11.520us
     %3559 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.159ms
       %3560 = :_LinearBackward [[4096, 1, 7168]] -> 1.159ms
         %3561 = :_Linear_backward [] -> 1.159ms
           %3562 = :nvte_quantize_v2 [] -> 73.216us
             %3563 = :quantize_transpose_vector_blockwise [] -> 73.216us
                 -->kernel: 0:7 %2801 =  [] -> 73.216us
           %3564 = :nvte_cublas_gemm_scaled [] -> 467.393us
                 -->kernel: 0:7 %2802 =  [] -> 459.041us
           %3565 = :nvte_cublas_gemm_scaled [] -> 454.721us
                 -->kernel: 0:7 %2803 =  [] -> 449.569us
     %3566 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 46.912us
       %3567 = :SwiGLUFunctionBackward [[4096, 2048]] -> 46.912us
         %3568 = :Torch-Compiled Region: 5/0 None -> 46.912us
           %3569 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 46.912us
                 -->kernel: 0:7 %2804 =  [] -> 46.912us
     %3570 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.004ms
       %3571 = :_LinearBackward [[4096, 1, 4096]] -> 2.004ms
         %3572 = :_Linear_backward [] -> 2.004ms
           %3573 = :nvte_quantize_v2 [] -> 44.256us
             %3574 = :quantize_transpose_vector_blockwise [] -> 44.256us
                 -->kernel: 0:7 %2805 =  [] -> 44.256us
           %3575 = :nvte_quantize_v2 [] -> 52.960us
             %3576 = :quantize_transpose_vector_blockwise [] -> 52.960us
                 -->kernel: 0:7 %2806 =  [] -> 52.960us
           %3577 = :nvte_cublas_gemm_scaled [] -> 863.746us
                 -->kernel: 0:7 %2807 =  [] -> 858.401us
           %3578 = :nvte_cublas_gemm_scaled [] -> 863.970us
                 -->kernel: 0:7 %2808 =  [] -> 859.362us
     %3579 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 853.794us
       %3580 = :FusedDispatchBackward [[15753, 7168], [], [15753, 8], [], []] -> 853.794us
         %3581 = :aten::zeros [[], [], [], [], []] -> 1.440us
           %3582 = :aten::zero_ [[15753, 8]] -> 1.440us
             %3583 = :aten::fill_ [[15753, 8], []] -> 1.440us
                 -->kernel: 0:7 %2809 =  [] -> 1.440us
                 -->kernel: 0:26 %2810 =  [] -> 13.792us
                 -->kernel: 0:26 %2811 =  [] -> 672.674us
     %3584 = :autograd::engine::evaluate_function: TopkBackward0 None -> 58.688us
       %3585 = :TopkBackward0 [[4096, 8]] -> 58.688us
         %3586 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 58.688us
           %3587 = :aten::zeros [[], [], [], [], []] -> 1.056us
             %3588 = :aten::zero_ [[4096, 32]] -> 1.056us
               %3589 = :aten::fill_ [[4096, 32], []] -> 1.056us
                 -->kernel: 0:7 %2812 =  [] -> 1.056us
           %3590 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 8.896us
                 -->kernel: 0:7 %2813 =  [] -> 8.896us
     %3591 = :autograd::engine::evaluate_function: ViewBackward0 None -> 53.024us
       %3592 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 53.024us
                 -->kernel: 0:7 %2814 =  [] -> 53.024us
     %3593 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 87.680us
       %3594 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 35.712us
         %3595 = :aten::ones_like [[], [], [], [], [], []] -> 1.248us
           %3596 = :aten::fill_ [[], []] -> 1.248us
                 -->kernel: 0:7 %2815 =  [] -> 1.248us
         %3597 = :aten::mul [[], [1]] -> 1.696us
                 -->kernel: 0:7 %2816 =  [] -> 1.696us
       %3598 = :aten::sum [[1], []] -> 2.592us
         %3599 = :aten::sum [[1], [], [], []] -> 2.592us
                 -->kernel: 0:7 %2817 =  [] -> 2.592us
     %3600 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.312us
       %3601 = :DivBackward0 [[]] -> 1.312us
         %3602 = :aten::div [[], []] -> 1.312us
                 -->kernel: 0:7 %2818 =  [] -> 1.312us
     %3603 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.176us
       %3604 = :FusedAuxLossBackward [[]] -> 2.176us
         %3605 = :nvte_fused_moe_aux_loss_backward [] -> 2.176us
                 -->kernel: 0:7 %2819 =  [] -> 2.176us
     %3606 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 62.753us
       %3607 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 62.753us
         %3608 = :aten::zeros [[], [], [], [], []] -> 1.216us
           %3609 = :aten::zero_ [[4096, 32]] -> 1.216us
             %3610 = :aten::fill_ [[4096, 32], []] -> 1.216us
                 -->kernel: 0:7 %2820 =  [] -> 1.216us
         %3611 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.896us
                 -->kernel: 0:7 %2821 =  [] -> 12.896us
     %3612 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 98.400us
       %3613 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 56.704us
         %3614 = :aten::zeros [[], [], [], [], []] -> 1.248us
           %3615 = :aten::zero_ [[4096, 32]] -> 1.248us
             %3616 = :aten::fill_ [[4096, 32], []] -> 1.248us
                 -->kernel: 0:7 %2822 =  [] -> 1.248us
         %3617 = :nvte_fused_topk_with_score_function_backward [] -> 13.696us
                 -->kernel: 0:7 %2823 =  [] -> 13.696us
       %3618 = :aten::add [[4096, 32], [4096, 32], []] -> 1.696us
                 -->kernel: 0:7 %2824 =  [] -> 1.696us
     %3619 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 799.906us
       %3620 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 705.442us
         %3621 = :aten::to [[32, 7168], [], [], [], []] -> 6.496us
           %3622 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.496us
             %3623 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.496us
                 -->kernel: 0:7 %2825 =  [] -> 6.496us
         %3624 = :nvte_cublas_gemm_scaled [] -> 83.809us
                 -->kernel: 0:7 %2826 =  [] -> 67.904us
         %3625 = :aten::to [[4096, 7168], [], [], [], []] -> 177.248us
           %3626 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 177.248us
             %3627 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 177.248us
                 -->kernel: 0:7 %2827 =  [] -> 177.248us
         %3628 = :nvte_cublas_gemm_scaled [] -> 82.881us
                 -->kernel: 0:7 %2828 =  [] -> 82.881us
         %3629 = :aten::to [[4096, 7168], [], [], [], []] -> 43.552us
           %3630 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.552us
             %3631 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.552us
                 -->kernel: 0:7 %2829 =  [] -> 43.552us
         %3632 = :aten::to [[32, 7168], [], [], [], []] -> 2.304us
           %3633 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.304us
             %3634 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.304us
                 -->kernel: 0:7 %2830 =  [] -> 2.304us
       %3635 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.664us
                 -->kernel: 0:7 %2831 =  [] -> 49.664us
     %3636 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.080us
       %3637 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.080us
                 -->kernel: 0:35 %2832 =  [] -> 2.080us
     %3638 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 327.264us
       %3639 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 197.696us
         %3640 = :nvte_rmsnorm_bwd [] -> 197.696us
                 -->kernel: 0:7 %2833 =  [] -> 167.296us
                 -->kernel: 0:7 %2834 =  [] -> 7.808us
       %3641 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.784us
                 -->kernel: 0:7 %2835 =  [] -> 50.784us
     %3642 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %3643 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %2836 =  [] -> 1.568us
     %3644 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.252ms
       %3645 = :_LinearBackward [[4096, 1, 7168]] -> 7.252ms
         %3646 = :_Linear_backward [] -> 7.252ms
           %3647 = :nvte_quantize_v2 [] -> 73.024us
             %3648 = :quantize_transpose_vector_blockwise [] -> 73.024us
                 -->kernel: 0:7 %2837 =  [] -> 73.024us
           %3649 = :nvte_quantize_v2 [] -> 111.008us
             %3650 = :quantize_transpose_vector_blockwise [] -> 111.008us
                 -->kernel: 0:7 %2838 =  [] -> 111.008us
           %3651 = :nvte_cublas_gemm_scaled [] -> 3.432ms
                 -->kernel: 0:7 %2839 =  [] -> 3.427ms
           %3652 = :nvte_cublas_gemm_scaled [] -> 3.434ms
                 -->kernel: 0:7 %2840 =  [] -> 3.427ms
     %3653 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.904ms
       %3654 = :BmmBackward0 [[128, 4096, 128]] -> 7.904ms
         %3655 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.978ms
                 -->kernel: 0:7 %2841 =  [] -> 3.967ms
         %3656 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.872ms
                 -->kernel: 0:7 %2842 =  [] -> 3.864ms
     %3657 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 7.014ms
       %3658 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 7.014ms
         %3659 = :nvte_scaled_softmax_backward [] -> 7.014ms
                 -->kernel: 0:7 %2843 =  [] -> 7.014ms
     %3660 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.210ms
       %3661 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.210ms
         %3662 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.937ms
                 -->kernel: 0:7 %2844 =  [] -> 5.926ms
         %3663 = :aten::mul [[128, 4096, 192], []] -> 115.008us
           %3664 = :aten::mul [[128, 4096, 192], []] -> 115.008us
                 -->kernel: 0:7 %2845 =  [] -> 115.008us
         %3665 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.867ms
                 -->kernel: 0:7 %2846 =  [] -> 5.861ms
         %3666 = :aten::mul [[128, 192, 4096], []] -> 115.457us
           %3667 = :aten::mul [[128, 192, 4096], []] -> 115.457us
                 -->kernel: 0:7 %2847 =  [] -> 115.457us
     %3668 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.467ms
       %3669 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.467ms
         %3670 = :aten::contiguous [[4096, 1, 128, 192], []] -> 744.802us
           %3671 = :aten::clone [[4096, 1, 128, 192], []] -> 744.802us
             %3672 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 744.802us
                 -->kernel: 0:7 %2848 =  [] -> 744.802us
         %3673 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.705us
           %3674 = :aten::clone [[4096, 1, 128, 128], []] -> 280.705us
             %3675 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.705us
                 -->kernel: 0:7 %2849 =  [] -> 280.705us
                 -->kernel: 0:7 %2850 =  [] -> 173.249us
     %3676 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 637.729us
       %3677 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 637.729us
         %3678 = :aten::contiguous [[4096, 1, 128, 192], []] -> 423.201us
           %3679 = :aten::clone [[4096, 1, 128, 192], []] -> 423.201us
             %3680 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 423.201us
                 -->kernel: 0:7 %2851 =  [] -> 423.201us
                 -->kernel: 0:7 %2852 =  [] -> 118.624us
     %3681 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.737ms
       %3682 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.737ms
         %3683 = :_LayerNormLinear_backward [] -> 1.737ms
           %3684 = :nvte_quantize_v2 [] -> 324.001us
             %3685 = :quantize_transpose_vector_blockwise [] -> 324.001us
                 -->kernel: 0:7 %2853 =  [] -> 324.001us
           %3686 = :nvte_cublas_gemm_scaled [] -> 570.593us
                 -->kernel: 0:7 %2854 =  [] -> 519.489us
                 -->kernel: 0:7 %2855 =  [] -> 19.264us
           %3687 = :nvte_cublas_gemm_scaled [] -> 527.233us
                 -->kernel: 0:7 %2856 =  [] -> 521.889us
           %3688 = :nvte_rmsnorm_bwd [] -> 20.928us
                 -->kernel: 0:7 %2857 =  [] -> 6.176us
                 -->kernel: 0:7 %2858 =  [] -> 3.200us
     %3689 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.984us
       %3690 = :aten::add_ [[512], [512], []] -> 1.984us
                 -->kernel: 0:35 %2859 =  [] -> 1.984us
     %3691 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.778ms
       %3692 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.778ms
         %3693 = :_LayerNormLinear_backward [] -> 2.778ms
           %3694 = :nvte_quantize_v2 [] -> 243.776us
             %3695 = :quantize_transpose_vector_blockwise [] -> 243.776us
                 -->kernel: 0:7 %2860 =  [] -> 243.776us
           %3696 = :nvte_cublas_gemm_scaled [] -> 1.117ms
                 -->kernel: 0:7 %2861 =  [] -> 1.109ms
           %3697 = :nvte_cublas_gemm_scaled [] -> 1.121ms
                 -->kernel: 0:7 %2862 =  [] -> 1.115ms
           %3698 = :nvte_rmsnorm_bwd [] -> 55.520us
                 -->kernel: 0:7 %2863 =  [] -> 23.008us
                 -->kernel: 0:7 %2864 =  [] -> 20.416us
     %3699 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.888us
       %3700 = :aten::add_ [[1536], [1536], []] -> 1.888us
                 -->kernel: 0:35 %2865 =  [] -> 1.888us
     %3701 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 9.952us
       %3702 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 9.952us
         %3703 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 9.952us
                 -->kernel: 0:7 %2866 =  [] -> 9.952us
     %3704 = :autograd::engine::evaluate_function: _LinearBackward None -> 435.649us
       %3705 = :_LinearBackward [[4096, 1, 576]] -> 435.649us
         %3706 = :_Linear_backward [] -> 435.649us
           %3707 = :nvte_quantize_v2 [] -> 14.464us
             %3708 = :quantize_transpose_vector_blockwise [] -> 14.464us
                 -->kernel: 0:7 %2867 =  [] -> 14.464us
           %3709 = :nvte_cublas_gemm_scaled [] -> 148.224us
                 -->kernel: 0:7 %2868 =  [] -> 141.504us
           %3710 = :nvte_cublas_gemm_scaled [] -> 138.913us
                 -->kernel: 0:7 %2869 =  [] -> 133.089us
     %3711 = :autograd::engine::evaluate_function: _LinearBackward None -> 983.107us
       %3712 = :_LinearBackward [[4096, 1, 1536]] -> 823.362us
         %3713 = :_Linear_backward [] -> 823.362us
           %3714 = :nvte_quantize_v2 [] -> 18.848us
             %3715 = :quantize_transpose_vector_blockwise [] -> 18.848us
                 -->kernel: 0:7 %2870 =  [] -> 18.848us
           %3716 = :nvte_cublas_gemm_scaled [] -> 335.584us
                 -->kernel: 0:7 %2871 =  [] -> 329.472us
           %3717 = :nvte_cublas_gemm_scaled [] -> 342.369us
                 -->kernel: 0:7 %2872 =  [] -> 337.857us
       %3718 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.633us
                 -->kernel: 0:7 %2873 =  [] -> 49.633us
     %3719 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 317.121us
       %3720 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 194.496us
         %3721 = :nvte_rmsnorm_bwd [] -> 194.496us
                 -->kernel: 0:7 %2874 =  [] -> 166.208us
                 -->kernel: 0:7 %2875 =  [] -> 7.776us
       %3722 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.184us
                 -->kernel: 0:7 %2876 =  [] -> 49.184us
     %3723 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.632us
       %3724 = :aten::add_ [[7168], [7168], []] -> 1.632us
                 -->kernel: 0:35 %2877 =  [] -> 1.632us
     %3725 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.961ms
       %3726 = :_LinearBackward [[4096, 1, 7168]] -> 7.961ms
         %3727 = :_Linear_backward [] -> 7.961ms
           %3728 = :nvte_quantize_v2 [] -> 74.561us
             %3729 = :quantize_transpose_vector_blockwise [] -> 74.561us
                 -->kernel: 0:7 %2878 =  [] -> 74.561us
           %3730 = :nvte_cublas_gemm_scaled [] -> 3.881ms
                 -->kernel: 0:7 %2879 =  [] -> 3.874ms
           %3731 = :nvte_cublas_gemm_scaled [] -> 3.861ms
                 -->kernel: 0:7 %2880 =  [] -> 3.855ms
     %3732 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 844.769us
       %3733 = :SwiGLUFunctionBackward [[4096, 18432]] -> 844.769us
         %3734 = :Torch-Compiled Region: 5/1 None -> 844.769us
           %3735 = :triton_poi_fused_cat_0 [[4096, 18432], [4096, 36864], [4096, 36864], [], [], [], [], []] -> 844.769us
                 -->kernel: 0:7 %2881 =  [] -> 844.769us
     %3736 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 16.395ms
       %3737 = :_LayerNormLinearBackward [[4096, 1, 36864]] -> 16.226ms
         %3738 = :_LayerNormLinear_backward [] -> 16.226ms
           %3739 = :nvte_quantize_v2 [] -> 360.513us
             %3740 = :quantize_transpose_vector_blockwise [] -> 360.513us
                 -->kernel: 0:7 %2882 =  [] -> 360.513us
           %3741 = :nvte_cublas_gemm_scaled [] -> 7.637ms
                 -->kernel: 0:7 %2883 =  [] -> 7.629ms
           %3742 = :nvte_cublas_gemm_scaled [] -> 7.696ms
                 -->kernel: 0:7 %2884 =  [] -> 7.687ms
           %3743 = :nvte_rmsnorm_bwd [] -> 195.008us
                 -->kernel: 0:7 %2885 =  [] -> 162.560us
                 -->kernel: 0:7 %2886 =  [] -> 7.968us
       %3744 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 48.960us
                 -->kernel: 0:7 %2887 =  [] -> 48.960us
     %3745 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %3746 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %2888 =  [] -> 1.600us
     %3747 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.274ms
       %3748 = :_LinearBackward [[4096, 1, 7168]] -> 7.274ms
         %3749 = :_Linear_backward [] -> 7.274ms
           %3750 = :nvte_quantize_v2 [] -> 73.696us
             %3751 = :quantize_transpose_vector_blockwise [] -> 73.696us
                 -->kernel: 0:7 %2889 =  [] -> 73.696us
           %3752 = :nvte_quantize_v2 [] -> 110.081us
             %3753 = :quantize_transpose_vector_blockwise [] -> 110.081us
                 -->kernel: 0:7 %2890 =  [] -> 110.081us
           %3754 = :nvte_cublas_gemm_scaled [] -> 3.436ms
                 -->kernel: 0:7 %2891 =  [] -> 3.429ms
           %3755 = :nvte_cublas_gemm_scaled [] -> 3.430ms
                 -->kernel: 0:7 %2892 =  [] -> 3.423ms
     %3756 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.905ms
       %3757 = :BmmBackward0 [[128, 4096, 128]] -> 7.905ms
         %3758 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.978ms
                 -->kernel: 0:7 %2893 =  [] -> 3.965ms
         %3759 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.873ms
                 -->kernel: 0:7 %2894 =  [] -> 3.865ms
     %3760 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.965ms
       %3761 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.965ms
         %3762 = :nvte_scaled_softmax_backward [] -> 6.965ms
                 -->kernel: 0:7 %2895 =  [] -> 6.965ms
     %3763 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.190ms
       %3764 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.190ms
         %3765 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.937ms
                 -->kernel: 0:7 %2896 =  [] -> 5.925ms
         %3766 = :aten::mul [[128, 4096, 192], []] -> 115.168us
           %3767 = :aten::mul [[128, 4096, 192], []] -> 115.168us
                 -->kernel: 0:7 %2897 =  [] -> 115.168us
         %3768 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.866ms
                 -->kernel: 0:7 %2898 =  [] -> 5.860ms
         %3769 = :aten::mul [[128, 192, 4096], []] -> 116.160us
           %3770 = :aten::mul [[128, 192, 4096], []] -> 116.160us
                 -->kernel: 0:7 %2899 =  [] -> 116.160us
     %3771 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.480ms
       %3772 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.480ms
         %3773 = :aten::contiguous [[4096, 1, 128, 192], []] -> 743.394us
           %3774 = :aten::clone [[4096, 1, 128, 192], []] -> 743.394us
             %3775 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 743.394us
                 -->kernel: 0:7 %2900 =  [] -> 743.394us
         %3776 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.513us
           %3777 = :aten::clone [[4096, 1, 128, 128], []] -> 280.513us
             %3778 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.513us
                 -->kernel: 0:7 %2901 =  [] -> 280.513us
                 -->kernel: 0:7 %2902 =  [] -> 171.969us
     %3779 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 643.777us
       %3780 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 643.777us
         %3781 = :aten::contiguous [[4096, 1, 128, 192], []] -> 423.361us
           %3782 = :aten::clone [[4096, 1, 128, 192], []] -> 423.361us
             %3783 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 423.361us
                 -->kernel: 0:7 %2903 =  [] -> 423.361us
                 -->kernel: 0:7 %2904 =  [] -> 118.784us
     %3784 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.731ms
       %3785 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.731ms
         %3786 = :_LayerNormLinear_backward [] -> 1.731ms
           %3787 = :nvte_quantize_v2 [] -> 322.977us
             %3788 = :quantize_transpose_vector_blockwise [] -> 322.977us
                 -->kernel: 0:7 %2905 =  [] -> 322.977us
           %3789 = :nvte_cublas_gemm_scaled [] -> 567.073us
                 -->kernel: 0:7 %2906 =  [] -> 519.105us
                 -->kernel: 0:7 %2907 =  [] -> 19.136us
           %3790 = :nvte_cublas_gemm_scaled [] -> 528.098us
                 -->kernel: 0:7 %2908 =  [] -> 522.402us
           %3791 = :nvte_rmsnorm_bwd [] -> 20.992us
                 -->kernel: 0:7 %2909 =  [] -> 6.720us
                 -->kernel: 0:7 %2910 =  [] -> 3.200us
     %3792 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.144us
       %3793 = :aten::add_ [[512], [512], []] -> 2.144us
                 -->kernel: 0:35 %2911 =  [] -> 2.144us
     %3794 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.791ms
       %3795 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.791ms
         %3796 = :_LayerNormLinear_backward [] -> 2.791ms
           %3797 = :nvte_quantize_v2 [] -> 243.232us
             %3798 = :quantize_transpose_vector_blockwise [] -> 243.232us
                 -->kernel: 0:7 %2912 =  [] -> 243.232us
           %3799 = :nvte_cublas_gemm_scaled [] -> 1.117ms
                 -->kernel: 0:7 %2913 =  [] -> 1.109ms
           %3800 = :nvte_cublas_gemm_scaled [] -> 1.120ms
                 -->kernel: 0:7 %2914 =  [] -> 1.115ms
           %3801 = :nvte_rmsnorm_bwd [] -> 55.264us
                 -->kernel: 0:7 %2915 =  [] -> 23.328us
                 -->kernel: 0:7 %2916 =  [] -> 20.384us
     %3802 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.176us
       %3803 = :aten::add_ [[1536], [1536], []] -> 2.176us
                 -->kernel: 0:35 %2917 =  [] -> 2.176us
     %3804 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.016us
       %3805 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.016us
         %3806 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.016us
                 -->kernel: 0:7 %2918 =  [] -> 10.016us
     %3807 = :autograd::engine::evaluate_function: _LinearBackward None -> 432.577us
       %3808 = :_LinearBackward [[4096, 1, 576]] -> 432.577us
         %3809 = :_Linear_backward [] -> 432.577us
           %3810 = :nvte_quantize_v2 [] -> 14.400us
             %3811 = :quantize_transpose_vector_blockwise [] -> 14.400us
                 -->kernel: 0:7 %2919 =  [] -> 14.400us
           %3812 = :nvte_cublas_gemm_scaled [] -> 148.609us
                 -->kernel: 0:7 %2920 =  [] -> 141.281us
           %3813 = :nvte_cublas_gemm_scaled [] -> 139.104us
                 -->kernel: 0:7 %2921 =  [] -> 133.696us
     %3814 = :autograd::engine::evaluate_function: _LinearBackward None -> 986.531us
       %3815 = :_LinearBackward [[4096, 1, 1536]] -> 824.162us
         %3816 = :_Linear_backward [] -> 824.162us
           %3817 = :nvte_quantize_v2 [] -> 18.433us
             %3818 = :quantize_transpose_vector_blockwise [] -> 18.433us
                 -->kernel: 0:7 %2922 =  [] -> 18.433us
           %3819 = :nvte_cublas_gemm_scaled [] -> 335.552us
                 -->kernel: 0:7 %2923 =  [] -> 329.312us
           %3820 = :nvte_cublas_gemm_scaled [] -> 342.336us
                 -->kernel: 0:7 %2924 =  [] -> 337.888us
       %3821 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.824us
                 -->kernel: 0:7 %2925 =  [] -> 49.824us
     %3822 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 320.865us
       %3823 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 195.649us
         %3824 = :nvte_rmsnorm_bwd [] -> 195.649us
                 -->kernel: 0:7 %2926 =  [] -> 165.601us
                 -->kernel: 0:7 %2927 =  [] -> 7.904us
       %3825 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.248us
                 -->kernel: 0:7 %2928 =  [] -> 49.248us
     %3826 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.632us
       %3827 = :aten::add_ [[7168], [7168], []] -> 1.632us
                 -->kernel: 0:35 %2929 =  [] -> 1.632us
     %3828 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 3.051ms
       %3829 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.446ms
         %3830 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.446ms
           %3831 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.446ms
             %3832 = :aten::arange [[], [], [], [], []] -> 1.152us
               %3833 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %2930 =  [] -> 1.152us
             %3834 = CCCL:cub::DeviceRadixSort [] -> 189.249us
                 -->kernel: 0:7 %2931 =  [] -> 3.520us
                 -->kernel: 0:7 %2932 =  [] -> 1.568us
                 -->kernel: 0:7 %2933 =  [] -> 7.904us
                 -->kernel: 0:7 %2934 =  [] -> 7.328us
                 -->kernel: 0:7 %2935 =  [] -> 7.296us
                 -->kernel: 0:7 %2936 =  [] -> 7.200us
                 -->kernel: 0:7 %2937 =  [] -> 6.944us
                 -->kernel: 0:7 %2938 =  [] -> 6.880us
                 -->kernel: 0:7 %2939 =  [] -> 7.072us
                 -->kernel: 0:7 %2940 =  [] -> 7.040us
             %3835 = :aten::zeros [[], [], [], [], []] -> 545.121us
               %3836 = :aten::zero_ [[129280, 7168]] -> 545.121us
                 %3837 = :aten::fill_ [[129280, 7168], []] -> 545.121us
                 -->kernel: 0:7 %2941 =  [] -> 545.121us
             %3838 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 20.704us
                 -->kernel: 0:7 %2942 =  [] -> 1.248us
                 -->kernel: 0:7 %2943 =  [] -> 4.320us
                 -->kernel: 0:7 %2944 =  [] -> 1.632us
             %3839 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 18.913us
                 -->kernel: 0:7 %2945 =  [] -> 1.280us
                 -->kernel: 0:7 %2946 =  [] -> 2.880us
                 -->kernel: 0:7 %2947 =  [] -> 1.600us
                 -->kernel: 0:7 %2948 =  [] -> 1.824us
                 -->kernel: 0:7 %2949 =  [] -> 244.416us
                 -->kernel: 0:7 %2950 =  [] -> 200.417us
       %3840 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.556ms
                 -->kernel: 0:35 %2951 =  [] -> 1.556ms
     %3841 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.557ms
       %3842 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.557ms
                 -->kernel: 0:35 %2952 =  [] -> 1.557ms
     %3843 = :aten::linalg_vector_norm [[3002413056], [], [], [], []] -> 2.550ms
                 -->kernel: 0:7 %2953 =  [] -> 616.001us
                 -->kernel: 0:7 %2954 =  [] -> 609.986us
                 -->kernel: 0:7 %2955 =  [] -> 607.937us
                 -->kernel: 0:7 %2956 =  [] -> 610.081us
     %3844 = :aten::isnan [[]] -> 1.728us
       %3845 = :aten::ne [[], []] -> 1.728us
                 -->kernel: 0:7 %2957 =  [] -> 1.728us
     %3846 = :aten::is_nonzero [[]] -> 2.240us
       %3847 = :aten::item [[]] -> 2.240us
         %3848 = :aten::_local_scalar_dense [[]] -> 2.240us
     %3849 = :aten::isinf [[]] -> 37.824us
       %3850 = :aten::abs [[]] -> 1.568us
         %3851 = :aten::abs [[], [0]] -> 1.568us
                 -->kernel: 0:7 %2958 =  [] -> 1.568us
       %3852 = :aten::eq [[], []] -> 1.568us
                 -->kernel: 0:7 %2959 =  [] -> 1.568us
     %3853 = :aten::is_nonzero [[]] -> 2.240us
       %3854 = :aten::item [[]] -> 2.240us
         %3855 = :aten::_local_scalar_dense [[]] -> 2.240us
     %3856 = :aten::mul_ [[3002413056], []] -> 3.543ms
                 -->kernel: 0:7 %2960 =  [] -> 863.490us
                 -->kernel: 0:7 %2961 =  [] -> 901.218us
                 -->kernel: 0:7 %2962 =  [] -> 872.162us
                 -->kernel: 0:7 %2963 =  [] -> 870.338us
     %3857 = :c10d::reduce_scatter_tensor_coalesced_ [[375301632], [3002413056], [], [], [], []] -> 14.519ms
       %3858 = :record_param_comms [[3002413056], [], [], [], [], [], [], [], [], []] -> 14.519ms
         %3859 = :nccl:reduce_scatter_tensor_coalesced [[3002413056]] -> 14.519ms
           %3860 = NCCL:ncclGroupEnd [] -> 14.519ms
                 -->kernel: 0:7 %2964 =  [] -> 14.519ms
     %3861 = :aten::linalg_vector_norm [[352321536], [], [], [], []] -> 304.545us
                 -->kernel: 0:7 %2965 =  [] -> 290.785us
     %3862 = :aten::isnan [[]] -> 1.728us
       %3863 = :aten::ne [[], []] -> 1.728us
                 -->kernel: 0:7 %2966 =  [] -> 1.728us
     %3864 = :aten::is_nonzero [[]] -> 2.208us
       %3865 = :aten::item [[]] -> 2.208us
         %3866 = :aten::_local_scalar_dense [[]] -> 2.208us
     %3867 = :aten::isinf [[]] -> 26.848us
       %3868 = :aten::abs [[]] -> 1.344us
         %3869 = :aten::abs [[], [0]] -> 1.344us
                 -->kernel: 0:7 %2967 =  [] -> 1.344us
       %3870 = :aten::eq [[], []] -> 1.344us
                 -->kernel: 0:7 %2968 =  [] -> 1.344us
     %3871 = :aten::is_nonzero [[]] -> 2.368us
       %3872 = :aten::item [[]] -> 2.368us
         %3873 = :aten::_local_scalar_dense [[]] -> 2.368us
     %3874 = :aten::mul_ [[352321536], []] -> 403.809us
                 -->kernel: 0:7 %2969 =  [] -> 403.809us
     %3875 = :aten::stack [[32], [32], []] -> 2.560us
       %3876 = :aten::cat [[32], [32], []] -> 2.560us
                 -->kernel: 0:7 %2970 =  [] -> 2.560us
     %3877 = :aten::stack [[32], [32], []] -> 1.856us
       %3878 = :aten::cat [[32], [32], []] -> 1.856us
                 -->kernel: 0:7 %2971 =  [] -> 1.856us
     %3879 = :c10d::allreduce_ [[2, 32], [], [], [], [], []] -> 15.136us
       %3880 = :record_param_comms [[2, 32], [], [], [], [], [], [], [], [], []] -> 15.136us
         %3881 = :nccl:all_reduce [[2, 32]] -> 15.136us
           %3882 = NCCL:ncclAllReduce [] -> 15.136us
                 -->kernel: 0:7 %2972 =  [] -> 15.136us
     %3883 = :aten::sum [[2, 32], [], [], []] -> 3.136us
                 -->kernel: 0:7 %2973 =  [] -> 3.136us
     %3884 = :aten::div [[2, 1], []] -> 1.696us
                 -->kernel: 0:7 %2974 =  [] -> 1.696us
     %3885 = :aten::sub [[2, 1], [2, 32], []] -> 1.792us
                 -->kernel: 0:7 %2975 =  [] -> 1.792us
     %3886 = :aten::sign [[2, 32]] -> 1.472us
                 -->kernel: 0:7 %2976 =  [] -> 1.472us
     %3887 = :aten::mul [[2, 32], []] -> 1.792us
                 -->kernel: 0:7 %2977 =  [] -> 1.792us
     %3888 = :aten::add [[2, 32], [2, 32], []] -> 3.072us
                 -->kernel: 0:7 %2978 =  [] -> 3.072us
     %3889 = :aten::zero_ [[32]] -> 1.024us
       %3890 = :aten::fill_ [[32], []] -> 1.024us
                 -->kernel: 0:7 %2979 =  [] -> 1.024us
     %3891 = :aten::copy_ [[32], [32], []] -> 1.024us
     %3892 = :aten::zero_ [[32]] -> 1.152us
       %3893 = :aten::fill_ [[32], []] -> 1.152us
                 -->kernel: 0:7 %2980 =  [] -> 1.152us
     %3894 = :aten::copy_ [[32], [32], []] -> 1.216us
     %3895 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %3896 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %3897 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %3898 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 8.960us
       %3899 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 8.960us
         %3900 = :nccl:all_reduce [[1]] -> 8.960us
           %3901 = NCCL:ncclAllReduce [] -> 8.960us
                 -->kernel: 0:7 %2981 =  [] -> 8.960us
     %3902 = :aten::item [[1]] -> 2.240us
       %3903 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %3904 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %3905 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %3906 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %3907 = :aten::zeros [[], [], [], [], []] -> 1.024us
       %3908 = :aten::zero_ [[320]] -> 1.024us
         %3909 = :aten::fill_ [[320], []] -> 1.024us
                 -->kernel: 0:7 %2982 =  [] -> 1.024us
     %3910 = :nvte_multi_tensor_l2norm_cuda [] -> 1.383ms
                 -->kernel: 0:7 %2983 =  [] -> 36.256us
                 -->kernel: 0:7 %2984 =  [] -> 33.568us
                 -->kernel: 0:7 %2985 =  [] -> 29.504us
                 -->kernel: 0:7 %2986 =  [] -> 29.760us
                 -->kernel: 0:7 %2987 =  [] -> 30.337us
                 -->kernel: 0:7 %2988 =  [] -> 29.984us
                 -->kernel: 0:7 %2989 =  [] -> 29.952us
                 -->kernel: 0:7 %2990 =  [] -> 29.760us
                 -->kernel: 0:7 %2991 =  [] -> 30.560us
                 -->kernel: 0:7 %2992 =  [] -> 29.760us
                 -->kernel: 0:7 %2993 =  [] -> 29.984us
                 -->kernel: 0:7 %2994 =  [] -> 30.368us
                 -->kernel: 0:7 %2995 =  [] -> 30.240us
                 -->kernel: 0:7 %2996 =  [] -> 30.336us
                 -->kernel: 0:7 %2997 =  [] -> 30.112us
                 -->kernel: 0:7 %2998 =  [] -> 30.049us
                 -->kernel: 0:7 %2999 =  [] -> 30.048us
                 -->kernel: 0:7 %3000 =  [] -> 29.728us
                 -->kernel: 0:7 %3001 =  [] -> 29.984us
                 -->kernel: 0:7 %3002 =  [] -> 30.112us
                 -->kernel: 0:7 %3003 =  [] -> 29.728us
                 -->kernel: 0:7 %3004 =  [] -> 30.240us
                 -->kernel: 0:7 %3005 =  [] -> 29.856us
                 -->kernel: 0:7 %3006 =  [] -> 29.696us
                 -->kernel: 0:7 %3007 =  [] -> 30.176us
                 -->kernel: 0:7 %3008 =  [] -> 30.048us
                 -->kernel: 0:7 %3009 =  [] -> 29.793us
                 -->kernel: 0:7 %3010 =  [] -> 29.792us
                 -->kernel: 0:7 %3011 =  [] -> 30.240us
                 -->kernel: 0:7 %3012 =  [] -> 30.112us
                 -->kernel: 0:7 %3013 =  [] -> 29.664us
                 -->kernel: 0:7 %3014 =  [] -> 29.952us
                 -->kernel: 0:7 %3015 =  [] -> 29.952us
                 -->kernel: 0:7 %3016 =  [] -> 30.496us
                 -->kernel: 0:7 %3017 =  [] -> 17.248us
                 -->kernel: 0:7 %3018 =  [] -> 1.568us
     %3911 = :aten::pow [[1], []] -> 1.632us
                 -->kernel: 0:7 %3019 =  [] -> 1.632us
     %3912 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 51.296us
       %3913 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 51.296us
         %3914 = :nccl:all_reduce [[1]] -> 51.296us
           %3915 = NCCL:ncclAllReduce [] -> 51.296us
                 -->kernel: 0:7 %3020 =  [] -> 51.296us
     %3916 = :aten::item [[1]] -> 2.240us
       %3917 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %3918 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %3919 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %3920 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %3921 = :nvte_multi_tensor_scale_cuda [] -> 933.346us
                 -->kernel: 0:7 %3021 =  [] -> 36.320us
                 -->kernel: 0:7 %3022 =  [] -> 42.592us
                 -->kernel: 0:7 %3023 =  [] -> 44.288us
                 -->kernel: 0:7 %3024 =  [] -> 43.680us
                 -->kernel: 0:7 %3025 =  [] -> 43.776us
                 -->kernel: 0:7 %3026 =  [] -> 43.328us
                 -->kernel: 0:7 %3027 =  [] -> 43.968us
                 -->kernel: 0:7 %3028 =  [] -> 43.264us
                 -->kernel: 0:7 %3029 =  [] -> 42.336us
                 -->kernel: 0:7 %3030 =  [] -> 42.528us
                 -->kernel: 0:7 %3031 =  [] -> 43.104us
                 -->kernel: 0:7 %3032 =  [] -> 43.104us
                 -->kernel: 0:7 %3033 =  [] -> 43.105us
                 -->kernel: 0:7 %3034 =  [] -> 43.648us
                 -->kernel: 0:7 %3035 =  [] -> 43.104us
                 -->kernel: 0:7 %3036 =  [] -> 44.512us
                 -->kernel: 0:7 %3037 =  [] -> 43.168us
                 -->kernel: 0:7 %3038 =  [] -> 30.624us
     %3922 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %3923 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %3924 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %3925 = :nvte_multi_tensor_scale_cuda [] -> 877.538us
                 -->kernel: 0:7 %3039 =  [] -> 42.656us
                 -->kernel: 0:7 %3040 =  [] -> 43.552us
                 -->kernel: 0:7 %3041 =  [] -> 42.880us
                 -->kernel: 0:7 %3042 =  [] -> 43.680us
                 -->kernel: 0:7 %3043 =  [] -> 42.848us
                 -->kernel: 0:7 %3044 =  [] -> 43.520us
                 -->kernel: 0:7 %3045 =  [] -> 42.816us
                 -->kernel: 0:7 %3046 =  [] -> 43.585us
                 -->kernel: 0:7 %3047 =  [] -> 42.880us
                 -->kernel: 0:7 %3048 =  [] -> 43.872us
                 -->kernel: 0:7 %3049 =  [] -> 43.520us
                 -->kernel: 0:7 %3050 =  [] -> 42.240us
                 -->kernel: 0:7 %3051 =  [] -> 42.656us
                 -->kernel: 0:7 %3052 =  [] -> 42.880us
                 -->kernel: 0:7 %3053 =  [] -> 43.456us
                 -->kernel: 0:7 %3054 =  [] -> 43.009us
                 -->kernel: 0:7 %3055 =  [] -> 27.776us
     %3926 = :Optimizer.step#HybridDeviceOptimizer.step None -> 317.614ms
       %3927 = :aten::copy_ [[375301632], [375301632], []] -> 43.652ms
         %3928 = :aten::to [[375301632], [], [], [], []] -> 2.226ms
           %3929 = :aten::_to_copy [[375301632], [], [], [], [], [], []] -> 2.226ms
             %3930 = :aten::copy_ [[375301632], [375301632], []] -> 2.226ms
                 -->kernel: 0:7 %3056 =  [] -> 2.226ms
         %3931 = :aten::copy_ [[375301632], [375301632], []] -> 41.381ms
       %3932 = :Optimizer.step#AdamW.step None -> 72.105ms
         %3933 = :aten::copy_ [[375301632], [375301632], []] -> 72.105ms
           %3934 = :aten::copy_ [[375301632], [375301632], []] -> 71.390ms
           %3935 = :aten::copy_ [[375301632], [375301632], []] -> 602.850us
                 -->kernel: 0:7 %3057 =  [] -> 602.850us
     %3936 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 342.202ms
       %3937 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 342.202ms
         %3938 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 342.202ms
           %3939 = NCCL:ncclGroupEnd [] -> 342.202ms
                 -->kernel: 0:39 %3058 =  [] -> 342.202ms
     %3940 = :Optimizer.step#HybridDeviceOptimizer.step None -> 84.168ms
       %3941 = :aten::to [[14680064], [], [], [], []] -> 89.344us
         %3942 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.344us
           %3943 = :aten::copy_ [[14680064], [14680064], []] -> 89.344us
                 -->kernel: 0:7 %3059 =  [] -> 89.344us
       %3944 = :aten::to [[29360128], [], [], [], []] -> 176.353us
         %3945 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.353us
           %3946 = :aten::copy_ [[29360128], [29360128], []] -> 176.353us
                 -->kernel: 0:7 %3060 =  [] -> 176.353us
       %3947 = :aten::to [[29360128], [], [], [], []] -> 175.584us
         %3948 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 175.584us
           %3949 = :aten::copy_ [[29360128], [29360128], []] -> 175.584us
                 -->kernel: 0:7 %3061 =  [] -> 175.584us
       %3950 = :aten::to [[29360128], [], [], [], []] -> 176.065us
         %3951 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.065us
           %3952 = :aten::copy_ [[29360128], [29360128], []] -> 176.065us
                 -->kernel: 0:7 %3062 =  [] -> 176.065us
       %3953 = :aten::to [[29360128], [], [], [], []] -> 176.128us
         %3954 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.128us
           %3955 = :aten::copy_ [[29360128], [29360128], []] -> 176.128us
                 -->kernel: 0:7 %3063 =  [] -> 176.128us
       %3956 = :aten::to [[14680064], [], [], [], []] -> 89.536us
         %3957 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.536us
           %3958 = :aten::copy_ [[14680064], [14680064], []] -> 89.536us
                 -->kernel: 0:7 %3064 =  [] -> 89.536us
       %3959 = :aten::to [[14680064], [], [], [], []] -> 89.536us
         %3960 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.536us
           %3961 = :aten::copy_ [[14680064], [14680064], []] -> 89.536us
                 -->kernel: 0:7 %3065 =  [] -> 89.536us
       %3962 = :aten::to [[14680064], [], [], [], []] -> 89.184us
         %3963 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.184us
           %3964 = :aten::copy_ [[14680064], [14680064], []] -> 89.184us
                 -->kernel: 0:7 %3066 =  [] -> 89.184us
       %3965 = :aten::to [[14680064], [], [], [], []] -> 89.504us
         %3966 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.504us
           %3967 = :aten::copy_ [[14680064], [14680064], []] -> 89.504us
                 -->kernel: 0:7 %3067 =  [] -> 89.504us
       %3968 = :aten::to [[29360128], [], [], [], []] -> 176.289us
         %3969 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.289us
           %3970 = :aten::copy_ [[29360128], [29360128], []] -> 176.289us
                 -->kernel: 0:7 %3068 =  [] -> 176.289us
       %3971 = :aten::to [[29360128], [], [], [], []] -> 176.288us
         %3972 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.288us
           %3973 = :aten::copy_ [[29360128], [29360128], []] -> 176.288us
                 -->kernel: 0:7 %3069 =  [] -> 176.288us
       %3974 = :aten::to [[29360128], [], [], [], []] -> 175.841us
         %3975 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 175.841us
           %3976 = :aten::copy_ [[29360128], [29360128], []] -> 175.841us
                 -->kernel: 0:7 %3070 =  [] -> 175.841us
       %3977 = :aten::to [[29360128], [], [], [], []] -> 176.512us
         %3978 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.512us
           %3979 = :aten::copy_ [[29360128], [29360128], []] -> 176.512us
                 -->kernel: 0:7 %3071 =  [] -> 176.512us
       %3980 = :aten::copy_ [[14680064], [14680064], []] -> 1.992ms
         %3981 = :aten::to [[14680064], [], [], [], []] -> 89.409us
           %3982 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.409us
             %3983 = :aten::copy_ [[14680064], [14680064], []] -> 89.409us
                 -->kernel: 0:7 %3072 =  [] -> 89.409us
         %3984 = :aten::copy_ [[14680064], [14680064], []] -> 1.842ms
       %3985 = :aten::copy_ [[14680064], [14680064], []] -> 1.841ms
         %3986 = :aten::to [[14680064], [], [], [], []] -> 88.544us
           %3987 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.544us
             %3988 = :aten::copy_ [[14680064], [14680064], []] -> 88.544us
                 -->kernel: 0:7 %3073 =  [] -> 88.544us
         %3989 = :aten::copy_ [[14680064], [14680064], []] -> 1.721ms
       %3990 = :aten::copy_ [[14680064], [14680064], []] -> 1.815ms
         %3991 = :aten::to [[14680064], [], [], [], []] -> 88.000us
           %3992 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.000us
             %3993 = :aten::copy_ [[14680064], [14680064], []] -> 88.000us
                 -->kernel: 0:7 %3074 =  [] -> 88.000us
         %3994 = :aten::copy_ [[14680064], [14680064], []] -> 1.696ms
       %3995 = :Optimizer.step#FusedAdam.step None -> 3.865ms
         %3996 = :nvte_multi_tensor_adam_cuda [] -> 3.082ms
                 -->kernel: 0:7 %3075 =  [] -> 199.072us
                 -->kernel: 0:7 %3076 =  [] -> 200.737us
                 -->kernel: 0:7 %3077 =  [] -> 200.320us
                 -->kernel: 0:7 %3078 =  [] -> 201.345us
                 -->kernel: 0:7 %3079 =  [] -> 198.368us
                 -->kernel: 0:7 %3080 =  [] -> 197.249us
                 -->kernel: 0:7 %3081 =  [] -> 200.320us
                 -->kernel: 0:7 %3082 =  [] -> 199.425us
                 -->kernel: 0:7 %3083 =  [] -> 197.344us
                 -->kernel: 0:7 %3084 =  [] -> 199.393us
                 -->kernel: 0:7 %3085 =  [] -> 198.624us
                 -->kernel: 0:7 %3086 =  [] -> 199.393us
                 -->kernel: 0:7 %3087 =  [] -> 199.232us
                 -->kernel: 0:7 %3088 =  [] -> 200.321us
                 -->kernel: 0:7 %3089 =  [] -> 141.440us
         %3997 = :aten::copy_ [[14680064], [14680064], []] -> 27.168us
                 -->kernel: 0:7 %3090 =  [] -> 27.168us
         %3998 = :aten::copy_ [[29360128], [29360128], []] -> 49.600us
                 -->kernel: 0:7 %3091 =  [] -> 49.600us
         %3999 = :aten::copy_ [[29360128], [29360128], []] -> 49.664us
                 -->kernel: 0:7 %3092 =  [] -> 49.664us
         %4000 = :aten::copy_ [[29360128], [29360128], []] -> 48.224us
                 -->kernel: 0:7 %3093 =  [] -> 48.224us
         %4001 = :aten::copy_ [[29360128], [29360128], []] -> 49.568us
                 -->kernel: 0:7 %3094 =  [] -> 49.568us
         %4002 = :aten::copy_ [[14680064], [14680064], []] -> 25.056us
                 -->kernel: 0:7 %3095 =  [] -> 25.056us
         %4003 = :aten::copy_ [[14680064], [14680064], []] -> 25.088us
                 -->kernel: 0:7 %3096 =  [] -> 25.088us
         %4004 = :aten::copy_ [[14680064], [14680064], []] -> 25.056us
                 -->kernel: 0:7 %3097 =  [] -> 25.056us
         %4005 = :aten::copy_ [[14680064], [14680064], []] -> 26.400us
                 -->kernel: 0:7 %3098 =  [] -> 26.400us
         %4006 = :aten::copy_ [[29360128], [29360128], []] -> 47.617us
                 -->kernel: 0:7 %3099 =  [] -> 47.617us
         %4007 = :aten::copy_ [[29360128], [29360128], []] -> 49.536us
                 -->kernel: 0:7 %3100 =  [] -> 49.536us
         %4008 = :aten::copy_ [[29360128], [29360128], []] -> 49.600us
                 -->kernel: 0:7 %3101 =  [] -> 49.600us
         %4009 = :aten::copy_ [[29360128], [29360128], []] -> 47.968us
                 -->kernel: 0:7 %3102 =  [] -> 47.968us
       %4010 = :Optimizer.step#AdamW.step None -> 8.725ms
         %4011 = :aten::copy_ [[14680064], [14680064], []] -> 2.928ms
           %4012 = :aten::copy_ [[14680064], [14680064], []] -> 2.852ms
           %4013 = :aten::copy_ [[14680064], [14680064], []] -> 24.352us
                 -->kernel: 0:7 %3103 =  [] -> 24.352us
         %4014 = :aten::copy_ [[14680064], [14680064], []] -> 2.783ms
           %4015 = :aten::copy_ [[14680064], [14680064], []] -> 2.744ms
           %4016 = :aten::copy_ [[14680064], [14680064], []] -> 23.456us
                 -->kernel: 0:7 %3104 =  [] -> 23.456us
         %4017 = :aten::copy_ [[14680064], [14680064], []] -> 2.739ms
           %4018 = :aten::copy_ [[14680064], [14680064], []] -> 2.706ms
           %4019 = :aten::copy_ [[14680064], [14680064], []] -> 24.064us
                 -->kernel: 0:7 %3105 =  [] -> 24.064us
     %4020 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 53.683ms
       %4021 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 53.683ms
         %4022 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 53.683ms
           %4023 = NCCL:ncclGroupEnd [] -> 53.683ms
                 -->kernel: 0:39 %3106 =  [] -> 53.683ms
     %4024 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %4025 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %4026 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %4027 = :aten::item [[1]] -> 3.552us
       %4028 = :aten::_local_scalar_dense [[1]] -> 3.552us
     %4029 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %4030 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %4031 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %4032 = :aten::item [[1]] -> 2.464us
       %4033 = :aten::_local_scalar_dense [[1]] -> 2.464us
     %4034 = :aten::item [[1]] -> 2.304us
       %4035 = :aten::_local_scalar_dense [[1]] -> 2.304us
     %4036 = :aten::cat [[1], []] -> 1.312us
     %4037 = :aten::mean [[1], []] -> 2.528us
       %4038 = :aten::mean [[1], [], [], []] -> 2.528us
                 -->kernel: 0:7 %3107 =  [] -> 2.528us
     %4039 = :aten::item [[1]] -> 2.656us
       %4040 = :aten::_local_scalar_dense [[1]] -> 2.656us
     %4041 = :aten::to [[1], [], [], [], [], []] -> 736.000ns
       %4042 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 736.000ns
         %4043 = :aten::copy_ [[1], [1], []] -> 736.000ns
     %4044 = :aten::add [[1], [], []] -> 1.632us
                 -->kernel: 0:7 %3108 =  [] -> 1.632us
     %4045 = :aten::to [[1], [], [], [], [], []] -> 736.000ns
       %4046 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 736.000ns
         %4047 = :aten::copy_ [[1], [1], []] -> 736.000ns
     %4048 = :aten::item [[1]] -> 2.336us
       %4049 = :aten::_local_scalar_dense [[1]] -> 2.336us
     %4050 = :aten::item [[1]] -> 2.176us
       %4051 = :aten::_local_scalar_dense [[1]] -> 2.176us
     %4052 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 1.641ms
       %4053 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 1.641ms
         %4054 = :nccl:all_reduce [[2]] -> 1.641ms
           %4055 = NCCL:ncclAllReduce [] -> 1.641ms
                 -->kernel: 0:7 %3109 =  [] -> 1.641ms
     %4056 = :c10d::allreduce_ [[3], [], [], [], [], []] -> 9.056us
       %4057 = :record_param_comms [[3], [], [], [], [], [], [], [], [], []] -> 9.056us
         %4058 = :nccl:all_reduce [[3]] -> 9.056us
           %4059 = NCCL:ncclAllReduce [] -> 9.056us
                 -->kernel: 0:7 %3110 =  [] -> 9.056us
     %4060 = :aten::mul [[3], []] -> 1.312us
                 -->kernel: 0:7 %3111 =  [] -> 1.312us
     %4061 = :aten::mul [[2], []] -> 1.504us
                 -->kernel: 0:7 %3112 =  [] -> 1.504us
     %4062 = :aten::sum [[3], []] -> 3.232us
       %4063 = :aten::sum [[3], [], [], []] -> 3.232us
                 -->kernel: 0:7 %3113 =  [] -> 3.232us
     %4064 = :aten::div [[], []] -> 1.280us
                 -->kernel: 0:7 %3114 =  [] -> 1.280us
     %4065 = :aten::add_ [[1], [], []] -> 1.280us
                 -->kernel: 0:7 %3115 =  [] -> 1.280us
     %4066 = :aten::sum [[2], []] -> 2.624us
       %4067 = :aten::sum [[2], [], [], []] -> 2.624us
                 -->kernel: 0:7 %3116 =  [] -> 2.624us
     %4068 = :aten::div [[], []] -> 1.344us
                 -->kernel: 0:7 %3117 =  [] -> 1.344us
     %4069 = :aten::add_ [[1], [], []] -> 1.280us
                 -->kernel: 0:7 %3118 =  [] -> 1.280us
     %4070 = :aten::zero_ [[3]] -> 960.000ns
       %4071 = :aten::fill_ [[3], []] -> 960.000ns
                 -->kernel: 0:7 %3119 =  [] -> 960.000ns
     %4072 = :aten::zero_ [[2]] -> 1.184us
       %4073 = :aten::fill_ [[2], []] -> 1.184us
                 -->kernel: 0:7 %3120 =  [] -> 1.184us
     %4074 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 308.737us
       %4075 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 308.737us
         %4076 = :nccl:all_reduce [[1]] -> 308.737us
           %4077 = NCCL:ncclAllReduce [] -> 308.737us
                 -->kernel: 0:7 %3121 =  [] -> 308.737us
     %4078 = :aten::mul [[1], []] -> 1.184us
                 -->kernel: 0:7 %3122 =  [] -> 1.184us
     %4079 = :aten::add_ [[1], [], []] -> 1.280us
                 -->kernel: 0:7 %3123 =  [] -> 1.280us
     %4080 = :aten::zero_ [[1]] -> 1.184us
       %4081 = :aten::fill_ [[1], []] -> 1.184us
                 -->kernel: 0:7 %3124 =  [] -> 1.184us
     %4082 = :c10d::barrier [[1], [], [], [], []] -> 148.705us
       %4083 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 148.705us
         %4084 = :aten::zeros [[], [], [], [], []] -> 1.184us
           %4085 = :aten::zero_ [[1]] -> 1.184us
             %4086 = :aten::fill_ [[1], []] -> 1.184us
                 -->kernel: 0:7 %3125 =  [] -> 1.184us
         %4087 = :nccl:all_reduce_barrier [[1]] -> 112.672us
           %4088 = NCCL:ncclAllReduce [] -> 112.672us
                 -->kernel: 0:7 %3126 =  [] -> 112.672us
     %4089 = :c10d::barrier [[1], [], [], [], []] -> 37.920us
       %4090 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 37.920us
         %4091 = :aten::zeros [[], [], [], [], []] -> 960.000ns
           %4092 = :aten::zero_ [[1]] -> 960.000ns
             %4093 = :aten::fill_ [[1], []] -> 960.000ns
                 -->kernel: 0:7 %3127 =  [] -> 960.000ns
         %4094 = :nccl:all_reduce_barrier [[1]] -> 7.808us
           %4095 = NCCL:ncclAllReduce [] -> 7.808us
                 -->kernel: 0:7 %3128 =  [] -> 7.808us
     %4096 = :aten::item [[1]] -> 2.336us
       %4097 = :aten::_local_scalar_dense [[1]] -> 2.336us
     %4098 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %4099 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %4100 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %4101 = :aten::item [[1]] -> 2.240us
       %4102 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %4103 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %4104 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %4105 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %4106 = :aten::item [[1]] -> 2.240us
       %4107 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %4108 = :aten::to [[1], [], [], [], [], []] -> 736.000ns
       %4109 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 736.000ns
         %4110 = :aten::copy_ [[1], [1], []] -> 736.000ns
     %4111 = :aten::item [[1]] -> 2.432us
       %4112 = :aten::_local_scalar_dense [[1]] -> 2.432us
     %4113 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %4114 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %4115 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %4116 = :aten::zeros [[], [], [], [], []] -> 1.120us
       %4117 = :aten::zero_ [[8, 24]] -> 1.120us
         %4118 = :aten::fill_ [[8, 24], []] -> 1.120us
                 -->kernel: 0:7 %3129 =  [] -> 1.120us
     %4119 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 114.304us
       %4120 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 114.304us
         %4121 = :nccl:_all_gather_base [[24]] -> 114.304us
           %4122 = NCCL:ncclAllGather [] -> 114.304us
                 -->kernel: 0:7 %3130 =  [] -> 114.304us
     %4123 = :aten::gt [[8], []] -> 1.472us
                 -->kernel: 0:7 %3131 =  [] -> 1.472us
     %4124 = :aten::index [[8], [8]] -> 63.040us
       %4125 = :aten::nonzero [[8]] -> 63.040us
         %4126 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3132 =  [] -> 1.440us
         %4127 = CCCL:cub::DeviceSelect::Flagged [] -> 15.392us
                 -->kernel: 0:7 %3133 =  [] -> 1.312us
                 -->kernel: 0:7 %3134 =  [] -> 1.920us
     %4128 = :aten::gt [[8], []] -> 1.504us
                 -->kernel: 0:7 %3135 =  [] -> 1.504us
     %4129 = :aten::index [[8], [8]] -> 45.568us
       %4130 = :aten::nonzero [[8]] -> 45.568us
         %4131 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %3136 =  [] -> 1.472us
         %4132 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %3137 =  [] -> 1.248us
                 -->kernel: 0:7 %3138 =  [] -> 1.824us
     %4133 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3139 =  [] -> 1.344us
     %4134 = :aten::index [[8], [8]] -> 42.944us
       %4135 = :aten::nonzero [[8]] -> 42.944us
         %4136 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3140 =  [] -> 1.440us
         %4137 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3141 =  [] -> 1.280us
                 -->kernel: 0:7 %3142 =  [] -> 1.792us
     %4138 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3143 =  [] -> 1.344us
     %4139 = :aten::index [[8], [8]] -> 43.680us
       %4140 = :aten::nonzero [[8]] -> 43.680us
         %4141 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3144 =  [] -> 1.440us
         %4142 = CCCL:cub::DeviceSelect::Flagged [] -> 12.608us
                 -->kernel: 0:7 %3145 =  [] -> 1.248us
                 -->kernel: 0:7 %3146 =  [] -> 1.824us
     %4143 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3147 =  [] -> 1.344us
     %4144 = :aten::index [[8], [8]] -> 42.848us
       %4145 = :aten::nonzero [[8]] -> 42.848us
         %4146 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3148 =  [] -> 1.440us
         %4147 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3149 =  [] -> 1.312us
                 -->kernel: 0:7 %3150 =  [] -> 1.792us
     %4148 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3151 =  [] -> 1.344us
     %4149 = :aten::index [[8], [8]] -> 42.720us
       %4150 = :aten::nonzero [[8]] -> 42.720us
         %4151 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %3152 =  [] -> 1.408us
         %4152 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3153 =  [] -> 1.248us
                 -->kernel: 0:7 %3154 =  [] -> 1.792us
     %4153 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3155 =  [] -> 1.344us
     %4154 = :aten::index [[8], [8]] -> 43.072us
       %4155 = :aten::nonzero [[8]] -> 43.072us
         %4156 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %3156 =  [] -> 1.408us
         %4157 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %3157 =  [] -> 1.312us
                 -->kernel: 0:7 %3158 =  [] -> 1.792us
     %4158 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3159 =  [] -> 1.344us
     %4159 = :aten::index [[8], [8]] -> 42.112us
       %4160 = :aten::nonzero [[8]] -> 42.112us
         %4161 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3160 =  [] -> 1.440us
         %4162 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %3161 =  [] -> 1.248us
                 -->kernel: 0:7 %3162 =  [] -> 1.792us
     %4163 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3163 =  [] -> 1.344us
     %4164 = :aten::index [[8], [8]] -> 42.144us
       %4165 = :aten::nonzero [[8]] -> 42.144us
         %4166 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3164 =  [] -> 1.440us
         %4167 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %3165 =  [] -> 1.280us
                 -->kernel: 0:7 %3166 =  [] -> 1.792us
     %4168 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3167 =  [] -> 1.344us
     %4169 = :aten::index [[8], [8]] -> 42.912us
       %4170 = :aten::nonzero [[8]] -> 42.912us
         %4171 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3168 =  [] -> 1.440us
         %4172 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %3169 =  [] -> 1.248us
                 -->kernel: 0:7 %3170 =  [] -> 1.824us
     %4173 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3171 =  [] -> 1.344us
     %4174 = :aten::index [[8], [8]] -> 42.048us
       %4175 = :aten::nonzero [[8]] -> 42.048us
         %4176 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %3172 =  [] -> 1.408us
         %4177 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3173 =  [] -> 1.312us
                 -->kernel: 0:7 %3174 =  [] -> 1.824us
     %4178 = :aten::gt [[8], []] -> 1.312us
                 -->kernel: 0:7 %3175 =  [] -> 1.312us
     %4179 = :aten::index [[8], [8]] -> 43.200us
       %4180 = :aten::nonzero [[8]] -> 43.200us
         %4181 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3176 =  [] -> 1.440us
         %4182 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %3177 =  [] -> 1.248us
                 -->kernel: 0:7 %3178 =  [] -> 1.792us
     %4183 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3179 =  [] -> 1.344us
     %4184 = :aten::index [[8], [8]] -> 43.424us
       %4185 = :aten::nonzero [[8]] -> 43.424us
         %4186 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %3180 =  [] -> 1.408us
         %4187 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %3181 =  [] -> 1.280us
                 -->kernel: 0:7 %3182 =  [] -> 1.792us
     %4188 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3183 =  [] -> 1.344us
     %4189 = :aten::index [[8], [8]] -> 48.704us
       %4190 = :aten::nonzero [[8]] -> 48.704us
         %4191 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3184 =  [] -> 1.440us
         %4192 = CCCL:cub::DeviceSelect::Flagged [] -> 12.192us
                 -->kernel: 0:7 %3185 =  [] -> 1.280us
                 -->kernel: 0:7 %3186 =  [] -> 1.824us
     %4193 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3187 =  [] -> 1.344us
     %4194 = :aten::index [[8], [8]] -> 44.704us
       %4195 = :aten::nonzero [[8]] -> 44.704us
         %4196 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3188 =  [] -> 1.440us
         %4197 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %3189 =  [] -> 1.280us
                 -->kernel: 0:7 %3190 =  [] -> 1.792us
     %4198 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3191 =  [] -> 1.344us
     %4199 = :aten::index [[8], [8]] -> 42.720us
       %4200 = :aten::nonzero [[8]] -> 42.720us
         %4201 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3192 =  [] -> 1.440us
         %4202 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %3193 =  [] -> 1.248us
                 -->kernel: 0:7 %3194 =  [] -> 1.824us
     %4203 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3195 =  [] -> 1.344us
     %4204 = :aten::index [[8], [8]] -> 42.496us
       %4205 = :aten::nonzero [[8]] -> 42.496us
         %4206 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3196 =  [] -> 1.440us
         %4207 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %3197 =  [] -> 1.280us
                 -->kernel: 0:7 %3198 =  [] -> 1.792us
     %4208 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3199 =  [] -> 1.344us
     %4209 = :aten::index [[8], [8]] -> 42.624us
       %4210 = :aten::nonzero [[8]] -> 42.624us
         %4211 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3200 =  [] -> 1.440us
         %4212 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %3201 =  [] -> 1.248us
                 -->kernel: 0:7 %3202 =  [] -> 1.792us
     %4213 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3203 =  [] -> 1.344us
     %4214 = :aten::index [[8], [8]] -> 42.784us
       %4215 = :aten::nonzero [[8]] -> 42.784us
         %4216 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %3204 =  [] -> 1.408us
         %4217 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3205 =  [] -> 1.312us
                 -->kernel: 0:7 %3206 =  [] -> 1.824us
     %4218 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3207 =  [] -> 1.344us
     %4219 = :aten::index [[8], [8]] -> 42.817us
       %4220 = :aten::nonzero [[8]] -> 42.817us
         %4221 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3208 =  [] -> 1.440us
         %4222 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %3209 =  [] -> 1.248us
                 -->kernel: 0:7 %3210 =  [] -> 1.792us
     %4223 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3211 =  [] -> 1.344us
     %4224 = :aten::index [[8], [8]] -> 42.816us
       %4225 = :aten::nonzero [[8]] -> 42.816us
         %4226 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3212 =  [] -> 1.440us
         %4227 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %3213 =  [] -> 1.312us
                 -->kernel: 0:7 %3214 =  [] -> 1.792us
     %4228 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3215 =  [] -> 1.344us
     %4229 = :aten::index [[8], [8]] -> 45.760us
       %4230 = :aten::nonzero [[8]] -> 45.760us
         %4231 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3216 =  [] -> 1.440us
         %4232 = CCCL:cub::DeviceSelect::Flagged [] -> 12.288us
                 -->kernel: 0:7 %3217 =  [] -> 1.280us
                 -->kernel: 0:7 %3218 =  [] -> 1.824us
     %4233 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3219 =  [] -> 1.344us
     %4234 = :aten::index [[8], [8]] -> 43.201us
       %4235 = :aten::nonzero [[8]] -> 43.201us
         %4236 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %3220 =  [] -> 1.408us
         %4237 = CCCL:cub::DeviceSelect::Flagged [] -> 12.001us
                 -->kernel: 0:7 %3221 =  [] -> 1.312us
                 -->kernel: 0:7 %3222 =  [] -> 1.824us
     %4238 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %3223 =  [] -> 1.344us
     %4239 = :aten::index [[8], [8]] -> 42.272us
       %4240 = :aten::nonzero [[8]] -> 42.272us
         %4241 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3224 =  [] -> 1.440us
         %4242 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %3225 =  [] -> 1.248us
                 -->kernel: 0:7 %3226 =  [] -> 1.792us
     %4243 = :aten::zeros [[], [], [], [], []] -> 960.000ns
       %4244 = :aten::zero_ [[8, 24]] -> 960.000ns
         %4245 = :aten::fill_ [[8, 24], []] -> 960.000ns
                 -->kernel: 0:7 %3227 =  [] -> 960.000ns
     %4246 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.712us
       %4247 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.712us
         %4248 = :nccl:_all_gather_base [[24]] -> 7.712us
           %4249 = NCCL:ncclAllGather [] -> 7.712us
                 -->kernel: 0:7 %3228 =  [] -> 7.712us
     %4250 = :aten::gt [[8], []] -> 1.920us
                 -->kernel: 0:7 %3229 =  [] -> 1.920us
     %4251 = :aten::index [[8], [8]] -> 47.232us
       %4252 = :aten::nonzero [[8]] -> 47.232us
         %4253 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3230 =  [] -> 1.248us
         %4254 = CCCL:cub::DeviceSelect::Flagged [] -> 12.320us
                 -->kernel: 0:7 %3231 =  [] -> 960.000ns
                 -->kernel: 0:7 %3232 =  [] -> 2.144us
     %4255 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %3233 =  [] -> 1.696us
     %4256 = :aten::index [[8], [8]] -> 44.224us
       %4257 = :aten::nonzero [[8]] -> 44.224us
         %4258 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %3234 =  [] -> 1.216us
         %4259 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3235 =  [] -> 992.000ns
                 -->kernel: 0:7 %3236 =  [] -> 2.112us
     %4260 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3237 =  [] -> 1.728us
     %4261 = :aten::index [[8], [8]] -> 42.720us
       %4262 = :aten::nonzero [[8]] -> 42.720us
         %4263 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3238 =  [] -> 1.248us
         %4264 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %3239 =  [] -> 960.000ns
                 -->kernel: 0:7 %3240 =  [] -> 2.112us
     %4265 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %3241 =  [] -> 1.696us
     %4266 = :aten::index [[8], [8]] -> 42.688us
       %4267 = :aten::nonzero [[8]] -> 42.688us
         %4268 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3242 =  [] -> 1.248us
         %4269 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3243 =  [] -> 992.000ns
                 -->kernel: 0:7 %3244 =  [] -> 2.080us
     %4270 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %3245 =  [] -> 1.760us
     %4271 = :aten::index [[8], [8]] -> 41.984us
       %4272 = :aten::nonzero [[8]] -> 41.984us
         %4273 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3246 =  [] -> 1.248us
         %4274 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %3247 =  [] -> 960.000ns
                 -->kernel: 0:7 %3248 =  [] -> 2.144us
     %4275 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %3249 =  [] -> 1.696us
     %4276 = :aten::index [[8], [8]] -> 42.720us
       %4277 = :aten::nonzero [[8]] -> 42.720us
         %4278 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %3250 =  [] -> 1.216us
         %4279 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %3251 =  [] -> 992.000ns
                 -->kernel: 0:7 %3252 =  [] -> 2.080us
     %4280 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %3253 =  [] -> 1.760us
     %4281 = :aten::index [[8], [8]] -> 42.017us
       %4282 = :aten::nonzero [[8]] -> 42.017us
         %4283 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3254 =  [] -> 1.248us
         %4284 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %3255 =  [] -> 960.000ns
                 -->kernel: 0:7 %3256 =  [] -> 2.080us
     %4285 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %3257 =  [] -> 1.696us
     %4286 = :aten::index [[8], [8]] -> 42.272us
       %4287 = :aten::nonzero [[8]] -> 42.272us
         %4288 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3258 =  [] -> 1.248us
         %4289 = CCCL:cub::DeviceSelect::Flagged [] -> 12.192us
                 -->kernel: 0:7 %3259 =  [] -> 992.000ns
                 -->kernel: 0:7 %3260 =  [] -> 2.048us
     %4290 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3261 =  [] -> 1.728us
     %4291 = :aten::index [[8], [8]] -> 41.856us
       %4292 = :aten::nonzero [[8]] -> 41.856us
         %4293 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %3262 =  [] -> 1.216us
         %4294 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %3263 =  [] -> 960.000ns
                 -->kernel: 0:7 %3264 =  [] -> 2.112us
     %4295 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3265 =  [] -> 1.728us
     %4296 = :aten::index [[8], [8]] -> 42.048us
       %4297 = :aten::nonzero [[8]] -> 42.048us
         %4298 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3266 =  [] -> 1.248us
         %4299 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %3267 =  [] -> 992.000ns
                 -->kernel: 0:7 %3268 =  [] -> 2.080us
     %4300 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %3269 =  [] -> 1.760us
     %4301 = :aten::index [[8], [8]] -> 42.176us
       %4302 = :aten::nonzero [[8]] -> 42.176us
         %4303 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3270 =  [] -> 1.248us
         %4304 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %3271 =  [] -> 960.000ns
                 -->kernel: 0:7 %3272 =  [] -> 2.112us
     %4305 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3273 =  [] -> 1.728us
     %4306 = :aten::index [[8], [8]] -> 43.776us
       %4307 = :aten::nonzero [[8]] -> 43.776us
         %4308 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3274 =  [] -> 1.248us
         %4309 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %3275 =  [] -> 992.000ns
                 -->kernel: 0:7 %3276 =  [] -> 2.080us
     %4310 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3277 =  [] -> 1.728us
     %4311 = :aten::index [[8], [8]] -> 41.728us
       %4312 = :aten::nonzero [[8]] -> 41.728us
         %4313 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3278 =  [] -> 1.248us
         %4314 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %3279 =  [] -> 960.000ns
                 -->kernel: 0:7 %3280 =  [] -> 2.144us
     %4315 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3281 =  [] -> 1.728us
     %4316 = :aten::index [[8], [8]] -> 42.016us
       %4317 = :aten::nonzero [[8]] -> 42.016us
         %4318 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %3282 =  [] -> 1.216us
         %4319 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3283 =  [] -> 992.000ns
                 -->kernel: 0:7 %3284 =  [] -> 2.080us
     %4320 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3285 =  [] -> 1.728us
     %4321 = :aten::index [[8], [8]] -> 41.856us
       %4322 = :aten::nonzero [[8]] -> 41.856us
         %4323 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3286 =  [] -> 1.248us
         %4324 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3287 =  [] -> 960.000ns
                 -->kernel: 0:7 %3288 =  [] -> 2.080us
     %4325 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %3289 =  [] -> 1.696us
     %4326 = :aten::index [[8], [8]] -> 41.856us
       %4327 = :aten::nonzero [[8]] -> 41.856us
         %4328 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3290 =  [] -> 1.248us
         %4329 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3291 =  [] -> 960.000ns
                 -->kernel: 0:7 %3292 =  [] -> 2.048us
     %4330 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3293 =  [] -> 1.728us
     %4331 = :aten::index [[8], [8]] -> 41.696us
       %4332 = :aten::nonzero [[8]] -> 41.696us
         %4333 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %3294 =  [] -> 1.216us
         %4334 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %3295 =  [] -> 960.000ns
                 -->kernel: 0:7 %3296 =  [] -> 2.112us
     %4335 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3297 =  [] -> 1.728us
     %4336 = :aten::index [[8], [8]] -> 42.400us
       %4337 = :aten::nonzero [[8]] -> 42.400us
         %4338 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3298 =  [] -> 1.248us
         %4339 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3299 =  [] -> 992.000ns
                 -->kernel: 0:7 %3300 =  [] -> 2.080us
     %4340 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3301 =  [] -> 1.728us
     %4341 = :aten::index [[8], [8]] -> 42.400us
       %4342 = :aten::nonzero [[8]] -> 42.400us
         %4343 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3302 =  [] -> 1.248us
         %4344 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %3303 =  [] -> 960.000ns
                 -->kernel: 0:7 %3304 =  [] -> 2.080us
     %4345 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3305 =  [] -> 1.728us
     %4346 = :aten::index [[8], [8]] -> 42.529us
       %4347 = :aten::nonzero [[8]] -> 42.529us
         %4348 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3306 =  [] -> 1.248us
         %4349 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3307 =  [] -> 992.000ns
                 -->kernel: 0:7 %3308 =  [] -> 2.048us
     %4350 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3309 =  [] -> 1.728us
     %4351 = :aten::index [[8], [8]] -> 42.240us
       %4352 = :aten::nonzero [[8]] -> 42.240us
         %4353 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3310 =  [] -> 1.248us
         %4354 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %3311 =  [] -> 960.000ns
                 -->kernel: 0:7 %3312 =  [] -> 2.112us
     %4355 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %3313 =  [] -> 1.728us
     %4356 = :aten::index [[8], [8]] -> 42.848us
       %4357 = :aten::nonzero [[8]] -> 42.848us
         %4358 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3314 =  [] -> 1.248us
         %4359 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3315 =  [] -> 992.000ns
                 -->kernel: 0:7 %3316 =  [] -> 2.080us
     %4360 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %3317 =  [] -> 1.760us
     %4361 = :aten::index [[8], [8]] -> 42.560us
       %4362 = :aten::nonzero [[8]] -> 42.560us
         %4363 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3318 =  [] -> 1.248us
         %4364 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %3319 =  [] -> 960.000ns
                 -->kernel: 0:7 %3320 =  [] -> 2.112us
     %4365 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %3321 =  [] -> 1.696us
     %4366 = :aten::index [[8], [8]] -> 42.752us
       %4367 = :aten::nonzero [[8]] -> 42.752us
         %4368 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %3322 =  [] -> 1.248us
         %4369 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %3323 =  [] -> 992.000ns
                 -->kernel: 0:7 %3324 =  [] -> 2.048us
     %4370 = :aten::zeros [[], [], [], [], []] -> 1.152us
       %4371 = :aten::zero_ [[8, 24]] -> 1.152us
         %4372 = :aten::fill_ [[8, 24], []] -> 1.152us
                 -->kernel: 0:7 %3325 =  [] -> 1.152us
     %4373 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.552us
       %4374 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.552us
         %4375 = :nccl:_all_gather_base [[24]] -> 7.552us
           %4376 = NCCL:ncclAllGather [] -> 7.552us
                 -->kernel: 0:7 %3326 =  [] -> 7.552us
     %4377 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %3327 =  [] -> 1.376us
     %4378 = :aten::index [[8], [8]] -> 47.393us
       %4379 = :aten::nonzero [[8]] -> 47.393us
         %4380 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %3328 =  [] -> 1.440us
         %4381 = CCCL:cub::DeviceSelect::Flagged [] -> 12.512us
                 -->kernel: 0:7 %3329 =  [] -> 1.312us
                 -->kernel: 0:7 %3330 =  [] -> 1.920us
     %4382 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %3331 =  [] -> 1.440us
     %4383 = :aten::index [[8], [8]] -> 43.840us
       %4384 = :aten::nonzero [[8]] -> 43.840us
         %4385 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3332 =  [] -> 1.504us
         %4386 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %3333 =  [] -> 1.344us
                 -->kernel: 0:7 %3334 =  [] -> 1.888us
     %4387 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3335 =  [] -> 1.408us
     %4388 = :aten::index [[8], [8]] -> 42.400us
       %4389 = :aten::nonzero [[8]] -> 42.400us
         %4390 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %3336 =  [] -> 1.536us
         %4391 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %3337 =  [] -> 1.344us
                 -->kernel: 0:7 %3338 =  [] -> 1.888us
     %4392 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %3339 =  [] -> 1.440us
     %4393 = :aten::index [[8], [8]] -> 43.297us
       %4394 = :aten::nonzero [[8]] -> 43.297us
         %4395 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3340 =  [] -> 1.504us
         %4396 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %3341 =  [] -> 1.344us
                 -->kernel: 0:7 %3342 =  [] -> 1.888us
     %4397 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3343 =  [] -> 1.408us
     %4398 = :aten::index [[8], [8]] -> 42.304us
       %4399 = :aten::nonzero [[8]] -> 42.304us
         %4400 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3344 =  [] -> 1.504us
         %4401 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3345 =  [] -> 1.344us
                 -->kernel: 0:7 %3346 =  [] -> 1.888us
     %4402 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %3347 =  [] -> 1.440us
     %4403 = :aten::index [[8], [8]] -> 43.168us
       %4404 = :aten::nonzero [[8]] -> 43.168us
         %4405 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %3348 =  [] -> 1.472us
         %4406 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %3349 =  [] -> 1.376us
                 -->kernel: 0:7 %3350 =  [] -> 1.888us
     %4407 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3351 =  [] -> 1.408us
     %4408 = :aten::index [[8], [8]] -> 43.264us
       %4409 = :aten::nonzero [[8]] -> 43.264us
         %4410 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %3352 =  [] -> 1.536us
         %4411 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %3353 =  [] -> 1.312us
                 -->kernel: 0:7 %3354 =  [] -> 1.920us
     %4412 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %3355 =  [] -> 1.440us
     %4413 = :aten::index [[8], [8]] -> 48.512us
       %4414 = :aten::nonzero [[8]] -> 48.512us
         %4415 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3356 =  [] -> 1.504us
         %4416 = CCCL:cub::DeviceSelect::Flagged [] -> 17.952us
                 -->kernel: 0:7 %3357 =  [] -> 1.376us
                 -->kernel: 0:7 %3358 =  [] -> 1.856us
     %4417 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %3359 =  [] -> 1.376us
     %4418 = :aten::index [[8], [8]] -> 44.448us
       %4419 = :aten::nonzero [[8]] -> 44.448us
         %4420 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %3360 =  [] -> 1.536us
         %4421 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %3361 =  [] -> 1.312us
                 -->kernel: 0:7 %3362 =  [] -> 1.888us
     %4422 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3363 =  [] -> 1.408us
     %4423 = :aten::index [[8], [8]] -> 42.624us
       %4424 = :aten::nonzero [[8]] -> 42.624us
         %4425 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3364 =  [] -> 1.504us
         %4426 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %3365 =  [] -> 1.376us
                 -->kernel: 0:7 %3366 =  [] -> 1.888us
     %4427 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3367 =  [] -> 1.408us
     %4428 = :aten::index [[8], [8]] -> 43.232us
       %4429 = :aten::nonzero [[8]] -> 43.232us
         %4430 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3368 =  [] -> 1.504us
         %4431 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %3369 =  [] -> 1.344us
                 -->kernel: 0:7 %3370 =  [] -> 1.888us
     %4432 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3371 =  [] -> 1.408us
     %4433 = :aten::index [[8], [8]] -> 43.232us
       %4434 = :aten::nonzero [[8]] -> 43.232us
         %4435 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3372 =  [] -> 1.504us
         %4436 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %3373 =  [] -> 1.344us
                 -->kernel: 0:7 %3374 =  [] -> 1.856us
     %4437 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3375 =  [] -> 1.408us
     %4438 = :aten::index [[8], [8]] -> 43.648us
       %4439 = :aten::nonzero [[8]] -> 43.648us
         %4440 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3376 =  [] -> 1.504us
         %4441 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %3377 =  [] -> 1.312us
                 -->kernel: 0:7 %3378 =  [] -> 1.888us
     %4442 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %3379 =  [] -> 1.440us
     %4443 = :aten::index [[8], [8]] -> 43.552us
       %4444 = :aten::nonzero [[8]] -> 43.552us
         %4445 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3380 =  [] -> 1.504us
         %4446 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %3381 =  [] -> 1.344us
                 -->kernel: 0:7 %3382 =  [] -> 1.856us
     %4447 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3383 =  [] -> 1.408us
     %4448 = :aten::index [[8], [8]] -> 42.944us
       %4449 = :aten::nonzero [[8]] -> 42.944us
         %4450 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3384 =  [] -> 1.504us
         %4451 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %3385 =  [] -> 1.312us
                 -->kernel: 0:7 %3386 =  [] -> 1.888us
     %4452 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %3387 =  [] -> 1.440us
     %4453 = :aten::index [[8], [8]] -> 43.776us
       %4454 = :aten::nonzero [[8]] -> 43.776us
         %4455 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %3388 =  [] -> 1.472us
         %4456 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %3389 =  [] -> 1.344us
                 -->kernel: 0:7 %3390 =  [] -> 1.856us
     %4457 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3391 =  [] -> 1.408us
     %4458 = :aten::index [[8], [8]] -> 43.424us
       %4459 = :aten::nonzero [[8]] -> 43.424us
         %4460 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %3392 =  [] -> 1.536us
         %4461 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %3393 =  [] -> 1.312us
                 -->kernel: 0:7 %3394 =  [] -> 1.888us
     %4462 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3395 =  [] -> 1.408us
     %4463 = :aten::index [[8], [8]] -> 42.688us
       %4464 = :aten::nonzero [[8]] -> 42.688us
         %4465 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %3396 =  [] -> 1.472us
         %4466 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %3397 =  [] -> 1.344us
                 -->kernel: 0:7 %3398 =  [] -> 1.856us
     %4467 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3399 =  [] -> 1.408us
     %4468 = :aten::index [[8], [8]] -> 44.448us
       %4469 = :aten::nonzero [[8]] -> 44.448us
         %4470 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3400 =  [] -> 1.504us
         %4471 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %3401 =  [] -> 1.312us
                 -->kernel: 0:7 %3402 =  [] -> 1.888us
     %4472 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %3403 =  [] -> 1.440us
     %4473 = :aten::index [[8], [8]] -> 42.944us
       %4474 = :aten::nonzero [[8]] -> 42.944us
         %4475 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %3404 =  [] -> 1.472us
         %4476 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %3405 =  [] -> 1.344us
                 -->kernel: 0:7 %3406 =  [] -> 1.888us
     %4477 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3407 =  [] -> 1.408us
     %4478 = :aten::index [[8], [8]] -> 43.392us
       %4479 = :aten::nonzero [[8]] -> 43.392us
         %4480 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %3408 =  [] -> 1.536us
         %4481 = CCCL:cub::DeviceSelect::Flagged [] -> 12.384us
                 -->kernel: 0:7 %3409 =  [] -> 1.344us
                 -->kernel: 0:7 %3410 =  [] -> 1.888us
     %4482 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3411 =  [] -> 1.408us
     %4483 = :aten::index [[8], [8]] -> 43.744us
       %4484 = :aten::nonzero [[8]] -> 43.744us
         %4485 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3412 =  [] -> 1.504us
         %4486 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %3413 =  [] -> 1.344us
                 -->kernel: 0:7 %3414 =  [] -> 1.856us
     %4487 = :aten::gt [[8], []] -> 1.409us
                 -->kernel: 0:7 %3415 =  [] -> 1.409us
     %4488 = :aten::index [[8], [8]] -> 43.456us
       %4489 = :aten::nonzero [[8]] -> 43.456us
         %4490 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3416 =  [] -> 1.504us
         %4491 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %3417 =  [] -> 1.312us
                 -->kernel: 0:7 %3418 =  [] -> 1.856us
     %4492 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %3419 =  [] -> 1.408us
     %4493 = :aten::index [[8], [8]] -> 43.392us
       %4494 = :aten::nonzero [[8]] -> 43.392us
         %4495 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %3420 =  [] -> 1.504us
         %4496 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %3421 =  [] -> 1.376us
                 -->kernel: 0:7 %3422 =  [] -> 1.888us
     %4497 = :aten::zero_ [[3002413056]] -> 1.801ms
       %4498 = :aten::fill_ [[3002413056], []] -> 1.801ms
                 -->kernel: 0:7 %3423 =  [] -> 441.473us
                 -->kernel: 0:7 %3424 =  [] -> 441.473us
                 -->kernel: 0:7 %3425 =  [] -> 441.633us
                 -->kernel: 0:7 %3426 =  [] -> 441.697us
     %4499 = :aten::zero_ [[352321536]] -> 207.905us
       %4500 = :aten::fill_ [[352321536], []] -> 207.905us
                 -->kernel: 0:7 %3427 =  [] -> 207.905us
     %4501 = :aten::zeros [[], [], [], [], []] -> 1.312us
       %4502 = :aten::zero_ [[]] -> 1.312us
         %4503 = :aten::fill_ [[], []] -> 1.312us
                 -->kernel: 0:7 %3428 =  [] -> 1.312us
     %4504 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.552us
       %4505 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.552us
         %4506 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.552us
     %4507 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.296us
       %4508 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.296us
         %4509 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.296us
     %4510 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 1.504us
       %4511 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 1.504us
         %4512 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.504us
     %4513 = :aten::to [[1, 1, 4096, 4096], [], [], [], [], [], [], []] -> 293.825us
       %4514 = :aten::_to_copy [[1, 1, 4096, 4096], [], [], [], [], [], []] -> 293.825us
         %4515 = :aten::copy_ [[1, 1, 4096, 4096], [1, 1, 4096, 4096], []] -> 293.825us
     %4516 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.264us
       %4517 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.264us
         %4518 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.264us
     %4519 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 269.761us
       %4520 = :aten::index_select [[129280, 7168], [], [4096]] -> 269.761us
                 -->kernel: 0:7 %3429 =  [] -> 269.761us
     %4521 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 127.745us
       %4522 = :nvte_rmsnorm_fwd [] -> 127.745us
                 -->kernel: 0:7 %3430 =  [] -> 127.745us
     %4523 = :TELinear forward [] -> 668.962us
       %4524 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 668.962us
         %4525 = :nvte_quantize_v2 [] -> 73.537us
           %4526 = :quantize_transpose_vector_blockwise [] -> 73.537us
                 -->kernel: 0:7 %3431 =  [] -> 73.537us
         %4527 = :nvte_quantize_v2 [] -> 20.800us
           %4528 = :quantize_transpose_square_blockwise [] -> 20.800us
                 -->kernel: 0:7 %3432 =  [] -> 20.800us
         %4529 = :nvte_cublas_gemm_scaled [] -> 339.681us
                 -->kernel: 0:7 %3433 =  [] -> 329.697us
     %4530 = :TELinear forward [] -> 424.577us
       %4531 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 424.577us
         %4532 = :nvte_quantize_v2 [] -> 73.792us
           %4533 = :quantize_transpose_vector_blockwise [] -> 73.792us
                 -->kernel: 0:7 %3434 =  [] -> 73.792us
         %4534 = :nvte_quantize_v2 [] -> 11.648us
           %4535 = :quantize_transpose_square_blockwise [] -> 11.648us
                 -->kernel: 0:7 %3435 =  [] -> 11.648us
         %4536 = :nvte_cublas_gemm_scaled [] -> 204.833us
                 -->kernel: 0:7 %3436 =  [] -> 197.441us
     %4537 = :TELayerNormColumnParallelLinear forward [] -> 1.388ms
       %4538 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.388ms
         %4539 = :nvte_rmsnorm_fwd [] -> 29.568us
                 -->kernel: 0:7 %3437 =  [] -> 29.568us
         %4540 = :nvte_quantize_v2 [] -> 17.120us
           %4541 = :quantize_transpose_vector_blockwise [] -> 17.120us
                 -->kernel: 0:7 %3438 =  [] -> 17.120us
         %4542 = :nvte_quantize_v2 [] -> 58.624us
           %4543 = :quantize_transpose_square_blockwise [] -> 58.624us
                 -->kernel: 0:7 %3439 =  [] -> 58.624us
         %4544 = :nvte_cublas_gemm_scaled [] -> 1.135ms
                 -->kernel: 0:7 %3440 =  [] -> 1.128ms
     %4545 = :TELayerNormColumnParallelLinear forward [] -> 941.603us
       %4546 = :aten::contiguous [[4096, 1, 512], []] -> 11.616us
         %4547 = :aten::clone [[4096, 1, 512], []] -> 11.616us
           %4548 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.616us
                 -->kernel: 0:7 %3441 =  [] -> 11.616us
       %4549 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 711.042us
         %4550 = :nvte_rmsnorm_fwd [] -> 4.256us
                 -->kernel: 0:7 %3442 =  [] -> 4.256us
         %4551 = :nvte_quantize_v2 [] -> 7.744us
           %4552 = :quantize_transpose_vector_blockwise [] -> 7.744us
                 -->kernel: 0:7 %3443 =  [] -> 7.744us
         %4553 = :nvte_quantize_v2 [] -> 28.352us
           %4554 = :quantize_transpose_square_blockwise [] -> 28.352us
                 -->kernel: 0:7 %3444 =  [] -> 28.352us
         %4555 = :nvte_cublas_gemm_scaled [] -> 524.002us
                 -->kernel: 0:7 %3445 =  [] -> 517.506us
     %4556 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.432us
                 -->kernel: 0:7 %3446 =  [] -> 114.432us
     %4557 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 173.537us
                 -->kernel: 0:7 %3447 =  [] -> 173.537us
     %4558 = :TEDotProductAttention forward [] -> 22.526ms
       %4559 = :aten::arange [[], [], [], [], []] -> 1.152us
         %4560 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %3448 =  [] -> 1.152us
       %4561 = :aten::arange [[], [], [], [], []] -> 1.152us
         %4562 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %3449 =  [] -> 1.152us
       %4563 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 61.184us
                 -->kernel: 0:7 %3450 =  [] -> 61.184us
       %4564 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 39.520us
                 -->kernel: 0:7 %3451 =  [] -> 39.520us
       %4565 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.336us
                 -->kernel: 0:7 %3452 =  [] -> 38.336us
       %4566 = :aten::le [[1, 1, 4096, 4096], []] -> 28.352us
                 -->kernel: 0:7 %3453 =  [] -> 28.352us
       %4567 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.576us
                 -->kernel: 0:7 %3454 =  [] -> 24.576us
       %4568 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.304us
                 -->kernel: 0:7 %3455 =  [] -> 14.304us
       %4569 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.848us
         %4570 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.848us
                 -->kernel: 0:7 %3456 =  [] -> 18.848us
       %4571 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.960us
         %4572 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.960us
                 -->kernel: 0:7 %3457 =  [] -> 12.960us
       %4573 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.464us
         %4574 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.464us
                 -->kernel: 0:7 %3458 =  [] -> 18.464us
       %4575 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.835ms
                 -->kernel: 0:7 %3459 =  [] -> 5.825ms
       %4576 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.005ms
         %4577 = :nvte_scaled_masked_softmax_forward [] -> 11.005ms
                 -->kernel: 0:7 %3460 =  [] -> 11.005ms
       %4578 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.988ms
                 -->kernel: 0:7 %3461 =  [] -> 3.976ms
       %4579 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.817us
         %4580 = :aten::clone [[4096, 1, 128, 128], []] -> 278.817us
           %4581 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.817us
                 -->kernel: 0:7 %3462 =  [] -> 278.817us
     %4582 = :TERowParallelLinear forward [] -> 3.867ms
       %4583 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.867ms
         %4584 = :nvte_quantize_v2 [] -> 98.048us
           %4585 = :quantize_transpose_vector_blockwise [] -> 98.048us
                 -->kernel: 0:7 %3463 =  [] -> 98.048us
         %4586 = :nvte_quantize_v2 [] -> 170.784us
           %4587 = :quantize_transpose_square_blockwise [] -> 170.784us
                 -->kernel: 0:7 %3464 =  [] -> 170.784us
         %4588 = :nvte_cublas_gemm_scaled [] -> 3.429ms
                 -->kernel: 0:7 %3465 =  [] -> 3.422ms
     %4589 = :Torch-Compiled Region: 1/2 None -> 43.840us
       %4590 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 43.840us
         %4591 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 43.840us
                 -->kernel: 0:7 %3466 =  [] -> 43.840us
     %4592 = :TELayerNormColumnParallelLinear forward [] -> 8.468ms
       %4593 = :_LayerNormLinear [[4096, 1, 7168], [7168], [], [36864, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 8.468ms
         %4594 = :nvte_rmsnorm_fwd [] -> 126.848us
                 -->kernel: 0:7 %3467 =  [] -> 126.848us
         %4595 = :nvte_quantize_v2 [] -> 73.792us
           %4596 = :quantize_transpose_vector_blockwise [] -> 73.792us
                 -->kernel: 0:7 %3468 =  [] -> 73.792us
         %4597 = :nvte_quantize_v2 [] -> 389.057us
           %4598 = :quantize_transpose_square_blockwise [] -> 389.057us
                 -->kernel: 0:7 %3469 =  [] -> 389.057us
         %4599 = :nvte_cublas_gemm_scaled [] -> 7.726ms
                 -->kernel: 0:7 %3470 =  [] -> 7.720ms
     %4600 = :SwiGLUFunction [[4096, 36864], [], []] -> 129.985us
       %4601 = :Torch-Compiled Region: 2/0 None -> 129.985us
         %4602 = :triton_poi_fused_mul_silu_0 [[4096, 36864], [4096, 18432], [], []] -> 129.985us
                 -->kernel: 0:7 %3471 =  [] -> 129.985us
     %4603 = :TERowParallelLinear forward [] -> 4.373ms
       %4604 = :_Linear [[7168, 18432], [4096, 1, 18432], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 4.373ms
         %4605 = :nvte_quantize_v2 [] -> 183.265us
           %4606 = :quantize_transpose_vector_blockwise [] -> 183.265us
                 -->kernel: 0:7 %3472 =  [] -> 183.265us
         %4607 = :nvte_quantize_v2 [] -> 194.496us
           %4608 = :quantize_transpose_square_blockwise [] -> 194.496us
                 -->kernel: 0:7 %3473 =  [] -> 194.496us
         %4609 = :nvte_cublas_gemm_scaled [] -> 3.856ms
                 -->kernel: 0:7 %3474 =  [] -> 3.849ms
     %4610 = :Torch-Compiled Region: 1/2 None -> 44.864us
       %4611 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.864us
         %4612 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.864us
                 -->kernel: 0:7 %3475 =  [] -> 44.864us
     %4613 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 127.104us
       %4614 = :nvte_rmsnorm_fwd [] -> 127.104us
                 -->kernel: 0:7 %3476 =  [] -> 127.104us
     %4615 = :TELinear forward [] -> 561.569us
       %4616 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 561.569us
         %4617 = :nvte_quantize_v2 [] -> 73.760us
           %4618 = :quantize_transpose_vector_blockwise [] -> 73.760us
                 -->kernel: 0:7 %3477 =  [] -> 73.760us
         %4619 = :nvte_quantize_v2 [] -> 20.577us
           %4620 = :quantize_transpose_square_blockwise [] -> 20.577us
                 -->kernel: 0:7 %3478 =  [] -> 20.577us
         %4621 = :nvte_cublas_gemm_scaled [] -> 337.216us
                 -->kernel: 0:7 %3479 =  [] -> 330.912us
     %4622 = :TELinear forward [] -> 414.593us
       %4623 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 414.593us
         %4624 = :nvte_quantize_v2 [] -> 72.960us
           %4625 = :quantize_transpose_vector_blockwise [] -> 72.960us
                 -->kernel: 0:7 %3480 =  [] -> 72.960us
         %4626 = :nvte_quantize_v2 [] -> 11.584us
           %4627 = :quantize_transpose_square_blockwise [] -> 11.584us
                 -->kernel: 0:7 %3481 =  [] -> 11.584us
         %4628 = :nvte_cublas_gemm_scaled [] -> 204.224us
                 -->kernel: 0:7 %3482 =  [] -> 197.856us
     %4629 = :TELayerNormColumnParallelLinear forward [] -> 1.375ms
       %4630 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.375ms
         %4631 = :nvte_rmsnorm_fwd [] -> 30.368us
                 -->kernel: 0:7 %3483 =  [] -> 30.368us
         %4632 = :nvte_quantize_v2 [] -> 17.184us
           %4633 = :quantize_transpose_vector_blockwise [] -> 17.184us
                 -->kernel: 0:7 %3484 =  [] -> 17.184us
         %4634 = :nvte_quantize_v2 [] -> 58.336us
           %4635 = :quantize_transpose_square_blockwise [] -> 58.336us
                 -->kernel: 0:7 %3485 =  [] -> 58.336us
         %4636 = :nvte_cublas_gemm_scaled [] -> 1.136ms
                 -->kernel: 0:7 %3486 =  [] -> 1.130ms
     %4637 = :TELayerNormColumnParallelLinear forward [] -> 900.162us
       %4638 = :aten::contiguous [[4096, 1, 512], []] -> 11.680us
         %4639 = :aten::clone [[4096, 1, 512], []] -> 11.680us
           %4640 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.680us
                 -->kernel: 0:7 %3487 =  [] -> 11.680us
       %4641 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 696.674us
         %4642 = :nvte_rmsnorm_fwd [] -> 4.224us
                 -->kernel: 0:7 %3488 =  [] -> 4.224us
         %4643 = :nvte_quantize_v2 [] -> 7.712us
           %4644 = :quantize_transpose_vector_blockwise [] -> 7.712us
                 -->kernel: 0:7 %3489 =  [] -> 7.712us
         %4645 = :nvte_quantize_v2 [] -> 28.512us
           %4646 = :quantize_transpose_square_blockwise [] -> 28.512us
                 -->kernel: 0:7 %3490 =  [] -> 28.512us
         %4647 = :nvte_cublas_gemm_scaled [] -> 526.178us
                 -->kernel: 0:7 %3491 =  [] -> 519.618us
     %4648 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.657us
                 -->kernel: 0:7 %3492 =  [] -> 114.657us
     %4649 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 172.833us
                 -->kernel: 0:7 %3493 =  [] -> 172.833us
     %4650 = :TEDotProductAttention forward [] -> 22.459ms
       %4651 = :aten::arange [[], [], [], [], []] -> 1.184us
         %4652 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %3494 =  [] -> 1.184us
       %4653 = :aten::arange [[], [], [], [], []] -> 1.184us
         %4654 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %3495 =  [] -> 1.184us
       %4655 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 61.824us
                 -->kernel: 0:7 %3496 =  [] -> 61.824us
       %4656 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 38.912us
                 -->kernel: 0:7 %3497 =  [] -> 38.912us
       %4657 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.816us
                 -->kernel: 0:7 %3498 =  [] -> 38.816us
       %4658 = :aten::le [[1, 1, 4096, 4096], []] -> 28.256us
                 -->kernel: 0:7 %3499 =  [] -> 28.256us
       %4659 = :aten::lt [[1, 1, 4096, 4096], []] -> 25.760us
                 -->kernel: 0:7 %3500 =  [] -> 25.760us
       %4660 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.496us
                 -->kernel: 0:7 %3501 =  [] -> 14.496us
       %4661 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.008us
         %4662 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 19.008us
                 -->kernel: 0:7 %3502 =  [] -> 19.008us
       %4663 = :aten::logical_not [[1, 1, 4096, 4096]] -> 13.024us
         %4664 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 13.024us
                 -->kernel: 0:7 %3503 =  [] -> 13.024us
       %4665 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.400us
         %4666 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.400us
                 -->kernel: 0:7 %3504 =  [] -> 18.400us
       %4667 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.834ms
                 -->kernel: 0:7 %3505 =  [] -> 5.826ms
       %4668 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.006ms
         %4669 = :nvte_scaled_masked_softmax_forward [] -> 11.006ms
                 -->kernel: 0:7 %3506 =  [] -> 11.006ms
       %4670 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.992ms
                 -->kernel: 0:7 %3507 =  [] -> 3.979ms
       %4671 = :aten::contiguous [[4096, 1, 128, 128], []] -> 279.104us
         %4672 = :aten::clone [[4096, 1, 128, 128], []] -> 279.104us
           %4673 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 279.104us
                 -->kernel: 0:7 %3508 =  [] -> 279.104us
     %4674 = :TERowParallelLinear forward [] -> 3.837ms
       %4675 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.837ms
         %4676 = :nvte_quantize_v2 [] -> 97.376us
           %4677 = :quantize_transpose_vector_blockwise [] -> 97.376us
                 -->kernel: 0:7 %3509 =  [] -> 97.376us
         %4678 = :nvte_quantize_v2 [] -> 168.288us
           %4679 = :quantize_transpose_square_blockwise [] -> 168.288us
                 -->kernel: 0:7 %3510 =  [] -> 168.288us
         %4680 = :nvte_cublas_gemm_scaled [] -> 3.427ms
                 -->kernel: 0:7 %3511 =  [] -> 3.420ms
     %4681 = :Torch-Compiled Region: 1/2 None -> 44.672us
       %4682 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.672us
         %4683 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.672us
                 -->kernel: 0:7 %3512 =  [] -> 44.672us
     %4684 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.688us
       %4685 = :nvte_rmsnorm_fwd [] -> 126.688us
                 -->kernel: 0:7 %3513 =  [] -> 126.688us
     %4686 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 42.592us
       %4687 = :nvte_cublas_gemm_scaled [] -> 42.592us
                 -->kernel: 0:7 %3514 =  [] -> 22.176us
                 -->kernel: 0:7 %3515 =  [] -> 2.592us
     %4688 = :RandomSTE [[4096, 1, 32]] -> 44.992us
       %4689 = :aten::clone [[4096, 1, 32], []] -> 1.632us
         %4690 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.632us
       %4691 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.736us
                 -->kernel: 0:7 %3516 =  [] -> 4.736us
     %4692 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 70.528us
       %4693 = :nvte_fused_topk_with_score_function_forward [] -> 70.528us
                 -->kernel: 0:7 %3517 =  [] -> 70.528us
     %4694 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 27.264us
       %4695 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 27.264us
                 -->kernel: 0:7 %3518 =  [] -> 27.264us
     %4696 = :aten::sum [[4096, 32], [], [], []] -> 46.848us
       %4697 = :aten::to [[4096, 32], [], [], [], []] -> 4.704us
         %4698 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.704us
           %4699 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.704us
                 -->kernel: 0:7 %3519 =  [] -> 4.704us
                 -->kernel: 0:7 %3520 =  [] -> 10.496us
     %4700 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.160us
       %4701 = :nvte_fused_moe_aux_loss_forward [] -> 12.160us
                 -->kernel: 0:7 %3521 =  [] -> 12.160us
     %4702 = :aten::div [[], []] -> 1.152us
                 -->kernel: 0:7 %3522 =  [] -> 1.152us
     %4703 = :aten::div [[], []] -> 1.408us
                 -->kernel: 0:7 %3523 =  [] -> 1.408us
     %4704 = :aten::add_ [[], [], []] -> 1.536us
                 -->kernel: 0:7 %3524 =  [] -> 1.536us
     %4705 = :aten::sum [[4096, 32], [], [], []] -> 36.800us
       %4706 = :aten::to [[4096, 32], [], [], [], []] -> 4.576us
         %4707 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.576us
           %4708 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.576us
                 -->kernel: 0:7 %3525 =  [] -> 4.576us
                 -->kernel: 0:7 %3526 =  [] -> 7.840us
     %4709 = :aten::add_ [[32], [32], []] -> 4.000us
                 -->kernel: 0:7 %3527 =  [] -> 4.000us
     %4710 = :aten::topk [[4096, 32], [], [], [], []] -> 54.880us
                 -->kernel: 0:7 %3528 =  [] -> 14.144us
                 -->kernel: 0:7 %3529 =  [] -> 7.680us
     %4711 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 1.194ms
                 -->kernel: 0:26 %3530 =  [] -> 43.008us
                 -->kernel: 0:26 %3531 =  [] -> 255.009us
                 -->kernel: 0:26 %3532 =  [] -> 760.930us
     %4712 = :TEColumnParallelLinear forward [] -> 1.136ms
       %4713 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.136ms
         %4714 = :nvte_quantize_v2 [] -> 45.248us
           %4715 = :quantize_transpose_vector_blockwise [] -> 45.248us
                 -->kernel: 0:7 %3533 =  [] -> 45.248us
         %4716 = :nvte_quantize_v2 [] -> 45.344us
           %4717 = :quantize_transpose_square_blockwise [] -> 45.344us
                 -->kernel: 0:7 %3534 =  [] -> 45.344us
         %4718 = :nvte_cublas_gemm_scaled [] -> 915.202us
                 -->kernel: 0:7 %3535 =  [] -> 907.746us
     %4719 = :SwiGLUFunction [[4096, 4096], [], []] -> 27.264us
       %4720 = :Torch-Compiled Region: 2/1 None -> 27.264us
         %4721 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 27.264us
                 -->kernel: 0:7 %3536 =  [] -> 27.264us
     %4722 = :TERowParallelLinear forward [] -> 610.817us
       %4723 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 610.817us
         %4724 = :nvte_quantize_v2 [] -> 22.880us
           %4725 = :quantize_transpose_vector_blockwise [] -> 22.880us
                 -->kernel: 0:7 %3537 =  [] -> 22.880us
         %4726 = :nvte_quantize_v2 [] -> 24.480us
           %4727 = :quantize_transpose_square_blockwise [] -> 24.480us
                 -->kernel: 0:7 %3538 =  [] -> 24.480us
         %4728 = :nvte_cublas_gemm_scaled [] -> 441.761us
                 -->kernel: 0:7 %3539 =  [] -> 435.713us
     %4729 = :IndicesToMultihot [[15870, 8], [15870, 8], []] -> 11.552us
                 -->kernel: 0:7 %3540 =  [] -> 11.552us
     %4730 = :aten::contiguous [[4, 15870], []] -> 2.944us
       %4731 = :aten::clone [[4, 15870], []] -> 2.944us
         %4732 = :aten::copy_ [[4, 15870], [4, 15870], []] -> 2.944us
                 -->kernel: 0:7 %3541 =  [] -> 2.944us
     %4733 = :aten::to [[4, 15870], [], [], [], []] -> 4.960us
       %4734 = :aten::_to_copy [[4, 15870], [], [], [], [], [], []] -> 4.960us
         %4735 = :aten::copy_ [[4, 15870], [4, 15870], []] -> 4.960us
                 -->kernel: 0:7 %3542 =  [] -> 4.960us
                 -->kernel: 0:7 %3543 =  [] -> 22.817us
     %4736 = :_moe_permute_mask_map [[15870, 7168], [15870, 4], [], [15870, 4]] -> 413.281us
                 -->kernel: 0:7 %3544 =  [] -> 2.144us
                 -->kernel: 0:7 %3545 =  [] -> 2.432us
                 -->kernel: 0:7 %3546 =  [] -> 13.216us
                 -->kernel: 0:7 %3547 =  [] -> 203.265us
     %4737 = :TEColumnParallelGroupedLinear forward [] -> 8.401ms
       %4738 = :_GroupedLinear [[33040, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.401ms
         %4739 = :nvte_quantize_v2 [] -> 223.616us
           %4740 = :quantize_transpose_vector_blockwise [] -> 223.616us
                 -->kernel: 0:7 %3548 =  [] -> 223.616us
         %4741 = :nvte_quantize_v2 [] -> 219.329us
           %4742 = :quantize_transpose_vector_blockwise [] -> 219.329us
                 -->kernel: 0:7 %3549 =  [] -> 219.329us
         %4743 = :nvte_quantize_v2 [] -> 223.488us
           %4744 = :quantize_transpose_vector_blockwise [] -> 223.488us
                 -->kernel: 0:7 %3550 =  [] -> 223.488us
         %4745 = :nvte_quantize_v2 [] -> 145.825us
           %4746 = :quantize_transpose_vector_blockwise [] -> 145.825us
                 -->kernel: 0:7 %3551 =  [] -> 145.825us
         %4747 = :nvte_quantize_v2 [] -> 45.792us
           %4748 = :quantize_transpose_square_blockwise [] -> 45.792us
                 -->kernel: 0:7 %3552 =  [] -> 45.792us
         %4749 = :nvte_quantize_v2 [] -> 45.344us
           %4750 = :quantize_transpose_square_blockwise [] -> 45.344us
                 -->kernel: 0:7 %3553 =  [] -> 45.344us
         %4751 = :nvte_quantize_v2 [] -> 45.024us
           %4752 = :quantize_transpose_square_blockwise [] -> 45.024us
                 -->kernel: 0:7 %3554 =  [] -> 45.024us
         %4753 = :nvte_quantize_v2 [] -> 45.984us
           %4754 = :quantize_transpose_square_blockwise [] -> 45.984us
                 -->kernel: 0:7 %3555 =  [] -> 45.984us
         %4755 = :nvte_multi_stream_cublas_gemm [] -> 7.085ms
           %4756 = :nvte_cublas_gemm [] -> 1.759ms
                 -->kernel: 0:159 %3556 =  [] -> 1.750ms
           %4757 = :nvte_cublas_gemm [] -> 1.752ms
                 -->kernel: 0:160 %3557 =  [] -> 1.745ms
           %4758 = :nvte_cublas_gemm [] -> 1.754ms
                 -->kernel: 0:161 %3558 =  [] -> 1.749ms
           %4759 = :nvte_cublas_gemm [] -> 1.753ms
                 -->kernel: 0:162 %3559 =  [] -> 1.749ms
     %4760 = :WeightedSwiGLUFunction [[33040, 4096], [33040, 1], []] -> 120.417us
       %4761 = :Torch-Compiled Region: 3/1 None -> 120.417us
         %4762 = :triton_poi_fused__to_copy_mul_silu_0 [[33040, 4096], [33040, 1], [33040, 2048], [], []] -> 120.417us
                 -->kernel: 0:7 %3560 =  [] -> 120.417us
     %4763 = :TERowParallelGroupedLinear forward [] -> 4.227ms
       %4764 = :_GroupedLinear [[33040, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.227ms
         %4765 = :nvte_quantize_v2 [] -> 68.384us
           %4766 = :quantize_transpose_vector_blockwise [] -> 68.384us
                 -->kernel: 0:7 %3561 =  [] -> 68.384us
         %4767 = :nvte_quantize_v2 [] -> 68.993us
           %4768 = :quantize_transpose_vector_blockwise [] -> 68.993us
                 -->kernel: 0:7 %3562 =  [] -> 68.993us
         %4769 = :nvte_quantize_v2 [] -> 69.568us
           %4770 = :quantize_transpose_vector_blockwise [] -> 69.568us
                 -->kernel: 0:7 %3563 =  [] -> 69.568us
         %4771 = :nvte_quantize_v2 [] -> 45.600us
           %4772 = :quantize_transpose_vector_blockwise [] -> 45.600us
                 -->kernel: 0:7 %3564 =  [] -> 45.600us
         %4773 = :nvte_quantize_v2 [] -> 24.640us
           %4774 = :quantize_transpose_square_blockwise [] -> 24.640us
                 -->kernel: 0:7 %3565 =  [] -> 24.640us
         %4775 = :nvte_quantize_v2 [] -> 23.840us
           %4776 = :quantize_transpose_square_blockwise [] -> 23.840us
                 -->kernel: 0:7 %3566 =  [] -> 23.840us
         %4777 = :nvte_quantize_v2 [] -> 24.384us
           %4778 = :quantize_transpose_square_blockwise [] -> 24.384us
                 -->kernel: 0:7 %3567 =  [] -> 24.384us
         %4779 = :nvte_quantize_v2 [] -> 24.385us
           %4780 = :quantize_transpose_square_blockwise [] -> 24.385us
                 -->kernel: 0:7 %3568 =  [] -> 24.385us
         %4781 = :nvte_multi_stream_cublas_gemm [] -> 3.588ms
           %4782 = :nvte_cublas_gemm [] -> 887.938us
                 -->kernel: 0:159 %3569 =  [] -> 880.578us
           %4783 = :nvte_cublas_gemm [] -> 871.010us
                 -->kernel: 0:160 %3570 =  [] -> 866.626us
           %4784 = :nvte_cublas_gemm [] -> 884.162us
                 -->kernel: 0:161 %3571 =  [] -> 880.770us
           %4785 = :nvte_cublas_gemm [] -> 883.682us
                 -->kernel: 0:162 %3572 =  [] -> 879.778us
     %4786 = :_moe_unpermute_mask_map [[33040, 7168], [15870, 9], [], []] -> 227.808us
                 -->kernel: 0:7 %3573 =  [] -> 227.808us
     %4787 = :FusedCombine [[15870, 7168], [], []] -> 755.394us
                 -->kernel: 0:26 %3574 =  [] -> 13.856us
                 -->kernel: 0:26 %3575 =  [] -> 711.458us
     %4788 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.448us
                 -->kernel: 0:7 %3576 =  [] -> 52.448us
     %4789 = :Torch-Compiled Region: 1/2 None -> 48.288us
       %4790 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 48.288us
         %4791 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 48.288us
                 -->kernel: 0:7 %3577 =  [] -> 48.288us
     %4792 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.016us
       %4793 = :nvte_rmsnorm_fwd [] -> 126.016us
                 -->kernel: 0:7 %3578 =  [] -> 126.016us
     %4794 = :aten::roll [[1, 4096], [], []] -> 2.144us
                 -->kernel: 0:7 %3579 =  [] -> 2.144us
     %4795 = :aten::fill_ [[1], []] -> 1.248us
                 -->kernel: 0:7 %3580 =  [] -> 1.248us
     %4796 = :aten::sum [[1, 4096], []] -> 3.680us
       %4797 = :aten::sum [[1, 4096], [], [], []] -> 3.680us
                 -->kernel: 0:7 %3581 =  [] -> 3.680us
     %4798 = :aten::roll [[1, 4096], [], []] -> 2.080us
                 -->kernel: 0:7 %3582 =  [] -> 2.080us
     %4799 = :aten::fill_ [[1], []] -> 1.280us
                 -->kernel: 0:7 %3583 =  [] -> 1.280us
     %4800 = :aten::sum [[1, 4096], []] -> 3.648us
       %4801 = :aten::sum [[1, 4096], [], [], []] -> 3.648us
                 -->kernel: 0:7 %3584 =  [] -> 3.648us
     %4802 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 268.896us
       %4803 = :aten::index_select [[129280, 7168], [], [4096]] -> 268.896us
                 -->kernel: 0:7 %3585 =  [] -> 268.896us
     %4804 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 128.064us
       %4805 = :nvte_rmsnorm_fwd [] -> 128.064us
                 -->kernel: 0:7 %3586 =  [] -> 128.064us
     %4806 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.848us
       %4807 = :nvte_rmsnorm_fwd [] -> 126.848us
                 -->kernel: 0:7 %3587 =  [] -> 126.848us
     %4808 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 163.297us
                 -->kernel: 0:7 %3588 =  [] -> 163.297us
     %4809 = :TEColumnParallelLinear forward [] -> 3.413ms
       %4810 = :_Linear [[7168, 14336], [4096, 1, 14336], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.413ms
         %4811 = :nvte_quantize_v2 [] -> 144.865us
           %4812 = :quantize_transpose_vector_blockwise [] -> 144.865us
                 -->kernel: 0:7 %3589 =  [] -> 144.865us
         %4813 = :nvte_quantize_v2 [] -> 153.536us
           %4814 = :quantize_transpose_square_blockwise [] -> 153.536us
                 -->kernel: 0:7 %3590 =  [] -> 153.536us
         %4815 = :nvte_cublas_gemm_scaled [] -> 2.983ms
                 -->kernel: 0:7 %3591 =  [] -> 2.975ms
     %4816 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 121.345us
       %4817 = :nvte_rmsnorm_fwd [] -> 121.345us
                 -->kernel: 0:7 %3592 =  [] -> 121.345us
     %4818 = :TELinear forward [] -> 559.489us
       %4819 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 559.489us
         %4820 = :nvte_quantize_v2 [] -> 73.344us
           %4821 = :quantize_transpose_vector_blockwise [] -> 73.344us
                 -->kernel: 0:7 %3593 =  [] -> 73.344us
         %4822 = :nvte_quantize_v2 [] -> 20.353us
           %4823 = :quantize_transpose_square_blockwise [] -> 20.353us
                 -->kernel: 0:7 %3594 =  [] -> 20.353us
         %4824 = :nvte_cublas_gemm_scaled [] -> 333.696us
                 -->kernel: 0:7 %3595 =  [] -> 327.648us
     %4825 = :TELinear forward [] -> 401.057us
       %4826 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 401.057us
         %4827 = :nvte_quantize_v2 [] -> 72.352us
           %4828 = :quantize_transpose_vector_blockwise [] -> 72.352us
                 -->kernel: 0:7 %3596 =  [] -> 72.352us
         %4829 = :nvte_quantize_v2 [] -> 12.480us
           %4830 = :quantize_transpose_square_blockwise [] -> 12.480us
                 -->kernel: 0:7 %3597 =  [] -> 12.480us
         %4831 = :nvte_cublas_gemm_scaled [] -> 203.520us
                 -->kernel: 0:7 %3598 =  [] -> 196.896us
     %4832 = :TELayerNormColumnParallelLinear forward [] -> 1.368ms
       %4833 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.368ms
         %4834 = :nvte_rmsnorm_fwd [] -> 30.784us
                 -->kernel: 0:7 %3599 =  [] -> 30.784us
         %4835 = :nvte_quantize_v2 [] -> 16.992us
           %4836 = :quantize_transpose_vector_blockwise [] -> 16.992us
                 -->kernel: 0:7 %3600 =  [] -> 16.992us
         %4837 = :nvte_quantize_v2 [] -> 57.952us
           %4838 = :quantize_transpose_square_blockwise [] -> 57.952us
                 -->kernel: 0:7 %3601 =  [] -> 57.952us
         %4839 = :nvte_cublas_gemm_scaled [] -> 1.129ms
                 -->kernel: 0:7 %3602 =  [] -> 1.122ms
     %4840 = :TELayerNormColumnParallelLinear forward [] -> 886.562us
       %4841 = :aten::contiguous [[4096, 1, 512], []] -> 11.520us
         %4842 = :aten::clone [[4096, 1, 512], []] -> 11.520us
           %4843 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.520us
                 -->kernel: 0:7 %3603 =  [] -> 11.520us
       %4844 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 691.298us
         %4845 = :nvte_rmsnorm_fwd [] -> 4.256us
                 -->kernel: 0:7 %3604 =  [] -> 4.256us
         %4846 = :nvte_quantize_v2 [] -> 7.712us
           %4847 = :quantize_transpose_vector_blockwise [] -> 7.712us
                 -->kernel: 0:7 %3605 =  [] -> 7.712us
         %4848 = :nvte_quantize_v2 [] -> 28.192us
           %4849 = :quantize_transpose_square_blockwise [] -> 28.192us
                 -->kernel: 0:7 %3606 =  [] -> 28.192us
         %4850 = :nvte_cublas_gemm_scaled [] -> 522.338us
                 -->kernel: 0:7 %3607 =  [] -> 515.554us
     %4851 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 113.857us
                 -->kernel: 0:7 %3608 =  [] -> 113.857us
     %4852 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 173.888us
                 -->kernel: 0:7 %3609 =  [] -> 173.888us
     %4853 = :TEDotProductAttention forward [] -> 22.360ms
       %4854 = :aten::arange [[], [], [], [], []] -> 1.184us
         %4855 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %3610 =  [] -> 1.184us
       %4856 = :aten::arange [[], [], [], [], []] -> 1.120us
         %4857 = :aten::arange [[], [], [], [0]] -> 1.120us
                 -->kernel: 0:7 %3611 =  [] -> 1.120us
       %4858 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 60.960us
                 -->kernel: 0:7 %3612 =  [] -> 60.960us
       %4859 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 39.616us
                 -->kernel: 0:7 %3613 =  [] -> 39.616us
       %4860 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.304us
                 -->kernel: 0:7 %3614 =  [] -> 38.304us
       %4861 = :aten::le [[1, 1, 4096, 4096], []] -> 28.192us
                 -->kernel: 0:7 %3615 =  [] -> 28.192us
       %4862 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.960us
                 -->kernel: 0:7 %3616 =  [] -> 24.960us
       %4863 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.528us
                 -->kernel: 0:7 %3617 =  [] -> 14.528us
       %4864 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.944us
         %4865 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.944us
                 -->kernel: 0:7 %3618 =  [] -> 18.944us
       %4866 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.928us
         %4867 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.928us
                 -->kernel: 0:7 %3619 =  [] -> 12.928us
       %4868 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.624us
         %4869 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.624us
                 -->kernel: 0:7 %3620 =  [] -> 18.624us
       %4870 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.804ms
                 -->kernel: 0:7 %3621 =  [] -> 5.796ms
       %4871 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 10.999ms
         %4872 = :nvte_scaled_masked_softmax_forward [] -> 10.999ms
                 -->kernel: 0:7 %3622 =  [] -> 10.999ms
       %4873 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.980ms
                 -->kernel: 0:7 %3623 =  [] -> 3.967ms
       %4874 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.657us
         %4875 = :aten::clone [[4096, 1, 128, 128], []] -> 278.657us
           %4876 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.657us
                 -->kernel: 0:7 %3624 =  [] -> 278.657us
     %4877 = :TERowParallelLinear forward [] -> 3.819ms
       %4878 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.819ms
         %4879 = :nvte_quantize_v2 [] -> 96.800us
           %4880 = :quantize_transpose_vector_blockwise [] -> 96.800us
                 -->kernel: 0:7 %3625 =  [] -> 96.800us
         %4881 = :nvte_quantize_v2 [] -> 169.536us
           %4882 = :quantize_transpose_square_blockwise [] -> 169.536us
                 -->kernel: 0:7 %3626 =  [] -> 169.536us
         %4883 = :nvte_cublas_gemm_scaled [] -> 3.404ms
                 -->kernel: 0:7 %3627 =  [] -> 3.397ms
     %4884 = :Torch-Compiled Region: 1/2 None -> 44.000us
       %4885 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.000us
         %4886 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.000us
                 -->kernel: 0:7 %3628 =  [] -> 44.000us
     %4887 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 127.040us
       %4888 = :nvte_rmsnorm_fwd [] -> 127.040us
                 -->kernel: 0:7 %3629 =  [] -> 127.040us
     %4889 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 41.568us
       %4890 = :nvte_cublas_gemm_scaled [] -> 41.568us
                 -->kernel: 0:7 %3630 =  [] -> 22.304us
                 -->kernel: 0:7 %3631 =  [] -> 2.560us
     %4891 = :RandomSTE [[4096, 1, 32]] -> 41.664us
       %4892 = :aten::clone [[4096, 1, 32], []] -> 1.600us
         %4893 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.600us
       %4894 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.704us
                 -->kernel: 0:7 %3632 =  [] -> 4.704us
     %4895 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 69.793us
       %4896 = :nvte_fused_topk_with_score_function_forward [] -> 69.793us
                 -->kernel: 0:7 %3633 =  [] -> 69.793us
     %4897 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 27.040us
       %4898 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 27.040us
                 -->kernel: 0:7 %3634 =  [] -> 27.040us
     %4899 = :aten::sum [[4096, 32], [], [], []] -> 47.040us
       %4900 = :aten::to [[4096, 32], [], [], [], []] -> 4.704us
         %4901 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.704us
           %4902 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.704us
                 -->kernel: 0:7 %3635 =  [] -> 4.704us
                 -->kernel: 0:7 %3636 =  [] -> 9.984us
     %4903 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.512us
       %4904 = :nvte_fused_moe_aux_loss_forward [] -> 12.512us
                 -->kernel: 0:7 %3637 =  [] -> 12.512us
     %4905 = :aten::div [[], []] -> 1.408us
                 -->kernel: 0:7 %3638 =  [] -> 1.408us
     %4906 = :aten::div [[], []] -> 1.568us
                 -->kernel: 0:7 %3639 =  [] -> 1.568us
     %4907 = :aten::add_ [[], [], []] -> 1.600us
                 -->kernel: 0:7 %3640 =  [] -> 1.600us
     %4908 = :aten::sum [[4096, 32], [], [], []] -> 36.576us
       %4909 = :aten::to [[4096, 32], [], [], [], []] -> 4.672us
         %4910 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.672us
           %4911 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.672us
                 -->kernel: 0:7 %3641 =  [] -> 4.672us
                 -->kernel: 0:7 %3642 =  [] -> 7.712us
     %4912 = :aten::add_ [[32], [32], []] -> 4.448us
                 -->kernel: 0:7 %3643 =  [] -> 4.448us
     %4913 = :aten::topk [[4096, 32], [], [], [], []] -> 51.488us
                 -->kernel: 0:7 %3644 =  [] -> 14.304us
                 -->kernel: 0:7 %3645 =  [] -> 7.680us
     %4914 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 821.666us
                 -->kernel: 0:26 %3646 =  [] -> 44.640us
                 -->kernel: 0:26 %3647 =  [] -> 12.704us
                 -->kernel: 0:26 %3648 =  [] -> 636.065us
     %4915 = :TEColumnParallelLinear forward [] -> 1.154ms
       %4916 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.154ms
         %4917 = :nvte_quantize_v2 [] -> 45.248us
           %4918 = :quantize_transpose_vector_blockwise [] -> 45.248us
                 -->kernel: 0:7 %3649 =  [] -> 45.248us
         %4919 = :nvte_quantize_v2 [] -> 44.480us
           %4920 = :quantize_transpose_square_blockwise [] -> 44.480us
                 -->kernel: 0:7 %3650 =  [] -> 44.480us
         %4921 = :nvte_cublas_gemm_scaled [] -> 914.562us
                 -->kernel: 0:7 %3651 =  [] -> 907.426us
     %4922 = :SwiGLUFunction [[4096, 4096], [], []] -> 27.008us
       %4923 = :Torch-Compiled Region: 2/1 None -> 27.008us
         %4924 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 27.008us
                 -->kernel: 0:7 %3652 =  [] -> 27.008us
     %4925 = :TERowParallelLinear forward [] -> 603.841us
       %4926 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 603.841us
         %4927 = :nvte_quantize_v2 [] -> 23.072us
           %4928 = :quantize_transpose_vector_blockwise [] -> 23.072us
                 -->kernel: 0:7 %3653 =  [] -> 23.072us
         %4929 = :nvte_quantize_v2 [] -> 24.768us
           %4930 = :quantize_transpose_square_blockwise [] -> 24.768us
                 -->kernel: 0:7 %3654 =  [] -> 24.768us
         %4931 = :nvte_cublas_gemm_scaled [] -> 441.569us
                 -->kernel: 0:7 %3655 =  [] -> 435.969us
     %4932 = :IndicesToMultihot [[15637, 8], [15637, 8], []] -> 11.680us
                 -->kernel: 0:7 %3656 =  [] -> 11.680us
     %4933 = :aten::contiguous [[4, 15637], []] -> 2.944us
       %4934 = :aten::clone [[4, 15637], []] -> 2.944us
         %4935 = :aten::copy_ [[4, 15637], [4, 15637], []] -> 2.944us
                 -->kernel: 0:7 %3657 =  [] -> 2.944us
     %4936 = :aten::to [[4, 15637], [], [], [], []] -> 4.832us
       %4937 = :aten::_to_copy [[4, 15637], [], [], [], [], [], []] -> 4.832us
         %4938 = :aten::copy_ [[4, 15637], [4, 15637], []] -> 4.832us
                 -->kernel: 0:7 %3658 =  [] -> 4.832us
                 -->kernel: 0:7 %3659 =  [] -> 22.784us
     %4939 = :_moe_permute_mask_map [[15637, 7168], [15637, 4], [], [15637, 4]] -> 392.513us
                 -->kernel: 0:7 %3660 =  [] -> 2.336us
                 -->kernel: 0:7 %3661 =  [] -> 2.464us
                 -->kernel: 0:7 %3662 =  [] -> 13.120us
                 -->kernel: 0:7 %3663 =  [] -> 200.673us
     %4940 = :TEColumnParallelGroupedLinear forward [] -> 8.535ms
       %4941 = :_GroupedLinear [[32704, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.535ms
         %4942 = :nvte_quantize_v2 [] -> 219.680us
           %4943 = :quantize_transpose_vector_blockwise [] -> 219.680us
                 -->kernel: 0:7 %3664 =  [] -> 219.680us
         %4944 = :nvte_quantize_v2 [] -> 218.977us
           %4945 = :quantize_transpose_vector_blockwise [] -> 218.977us
                 -->kernel: 0:7 %3665 =  [] -> 218.977us
         %4946 = :nvte_quantize_v2 [] -> 223.072us
           %4947 = :quantize_transpose_vector_blockwise [] -> 223.072us
                 -->kernel: 0:7 %3666 =  [] -> 223.072us
         %4948 = :nvte_quantize_v2 [] -> 220.129us
           %4949 = :quantize_transpose_vector_blockwise [] -> 220.129us
                 -->kernel: 0:7 %3667 =  [] -> 220.129us
         %4950 = :nvte_quantize_v2 [] -> 45.408us
           %4951 = :quantize_transpose_square_blockwise [] -> 45.408us
                 -->kernel: 0:7 %3668 =  [] -> 45.408us
         %4952 = :nvte_quantize_v2 [] -> 45.536us
           %4953 = :quantize_transpose_square_blockwise [] -> 45.536us
                 -->kernel: 0:7 %3669 =  [] -> 45.536us
         %4954 = :nvte_quantize_v2 [] -> 45.856us
           %4955 = :quantize_transpose_square_blockwise [] -> 45.856us
                 -->kernel: 0:7 %3670 =  [] -> 45.856us
         %4956 = :nvte_quantize_v2 [] -> 45.569us
           %4957 = :quantize_transpose_square_blockwise [] -> 45.569us
                 -->kernel: 0:7 %3671 =  [] -> 45.569us
         %4958 = :nvte_multi_stream_cublas_gemm [] -> 7.075ms
           %4959 = :nvte_cublas_gemm [] -> 1.756ms
                 -->kernel: 0:159 %3672 =  [] -> 1.748ms
           %4960 = :nvte_cublas_gemm [] -> 1.748ms
                 -->kernel: 0:160 %3673 =  [] -> 1.744ms
           %4961 = :nvte_cublas_gemm [] -> 1.752ms
                 -->kernel: 0:161 %3674 =  [] -> 1.748ms
           %4962 = :nvte_cublas_gemm [] -> 1.749ms
                 -->kernel: 0:162 %3675 =  [] -> 1.744ms
     %4963 = :WeightedSwiGLUFunction [[32704, 4096], [32704, 1], []] -> 119.456us
       %4964 = :Torch-Compiled Region: 3/1 None -> 119.456us
         %4965 = :triton_poi_fused__to_copy_mul_silu_0 [[32704, 4096], [32704, 1], [32704, 2048], [], []] -> 119.456us
                 -->kernel: 0:7 %3676 =  [] -> 119.456us
     %4966 = :TERowParallelGroupedLinear forward [] -> 4.223ms
       %4967 = :_GroupedLinear [[32704, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.223ms
         %4968 = :nvte_quantize_v2 [] -> 66.176us
           %4969 = :quantize_transpose_vector_blockwise [] -> 66.176us
                 -->kernel: 0:7 %3677 =  [] -> 66.176us
         %4970 = :nvte_quantize_v2 [] -> 67.648us
           %4971 = :quantize_transpose_vector_blockwise [] -> 67.648us
                 -->kernel: 0:7 %3678 =  [] -> 67.648us
         %4972 = :nvte_quantize_v2 [] -> 68.992us
           %4973 = :quantize_transpose_vector_blockwise [] -> 68.992us
                 -->kernel: 0:7 %3679 =  [] -> 68.992us
         %4974 = :nvte_quantize_v2 [] -> 68.864us
           %4975 = :quantize_transpose_vector_blockwise [] -> 68.864us
                 -->kernel: 0:7 %3680 =  [] -> 68.864us
         %4976 = :nvte_quantize_v2 [] -> 24.928us
           %4977 = :quantize_transpose_square_blockwise [] -> 24.928us
                 -->kernel: 0:7 %3681 =  [] -> 24.928us
         %4978 = :nvte_quantize_v2 [] -> 24.384us
           %4979 = :quantize_transpose_square_blockwise [] -> 24.384us
                 -->kernel: 0:7 %3682 =  [] -> 24.384us
         %4980 = :nvte_quantize_v2 [] -> 24.704us
           %4981 = :quantize_transpose_square_blockwise [] -> 24.704us
                 -->kernel: 0:7 %3683 =  [] -> 24.704us
         %4982 = :nvte_quantize_v2 [] -> 24.896us
           %4983 = :quantize_transpose_square_blockwise [] -> 24.896us
                 -->kernel: 0:7 %3684 =  [] -> 24.896us
         %4984 = :nvte_multi_stream_cublas_gemm [] -> 3.559ms
           %4985 = :nvte_cublas_gemm [] -> 873.954us
                 -->kernel: 0:159 %3685 =  [] -> 866.562us
           %4986 = :nvte_cublas_gemm [] -> 870.978us
                 -->kernel: 0:160 %3686 =  [] -> 866.594us
           %4987 = :nvte_cublas_gemm [] -> 883.170us
                 -->kernel: 0:161 %3687 =  [] -> 879.522us
           %4988 = :nvte_cublas_gemm [] -> 870.915us
                 -->kernel: 0:162 %3688 =  [] -> 866.850us
     %4989 = :_moe_unpermute_mask_map [[32704, 7168], [15637, 9], [], []] -> 225.057us
                 -->kernel: 0:7 %3689 =  [] -> 225.057us
     %4990 = :FusedCombine [[15637, 7168], [], []] -> 757.058us
                 -->kernel: 0:26 %3690 =  [] -> 14.048us
                 -->kernel: 0:26 %3691 =  [] -> 716.066us
     %4991 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.320us
                 -->kernel: 0:7 %3692 =  [] -> 52.320us
     %4992 = :Torch-Compiled Region: 1/2 None -> 47.104us
       %4993 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 47.104us
         %4994 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 47.104us
                 -->kernel: 0:7 %3693 =  [] -> 47.104us
     %4995 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.657us
       %4996 = :nvte_rmsnorm_fwd [] -> 126.657us
                 -->kernel: 0:7 %3694 =  [] -> 126.657us
     %4997 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 162.400us
                 -->kernel: 0:7 %3695 =  [] -> 162.400us
     %4998 = :aten::clone [[1, 4096], []] -> 1.568us
       %4999 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.568us
     %5000 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.681ms
       %5001 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.681ms
         %5002 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.681ms
                 -->kernel: 0:7 %3696 =  [] -> 53.670ms
     %5003 = :aten::roll [[1, 4096], [], []] -> 2.080us
                 -->kernel: 0:7 %3697 =  [] -> 2.080us
     %5004 = :aten::fill_ [[1], []] -> 1.056us
                 -->kernel: 0:7 %3698 =  [] -> 1.056us
     %5005 = :aten::sum [[1, 4096], []] -> 3.648us
       %5006 = :aten::sum [[1, 4096], [], [], []] -> 3.648us
                 -->kernel: 0:7 %3699 =  [] -> 3.648us
     %5007 = :aten::roll [[1, 4096], [], []] -> 2.176us
                 -->kernel: 0:7 %3700 =  [] -> 2.176us
     %5008 = :aten::fill_ [[1], []] -> 1.088us
                 -->kernel: 0:7 %3701 =  [] -> 1.088us
     %5009 = :aten::sum [[1, 4096], []] -> 3.072us
       %5010 = :aten::sum [[1, 4096], [], [], []] -> 3.072us
                 -->kernel: 0:7 %3702 =  [] -> 3.072us
     %5011 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.481ms
       %5012 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %5013 = :aten::zero_ [[4096]] -> 1.120us
           %5014 = :aten::fill_ [[4096], []] -> 1.120us
                 -->kernel: 0:7 %3703 =  [] -> 1.120us
       %5015 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %5016 = :aten::zero_ [[12288]] -> 1.120us
           %5017 = :aten::fill_ [[12288], []] -> 1.120us
                 -->kernel: 0:7 %3704 =  [] -> 1.120us
                 -->kernel: 0:7 %3705 =  [] -> 659.650us
                 -->kernel: 0:7 %3706 =  [] -> 600.737us
     %5018 = :aten::mul [[1, 4096], [1, 4096]] -> 1.600us
                 -->kernel: 0:7 %3707 =  [] -> 1.600us
     %5019 = :aten::sum [[1, 4096], []] -> 3.232us
       %5020 = :aten::sum [[1, 4096], [], [], []] -> 3.232us
                 -->kernel: 0:7 %3708 =  [] -> 3.232us
     %5021 = :aten::div [[], []] -> 1.696us
                 -->kernel: 0:7 %3709 =  [] -> 1.696us
     %5022 = :aten::add_ [[], [], []] -> 1.376us
                 -->kernel: 0:7 %3710 =  [] -> 1.376us
     %5023 = :aten::mul [[1, 4096], []] -> 1.280us
                 -->kernel: 0:7 %3711 =  [] -> 1.280us
     %5024 = :aten::div [[1, 4096], []] -> 2.464us
                 -->kernel: 0:7 %3712 =  [] -> 2.464us
     %5025 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.692ms
       %5026 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.692ms
         %5027 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.692ms
                 -->kernel: 0:7 %3713 =  [] -> 53.681ms
     %5028 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.481ms
       %5029 = :aten::zeros [[], [], [], [], []] -> 1.152us
         %5030 = :aten::zero_ [[4096]] -> 1.152us
           %5031 = :aten::fill_ [[4096], []] -> 1.152us
                 -->kernel: 0:7 %3714 =  [] -> 1.152us
       %5032 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %5033 = :aten::zero_ [[12288]] -> 1.120us
           %5034 = :aten::fill_ [[12288], []] -> 1.120us
                 -->kernel: 0:7 %3715 =  [] -> 1.120us
                 -->kernel: 0:7 %3716 =  [] -> 658.689us
                 -->kernel: 0:7 %3717 =  [] -> 600.001us
     %5035 = :aten::mul [[4096], [4096]] -> 1.728us
                 -->kernel: 0:7 %3718 =  [] -> 1.728us
     %5036 = :aten::sum [[4096], []] -> 3.424us
       %5037 = :aten::sum [[4096], [], [], []] -> 3.424us
                 -->kernel: 0:7 %3719 =  [] -> 3.424us
     %5038 = :aten::sum [[4096], []] -> 3.264us
       %5039 = :aten::sum [[4096], [], [], []] -> 3.264us
                 -->kernel: 0:7 %3720 =  [] -> 3.264us
     %5040 = :aten::stack [[], [], []] -> 2.080us
       %5041 = :aten::cat [[1], [1], []] -> 2.080us
                 -->kernel: 0:7 %3721 =  [] -> 2.080us
     %5042 = :aten::isnan [[2]] -> 1.408us
       %5043 = :aten::ne [[2], [2]] -> 1.408us
                 -->kernel: 0:7 %3722 =  [] -> 1.408us
     %5044 = :aten::any [[2]] -> 2.944us
                 -->kernel: 0:7 %3723 =  [] -> 2.944us
     %5045 = :aten::is_nonzero [[]] -> 2.976us
       %5046 = :aten::item [[]] -> 2.976us
         %5047 = :aten::_local_scalar_dense [[]] -> 2.976us
     %5048 = :aten::clone [[], []] -> 1.280us
       %5049 = :aten::copy_ [[], [], []] -> 1.280us
     %5050 = :aten::clone [[], []] -> 1.184us
       %5051 = :aten::copy_ [[], [], []] -> 1.184us
     %5052 = :aten::cat [[1], [1], []] -> 1.600us
                 -->kernel: 0:7 %3724 =  [] -> 1.600us
     %5053 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 108.768us
       %5054 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 108.768us
         %5055 = :nccl:all_reduce [[2]] -> 108.768us
           %5056 = NCCL:ncclAllReduce [] -> 108.768us
                 -->kernel: 0:7 %3725 =  [] -> 108.768us
     %5057 = :aten::div [[2], []] -> 1.344us
                 -->kernel: 0:7 %3726 =  [] -> 1.344us
     %5058 = :aten::div [[], []] -> 1.344us
                 -->kernel: 0:7 %3727 =  [] -> 1.344us
     %5059 = :aten::mul [[], []] -> 1.088us
                 -->kernel: 0:7 %3728 =  [] -> 1.088us
     %5060 = :aten::mul_ [[], []] -> 1.216us
                 -->kernel: 0:7 %3729 =  [] -> 1.216us
     %5061 = :aten::div_ [[], []] -> 1.248us
                 -->kernel: 0:7 %3730 =  [] -> 1.248us
     %5062 = :aten::ones [[], [], [], [], []] -> 896.000ns
       %5063 = :aten::fill_ [[1], []] -> 896.000ns
                 -->kernel: 0:7 %3731 =  [] -> 896.000ns
     %5064 = :aten::mul [[1], [1]] -> 1.344us
                 -->kernel: 0:7 %3732 =  [] -> 1.344us
     %5065 = :aten::div [[1], []] -> 1.376us
                 -->kernel: 0:7 %3733 =  [] -> 1.376us
     %5066 = :aten::copy_ [[1], [1], []] -> 1.184us
     %5067 = :aten::ones [[], [], [], [], []] -> 896.000ns
       %5068 = :aten::fill_ [[1], []] -> 896.000ns
                 -->kernel: 0:7 %3734 =  [] -> 896.000ns
     %5069 = :aten::mul [[1], [1]] -> 1.120us
                 -->kernel: 0:7 %3735 =  [] -> 1.120us
     %5070 = :aten::div [[1], []] -> 1.568us
                 -->kernel: 0:7 %3736 =  [] -> 1.568us
     %5071 = :aten::add_ [[], [], []] -> 1.408us
                 -->kernel: 0:7 %3737 =  [] -> 1.408us
     %5072 = :aten::mul [[1], []] -> 1.120us
                 -->kernel: 0:7 %3738 =  [] -> 1.120us
     %5073 = :aten::ones_like [[1], [], [], [], [], []] -> 960.000ns
       %5074 = :aten::fill_ [[1], []] -> 960.000ns
                 -->kernel: 0:7 %3739 =  [] -> 960.000ns
     %5075 = :autograd::engine::evaluate_function: MulBackward0 None -> 105.633us
       %5076 = :MulBackward0 [[1]] -> 1.312us
         %5077 = :aten::mul [[1], [1]] -> 1.312us
                 -->kernel: 0:7 %3740 =  [] -> 1.312us
       %5078 = :aten::sum [[1], []] -> 3.072us
         %5079 = :aten::sum [[1], [], [], []] -> 3.072us
                 -->kernel: 0:7 %3741 =  [] -> 3.072us
     %5080 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.376us
       %5081 = :DivBackward0 [[]] -> 1.376us
         %5082 = :aten::div [[], []] -> 1.376us
                 -->kernel: 0:7 %3742 =  [] -> 1.376us
     %5083 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.152us
       %5084 = :MulBackward0 [[]] -> 1.152us
         %5085 = :aten::mul [[], []] -> 1.152us
                 -->kernel: 0:7 %3743 =  [] -> 1.152us
     %5086 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.312us
       %5087 = :MulBackward0 [[]] -> 1.312us
         %5088 = :aten::mul [[], []] -> 1.312us
                 -->kernel: 0:7 %3744 =  [] -> 1.312us
     %5089 = :autograd::engine::evaluate_function: SelectBackward0 None -> 62.528us
       %5090 = :SelectBackward0 [[]] -> 62.528us
         %5091 = :aten::select_backward [[], [], [], []] -> 62.528us
           %5092 = :aten::zeros [[], [], [], [], []] -> 1.184us
             %5093 = :aten::zero_ [[2]] -> 1.184us
               %5094 = :aten::fill_ [[2], []] -> 1.184us
                 -->kernel: 0:7 %3745 =  [] -> 1.184us
           %5095 = :aten::copy_ [[], [], []] -> 1.024us
     %5096 = :autograd::engine::evaluate_function: MulBackward0 None -> 2.176us
       %5097 = :MulBackward0 [[4096]] -> 2.176us
         %5098 = :aten::mul [[4096], [4096]] -> 2.176us
                 -->kernel: 0:7 %3746 =  [] -> 2.176us
     %5099 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 771.746us
       %5100 = :CrossEntropyFunctionBackward [[4096, 1]] -> 771.746us
         %5101 = :aten::to [[], [], [], [], [], []] -> 832.000ns
           %5102 = :aten::_to_copy [[], [], [], [], [], [], []] -> 832.000ns
             %5103 = :aten::copy_ [[], [], []] -> 832.000ns
                 -->kernel: 0:7 %3747 =  [] -> 598.530us
     %5104 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 109.136ms
       %5105 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.136ms
         %5106 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.582ms
           %5107 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.582ms
                 -->kernel: 0:7 %3748 =  [] -> 55.571ms
                 -->kernel: 0:7 %3749 =  [] -> 53.316ms
     %5108 = :autograd::engine::evaluate_function: MTPLossAutoScalerBackward None -> 70.720us
       %5109 = :MTPLossAutoScalerBackward [[4096, 1, 7168]] -> 70.720us
         %5110 = :aten::ones_like [[1, 4096], [], [], [], [], []] -> 1.152us
           %5111 = :aten::fill_ [[1, 4096], []] -> 1.152us
                 -->kernel: 0:7 %3750 =  [] -> 1.152us
         %5112 = :aten::mul [[1, 4096], [1]] -> 2.080us
                 -->kernel: 0:7 %3751 =  [] -> 2.080us
     %5113 = :autograd::engine::evaluate_function: DivBackward0 None -> 2.304us
       %5114 = :DivBackward0 [[1, 4096]] -> 2.304us
         %5115 = :aten::div [[1, 4096], []] -> 2.304us
                 -->kernel: 0:7 %3752 =  [] -> 2.304us
     %5116 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.376us
       %5117 = :MulBackward0 [[1, 4096]] -> 1.376us
         %5118 = :aten::mul [[1, 4096], []] -> 1.376us
                 -->kernel: 0:7 %3753 =  [] -> 1.376us
     %5119 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.504us
       %5120 = :MulBackward0 [[1, 4096]] -> 1.504us
         %5121 = :aten::mul [[1, 4096], [1, 4096]] -> 1.504us
                 -->kernel: 0:7 %3754 =  [] -> 1.504us
     %5122 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 754.626us
       %5123 = :CrossEntropyFunctionBackward [[4096, 1]] -> 754.626us
         %5124 = :aten::to [[], [], [], [], [], []] -> 896.000ns
           %5125 = :aten::_to_copy [[], [], [], [], [], [], []] -> 896.000ns
             %5126 = :aten::copy_ [[], [], []] -> 896.000ns
                 -->kernel: 0:7 %3755 =  [] -> 592.802us
     %5127 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 110.952ms
       %5128 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.500ms
         %5129 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.782ms
           %5130 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.782ms
                 -->kernel: 0:7 %3756 =  [] -> 55.771ms
                 -->kernel: 0:7 %3757 =  [] -> 53.484ms
       %5131 = :aten::add [[129280, 7168], [129280, 7168], []] -> 1.158ms
                 -->kernel: 0:35 %3758 =  [] -> 1.158ms
     %5132 = :autograd::engine::evaluate_function: SplitBackward0 None -> 163.329us
       %5133 = :SplitBackward0 [[4096, 1, 7168], [4096, 1, 7168]] -> 163.329us
         %5134 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 163.329us
                 -->kernel: 0:7 %3759 =  [] -> 163.329us
     %5135 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 206.657us
       %5136 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 206.657us
         %5137 = :nvte_rmsnorm_bwd [] -> 206.657us
                 -->kernel: 0:7 %3760 =  [] -> 168.961us
                 -->kernel: 0:7 %3761 =  [] -> 7.904us
     %5138 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.952us
       %5139 = :aten::add_ [[7168], [7168], []] -> 1.952us
                 -->kernel: 0:35 %3762 =  [] -> 1.952us
     %5140 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 964.834us
       %5141 = :FusedCombineBackward [[4096, 7168], []] -> 964.834us
                 -->kernel: 0:26 %3763 =  [] -> 123.264us
                 -->kernel: 0:26 %3764 =  [] -> 780.321us
     %5142 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 199.041us
       %5143 = :_moe_unpermute_mask_mapBackward [[15637, 7168]] -> 199.041us
                 -->kernel: 0:7 %3765 =  [] -> 199.041us
     %5144 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.634ms
       %5145 = :_GroupedLinearBackward [[32704, 7168]] -> 8.634ms
         %5146 = :_GroupedLinear_backward [] -> 8.634ms
           %5147 = :nvte_quantize_v2 [] -> 219.905us
             %5148 = :quantize_transpose_vector_blockwise [] -> 219.905us
                 -->kernel: 0:7 %3766 =  [] -> 219.905us
           %5149 = :nvte_quantize_v2 [] -> 218.817us
             %5150 = :quantize_transpose_vector_blockwise [] -> 218.817us
                 -->kernel: 0:7 %3767 =  [] -> 218.817us
           %5151 = :nvte_quantize_v2 [] -> 223.296us
             %5152 = :quantize_transpose_vector_blockwise [] -> 223.296us
                 -->kernel: 0:7 %3768 =  [] -> 223.296us
           %5153 = :nvte_quantize_v2 [] -> 219.713us
             %5154 = :quantize_transpose_vector_blockwise [] -> 219.713us
                 -->kernel: 0:7 %3769 =  [] -> 219.713us
           %5155 = :nvte_multi_stream_cublas_gemm [] -> 3.724ms
             %5156 = :nvte_cublas_gemm [] -> 919.842us
                 -->kernel: 0:159 %3770 =  [] -> 908.546us
             %5157 = :nvte_cublas_gemm [] -> 913.475us
                 -->kernel: 0:160 %3771 =  [] -> 907.747us
             %5158 = :nvte_cublas_gemm [] -> 913.442us
                 -->kernel: 0:161 %3772 =  [] -> 908.834us
             %5159 = :nvte_cublas_gemm [] -> 912.258us
                 -->kernel: 0:162 %3773 =  [] -> 907.362us
           %5160 = :nvte_multi_stream_cublas_gemm [] -> 3.666ms
             %5161 = :nvte_cublas_gemm [] -> 901.346us
                 -->kernel: 0:159 %3774 =  [] -> 892.514us
             %5162 = :nvte_cublas_gemm [] -> 895.651us
                 -->kernel: 0:160 %3775 =  [] -> 891.267us
             %5163 = :nvte_cublas_gemm [] -> 909.858us
                 -->kernel: 0:161 %3776 =  [] -> 905.474us
             %5164 = :nvte_cublas_gemm [] -> 895.490us
                 -->kernel: 0:162 %3777 =  [] -> 892.226us
     %5165 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 590.466us
       %5166 = :WeightedSwiGLUFunctionBackward [[32704, 2048]] -> 590.466us
         %5167 = :Torch-Compiled Region: 4/1 None -> 590.466us
           %5168 = :triton_poi_fused__to_copy_cat_0 [[32704, 2048], [32704, 1], [32704, 4096], [32704, 4096], [], []] -> 400.769us
                 -->kernel: 0:7 %3778 =  [] -> 400.769us
           %5169 = :triton_red_fused__to_copy_mul_silu_sum_1 [[32704, 4096], [32704, 2048], [32704, 1], [], [], [], []] -> 129.505us
                 -->kernel: 0:7 %3779 =  [] -> 129.505us
     %5170 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.759ms
       %5171 = :_GroupedLinearBackward [[32704, 4096]] -> 14.759ms
         %5172 = :_GroupedLinear_backward [] -> 14.759ms
           %5173 = :nvte_quantize_v2 [] -> 124.577us
             %5174 = :quantize_transpose_vector_blockwise [] -> 124.577us
                 -->kernel: 0:7 %3780 =  [] -> 124.577us
           %5175 = :nvte_quantize_v2 [] -> 128.768us
             %5176 = :quantize_transpose_vector_blockwise [] -> 128.768us
                 -->kernel: 0:7 %3781 =  [] -> 128.768us
           %5177 = :nvte_quantize_v2 [] -> 131.200us
             %5178 = :quantize_transpose_vector_blockwise [] -> 131.200us
                 -->kernel: 0:7 %3782 =  [] -> 131.200us
           %5179 = :nvte_quantize_v2 [] -> 130.017us
             %5180 = :quantize_transpose_vector_blockwise [] -> 130.017us
                 -->kernel: 0:7 %3783 =  [] -> 130.017us
           %5181 = :nvte_multi_stream_cublas_gemm [] -> 7.004ms
             %5182 = :nvte_cublas_gemm [] -> 1.725ms
                 -->kernel: 0:159 %3784 =  [] -> 1.718ms
             %5183 = :nvte_cublas_gemm [] -> 1.723ms
                 -->kernel: 0:160 %3785 =  [] -> 1.718ms
             %5184 = :nvte_cublas_gemm [] -> 1.755ms
                 -->kernel: 0:161 %3786 =  [] -> 1.751ms
             %5185 = :nvte_cublas_gemm [] -> 1.724ms
                 -->kernel: 0:162 %3787 =  [] -> 1.718ms
           %5186 = :nvte_multi_stream_cublas_gemm [] -> 6.959ms
             %5187 = :nvte_cublas_gemm [] -> 1.719ms
                 -->kernel: 0:159 %3788 =  [] -> 1.714ms
             %5188 = :nvte_cublas_gemm [] -> 1.717ms
                 -->kernel: 0:160 %3789 =  [] -> 1.713ms
             %5189 = :nvte_cublas_gemm [] -> 1.741ms
                 -->kernel: 0:161 %3790 =  [] -> 1.737ms
             %5190 = :nvte_cublas_gemm [] -> 1.717ms
                 -->kernel: 0:162 %3791 =  [] -> 1.713ms
     %5191 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 388.737us
       %5192 = :_moe_permute_mask_mapBackward [[32704, 7168], [], [32704]] -> 388.737us
         %5193 = :aten::zeros [[], [], [], [], []] -> 1.280us
           %5194 = :aten::zero_ [[15637, 9]] -> 1.280us
             %5195 = :aten::fill_ [[15637, 9], []] -> 1.280us
                 -->kernel: 0:7 %3792 =  [] -> 1.280us
                 -->kernel: 0:7 %3793 =  [] -> 211.872us
     %5196 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 97.537us
       %5197 = :IndicesToMultihotBackward [[], [15637, 4]] -> 97.537us
         %5198 = :aten::zeros [[], [], [], [], []] -> 1.440us
           %5199 = :aten::zero_ [[15637, 4]] -> 1.440us
             %5200 = :aten::fill_ [[15637, 4], []] -> 1.440us
                 -->kernel: 0:7 %3794 =  [] -> 1.440us
                 -->kernel: 0:7 %3795 =  [] -> 11.328us
     %5201 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.185ms
       %5202 = :_LinearBackward [[4096, 1, 7168]] -> 1.185ms
         %5203 = :_Linear_backward [] -> 1.185ms
           %5204 = :nvte_quantize_v2 [] -> 72.928us
             %5205 = :quantize_transpose_vector_blockwise [] -> 72.928us
                 -->kernel: 0:7 %3796 =  [] -> 72.928us
           %5206 = :nvte_cublas_gemm_scaled [] -> 467.841us
                 -->kernel: 0:7 %3797 =  [] -> 456.865us
           %5207 = :nvte_cublas_gemm_scaled [] -> 453.825us
                 -->kernel: 0:7 %3798 =  [] -> 448.609us
     %5208 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 47.104us
       %5209 = :SwiGLUFunctionBackward [[4096, 2048]] -> 47.104us
         %5210 = :Torch-Compiled Region: 5/0 None -> 47.104us
           %5211 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 47.104us
                 -->kernel: 0:7 %3799 =  [] -> 47.104us
     %5212 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.018ms
       %5213 = :_LinearBackward [[4096, 1, 4096]] -> 2.018ms
         %5214 = :_Linear_backward [] -> 2.018ms
           %5215 = :nvte_quantize_v2 [] -> 44.192us
             %5216 = :quantize_transpose_vector_blockwise [] -> 44.192us
                 -->kernel: 0:7 %3800 =  [] -> 44.192us
           %5217 = :nvte_quantize_v2 [] -> 51.937us
             %5218 = :quantize_transpose_vector_blockwise [] -> 51.937us
                 -->kernel: 0:7 %3801 =  [] -> 51.937us
           %5219 = :nvte_cublas_gemm_scaled [] -> 867.170us
                 -->kernel: 0:7 %3802 =  [] -> 860.962us
           %5220 = :nvte_cublas_gemm_scaled [] -> 867.618us
                 -->kernel: 0:7 %3803 =  [] -> 862.562us
     %5221 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 863.618us
       %5222 = :FusedDispatchBackward [[15637, 7168], [], [15637, 8], [], []] -> 863.618us
         %5223 = :aten::zeros [[], [], [], [], []] -> 1.408us
           %5224 = :aten::zero_ [[15637, 8]] -> 1.408us
             %5225 = :aten::fill_ [[15637, 8], []] -> 1.408us
                 -->kernel: 0:7 %3804 =  [] -> 1.408us
                 -->kernel: 0:26 %3805 =  [] -> 13.664us
                 -->kernel: 0:26 %3806 =  [] -> 682.657us
     %5226 = :autograd::engine::evaluate_function: TopkBackward0 None -> 60.576us
       %5227 = :TopkBackward0 [[4096, 8]] -> 60.576us
         %5228 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 60.576us
           %5229 = :aten::zeros [[], [], [], [], []] -> 960.000ns
             %5230 = :aten::zero_ [[4096, 32]] -> 960.000ns
               %5231 = :aten::fill_ [[4096, 32], []] -> 960.000ns
                 -->kernel: 0:7 %3807 =  [] -> 960.000ns
           %5232 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 8.832us
                 -->kernel: 0:7 %3808 =  [] -> 8.832us
     %5233 = :autograd::engine::evaluate_function: ViewBackward0 None -> 52.576us
       %5234 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.576us
                 -->kernel: 0:7 %3809 =  [] -> 52.576us
     %5235 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 89.217us
       %5236 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 37.376us
         %5237 = :aten::ones_like [[], [], [], [], [], []] -> 1.312us
           %5238 = :aten::fill_ [[], []] -> 1.312us
                 -->kernel: 0:7 %3810 =  [] -> 1.312us
         %5239 = :aten::mul [[], [1]] -> 1.504us
                 -->kernel: 0:7 %3811 =  [] -> 1.504us
       %5240 = :aten::sum [[1], []] -> 2.656us
         %5241 = :aten::sum [[1], [], [], []] -> 2.656us
                 -->kernel: 0:7 %3812 =  [] -> 2.656us
     %5242 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.472us
       %5243 = :DivBackward0 [[]] -> 1.472us
         %5244 = :aten::div [[], []] -> 1.472us
                 -->kernel: 0:7 %3813 =  [] -> 1.472us
     %5245 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.272us
       %5246 = :FusedAuxLossBackward [[]] -> 2.272us
         %5247 = :nvte_fused_moe_aux_loss_backward [] -> 2.272us
                 -->kernel: 0:7 %3814 =  [] -> 2.272us
     %5248 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 62.144us
       %5249 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 62.144us
         %5250 = :aten::zeros [[], [], [], [], []] -> 1.216us
           %5251 = :aten::zero_ [[4096, 32]] -> 1.216us
             %5252 = :aten::fill_ [[4096, 32], []] -> 1.216us
                 -->kernel: 0:7 %3815 =  [] -> 1.216us
         %5253 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.992us
                 -->kernel: 0:7 %3816 =  [] -> 12.992us
     %5254 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 105.249us
       %5255 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 57.280us
         %5256 = :aten::zeros [[], [], [], [], []] -> 1.152us
           %5257 = :aten::zero_ [[4096, 32]] -> 1.152us
             %5258 = :aten::fill_ [[4096, 32], []] -> 1.152us
                 -->kernel: 0:7 %3817 =  [] -> 1.152us
         %5259 = :nvte_fused_topk_with_score_function_backward [] -> 13.728us
                 -->kernel: 0:7 %3818 =  [] -> 13.728us
       %5260 = :aten::add [[4096, 32], [4096, 32], []] -> 1.696us
                 -->kernel: 0:7 %3819 =  [] -> 1.696us
     %5261 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 800.610us
       %5262 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 702.753us
         %5263 = :aten::to [[32, 7168], [], [], [], []] -> 6.336us
           %5264 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.336us
             %5265 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.336us
                 -->kernel: 0:7 %3820 =  [] -> 6.336us
         %5266 = :nvte_cublas_gemm_scaled [] -> 84.192us
                 -->kernel: 0:7 %3821 =  [] -> 68.000us
         %5267 = :aten::to [[4096, 7168], [], [], [], []] -> 176.353us
           %5268 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 176.353us
             %5269 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 176.353us
                 -->kernel: 0:7 %3822 =  [] -> 176.353us
         %5270 = :nvte_cublas_gemm_scaled [] -> 82.176us
                 -->kernel: 0:7 %3823 =  [] -> 82.176us
         %5271 = :aten::to [[4096, 7168], [], [], [], []] -> 43.584us
           %5272 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.584us
             %5273 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.584us
                 -->kernel: 0:7 %3824 =  [] -> 43.584us
         %5274 = :aten::to [[32, 7168], [], [], [], []] -> 2.080us
           %5275 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.080us
             %5276 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.080us
                 -->kernel: 0:7 %3825 =  [] -> 2.080us
       %5277 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.008us
                 -->kernel: 0:7 %3826 =  [] -> 51.008us
     %5278 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.016us
       %5279 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.016us
                 -->kernel: 0:35 %3827 =  [] -> 2.016us
     %5280 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 321.249us
       %5281 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 198.497us
         %5282 = :nvte_rmsnorm_bwd [] -> 198.497us
                 -->kernel: 0:7 %3828 =  [] -> 167.169us
                 -->kernel: 0:7 %3829 =  [] -> 8.096us
       %5283 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.720us
                 -->kernel: 0:7 %3830 =  [] -> 50.720us
     %5284 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.536us
       %5285 = :aten::add_ [[7168], [7168], []] -> 1.536us
                 -->kernel: 0:35 %3831 =  [] -> 1.536us
     %5286 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.282ms
       %5287 = :_LinearBackward [[4096, 1, 7168]] -> 7.282ms
         %5288 = :_Linear_backward [] -> 7.282ms
           %5289 = :nvte_quantize_v2 [] -> 73.376us
             %5290 = :quantize_transpose_vector_blockwise [] -> 73.376us
                 -->kernel: 0:7 %3832 =  [] -> 73.376us
           %5291 = :nvte_quantize_v2 [] -> 110.112us
             %5292 = :quantize_transpose_vector_blockwise [] -> 110.112us
                 -->kernel: 0:7 %3833 =  [] -> 110.112us
           %5293 = :nvte_cublas_gemm_scaled [] -> 3.440ms
                 -->kernel: 0:7 %3834 =  [] -> 3.434ms
           %5294 = :nvte_cublas_gemm_scaled [] -> 3.440ms
                 -->kernel: 0:7 %3835 =  [] -> 3.433ms
     %5295 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.917ms
       %5296 = :BmmBackward0 [[128, 4096, 128]] -> 7.917ms
         %5297 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.982ms
                 -->kernel: 0:7 %3836 =  [] -> 3.970ms
         %5298 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.882ms
                 -->kernel: 0:7 %3837 =  [] -> 3.874ms
     %5299 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.950ms
       %5300 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.950ms
         %5301 = :nvte_scaled_softmax_backward [] -> 6.950ms
                 -->kernel: 0:7 %3838 =  [] -> 6.950ms
     %5302 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.215ms
       %5303 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.215ms
         %5304 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.949ms
                 -->kernel: 0:7 %3839 =  [] -> 5.939ms
         %5305 = :aten::mul [[128, 4096, 192], []] -> 114.816us
           %5306 = :aten::mul [[128, 4096, 192], []] -> 114.816us
                 -->kernel: 0:7 %3840 =  [] -> 114.816us
         %5307 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.874ms
                 -->kernel: 0:7 %3841 =  [] -> 5.867ms
         %5308 = :aten::mul [[128, 192, 4096], []] -> 115.072us
           %5309 = :aten::mul [[128, 192, 4096], []] -> 115.072us
                 -->kernel: 0:7 %3842 =  [] -> 115.072us
     %5310 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.467ms
       %5311 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.467ms
         %5312 = :aten::contiguous [[4096, 1, 128, 192], []] -> 744.802us
           %5313 = :aten::clone [[4096, 1, 128, 192], []] -> 744.802us
             %5314 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 744.802us
                 -->kernel: 0:7 %3843 =  [] -> 744.802us
         %5315 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.576us
           %5316 = :aten::clone [[4096, 1, 128, 128], []] -> 280.576us
             %5317 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.576us
                 -->kernel: 0:7 %3844 =  [] -> 280.576us
                 -->kernel: 0:7 %3845 =  [] -> 172.672us
     %5318 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 649.569us
       %5319 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 649.569us
         %5320 = :aten::contiguous [[4096, 1, 128, 192], []] -> 422.977us
           %5321 = :aten::clone [[4096, 1, 128, 192], []] -> 422.977us
             %5322 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 422.977us
                 -->kernel: 0:7 %3846 =  [] -> 422.977us
                 -->kernel: 0:7 %3847 =  [] -> 118.848us
     %5323 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.735ms
       %5324 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.735ms
         %5325 = :_LayerNormLinear_backward [] -> 1.735ms
           %5326 = :nvte_quantize_v2 [] -> 324.321us
             %5327 = :quantize_transpose_vector_blockwise [] -> 324.321us
                 -->kernel: 0:7 %3848 =  [] -> 324.321us
           %5328 = :nvte_cublas_gemm_scaled [] -> 563.873us
                 -->kernel: 0:7 %3849 =  [] -> 519.265us
                 -->kernel: 0:7 %3850 =  [] -> 18.912us
           %5329 = :nvte_cublas_gemm_scaled [] -> 527.874us
                 -->kernel: 0:7 %3851 =  [] -> 521.570us
           %5330 = :nvte_rmsnorm_bwd [] -> 21.536us
                 -->kernel: 0:7 %3852 =  [] -> 5.920us
                 -->kernel: 0:7 %3853 =  [] -> 3.072us
     %5331 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.080us
       %5332 = :aten::add_ [[512], [512], []] -> 2.080us
                 -->kernel: 0:35 %3854 =  [] -> 2.080us
     %5333 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.792ms
       %5334 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.792ms
         %5335 = :_LayerNormLinear_backward [] -> 2.792ms
           %5336 = :nvte_quantize_v2 [] -> 243.840us
             %5337 = :quantize_transpose_vector_blockwise [] -> 243.840us
                 -->kernel: 0:7 %3855 =  [] -> 243.840us
           %5338 = :nvte_cublas_gemm_scaled [] -> 1.117ms
                 -->kernel: 0:7 %3856 =  [] -> 1.109ms
           %5339 = :nvte_cublas_gemm_scaled [] -> 1.121ms
                 -->kernel: 0:7 %3857 =  [] -> 1.116ms
           %5340 = :nvte_rmsnorm_bwd [] -> 54.976us
                 -->kernel: 0:7 %3858 =  [] -> 23.168us
                 -->kernel: 0:7 %3859 =  [] -> 20.704us
     %5341 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.760us
       %5342 = :aten::add_ [[1536], [1536], []] -> 1.760us
                 -->kernel: 0:35 %3860 =  [] -> 1.760us
     %5343 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.080us
       %5344 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.080us
         %5345 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.080us
                 -->kernel: 0:7 %3861 =  [] -> 10.080us
     %5346 = :autograd::engine::evaluate_function: _LinearBackward None -> 440.577us
       %5347 = :_LinearBackward [[4096, 1, 576]] -> 440.577us
         %5348 = :_Linear_backward [] -> 440.577us
           %5349 = :nvte_quantize_v2 [] -> 14.688us
             %5350 = :quantize_transpose_vector_blockwise [] -> 14.688us
                 -->kernel: 0:7 %3862 =  [] -> 14.688us
           %5351 = :nvte_cublas_gemm_scaled [] -> 147.488us
                 -->kernel: 0:7 %3863 =  [] -> 141.664us
           %5352 = :nvte_cublas_gemm_scaled [] -> 139.296us
                 -->kernel: 0:7 %3864 =  [] -> 133.312us
     %5353 = :autograd::engine::evaluate_function: _LinearBackward None -> 974.626us
       %5354 = :_LinearBackward [[4096, 1, 1536]] -> 817.218us
         %5355 = :_Linear_backward [] -> 817.218us
           %5356 = :nvte_quantize_v2 [] -> 18.368us
             %5357 = :quantize_transpose_vector_blockwise [] -> 18.368us
                 -->kernel: 0:7 %3865 =  [] -> 18.368us
           %5358 = :nvte_cublas_gemm_scaled [] -> 335.713us
                 -->kernel: 0:7 %3866 =  [] -> 329.697us
           %5359 = :nvte_cublas_gemm_scaled [] -> 341.793us
                 -->kernel: 0:7 %3867 =  [] -> 337.921us
       %5360 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.600us
                 -->kernel: 0:7 %3868 =  [] -> 49.600us
     %5361 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 320.160us
       %5362 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 197.024us
         %5363 = :nvte_rmsnorm_bwd [] -> 197.024us
                 -->kernel: 0:7 %3869 =  [] -> 165.952us
                 -->kernel: 0:7 %3870 =  [] -> 7.808us
       %5364 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 48.928us
                 -->kernel: 0:7 %3871 =  [] -> 48.928us
     %5365 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.664us
       %5366 = :aten::add_ [[7168], [7168], []] -> 1.664us
                 -->kernel: 0:35 %3872 =  [] -> 1.664us
     %5367 = :autograd::engine::evaluate_function: _LinearBackward None -> 6.211ms
       %5368 = :_LinearBackward [[4096, 1, 7168]] -> 6.211ms
         %5369 = :_Linear_backward [] -> 6.211ms
           %5370 = :nvte_quantize_v2 [] -> 73.952us
             %5371 = :quantize_transpose_vector_blockwise [] -> 73.952us
                 -->kernel: 0:7 %3873 =  [] -> 73.952us
           %5372 = :nvte_cublas_gemm_scaled [] -> 2.990ms
                 -->kernel: 0:7 %3874 =  [] -> 2.984ms
           %5373 = :nvte_cublas_gemm_scaled [] -> 3.006ms
                 -->kernel: 0:7 %3875 =  [] -> 3.000ms
     %5374 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 381.569us
       %5375 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 381.569us
         %5376 = :aten::contiguous [[4096, 1, 7168], []] -> 115.073us
           %5377 = :aten::clone [[4096, 1, 7168], []] -> 115.073us
             %5378 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 115.073us
                 -->kernel: 0:7 %3876 =  [] -> 115.073us
         %5379 = :nvte_rmsnorm_bwd [] -> 192.128us
                 -->kernel: 0:7 %3877 =  [] -> 167.392us
                 -->kernel: 0:7 %3878 =  [] -> 7.680us
     %5380 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %5381 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %3879 =  [] -> 1.568us
     %5382 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 377.377us
       %5383 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 377.377us
         %5384 = :aten::contiguous [[4096, 1, 7168], []] -> 116.256us
           %5385 = :aten::clone [[4096, 1, 7168], []] -> 116.256us
             %5386 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 116.256us
                 -->kernel: 0:7 %3880 =  [] -> 116.256us
         %5387 = :nvte_rmsnorm_bwd [] -> 191.233us
                 -->kernel: 0:7 %3881 =  [] -> 166.657us
                 -->kernel: 0:7 %3882 =  [] -> 8.000us
     %5388 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %5389 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %3883 =  [] -> 1.600us
     %5390 = :autograd::engine::evaluate_function: MakeViewlessTensorBackward None -> 50.336us
       %5391 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.336us
                 -->kernel: 0:7 %3884 =  [] -> 50.336us
     %5392 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 1.377ms
       %5393 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.377ms
         %5394 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.377ms
           %5395 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.377ms
             %5396 = :aten::arange [[], [], [], [], []] -> 1.184us
               %5397 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %3885 =  [] -> 1.184us
             %5398 = CCCL:cub::DeviceRadixSort [] -> 186.464us
                 -->kernel: 0:7 %3886 =  [] -> 3.616us
                 -->kernel: 0:7 %3887 =  [] -> 1.568us
                 -->kernel: 0:7 %3888 =  [] -> 7.616us
                 -->kernel: 0:7 %3889 =  [] -> 7.072us
                 -->kernel: 0:7 %3890 =  [] -> 6.976us
                 -->kernel: 0:7 %3891 =  [] -> 7.200us
                 -->kernel: 0:7 %3892 =  [] -> 7.072us
                 -->kernel: 0:7 %3893 =  [] -> 6.880us
                 -->kernel: 0:7 %3894 =  [] -> 6.944us
                 -->kernel: 0:7 %3895 =  [] -> 7.040us
             %5399 = :aten::zeros [[], [], [], [], []] -> 544.673us
               %5400 = :aten::zero_ [[129280, 7168]] -> 544.673us
                 %5401 = :aten::fill_ [[129280, 7168], []] -> 544.673us
                 -->kernel: 0:7 %3896 =  [] -> 544.673us
             %5402 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 17.184us
                 -->kernel: 0:7 %3897 =  [] -> 1.248us
                 -->kernel: 0:7 %3898 =  [] -> 3.968us
                 -->kernel: 0:7 %3899 =  [] -> 1.664us
             %5403 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 18.752us
                 -->kernel: 0:7 %3900 =  [] -> 1.568us
                 -->kernel: 0:7 %3901 =  [] -> 3.072us
                 -->kernel: 0:7 %3902 =  [] -> 1.344us
                 -->kernel: 0:7 %3903 =  [] -> 1.952us
                 -->kernel: 0:7 %3904 =  [] -> 224.064us
                 -->kernel: 0:7 %3905 =  [] -> 166.337us
     %5404 = :autograd::engine::evaluate_function: SplitBackward0 None -> 35.424us
       %5405 = :SplitBackward0 [[4096, 1, 7168]] -> 35.424us
         %5406 = :aten::cat [[4096, 1, 7168], []] -> 35.424us
     %5407 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 194.689us
       %5408 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 194.689us
         %5409 = :nvte_rmsnorm_bwd [] -> 194.689us
                 -->kernel: 0:7 %3906 =  [] -> 167.745us
                 -->kernel: 0:7 %3907 =  [] -> 7.904us
     %5410 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %5411 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %3908 =  [] -> 1.568us
     %5412 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 848.354us
       %5413 = :FusedCombineBackward [[4096, 7168], []] -> 848.354us
                 -->kernel: 0:26 %3909 =  [] -> 8.224us
                 -->kernel: 0:26 %3910 =  [] -> 787.042us
     %5414 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 201.505us
       %5415 = :_moe_unpermute_mask_mapBackward [[15870, 7168]] -> 201.505us
                 -->kernel: 0:7 %3911 =  [] -> 201.505us
     %5416 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.492ms
       %5417 = :_GroupedLinearBackward [[33040, 7168]] -> 8.492ms
         %5418 = :_GroupedLinear_backward [] -> 8.492ms
           %5419 = :nvte_quantize_v2 [] -> 222.336us
             %5420 = :quantize_transpose_vector_blockwise [] -> 222.336us
                 -->kernel: 0:7 %3912 =  [] -> 222.336us
           %5421 = :nvte_quantize_v2 [] -> 218.945us
             %5422 = :quantize_transpose_vector_blockwise [] -> 218.945us
                 -->kernel: 0:7 %3913 =  [] -> 218.945us
           %5423 = :nvte_quantize_v2 [] -> 223.968us
             %5424 = :quantize_transpose_vector_blockwise [] -> 223.968us
                 -->kernel: 0:7 %3914 =  [] -> 223.968us
           %5425 = :nvte_quantize_v2 [] -> 144.353us
             %5426 = :quantize_transpose_vector_blockwise [] -> 144.353us
                 -->kernel: 0:7 %3915 =  [] -> 144.353us
           %5427 = :nvte_multi_stream_cublas_gemm [] -> 3.713ms
             %5428 = :nvte_cublas_gemm [] -> 916.962us
                 -->kernel: 0:159 %3916 =  [] -> 906.978us
             %5429 = :nvte_cublas_gemm [] -> 910.050us
                 -->kernel: 0:160 %3917 =  [] -> 905.186us
             %5430 = :nvte_cublas_gemm [] -> 910.818us
                 -->kernel: 0:161 %3918 =  [] -> 906.594us
             %5431 = :nvte_cublas_gemm [] -> 911.106us
                 -->kernel: 0:162 %3919 =  [] -> 906.082us
           %5432 = :nvte_multi_stream_cublas_gemm [] -> 3.677ms
             %5433 = :nvte_cublas_gemm [] -> 909.570us
                 -->kernel: 0:159 %3920 =  [] -> 903.394us
             %5434 = :nvte_cublas_gemm [] -> 893.858us
                 -->kernel: 0:160 %3921 =  [] -> 889.154us
             %5435 = :nvte_cublas_gemm [] -> 906.818us
                 -->kernel: 0:161 %3922 =  [] -> 903.330us
             %5436 = :nvte_cublas_gemm [] -> 905.667us
                 -->kernel: 0:162 %3923 =  [] -> 902.531us
     %5437 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 596.161us
       %5438 = :WeightedSwiGLUFunctionBackward [[33040, 2048]] -> 596.161us
         %5439 = :Torch-Compiled Region: 4/1 None -> 596.161us
           %5440 = :triton_poi_fused__to_copy_cat_0 [[33040, 2048], [33040, 1], [33040, 4096], [33040, 4096], [], []] -> 405.473us
                 -->kernel: 0:7 %3924 =  [] -> 405.473us
           %5441 = :triton_red_fused__to_copy_mul_silu_sum_1 [[33040, 4096], [33040, 2048], [33040, 1], [], [], [], []] -> 131.712us
                 -->kernel: 0:7 %3925 =  [] -> 131.712us
     %5442 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.754ms
       %5443 = :_GroupedLinearBackward [[33040, 4096]] -> 14.754ms
         %5444 = :_GroupedLinear_backward [] -> 14.754ms
           %5445 = :nvte_quantize_v2 [] -> 126.656us
             %5446 = :quantize_transpose_vector_blockwise [] -> 126.656us
                 -->kernel: 0:7 %3926 =  [] -> 126.656us
           %5447 = :nvte_quantize_v2 [] -> 129.121us
             %5448 = :quantize_transpose_vector_blockwise [] -> 129.121us
                 -->kernel: 0:7 %3927 =  [] -> 129.121us
           %5449 = :nvte_quantize_v2 [] -> 132.608us
             %5450 = :quantize_transpose_vector_blockwise [] -> 132.608us
                 -->kernel: 0:7 %3928 =  [] -> 132.608us
           %5451 = :nvte_quantize_v2 [] -> 85.824us
             %5452 = :quantize_transpose_vector_blockwise [] -> 85.824us
                 -->kernel: 0:7 %3929 =  [] -> 85.824us
           %5453 = :nvte_multi_stream_cublas_gemm [] -> 7.026ms
             %5454 = :nvte_cublas_gemm [] -> 1.752ms
                 -->kernel: 0:159 %3930 =  [] -> 1.745ms
             %5455 = :nvte_cublas_gemm [] -> 1.715ms
                 -->kernel: 0:160 %3931 =  [] -> 1.711ms
             %5456 = :nvte_cublas_gemm [] -> 1.748ms
                 -->kernel: 0:161 %3932 =  [] -> 1.744ms
             %5457 = :nvte_cublas_gemm [] -> 1.748ms
                 -->kernel: 0:162 %3933 =  [] -> 1.744ms
           %5458 = :nvte_multi_stream_cublas_gemm [] -> 6.983ms
             %5459 = :nvte_cublas_gemm [] -> 1.739ms
                 -->kernel: 0:159 %3934 =  [] -> 1.731ms
             %5460 = :nvte_cublas_gemm [] -> 1.710ms
                 -->kernel: 0:160 %3935 =  [] -> 1.706ms
             %5461 = :nvte_cublas_gemm [] -> 1.734ms
                 -->kernel: 0:161 %3936 =  [] -> 1.730ms
             %5462 = :nvte_cublas_gemm [] -> 1.734ms
                 -->kernel: 0:162 %3937 =  [] -> 1.730ms
     %5463 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 385.569us
       %5464 = :_moe_permute_mask_mapBackward [[33040, 7168], [], [33040]] -> 385.569us
         %5465 = :aten::zeros [[], [], [], [], []] -> 1.280us
           %5466 = :aten::zero_ [[15870, 9]] -> 1.280us
             %5467 = :aten::fill_ [[15870, 9], []] -> 1.280us
                 -->kernel: 0:7 %3938 =  [] -> 1.280us
                 -->kernel: 0:7 %3939 =  [] -> 214.145us
     %5468 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 96.320us
       %5469 = :IndicesToMultihotBackward [[], [15870, 4]] -> 96.320us
         %5470 = :aten::zeros [[], [], [], [], []] -> 1.408us
           %5471 = :aten::zero_ [[15870, 4]] -> 1.408us
             %5472 = :aten::fill_ [[15870, 4], []] -> 1.408us
                 -->kernel: 0:7 %3940 =  [] -> 1.408us
                 -->kernel: 0:7 %3941 =  [] -> 11.392us
     %5473 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.156ms
       %5474 = :_LinearBackward [[4096, 1, 7168]] -> 1.156ms
         %5475 = :_Linear_backward [] -> 1.156ms
           %5476 = :nvte_quantize_v2 [] -> 72.736us
             %5477 = :quantize_transpose_vector_blockwise [] -> 72.736us
                 -->kernel: 0:7 %3942 =  [] -> 72.736us
           %5478 = :nvte_cublas_gemm_scaled [] -> 467.009us
                 -->kernel: 0:7 %3943 =  [] -> 458.881us
           %5479 = :nvte_cublas_gemm_scaled [] -> 455.393us
                 -->kernel: 0:7 %3944 =  [] -> 450.049us
     %5480 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 47.168us
       %5481 = :SwiGLUFunctionBackward [[4096, 2048]] -> 47.168us
         %5482 = :Torch-Compiled Region: 5/0 None -> 47.168us
           %5483 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 47.168us
                 -->kernel: 0:7 %3945 =  [] -> 47.168us
     %5484 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.016ms
       %5485 = :_LinearBackward [[4096, 1, 4096]] -> 2.016ms
         %5486 = :_Linear_backward [] -> 2.016ms
           %5487 = :nvte_quantize_v2 [] -> 44.448us
             %5488 = :quantize_transpose_vector_blockwise [] -> 44.448us
                 -->kernel: 0:7 %3946 =  [] -> 44.448us
           %5489 = :nvte_quantize_v2 [] -> 52.864us
             %5490 = :quantize_transpose_vector_blockwise [] -> 52.864us
                 -->kernel: 0:7 %3947 =  [] -> 52.864us
           %5491 = :nvte_cublas_gemm_scaled [] -> 866.114us
                 -->kernel: 0:7 %3948 =  [] -> 860.034us
           %5492 = :nvte_cublas_gemm_scaled [] -> 866.114us
                 -->kernel: 0:7 %3949 =  [] -> 860.066us
     %5493 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 889.986us
       %5494 = :FusedDispatchBackward [[15870, 7168], [], [15870, 8], [], []] -> 889.986us
         %5495 = :aten::zeros [[], [], [], [], []] -> 1.472us
           %5496 = :aten::zero_ [[15870, 8]] -> 1.472us
             %5497 = :aten::fill_ [[15870, 8], []] -> 1.472us
                 -->kernel: 0:7 %3950 =  [] -> 1.472us
                 -->kernel: 0:26 %3951 =  [] -> 13.664us
                 -->kernel: 0:26 %3952 =  [] -> 703.714us
     %5498 = :autograd::engine::evaluate_function: TopkBackward0 None -> 57.376us
       %5499 = :TopkBackward0 [[4096, 8]] -> 57.376us
         %5500 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 57.376us
           %5501 = :aten::zeros [[], [], [], [], []] -> 960.000ns
             %5502 = :aten::zero_ [[4096, 32]] -> 960.000ns
               %5503 = :aten::fill_ [[4096, 32], []] -> 960.000ns
                 -->kernel: 0:7 %3953 =  [] -> 960.000ns
           %5504 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 9.312us
                 -->kernel: 0:7 %3954 =  [] -> 9.312us
     %5505 = :autograd::engine::evaluate_function: ViewBackward0 None -> 53.152us
       %5506 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 53.152us
                 -->kernel: 0:7 %3955 =  [] -> 53.152us
     %5507 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 87.552us
       %5508 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 35.840us
         %5509 = :aten::ones_like [[], [], [], [], [], []] -> 1.216us
           %5510 = :aten::fill_ [[], []] -> 1.216us
                 -->kernel: 0:7 %3956 =  [] -> 1.216us
         %5511 = :aten::mul [[], [1]] -> 1.472us
                 -->kernel: 0:7 %3957 =  [] -> 1.472us
       %5512 = :aten::sum [[1], []] -> 2.432us
         %5513 = :aten::sum [[1], [], [], []] -> 2.432us
                 -->kernel: 0:7 %3958 =  [] -> 2.432us
     %5514 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.408us
       %5515 = :DivBackward0 [[]] -> 1.408us
         %5516 = :aten::div [[], []] -> 1.408us
                 -->kernel: 0:7 %3959 =  [] -> 1.408us
     %5517 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.176us
       %5518 = :FusedAuxLossBackward [[]] -> 2.176us
         %5519 = :nvte_fused_moe_aux_loss_backward [] -> 2.176us
                 -->kernel: 0:7 %3960 =  [] -> 2.176us
     %5520 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 69.504us
       %5521 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 69.504us
         %5522 = :aten::zeros [[], [], [], [], []] -> 1.216us
           %5523 = :aten::zero_ [[4096, 32]] -> 1.216us
             %5524 = :aten::fill_ [[4096, 32], []] -> 1.216us
                 -->kernel: 0:7 %3961 =  [] -> 1.216us
         %5525 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.864us
                 -->kernel: 0:7 %3962 =  [] -> 12.864us
     %5526 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 97.088us
       %5527 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 55.488us
         %5528 = :aten::zeros [[], [], [], [], []] -> 1.152us
           %5529 = :aten::zero_ [[4096, 32]] -> 1.152us
             %5530 = :aten::fill_ [[4096, 32], []] -> 1.152us
                 -->kernel: 0:7 %3963 =  [] -> 1.152us
         %5531 = :nvte_fused_topk_with_score_function_backward [] -> 13.664us
                 -->kernel: 0:7 %3964 =  [] -> 13.664us
       %5532 = :aten::add [[4096, 32], [4096, 32], []] -> 1.632us
                 -->kernel: 0:7 %3965 =  [] -> 1.632us
     %5533 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 810.754us
       %5534 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 711.810us
         %5535 = :aten::to [[32, 7168], [], [], [], []] -> 6.432us
           %5536 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.432us
             %5537 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.432us
                 -->kernel: 0:7 %3966 =  [] -> 6.432us
         %5538 = :nvte_cublas_gemm_scaled [] -> 83.424us
                 -->kernel: 0:7 %3967 =  [] -> 67.840us
         %5539 = :aten::to [[4096, 7168], [], [], [], []] -> 176.768us
           %5540 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 176.768us
             %5541 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 176.768us
                 -->kernel: 0:7 %3968 =  [] -> 176.768us
         %5542 = :nvte_cublas_gemm_scaled [] -> 82.433us
                 -->kernel: 0:7 %3969 =  [] -> 82.433us
         %5543 = :aten::to [[4096, 7168], [], [], [], []] -> 43.680us
           %5544 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.680us
             %5545 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.680us
                 -->kernel: 0:7 %3970 =  [] -> 43.680us
         %5546 = :aten::to [[32, 7168], [], [], [], []] -> 2.144us
           %5547 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.144us
             %5548 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.144us
                 -->kernel: 0:7 %3971 =  [] -> 2.144us
       %5549 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.888us
                 -->kernel: 0:7 %3972 =  [] -> 49.888us
     %5550 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.144us
       %5551 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.144us
                 -->kernel: 0:35 %3973 =  [] -> 2.144us
     %5552 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 336.289us
       %5553 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 201.504us
         %5554 = :nvte_rmsnorm_bwd [] -> 201.504us
                 -->kernel: 0:7 %3974 =  [] -> 166.976us
                 -->kernel: 0:7 %3975 =  [] -> 7.776us
       %5555 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.073us
                 -->kernel: 0:7 %3976 =  [] -> 51.073us
     %5556 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.536us
       %5557 = :aten::add_ [[7168], [7168], []] -> 1.536us
                 -->kernel: 0:35 %3977 =  [] -> 1.536us
     %5558 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.248ms
       %5559 = :_LinearBackward [[4096, 1, 7168]] -> 7.248ms
         %5560 = :_Linear_backward [] -> 7.248ms
           %5561 = :nvte_quantize_v2 [] -> 73.760us
             %5562 = :quantize_transpose_vector_blockwise [] -> 73.760us
                 -->kernel: 0:7 %3978 =  [] -> 73.760us
           %5563 = :nvte_quantize_v2 [] -> 110.240us
             %5564 = :quantize_transpose_vector_blockwise [] -> 110.240us
                 -->kernel: 0:7 %3979 =  [] -> 110.240us
           %5565 = :nvte_cublas_gemm_scaled [] -> 3.435ms
                 -->kernel: 0:7 %3980 =  [] -> 3.428ms
           %5566 = :nvte_cublas_gemm_scaled [] -> 3.428ms
                 -->kernel: 0:7 %3981 =  [] -> 3.422ms
     %5567 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.904ms
       %5568 = :BmmBackward0 [[128, 4096, 128]] -> 7.904ms
         %5569 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.975ms
                 -->kernel: 0:7 %3982 =  [] -> 3.964ms
         %5570 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.872ms
                 -->kernel: 0:7 %3983 =  [] -> 3.863ms
     %5571 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 7.015ms
       %5572 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 7.015ms
         %5573 = :nvte_scaled_softmax_backward [] -> 7.015ms
                 -->kernel: 0:7 %3984 =  [] -> 7.015ms
     %5574 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.206ms
       %5575 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.206ms
         %5576 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.936ms
                 -->kernel: 0:7 %3985 =  [] -> 5.927ms
         %5577 = :aten::mul [[128, 4096, 192], []] -> 114.881us
           %5578 = :aten::mul [[128, 4096, 192], []] -> 114.881us
                 -->kernel: 0:7 %3986 =  [] -> 114.881us
         %5579 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.862ms
                 -->kernel: 0:7 %3987 =  [] -> 5.856ms
         %5580 = :aten::mul [[128, 192, 4096], []] -> 114.976us
           %5581 = :aten::mul [[128, 192, 4096], []] -> 114.976us
                 -->kernel: 0:7 %3988 =  [] -> 114.976us
     %5582 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.471ms
       %5583 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.471ms
         %5584 = :aten::contiguous [[4096, 1, 128, 192], []] -> 745.089us
           %5585 = :aten::clone [[4096, 1, 128, 192], []] -> 745.089us
             %5586 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 745.089us
                 -->kernel: 0:7 %3989 =  [] -> 745.089us
         %5587 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.929us
           %5588 = :aten::clone [[4096, 1, 128, 128], []] -> 280.929us
             %5589 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.929us
                 -->kernel: 0:7 %3990 =  [] -> 280.929us
                 -->kernel: 0:7 %3991 =  [] -> 172.480us
     %5590 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 640.642us
       %5591 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 640.642us
         %5592 = :aten::contiguous [[4096, 1, 128, 192], []] -> 422.945us
           %5593 = :aten::clone [[4096, 1, 128, 192], []] -> 422.945us
             %5594 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 422.945us
                 -->kernel: 0:7 %3992 =  [] -> 422.945us
                 -->kernel: 0:7 %3993 =  [] -> 118.976us
     %5595 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.742ms
       %5596 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.742ms
         %5597 = :_LayerNormLinear_backward [] -> 1.742ms
           %5598 = :nvte_quantize_v2 [] -> 324.129us
             %5599 = :quantize_transpose_vector_blockwise [] -> 324.129us
                 -->kernel: 0:7 %3994 =  [] -> 324.129us
           %5600 = :nvte_cublas_gemm_scaled [] -> 567.618us
                 -->kernel: 0:7 %3995 =  [] -> 520.962us
                 -->kernel: 0:7 %3996 =  [] -> 19.136us
           %5601 = :nvte_cublas_gemm_scaled [] -> 527.489us
                 -->kernel: 0:7 %3997 =  [] -> 521.537us
           %5602 = :nvte_rmsnorm_bwd [] -> 21.632us
                 -->kernel: 0:7 %3998 =  [] -> 6.656us
                 -->kernel: 0:7 %3999 =  [] -> 3.136us
     %5603 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.984us
       %5604 = :aten::add_ [[512], [512], []] -> 1.984us
                 -->kernel: 0:35 %4000 =  [] -> 1.984us
     %5605 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.789ms
       %5606 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.789ms
         %5607 = :_LayerNormLinear_backward [] -> 2.789ms
           %5608 = :nvte_quantize_v2 [] -> 244.257us
             %5609 = :quantize_transpose_vector_blockwise [] -> 244.257us
                 -->kernel: 0:7 %4001 =  [] -> 244.257us
           %5610 = :nvte_cublas_gemm_scaled [] -> 1.120ms
                 -->kernel: 0:7 %4002 =  [] -> 1.113ms
           %5611 = :nvte_cublas_gemm_scaled [] -> 1.122ms
                 -->kernel: 0:7 %4003 =  [] -> 1.116ms
           %5612 = :nvte_rmsnorm_bwd [] -> 56.128us
                 -->kernel: 0:7 %4004 =  [] -> 23.168us
                 -->kernel: 0:7 %4005 =  [] -> 20.352us
     %5613 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.632us
       %5614 = :aten::add_ [[1536], [1536], []] -> 1.632us
                 -->kernel: 0:35 %4006 =  [] -> 1.632us
     %5615 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.016us
       %5616 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.016us
         %5617 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.016us
                 -->kernel: 0:7 %4007 =  [] -> 10.016us
     %5618 = :autograd::engine::evaluate_function: _LinearBackward None -> 439.777us
       %5619 = :_LinearBackward [[4096, 1, 576]] -> 439.777us
         %5620 = :_Linear_backward [] -> 439.777us
           %5621 = :nvte_quantize_v2 [] -> 14.400us
             %5622 = :quantize_transpose_vector_blockwise [] -> 14.400us
                 -->kernel: 0:7 %4008 =  [] -> 14.400us
           %5623 = :nvte_cublas_gemm_scaled [] -> 148.000us
                 -->kernel: 0:7 %4009 =  [] -> 141.056us
           %5624 = :nvte_cublas_gemm_scaled [] -> 139.456us
                 -->kernel: 0:7 %4010 =  [] -> 133.504us
     %5625 = :autograd::engine::evaluate_function: _LinearBackward None -> 983.651us
       %5626 = :_LinearBackward [[4096, 1, 1536]] -> 822.786us
         %5627 = :_Linear_backward [] -> 822.786us
           %5628 = :nvte_quantize_v2 [] -> 18.400us
             %5629 = :quantize_transpose_vector_blockwise [] -> 18.400us
                 -->kernel: 0:7 %4011 =  [] -> 18.400us
           %5630 = :nvte_cublas_gemm_scaled [] -> 336.672us
                 -->kernel: 0:7 %4012 =  [] -> 330.368us
           %5631 = :nvte_cublas_gemm_scaled [] -> 343.584us
                 -->kernel: 0:7 %4013 =  [] -> 338.592us
       %5632 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.728us
                 -->kernel: 0:7 %4014 =  [] -> 49.728us
     %5633 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 319.137us
       %5634 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 194.785us
         %5635 = :nvte_rmsnorm_bwd [] -> 194.785us
                 -->kernel: 0:7 %4015 =  [] -> 165.857us
                 -->kernel: 0:7 %4016 =  [] -> 7.872us
       %5636 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.920us
                 -->kernel: 0:7 %4017 =  [] -> 49.920us
     %5637 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.536us
       %5638 = :aten::add_ [[7168], [7168], []] -> 1.536us
                 -->kernel: 0:35 %4018 =  [] -> 1.536us
     %5639 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.960ms
       %5640 = :_LinearBackward [[4096, 1, 7168]] -> 7.960ms
         %5641 = :_Linear_backward [] -> 7.960ms
           %5642 = :nvte_quantize_v2 [] -> 73.920us
             %5643 = :quantize_transpose_vector_blockwise [] -> 73.920us
                 -->kernel: 0:7 %4019 =  [] -> 73.920us
           %5644 = :nvte_cublas_gemm_scaled [] -> 3.876ms
                 -->kernel: 0:7 %4020 =  [] -> 3.870ms
           %5645 = :nvte_cublas_gemm_scaled [] -> 3.859ms
                 -->kernel: 0:7 %4021 =  [] -> 3.851ms
     %5646 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 844.706us
       %5647 = :SwiGLUFunctionBackward [[4096, 18432]] -> 844.706us
         %5648 = :Torch-Compiled Region: 5/1 None -> 844.706us
           %5649 = :triton_poi_fused_cat_0 [[4096, 18432], [4096, 36864], [4096, 36864], [], [], [], [], []] -> 844.706us
                 -->kernel: 0:7 %4022 =  [] -> 844.706us
     %5650 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 16.381ms
       %5651 = :_LayerNormLinearBackward [[4096, 1, 36864]] -> 16.202ms
         %5652 = :_LayerNormLinear_backward [] -> 16.202ms
           %5653 = :nvte_quantize_v2 [] -> 361.377us
             %5654 = :quantize_transpose_vector_blockwise [] -> 361.377us
                 -->kernel: 0:7 %4023 =  [] -> 361.377us
           %5655 = :nvte_cublas_gemm_scaled [] -> 7.638ms
                 -->kernel: 0:7 %4024 =  [] -> 7.630ms
           %5656 = :nvte_cublas_gemm_scaled [] -> 7.694ms
                 -->kernel: 0:7 %4025 =  [] -> 7.687ms
           %5657 = :nvte_rmsnorm_bwd [] -> 196.448us
                 -->kernel: 0:7 %4026 =  [] -> 163.200us
                 -->kernel: 0:7 %4027 =  [] -> 7.904us
       %5658 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.952us
                 -->kernel: 0:7 %4028 =  [] -> 49.952us
     %5659 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.696us
       %5660 = :aten::add_ [[7168], [7168], []] -> 1.696us
                 -->kernel: 0:35 %4029 =  [] -> 1.696us
     %5661 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.274ms
       %5662 = :_LinearBackward [[4096, 1, 7168]] -> 7.274ms
         %5663 = :_Linear_backward [] -> 7.274ms
           %5664 = :nvte_quantize_v2 [] -> 73.824us
             %5665 = :quantize_transpose_vector_blockwise [] -> 73.824us
                 -->kernel: 0:7 %4030 =  [] -> 73.824us
           %5666 = :nvte_quantize_v2 [] -> 110.112us
             %5667 = :quantize_transpose_vector_blockwise [] -> 110.112us
                 -->kernel: 0:7 %4031 =  [] -> 110.112us
           %5668 = :nvte_cublas_gemm_scaled [] -> 3.433ms
                 -->kernel: 0:7 %4032 =  [] -> 3.427ms
           %5669 = :nvte_cublas_gemm_scaled [] -> 3.432ms
                 -->kernel: 0:7 %4033 =  [] -> 3.426ms
     %5670 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.908ms
       %5671 = :BmmBackward0 [[128, 4096, 128]] -> 7.908ms
         %5672 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.978ms
                 -->kernel: 0:7 %4034 =  [] -> 3.966ms
         %5673 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.874ms
                 -->kernel: 0:7 %4035 =  [] -> 3.865ms
     %5674 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.963ms
       %5675 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.963ms
         %5676 = :nvte_scaled_softmax_backward [] -> 6.963ms
                 -->kernel: 0:7 %4036 =  [] -> 6.963ms
     %5677 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.187ms
       %5678 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.187ms
         %5679 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.938ms
                 -->kernel: 0:7 %4037 =  [] -> 5.927ms
         %5680 = :aten::mul [[128, 4096, 192], []] -> 114.784us
           %5681 = :aten::mul [[128, 4096, 192], []] -> 114.784us
                 -->kernel: 0:7 %4038 =  [] -> 114.784us
         %5682 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.863ms
                 -->kernel: 0:7 %4039 =  [] -> 5.856ms
         %5683 = :aten::mul [[128, 192, 4096], []] -> 114.944us
           %5684 = :aten::mul [[128, 192, 4096], []] -> 114.944us
                 -->kernel: 0:7 %4040 =  [] -> 114.944us
     %5685 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.486ms
       %5686 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.486ms
         %5687 = :aten::contiguous [[4096, 1, 128, 192], []] -> 744.610us
           %5688 = :aten::clone [[4096, 1, 128, 192], []] -> 744.610us
             %5689 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 744.610us
                 -->kernel: 0:7 %4041 =  [] -> 744.610us
         %5690 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.832us
           %5691 = :aten::clone [[4096, 1, 128, 128], []] -> 280.832us
             %5692 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.832us
                 -->kernel: 0:7 %4042 =  [] -> 280.832us
                 -->kernel: 0:7 %4043 =  [] -> 172.800us
     %5693 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 637.249us
       %5694 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 637.249us
         %5695 = :aten::contiguous [[4096, 1, 128, 192], []] -> 422.785us
           %5696 = :aten::clone [[4096, 1, 128, 192], []] -> 422.785us
             %5697 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 422.785us
                 -->kernel: 0:7 %4044 =  [] -> 422.785us
                 -->kernel: 0:7 %4045 =  [] -> 118.464us
     %5698 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.730ms
       %5699 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.730ms
         %5700 = :_LayerNormLinear_backward [] -> 1.730ms
           %5701 = :nvte_quantize_v2 [] -> 323.520us
             %5702 = :quantize_transpose_vector_blockwise [] -> 323.520us
                 -->kernel: 0:7 %4046 =  [] -> 323.520us
           %5703 = :nvte_cublas_gemm_scaled [] -> 565.281us
                 -->kernel: 0:7 %4047 =  [] -> 518.369us
                 -->kernel: 0:7 %4048 =  [] -> 19.008us
           %5704 = :nvte_cublas_gemm_scaled [] -> 527.073us
                 -->kernel: 0:7 %4049 =  [] -> 521.057us
           %5705 = :nvte_rmsnorm_bwd [] -> 21.536us
                 -->kernel: 0:7 %4050 =  [] -> 6.464us
                 -->kernel: 0:7 %4051 =  [] -> 3.168us
     %5706 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.048us
       %5707 = :aten::add_ [[512], [512], []] -> 2.048us
                 -->kernel: 0:35 %4052 =  [] -> 2.048us
     %5708 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.796ms
       %5709 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.796ms
         %5710 = :_LayerNormLinear_backward [] -> 2.796ms
           %5711 = :nvte_quantize_v2 [] -> 244.096us
             %5712 = :quantize_transpose_vector_blockwise [] -> 244.096us
                 -->kernel: 0:7 %4053 =  [] -> 244.096us
           %5713 = :nvte_cublas_gemm_scaled [] -> 1.118ms
                 -->kernel: 0:7 %4054 =  [] -> 1.109ms
           %5714 = :nvte_cublas_gemm_scaled [] -> 1.121ms
                 -->kernel: 0:7 %4055 =  [] -> 1.115ms
           %5715 = :nvte_rmsnorm_bwd [] -> 55.712us
                 -->kernel: 0:7 %4056 =  [] -> 23.200us
                 -->kernel: 0:7 %4057 =  [] -> 20.544us
     %5716 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.888us
       %5717 = :aten::add_ [[1536], [1536], []] -> 1.888us
                 -->kernel: 0:35 %4058 =  [] -> 1.888us
     %5718 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.048us
       %5719 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.048us
         %5720 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.048us
                 -->kernel: 0:7 %4059 =  [] -> 10.048us
     %5721 = :autograd::engine::evaluate_function: _LinearBackward None -> 431.617us
       %5722 = :_LinearBackward [[4096, 1, 576]] -> 431.617us
         %5723 = :_Linear_backward [] -> 431.617us
           %5724 = :nvte_quantize_v2 [] -> 14.752us
             %5725 = :quantize_transpose_vector_blockwise [] -> 14.752us
                 -->kernel: 0:7 %4060 =  [] -> 14.752us
           %5726 = :nvte_cublas_gemm_scaled [] -> 147.649us
                 -->kernel: 0:7 %4061 =  [] -> 141.313us
           %5727 = :nvte_cublas_gemm_scaled [] -> 139.296us
                 -->kernel: 0:7 %4062 =  [] -> 133.536us
     %5728 = :autograd::engine::evaluate_function: _LinearBackward None -> 990.754us
       %5729 = :_LinearBackward [[4096, 1, 1536]] -> 821.282us
         %5730 = :_Linear_backward [] -> 821.282us
           %5731 = :nvte_quantize_v2 [] -> 18.400us
             %5732 = :quantize_transpose_vector_blockwise [] -> 18.400us
                 -->kernel: 0:7 %4063 =  [] -> 18.400us
           %5733 = :nvte_cublas_gemm_scaled [] -> 335.361us
                 -->kernel: 0:7 %4064 =  [] -> 329.377us
           %5734 = :nvte_cublas_gemm_scaled [] -> 343.233us
                 -->kernel: 0:7 %4065 =  [] -> 338.465us
       %5735 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.176us
                 -->kernel: 0:7 %4066 =  [] -> 50.176us
     %5736 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 319.809us
       %5737 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 195.329us
         %5738 = :nvte_rmsnorm_bwd [] -> 195.329us
                 -->kernel: 0:7 %4067 =  [] -> 163.905us
                 -->kernel: 0:7 %4068 =  [] -> 7.840us
       %5739 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.408us
                 -->kernel: 0:7 %4069 =  [] -> 49.408us
     %5740 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.696us
       %5741 = :aten::add_ [[7168], [7168], []] -> 1.696us
                 -->kernel: 0:35 %4070 =  [] -> 1.696us
     %5742 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 2.989ms
       %5743 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.387ms
         %5744 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.387ms
           %5745 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.387ms
             %5746 = :aten::arange [[], [], [], [], []] -> 1.152us
               %5747 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %4071 =  [] -> 1.152us
             %5748 = CCCL:cub::DeviceRadixSort [] -> 189.696us
                 -->kernel: 0:7 %4072 =  [] -> 3.712us
                 -->kernel: 0:7 %4073 =  [] -> 1.568us
                 -->kernel: 0:7 %4074 =  [] -> 7.616us
                 -->kernel: 0:7 %4075 =  [] -> 7.392us
                 -->kernel: 0:7 %4076 =  [] -> 7.264us
                 -->kernel: 0:7 %4077 =  [] -> 6.944us
                 -->kernel: 0:7 %4078 =  [] -> 6.912us
                 -->kernel: 0:7 %4079 =  [] -> 7.008us
                 -->kernel: 0:7 %4080 =  [] -> 7.200us
                 -->kernel: 0:7 %4081 =  [] -> 6.880us
             %5749 = :aten::zeros [[], [], [], [], []] -> 545.058us
               %5750 = :aten::zero_ [[129280, 7168]] -> 545.058us
                 %5751 = :aten::fill_ [[129280, 7168], []] -> 545.058us
                 -->kernel: 0:7 %4082 =  [] -> 545.058us
             %5752 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 19.776us
                 -->kernel: 0:7 %4083 =  [] -> 1.504us
                 -->kernel: 0:7 %4084 =  [] -> 4.224us
                 -->kernel: 0:7 %4085 =  [] -> 1.728us
             %5753 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 17.760us
                 -->kernel: 0:7 %4086 =  [] -> 1.248us
                 -->kernel: 0:7 %4087 =  [] -> 2.848us
                 -->kernel: 0:7 %4088 =  [] -> 1.568us
                 -->kernel: 0:7 %4089 =  [] -> 1.920us
                 -->kernel: 0:7 %4090 =  [] -> 223.201us
                 -->kernel: 0:7 %4091 =  [] -> 165.824us
       %5754 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.555ms
                 -->kernel: 0:35 %4092 =  [] -> 1.555ms
     %5755 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.557ms
       %5756 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.557ms
                 -->kernel: 0:35 %4093 =  [] -> 1.557ms
     %5757 = :aten::linalg_vector_norm [[3002413056], [], [], [], []] -> 2.544ms
                 -->kernel: 0:7 %4094 =  [] -> 615.073us
                 -->kernel: 0:7 %4095 =  [] -> 610.306us
                 -->kernel: 0:7 %4096 =  [] -> 608.545us
                 -->kernel: 0:7 %4097 =  [] -> 609.346us
     %5758 = :aten::isnan [[]] -> 1.920us
       %5759 = :aten::ne [[], []] -> 1.920us
                 -->kernel: 0:7 %4098 =  [] -> 1.920us
     %5760 = :aten::is_nonzero [[]] -> 2.176us
       %5761 = :aten::item [[]] -> 2.176us
         %5762 = :aten::_local_scalar_dense [[]] -> 2.176us
     %5763 = :aten::isinf [[]] -> 39.200us
       %5764 = :aten::abs [[]] -> 1.472us
         %5765 = :aten::abs [[], [0]] -> 1.472us
                 -->kernel: 0:7 %4099 =  [] -> 1.472us
       %5766 = :aten::eq [[], []] -> 1.536us
                 -->kernel: 0:7 %4100 =  [] -> 1.536us
     %5767 = :aten::is_nonzero [[]] -> 2.176us
       %5768 = :aten::item [[]] -> 2.176us
         %5769 = :aten::_local_scalar_dense [[]] -> 2.176us
     %5770 = :aten::mul_ [[3002413056], []] -> 3.551ms
                 -->kernel: 0:7 %4101 =  [] -> 863.426us
                 -->kernel: 0:7 %4102 =  [] -> 901.442us
                 -->kernel: 0:7 %4103 =  [] -> 871.746us
                 -->kernel: 0:7 %4104 =  [] -> 870.658us
     %5771 = :c10d::reduce_scatter_tensor_coalesced_ [[375301632], [3002413056], [], [], [], []] -> 14.493ms
       %5772 = :record_param_comms [[3002413056], [], [], [], [], [], [], [], [], []] -> 14.493ms
         %5773 = :nccl:reduce_scatter_tensor_coalesced [[3002413056]] -> 14.493ms
           %5774 = NCCL:ncclGroupEnd [] -> 14.493ms
                 -->kernel: 0:7 %4105 =  [] -> 14.493ms
     %5775 = :aten::linalg_vector_norm [[352321536], [], [], [], []] -> 305.025us
                 -->kernel: 0:7 %4106 =  [] -> 291.553us
     %5776 = :aten::isnan [[]] -> 1.504us
       %5777 = :aten::ne [[], []] -> 1.504us
                 -->kernel: 0:7 %4107 =  [] -> 1.504us
     %5778 = :aten::is_nonzero [[]] -> 2.176us
       %5779 = :aten::item [[]] -> 2.176us
         %5780 = :aten::_local_scalar_dense [[]] -> 2.176us
     %5781 = :aten::isinf [[]] -> 26.880us
       %5782 = :aten::abs [[]] -> 1.312us
         %5783 = :aten::abs [[], [0]] -> 1.312us
                 -->kernel: 0:7 %4108 =  [] -> 1.312us
       %5784 = :aten::eq [[], []] -> 1.696us
                 -->kernel: 0:7 %4109 =  [] -> 1.696us
     %5785 = :aten::is_nonzero [[]] -> 2.464us
       %5786 = :aten::item [[]] -> 2.464us
         %5787 = :aten::_local_scalar_dense [[]] -> 2.464us
     %5788 = :aten::mul_ [[352321536], []] -> 404.001us
                 -->kernel: 0:7 %4110 =  [] -> 404.001us
     %5789 = :aten::stack [[32], [32], []] -> 1.984us
       %5790 = :aten::cat [[32], [32], []] -> 1.984us
                 -->kernel: 0:7 %4111 =  [] -> 1.984us
     %5791 = :aten::stack [[32], [32], []] -> 1.856us
       %5792 = :aten::cat [[32], [32], []] -> 1.856us
                 -->kernel: 0:7 %4112 =  [] -> 1.856us
     %5793 = :c10d::allreduce_ [[2, 32], [], [], [], [], []] -> 15.488us
       %5794 = :record_param_comms [[2, 32], [], [], [], [], [], [], [], [], []] -> 15.488us
         %5795 = :nccl:all_reduce [[2, 32]] -> 15.488us
           %5796 = NCCL:ncclAllReduce [] -> 15.488us
                 -->kernel: 0:7 %4113 =  [] -> 15.488us
     %5797 = :aten::sum [[2, 32], [], [], []] -> 3.072us
                 -->kernel: 0:7 %4114 =  [] -> 3.072us
     %5798 = :aten::div [[2, 1], []] -> 1.696us
                 -->kernel: 0:7 %4115 =  [] -> 1.696us
     %5799 = :aten::sub [[2, 1], [2, 32], []] -> 2.048us
                 -->kernel: 0:7 %4116 =  [] -> 2.048us
     %5800 = :aten::sign [[2, 32]] -> 1.696us
                 -->kernel: 0:7 %4117 =  [] -> 1.696us
     %5801 = :aten::mul [[2, 32], []] -> 1.504us
                 -->kernel: 0:7 %4118 =  [] -> 1.504us
     %5802 = :aten::add [[2, 32], [2, 32], []] -> 3.008us
                 -->kernel: 0:7 %4119 =  [] -> 3.008us
     %5803 = :aten::zero_ [[32]] -> 992.000ns
       %5804 = :aten::fill_ [[32], []] -> 992.000ns
                 -->kernel: 0:7 %4120 =  [] -> 992.000ns
     %5805 = :aten::copy_ [[32], [32], []] -> 1.184us
     %5806 = :aten::zero_ [[32]] -> 1.152us
       %5807 = :aten::fill_ [[32], []] -> 1.152us
                 -->kernel: 0:7 %4121 =  [] -> 1.152us
     %5808 = :aten::copy_ [[32], [32], []] -> 992.000ns
     %5809 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %5810 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %5811 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %5812 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 8.928us
       %5813 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 8.928us
         %5814 = :nccl:all_reduce [[1]] -> 8.928us
           %5815 = NCCL:ncclAllReduce [] -> 8.928us
                 -->kernel: 0:7 %4122 =  [] -> 8.928us
     %5816 = :aten::item [[1]] -> 2.208us
       %5817 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %5818 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %5819 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %5820 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %5821 = :aten::zeros [[], [], [], [], []] -> 1.216us
       %5822 = :aten::zero_ [[320]] -> 1.216us
         %5823 = :aten::fill_ [[320], []] -> 1.216us
                 -->kernel: 0:7 %4123 =  [] -> 1.216us
     %5824 = :nvte_multi_tensor_l2norm_cuda [] -> 1.395ms
                 -->kernel: 0:7 %4124 =  [] -> 36.032us
                 -->kernel: 0:7 %4125 =  [] -> 33.120us
                 -->kernel: 0:7 %4126 =  [] -> 29.760us
                 -->kernel: 0:7 %4127 =  [] -> 29.888us
                 -->kernel: 0:7 %4128 =  [] -> 30.112us
                 -->kernel: 0:7 %4129 =  [] -> 30.144us
                 -->kernel: 0:7 %4130 =  [] -> 29.760us
                 -->kernel: 0:7 %4131 =  [] -> 30.368us
                 -->kernel: 0:7 %4132 =  [] -> 30.241us
                 -->kernel: 0:7 %4133 =  [] -> 30.112us
                 -->kernel: 0:7 %4134 =  [] -> 29.728us
                 -->kernel: 0:7 %4135 =  [] -> 29.792us
                 -->kernel: 0:7 %4136 =  [] -> 30.240us
                 -->kernel: 0:7 %4137 =  [] -> 29.696us
                 -->kernel: 0:7 %4138 =  [] -> 29.952us
                 -->kernel: 0:7 %4139 =  [] -> 30.208us
                 -->kernel: 0:7 %4140 =  [] -> 29.920us
                 -->kernel: 0:7 %4141 =  [] -> 30.304us
                 -->kernel: 0:7 %4142 =  [] -> 29.697us
                 -->kernel: 0:7 %4143 =  [] -> 29.760us
                 -->kernel: 0:7 %4144 =  [] -> 29.696us
                 -->kernel: 0:7 %4145 =  [] -> 29.664us
                 -->kernel: 0:7 %4146 =  [] -> 30.176us
                 -->kernel: 0:7 %4147 =  [] -> 30.016us
                 -->kernel: 0:7 %4148 =  [] -> 30.400us
                 -->kernel: 0:7 %4149 =  [] -> 29.760us
                 -->kernel: 0:7 %4150 =  [] -> 29.984us
                 -->kernel: 0:7 %4151 =  [] -> 30.528us
                 -->kernel: 0:7 %4152 =  [] -> 29.856us
                 -->kernel: 0:7 %4153 =  [] -> 30.241us
                 -->kernel: 0:7 %4154 =  [] -> 29.728us
                 -->kernel: 0:7 %4155 =  [] -> 29.952us
                 -->kernel: 0:7 %4156 =  [] -> 30.432us
                 -->kernel: 0:7 %4157 =  [] -> 30.112us
                 -->kernel: 0:7 %4158 =  [] -> 17.152us
                 -->kernel: 0:7 %4159 =  [] -> 1.984us
     %5825 = :aten::pow [[1], []] -> 1.696us
                 -->kernel: 0:7 %4160 =  [] -> 1.696us
     %5826 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 33.568us
       %5827 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 33.568us
         %5828 = :nccl:all_reduce [[1]] -> 33.568us
           %5829 = NCCL:ncclAllReduce [] -> 33.568us
                 -->kernel: 0:7 %4161 =  [] -> 33.568us
     %5830 = :aten::item [[1]] -> 2.240us
       %5831 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %5832 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %5833 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %5834 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %5835 = :nvte_multi_tensor_scale_cuda [] -> 934.370us
                 -->kernel: 0:7 %4162 =  [] -> 35.872us
                 -->kernel: 0:7 %4163 =  [] -> 43.264us
                 -->kernel: 0:7 %4164 =  [] -> 43.680us
                 -->kernel: 0:7 %4165 =  [] -> 42.848us
                 -->kernel: 0:7 %4166 =  [] -> 43.584us
                 -->kernel: 0:7 %4167 =  [] -> 43.265us
                 -->kernel: 0:7 %4168 =  [] -> 44.000us
                 -->kernel: 0:7 %4169 =  [] -> 43.200us
                 -->kernel: 0:7 %4170 =  [] -> 44.512us
                 -->kernel: 0:7 %4171 =  [] -> 42.816us
                 -->kernel: 0:7 %4172 =  [] -> 43.552us
                 -->kernel: 0:7 %4173 =  [] -> 43.488us
                 -->kernel: 0:7 %4174 =  [] -> 43.488us
                 -->kernel: 0:7 %4175 =  [] -> 42.848us
                 -->kernel: 0:7 %4176 =  [] -> 42.848us
                 -->kernel: 0:7 %4177 =  [] -> 42.976us
                 -->kernel: 0:7 %4178 =  [] -> 42.880us
                 -->kernel: 0:7 %4179 =  [] -> 29.600us
     %5836 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %5837 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %5838 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %5839 = :nvte_multi_tensor_scale_cuda [] -> 883.298us
                 -->kernel: 0:7 %4180 =  [] -> 43.808us
                 -->kernel: 0:7 %4181 =  [] -> 42.976us
                 -->kernel: 0:7 %4182 =  [] -> 42.848us
                 -->kernel: 0:7 %4183 =  [] -> 43.264us
                 -->kernel: 0:7 %4184 =  [] -> 42.720us
                 -->kernel: 0:7 %4185 =  [] -> 43.264us
                 -->kernel: 0:7 %4186 =  [] -> 42.816us
                 -->kernel: 0:7 %4187 =  [] -> 44.097us
                 -->kernel: 0:7 %4188 =  [] -> 42.752us
                 -->kernel: 0:7 %4189 =  [] -> 44.160us
                 -->kernel: 0:7 %4190 =  [] -> 43.456us
                 -->kernel: 0:7 %4191 =  [] -> 43.936us
                 -->kernel: 0:7 %4192 =  [] -> 42.784us
                 -->kernel: 0:7 %4193 =  [] -> 44.000us
                 -->kernel: 0:7 %4194 =  [] -> 42.912us
                 -->kernel: 0:7 %4195 =  [] -> 43.361us
                 -->kernel: 0:7 %4196 =  [] -> 28.000us
     %5840 = :Optimizer.step#HybridDeviceOptimizer.step None -> 318.560ms
       %5841 = :aten::copy_ [[375301632], [375301632], []] -> 43.906ms
         %5842 = :aten::to [[375301632], [], [], [], []] -> 2.226ms
           %5843 = :aten::_to_copy [[375301632], [], [], [], [], [], []] -> 2.226ms
             %5844 = :aten::copy_ [[375301632], [375301632], []] -> 2.226ms
                 -->kernel: 0:7 %4197 =  [] -> 2.226ms
         %5845 = :aten::copy_ [[375301632], [375301632], []] -> 41.625ms
       %5846 = :Optimizer.step#AdamW.step None -> 72.093ms
         %5847 = :aten::copy_ [[375301632], [375301632], []] -> 72.093ms
           %5848 = :aten::copy_ [[375301632], [375301632], []] -> 71.375ms
           %5849 = :aten::copy_ [[375301632], [375301632], []] -> 604.609us
                 -->kernel: 0:7 %4198 =  [] -> 604.609us
     %5850 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 340.741ms
       %5851 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 340.741ms
         %5852 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 340.741ms
           %5853 = NCCL:ncclGroupEnd [] -> 340.741ms
                 -->kernel: 0:39 %4199 =  [] -> 340.741ms
     %5854 = :Optimizer.step#HybridDeviceOptimizer.step None -> 84.104ms
       %5855 = :aten::to [[14680064], [], [], [], []] -> 88.992us
         %5856 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.992us
           %5857 = :aten::copy_ [[14680064], [14680064], []] -> 88.992us
                 -->kernel: 0:7 %4200 =  [] -> 88.992us
       %5858 = :aten::to [[29360128], [], [], [], []] -> 176.480us
         %5859 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.480us
           %5860 = :aten::copy_ [[29360128], [29360128], []] -> 176.480us
                 -->kernel: 0:7 %4201 =  [] -> 176.480us
       %5861 = :aten::to [[29360128], [], [], [], []] -> 176.513us
         %5862 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.513us
           %5863 = :aten::copy_ [[29360128], [29360128], []] -> 176.513us
                 -->kernel: 0:7 %4202 =  [] -> 176.513us
       %5864 = :aten::to [[29360128], [], [], [], []] -> 176.448us
         %5865 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.448us
           %5866 = :aten::copy_ [[29360128], [29360128], []] -> 176.448us
                 -->kernel: 0:7 %4203 =  [] -> 176.448us
       %5867 = :aten::to [[29360128], [], [], [], []] -> 176.353us
         %5868 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.353us
           %5869 = :aten::copy_ [[29360128], [29360128], []] -> 176.353us
                 -->kernel: 0:7 %4204 =  [] -> 176.353us
       %5870 = :aten::to [[14680064], [], [], [], []] -> 89.216us
         %5871 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.216us
           %5872 = :aten::copy_ [[14680064], [14680064], []] -> 89.216us
                 -->kernel: 0:7 %4205 =  [] -> 89.216us
       %5873 = :aten::to [[14680064], [], [], [], []] -> 89.568us
         %5874 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.568us
           %5875 = :aten::copy_ [[14680064], [14680064], []] -> 89.568us
                 -->kernel: 0:7 %4206 =  [] -> 89.568us
       %5876 = :aten::to [[14680064], [], [], [], []] -> 89.280us
         %5877 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.280us
           %5878 = :aten::copy_ [[14680064], [14680064], []] -> 89.280us
                 -->kernel: 0:7 %4207 =  [] -> 89.280us
       %5879 = :aten::to [[14680064], [], [], [], []] -> 89.568us
         %5880 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.568us
           %5881 = :aten::copy_ [[14680064], [14680064], []] -> 89.568us
                 -->kernel: 0:7 %4208 =  [] -> 89.568us
       %5882 = :aten::to [[29360128], [], [], [], []] -> 176.449us
         %5883 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.449us
           %5884 = :aten::copy_ [[29360128], [29360128], []] -> 176.449us
                 -->kernel: 0:7 %4209 =  [] -> 176.449us
       %5885 = :aten::to [[29360128], [], [], [], []] -> 176.896us
         %5886 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.896us
           %5887 = :aten::copy_ [[29360128], [29360128], []] -> 176.896us
                 -->kernel: 0:7 %4210 =  [] -> 176.896us
       %5888 = :aten::to [[29360128], [], [], [], []] -> 175.969us
         %5889 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 175.969us
           %5890 = :aten::copy_ [[29360128], [29360128], []] -> 175.969us
                 -->kernel: 0:7 %4211 =  [] -> 175.969us
       %5891 = :aten::to [[29360128], [], [], [], []] -> 175.968us
         %5892 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 175.968us
           %5893 = :aten::copy_ [[29360128], [29360128], []] -> 175.968us
                 -->kernel: 0:7 %4212 =  [] -> 175.968us
       %5894 = :aten::copy_ [[14680064], [14680064], []] -> 1.997ms
         %5895 = :aten::to [[14680064], [], [], [], []] -> 89.024us
           %5896 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.024us
             %5897 = :aten::copy_ [[14680064], [14680064], []] -> 89.024us
                 -->kernel: 0:7 %4213 =  [] -> 89.024us
         %5898 = :aten::copy_ [[14680064], [14680064], []] -> 1.847ms
       %5899 = :aten::copy_ [[14680064], [14680064], []] -> 1.825ms
         %5900 = :aten::to [[14680064], [], [], [], []] -> 88.224us
           %5901 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.224us
             %5902 = :aten::copy_ [[14680064], [14680064], []] -> 88.224us
                 -->kernel: 0:7 %4214 =  [] -> 88.224us
         %5903 = :aten::copy_ [[14680064], [14680064], []] -> 1.707ms
       %5904 = :aten::copy_ [[14680064], [14680064], []] -> 1.791ms
         %5905 = :aten::to [[14680064], [], [], [], []] -> 88.256us
           %5906 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 88.256us
             %5907 = :aten::copy_ [[14680064], [14680064], []] -> 88.256us
                 -->kernel: 0:7 %4215 =  [] -> 88.256us
         %5908 = :aten::copy_ [[14680064], [14680064], []] -> 1.676ms
       %5909 = :Optimizer.step#FusedAdam.step None -> 3.869ms
         %5910 = :nvte_multi_tensor_adam_cuda [] -> 3.083ms
                 -->kernel: 0:7 %4216 =  [] -> 199.424us
                 -->kernel: 0:7 %4217 =  [] -> 199.841us
                 -->kernel: 0:7 %4218 =  [] -> 200.736us
                 -->kernel: 0:7 %4219 =  [] -> 199.073us
                 -->kernel: 0:7 %4220 =  [] -> 199.776us
                 -->kernel: 0:7 %4221 =  [] -> 198.913us
                 -->kernel: 0:7 %4222 =  [] -> 200.768us
                 -->kernel: 0:7 %4223 =  [] -> 198.913us
                 -->kernel: 0:7 %4224 =  [] -> 197.536us
                 -->kernel: 0:7 %4225 =  [] -> 198.305us
                 -->kernel: 0:7 %4226 =  [] -> 199.136us
                 -->kernel: 0:7 %4227 =  [] -> 199.681us
                 -->kernel: 0:7 %4228 =  [] -> 198.496us
                 -->kernel: 0:7 %4229 =  [] -> 199.105us
                 -->kernel: 0:7 %4230 =  [] -> 141.280us
         %5911 = :aten::copy_ [[14680064], [14680064], []] -> 28.000us
                 -->kernel: 0:7 %4231 =  [] -> 28.000us
         %5912 = :aten::copy_ [[29360128], [29360128], []] -> 48.992us
                 -->kernel: 0:7 %4232 =  [] -> 48.992us
         %5913 = :aten::copy_ [[29360128], [29360128], []] -> 48.160us
                 -->kernel: 0:7 %4233 =  [] -> 48.160us
         %5914 = :aten::copy_ [[29360128], [29360128], []] -> 49.632us
                 -->kernel: 0:7 %4234 =  [] -> 49.632us
         %5915 = :aten::copy_ [[29360128], [29360128], []] -> 48.160us
                 -->kernel: 0:7 %4235 =  [] -> 48.160us
         %5916 = :aten::copy_ [[14680064], [14680064], []] -> 25.856us
                 -->kernel: 0:7 %4236 =  [] -> 25.856us
         %5917 = :aten::copy_ [[14680064], [14680064], []] -> 25.216us
                 -->kernel: 0:7 %4237 =  [] -> 25.216us
         %5918 = :aten::copy_ [[14680064], [14680064], []] -> 26.240us
                 -->kernel: 0:7 %4238 =  [] -> 26.240us
         %5919 = :aten::copy_ [[14680064], [14680064], []] -> 24.992us
                 -->kernel: 0:7 %4239 =  [] -> 24.992us
         %5920 = :aten::copy_ [[29360128], [29360128], []] -> 49.408us
                 -->kernel: 0:7 %4240 =  [] -> 49.408us
         %5921 = :aten::copy_ [[29360128], [29360128], []] -> 47.809us
                 -->kernel: 0:7 %4241 =  [] -> 47.809us
         %5922 = :aten::copy_ [[29360128], [29360128], []] -> 49.504us
                 -->kernel: 0:7 %4242 =  [] -> 49.504us
         %5923 = :aten::copy_ [[29360128], [29360128], []] -> 49.696us
                 -->kernel: 0:7 %4243 =  [] -> 49.696us
       %5924 = :Optimizer.step#AdamW.step None -> 8.738ms
         %5925 = :aten::copy_ [[14680064], [14680064], []] -> 2.944ms
           %5926 = :aten::copy_ [[14680064], [14680064], []] -> 2.864ms
           %5927 = :aten::copy_ [[14680064], [14680064], []] -> 25.216us
                 -->kernel: 0:7 %4244 =  [] -> 25.216us
         %5928 = :aten::copy_ [[14680064], [14680064], []] -> 2.770ms
           %5929 = :aten::copy_ [[14680064], [14680064], []] -> 2.735ms
           %5930 = :aten::copy_ [[14680064], [14680064], []] -> 23.488us
                 -->kernel: 0:7 %4245 =  [] -> 23.488us
         %5931 = :aten::copy_ [[14680064], [14680064], []] -> 2.737ms
           %5932 = :aten::copy_ [[14680064], [14680064], []] -> 2.703ms
           %5933 = :aten::copy_ [[14680064], [14680064], []] -> 24.128us
                 -->kernel: 0:7 %4246 =  [] -> 24.128us
     %5934 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 53.807ms
       %5935 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 53.807ms
         %5936 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 53.807ms
           %5937 = NCCL:ncclGroupEnd [] -> 53.807ms
                 -->kernel: 0:39 %4247 =  [] -> 53.807ms
     %5938 = :aten::to [[1], [], [], [], [], []] -> 768.000ns
       %5939 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 768.000ns
         %5940 = :aten::copy_ [[1], [1], []] -> 768.000ns
     %5941 = :aten::item [[1]] -> 3.232us
       %5942 = :aten::_local_scalar_dense [[1]] -> 3.232us
     %5943 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %5944 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %5945 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %5946 = :aten::item [[1]] -> 2.240us
       %5947 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %5948 = :aten::item [[1]] -> 2.240us
       %5949 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %5950 = :aten::cat [[1], []] -> 1.472us
     %5951 = :aten::mean [[1], []] -> 2.816us
       %5952 = :aten::mean [[1], [], [], []] -> 2.816us
                 -->kernel: 0:7 %4248 =  [] -> 2.816us
     %5953 = :aten::item [[1]] -> 2.880us
       %5954 = :aten::_local_scalar_dense [[1]] -> 2.880us
     %5955 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %5956 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %5957 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %5958 = :aten::add [[1], [], []] -> 1.728us
                 -->kernel: 0:7 %4249 =  [] -> 1.728us
     %5959 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %5960 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %5961 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %5962 = :aten::item [[1]] -> 2.176us
       %5963 = :aten::_local_scalar_dense [[1]] -> 2.176us
     %5964 = :aten::item [[1]] -> 2.368us
       %5965 = :aten::_local_scalar_dense [[1]] -> 2.368us
     %5966 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 1.727ms
       %5967 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 1.727ms
         %5968 = :nccl:all_reduce [[2]] -> 1.727ms
           %5969 = NCCL:ncclAllReduce [] -> 1.727ms
                 -->kernel: 0:7 %4250 =  [] -> 1.727ms
     %5970 = :c10d::allreduce_ [[3], [], [], [], [], []] -> 9.024us
       %5971 = :record_param_comms [[3], [], [], [], [], [], [], [], [], []] -> 9.024us
         %5972 = :nccl:all_reduce [[3]] -> 9.024us
           %5973 = NCCL:ncclAllReduce [] -> 9.024us
                 -->kernel: 0:7 %4251 =  [] -> 9.024us
     %5974 = :aten::mul [[3], []] -> 1.504us
                 -->kernel: 0:7 %4252 =  [] -> 1.504us
     %5975 = :aten::mul [[2], []] -> 1.376us
                 -->kernel: 0:7 %4253 =  [] -> 1.376us
     %5976 = :aten::sum [[3], []] -> 2.656us
       %5977 = :aten::sum [[3], [], [], []] -> 2.656us
                 -->kernel: 0:7 %4254 =  [] -> 2.656us
     %5978 = :aten::div [[], []] -> 1.056us
                 -->kernel: 0:7 %4255 =  [] -> 1.056us
     %5979 = :aten::add_ [[1], [], []] -> 1.536us
                 -->kernel: 0:7 %4256 =  [] -> 1.536us
     %5980 = :aten::sum [[2], []] -> 2.720us
       %5981 = :aten::sum [[2], [], [], []] -> 2.720us
                 -->kernel: 0:7 %4257 =  [] -> 2.720us
     %5982 = :aten::div [[], []] -> 1.056us
                 -->kernel: 0:7 %4258 =  [] -> 1.056us
     %5983 = :aten::add_ [[1], [], []] -> 1.344us
                 -->kernel: 0:7 %4259 =  [] -> 1.344us
     %5984 = :aten::zero_ [[3]] -> 1.184us
       %5985 = :aten::fill_ [[3], []] -> 1.184us
                 -->kernel: 0:7 %4260 =  [] -> 1.184us
     %5986 = :aten::zero_ [[2]] -> 1.056us
       %5987 = :aten::fill_ [[2], []] -> 1.056us
                 -->kernel: 0:7 %4261 =  [] -> 1.056us
     %5988 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 309.089us
       %5989 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 309.089us
         %5990 = :nccl:all_reduce [[1]] -> 309.089us
           %5991 = NCCL:ncclAllReduce [] -> 309.089us
                 -->kernel: 0:7 %4262 =  [] -> 309.089us
     %5992 = :aten::mul [[1], []] -> 1.152us
                 -->kernel: 0:7 %4263 =  [] -> 1.152us
     %5993 = :aten::add_ [[1], [], []] -> 1.440us
                 -->kernel: 0:7 %4264 =  [] -> 1.440us
     %5994 = :aten::zero_ [[1]] -> 1.120us
       %5995 = :aten::fill_ [[1], []] -> 1.120us
                 -->kernel: 0:7 %4265 =  [] -> 1.120us
     %5996 = :c10d::barrier [[1], [], [], [], []] -> 162.432us
       %5997 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 162.432us
         %5998 = :aten::zeros [[], [], [], [], []] -> 896.000ns
           %5999 = :aten::zero_ [[1]] -> 896.000ns
             %6000 = :aten::fill_ [[1], []] -> 896.000ns
                 -->kernel: 0:7 %4266 =  [] -> 896.000ns
         %6001 = :nccl:all_reduce_barrier [[1]] -> 127.904us
           %6002 = NCCL:ncclAllReduce [] -> 127.904us
                 -->kernel: 0:7 %4267 =  [] -> 127.904us
     %6003 = :c10d::barrier [[1], [], [], [], []] -> 38.369us
       %6004 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 38.369us
         %6005 = :aten::zeros [[], [], [], [], []] -> 1.184us
           %6006 = :aten::zero_ [[1]] -> 1.184us
             %6007 = :aten::fill_ [[1], []] -> 1.184us
                 -->kernel: 0:7 %4268 =  [] -> 1.184us
         %6008 = :nccl:all_reduce_barrier [[1]] -> 7.872us
           %6009 = NCCL:ncclAllReduce [] -> 7.872us
                 -->kernel: 0:7 %4269 =  [] -> 7.872us
     %6010 = :aten::item [[1]] -> 2.368us
       %6011 = :aten::_local_scalar_dense [[1]] -> 2.368us
     %6012 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %6013 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %6014 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %6015 = :aten::item [[1]] -> 2.176us
       %6016 = :aten::_local_scalar_dense [[1]] -> 2.176us
     %6017 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %6018 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %6019 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %6020 = :aten::item [[1]] -> 2.176us
       %6021 = :aten::_local_scalar_dense [[1]] -> 2.176us
     %6022 = :aten::to [[1], [], [], [], [], []] -> 832.000ns
       %6023 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 832.000ns
         %6024 = :aten::copy_ [[1], [1], []] -> 832.000ns
     %6025 = :aten::item [[1]] -> 2.208us
       %6026 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %6027 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %6028 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %6029 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %6030 = :aten::zeros [[], [], [], [], []] -> 928.000ns
       %6031 = :aten::zero_ [[8, 24]] -> 928.000ns
         %6032 = :aten::fill_ [[8, 24], []] -> 928.000ns
                 -->kernel: 0:7 %4270 =  [] -> 928.000ns
     %6033 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 58.432us
       %6034 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 58.432us
         %6035 = :nccl:_all_gather_base [[24]] -> 58.432us
           %6036 = NCCL:ncclAllGather [] -> 58.432us
                 -->kernel: 0:7 %4271 =  [] -> 58.432us
     %6037 = :aten::gt [[8], []] -> 1.856us
                 -->kernel: 0:7 %4272 =  [] -> 1.856us
     %6038 = :aten::index [[8], [8]] -> 62.049us
       %6039 = :aten::nonzero [[8]] -> 62.049us
         %6040 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %4273 =  [] -> 1.536us
         %6041 = CCCL:cub::DeviceSelect::Flagged [] -> 14.592us
                 -->kernel: 0:7 %4274 =  [] -> 1.024us
                 -->kernel: 0:7 %4275 =  [] -> 2.048us
     %6042 = :aten::gt [[8], []] -> 1.952us
                 -->kernel: 0:7 %4276 =  [] -> 1.952us
     %6043 = :aten::index [[8], [8]] -> 44.768us
       %6044 = :aten::nonzero [[8]] -> 44.768us
         %6045 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4277 =  [] -> 1.504us
         %6046 = CCCL:cub::DeviceSelect::Flagged [] -> 12.608us
                 -->kernel: 0:7 %4278 =  [] -> 992.000ns
                 -->kernel: 0:7 %4279 =  [] -> 1.888us
     %6047 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4280 =  [] -> 1.792us
     %6048 = :aten::index [[8], [8]] -> 43.200us
       %6049 = :aten::nonzero [[8]] -> 43.200us
         %6050 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4281 =  [] -> 1.504us
         %6051 = CCCL:cub::DeviceSelect::Flagged [] -> 11.680us
                 -->kernel: 0:7 %4282 =  [] -> 992.000ns
                 -->kernel: 0:7 %4283 =  [] -> 1.824us
     %6052 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4284 =  [] -> 1.792us
     %6053 = :aten::index [[8], [8]] -> 44.512us
       %6054 = :aten::nonzero [[8]] -> 44.512us
         %6055 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4285 =  [] -> 1.472us
         %6056 = CCCL:cub::DeviceSelect::Flagged [] -> 12.480us
                 -->kernel: 0:7 %4286 =  [] -> 992.000ns
                 -->kernel: 0:7 %4287 =  [] -> 1.856us
     %6057 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4288 =  [] -> 1.792us
     %6058 = :aten::index [[8], [8]] -> 42.720us
       %6059 = :aten::nonzero [[8]] -> 42.720us
         %6060 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4289 =  [] -> 1.504us
         %6061 = CCCL:cub::DeviceSelect::Flagged [] -> 11.680us
                 -->kernel: 0:7 %4290 =  [] -> 992.000ns
                 -->kernel: 0:7 %4291 =  [] -> 1.856us
     %6062 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4292 =  [] -> 1.792us
     %6063 = :aten::index [[8], [8]] -> 43.808us
       %6064 = :aten::nonzero [[8]] -> 43.808us
         %6065 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4293 =  [] -> 1.472us
         %6066 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %4294 =  [] -> 992.000ns
                 -->kernel: 0:7 %4295 =  [] -> 1.888us
     %6067 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4296 =  [] -> 1.792us
     %6068 = :aten::index [[8], [8]] -> 42.240us
       %6069 = :aten::nonzero [[8]] -> 42.240us
         %6070 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4297 =  [] -> 1.504us
         %6071 = CCCL:cub::DeviceSelect::Flagged [] -> 11.552us
                 -->kernel: 0:7 %4298 =  [] -> 1.024us
                 -->kernel: 0:7 %4299 =  [] -> 1.856us
     %6072 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4300 =  [] -> 1.792us
     %6073 = :aten::index [[8], [8]] -> 42.624us
       %6074 = :aten::nonzero [[8]] -> 42.624us
         %6075 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4301 =  [] -> 1.472us
         %6076 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %4302 =  [] -> 1.024us
                 -->kernel: 0:7 %4303 =  [] -> 1.856us
     %6077 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4304 =  [] -> 1.760us
     %6078 = :aten::index [[8], [8]] -> 42.432us
       %6079 = :aten::nonzero [[8]] -> 42.432us
         %6080 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4305 =  [] -> 1.472us
         %6081 = CCCL:cub::DeviceSelect::Flagged [] -> 11.520us
                 -->kernel: 0:7 %4306 =  [] -> 992.000ns
                 -->kernel: 0:7 %4307 =  [] -> 1.824us
     %6082 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4308 =  [] -> 1.792us
     %6083 = :aten::index [[8], [8]] -> 44.192us
       %6084 = :aten::nonzero [[8]] -> 44.192us
         %6085 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4309 =  [] -> 1.472us
         %6086 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %4310 =  [] -> 992.000ns
                 -->kernel: 0:7 %4311 =  [] -> 1.888us
     %6087 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4312 =  [] -> 1.760us
     %6088 = :aten::index [[8], [8]] -> 43.392us
       %6089 = :aten::nonzero [[8]] -> 43.392us
         %6090 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4313 =  [] -> 1.504us
         %6091 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %4314 =  [] -> 1.024us
                 -->kernel: 0:7 %4315 =  [] -> 1.856us
     %6092 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4316 =  [] -> 1.792us
     %6093 = :aten::index [[8], [8]] -> 42.368us
       %6094 = :aten::nonzero [[8]] -> 42.368us
         %6095 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4317 =  [] -> 1.504us
         %6096 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %4318 =  [] -> 992.000ns
                 -->kernel: 0:7 %4319 =  [] -> 1.856us
     %6097 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4320 =  [] -> 1.792us
     %6098 = :aten::index [[8], [8]] -> 48.481us
       %6099 = :aten::nonzero [[8]] -> 48.481us
         %6100 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4321 =  [] -> 1.504us
         %6101 = CCCL:cub::DeviceSelect::Flagged [] -> 11.680us
                 -->kernel: 0:7 %4322 =  [] -> 992.000ns
                 -->kernel: 0:7 %4323 =  [] -> 1.856us
     %6102 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4324 =  [] -> 1.824us
     %6103 = :aten::index [[8], [8]] -> 48.576us
       %6104 = :aten::nonzero [[8]] -> 48.576us
         %6105 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4325 =  [] -> 1.472us
         %6106 = CCCL:cub::DeviceSelect::Flagged [] -> 12.640us
                 -->kernel: 0:7 %4326 =  [] -> 992.000ns
                 -->kernel: 0:7 %4327 =  [] -> 1.856us
     %6107 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4328 =  [] -> 1.792us
     %6108 = :aten::index [[8], [8]] -> 43.264us
       %6109 = :aten::nonzero [[8]] -> 43.264us
         %6110 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4329 =  [] -> 1.504us
         %6111 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %4330 =  [] -> 992.000ns
                 -->kernel: 0:7 %4331 =  [] -> 1.856us
     %6112 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4332 =  [] -> 1.792us
     %6113 = :aten::index [[8], [8]] -> 43.809us
       %6114 = :aten::nonzero [[8]] -> 43.809us
         %6115 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4333 =  [] -> 1.472us
         %6116 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %4334 =  [] -> 1.024us
                 -->kernel: 0:7 %4335 =  [] -> 1.856us
     %6117 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4336 =  [] -> 1.760us
     %6118 = :aten::index [[8], [8]] -> 51.968us
       %6119 = :aten::nonzero [[8]] -> 51.968us
         %6120 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4337 =  [] -> 1.504us
         %6121 = CCCL:cub::DeviceSelect::Flagged [] -> 12.384us
                 -->kernel: 0:7 %4338 =  [] -> 1.024us
                 -->kernel: 0:7 %4339 =  [] -> 1.856us
     %6122 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4340 =  [] -> 1.792us
     %6123 = :aten::index [[8], [8]] -> 44.224us
       %6124 = :aten::nonzero [[8]] -> 44.224us
         %6125 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4341 =  [] -> 1.472us
         %6126 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %4342 =  [] -> 1.056us
                 -->kernel: 0:7 %4343 =  [] -> 1.888us
     %6127 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4344 =  [] -> 1.760us
     %6128 = :aten::index [[8], [8]] -> 43.041us
       %6129 = :aten::nonzero [[8]] -> 43.041us
         %6130 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4345 =  [] -> 1.504us
         %6131 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %4346 =  [] -> 1.056us
                 -->kernel: 0:7 %4347 =  [] -> 1.856us
     %6132 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4348 =  [] -> 1.824us
     %6133 = :aten::index [[8], [8]] -> 49.920us
       %6134 = :aten::nonzero [[8]] -> 49.920us
         %6135 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4349 =  [] -> 1.472us
         %6136 = CCCL:cub::DeviceSelect::Flagged [] -> 17.600us
                 -->kernel: 0:7 %4350 =  [] -> 1.056us
                 -->kernel: 0:7 %4351 =  [] -> 1.856us
     %6137 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4352 =  [] -> 1.792us
     %6138 = :aten::index [[8], [8]] -> 43.520us
       %6139 = :aten::nonzero [[8]] -> 43.520us
         %6140 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4353 =  [] -> 1.472us
         %6141 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %4354 =  [] -> 1.056us
                 -->kernel: 0:7 %4355 =  [] -> 1.856us
     %6142 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4356 =  [] -> 1.824us
     %6143 = :aten::index [[8], [8]] -> 44.257us
       %6144 = :aten::nonzero [[8]] -> 44.257us
         %6145 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4357 =  [] -> 1.472us
         %6146 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %4358 =  [] -> 1.056us
                 -->kernel: 0:7 %4359 =  [] -> 1.888us
     %6147 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4360 =  [] -> 1.760us
     %6148 = :aten::index [[8], [8]] -> 43.392us
       %6149 = :aten::nonzero [[8]] -> 43.392us
         %6150 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4361 =  [] -> 1.504us
         %6151 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %4362 =  [] -> 1.056us
                 -->kernel: 0:7 %4363 =  [] -> 1.856us
     %6152 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4364 =  [] -> 1.824us
     %6153 = :aten::index [[8], [8]] -> 43.456us
       %6154 = :aten::nonzero [[8]] -> 43.456us
         %6155 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4365 =  [] -> 1.504us
         %6156 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %4366 =  [] -> 1.088us
                 -->kernel: 0:7 %4367 =  [] -> 1.856us
     %6157 = :aten::zeros [[], [], [], [], []] -> 1.216us
       %6158 = :aten::zero_ [[8, 24]] -> 1.216us
         %6159 = :aten::fill_ [[8, 24], []] -> 1.216us
                 -->kernel: 0:7 %4368 =  [] -> 1.216us
     %6160 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.840us
       %6161 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.840us
         %6162 = :nccl:_all_gather_base [[24]] -> 7.840us
           %6163 = NCCL:ncclAllGather [] -> 7.840us
                 -->kernel: 0:7 %4369 =  [] -> 7.840us
     %6164 = :aten::gt [[8], []] -> 1.600us
                 -->kernel: 0:7 %4370 =  [] -> 1.600us
     %6165 = :aten::index [[8], [8]] -> 48.864us
       %6166 = :aten::nonzero [[8]] -> 48.864us
         %6167 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4371 =  [] -> 1.312us
         %6168 = CCCL:cub::DeviceSelect::Flagged [] -> 12.576us
                 -->kernel: 0:7 %4372 =  [] -> 1.376us
                 -->kernel: 0:7 %4373 =  [] -> 2.176us
     %6169 = :aten::gt [[8], []] -> 1.472us
                 -->kernel: 0:7 %4374 =  [] -> 1.472us
     %6170 = :aten::index [[8], [8]] -> 46.976us
       %6171 = :aten::nonzero [[8]] -> 46.976us
         %6172 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4375 =  [] -> 1.312us
         %6173 = CCCL:cub::DeviceSelect::Flagged [] -> 12.832us
                 -->kernel: 0:7 %4376 =  [] -> 1.312us
                 -->kernel: 0:7 %4377 =  [] -> 2.208us
     %6174 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4378 =  [] -> 1.440us
     %6175 = :aten::index [[8], [8]] -> 44.064us
       %6176 = :aten::nonzero [[8]] -> 44.064us
         %6177 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4379 =  [] -> 1.312us
         %6178 = CCCL:cub::DeviceSelect::Flagged [] -> 12.480us
                 -->kernel: 0:7 %4380 =  [] -> 1.376us
                 -->kernel: 0:7 %4381 =  [] -> 2.144us
     %6179 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4382 =  [] -> 1.440us
     %6180 = :aten::index [[8], [8]] -> 43.680us
       %6181 = :aten::nonzero [[8]] -> 43.680us
         %6182 = CCCL:cub::DeviceReduce::Sum [] -> 1.344us
                 -->kernel: 0:7 %4383 =  [] -> 1.344us
         %6183 = CCCL:cub::DeviceSelect::Flagged [] -> 12.576us
                 -->kernel: 0:7 %4384 =  [] -> 1.344us
                 -->kernel: 0:7 %4385 =  [] -> 2.176us
     %6184 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4386 =  [] -> 1.440us
     %6185 = :aten::index [[8], [8]] -> 42.816us
       %6186 = :aten::nonzero [[8]] -> 42.816us
         %6187 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %4387 =  [] -> 1.280us
         %6188 = CCCL:cub::DeviceSelect::Flagged [] -> 12.448us
                 -->kernel: 0:7 %4388 =  [] -> 1.344us
                 -->kernel: 0:7 %4389 =  [] -> 2.144us
     %6189 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4390 =  [] -> 1.440us
     %6190 = :aten::index [[8], [8]] -> 43.392us
       %6191 = :aten::nonzero [[8]] -> 43.392us
         %6192 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4391 =  [] -> 1.312us
         %6193 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %4392 =  [] -> 1.312us
                 -->kernel: 0:7 %4393 =  [] -> 2.176us
     %6194 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %4394 =  [] -> 1.408us
     %6195 = :aten::index [[8], [8]] -> 43.232us
       %6196 = :aten::nonzero [[8]] -> 43.232us
         %6197 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %4395 =  [] -> 1.280us
         %6198 = CCCL:cub::DeviceSelect::Flagged [] -> 13.216us
                 -->kernel: 0:7 %4396 =  [] -> 1.344us
                 -->kernel: 0:7 %4397 =  [] -> 2.144us
     %6199 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4398 =  [] -> 1.440us
     %6200 = :aten::index [[8], [8]] -> 42.592us
       %6201 = :aten::nonzero [[8]] -> 42.592us
         %6202 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4399 =  [] -> 1.312us
         %6203 = CCCL:cub::DeviceSelect::Flagged [] -> 12.512us
                 -->kernel: 0:7 %4400 =  [] -> 1.312us
                 -->kernel: 0:7 %4401 =  [] -> 2.144us
     %6204 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4402 =  [] -> 1.440us
     %6205 = :aten::index [[8], [8]] -> 43.488us
       %6206 = :aten::nonzero [[8]] -> 43.488us
         %6207 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4403 =  [] -> 1.312us
         %6208 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %4404 =  [] -> 1.344us
                 -->kernel: 0:7 %4405 =  [] -> 2.112us
     %6209 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4406 =  [] -> 1.440us
     %6210 = :aten::index [[8], [8]] -> 43.872us
       %6211 = :aten::nonzero [[8]] -> 43.872us
         %6212 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4407 =  [] -> 1.312us
         %6213 = CCCL:cub::DeviceSelect::Flagged [] -> 12.384us
                 -->kernel: 0:7 %4408 =  [] -> 1.312us
                 -->kernel: 0:7 %4409 =  [] -> 2.176us
     %6214 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4410 =  [] -> 1.440us
     %6215 = :aten::index [[8], [8]] -> 43.200us
       %6216 = :aten::nonzero [[8]] -> 43.200us
         %6217 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4411 =  [] -> 1.312us
         %6218 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %4412 =  [] -> 1.344us
                 -->kernel: 0:7 %4413 =  [] -> 2.144us
     %6219 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4414 =  [] -> 1.440us
     %6220 = :aten::index [[8], [8]] -> 42.817us
       %6221 = :aten::nonzero [[8]] -> 42.817us
         %6222 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4415 =  [] -> 1.312us
         %6223 = CCCL:cub::DeviceSelect::Flagged [] -> 12.480us
                 -->kernel: 0:7 %4416 =  [] -> 1.312us
                 -->kernel: 0:7 %4417 =  [] -> 2.176us
     %6224 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %4418 =  [] -> 1.408us
     %6225 = :aten::index [[8], [8]] -> 42.336us
       %6226 = :aten::nonzero [[8]] -> 42.336us
         %6227 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %4419 =  [] -> 1.280us
         %6228 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %4420 =  [] -> 1.344us
                 -->kernel: 0:7 %4421 =  [] -> 2.112us
     %6229 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4422 =  [] -> 1.440us
     %6230 = :aten::index [[8], [8]] -> 42.496us
       %6231 = :aten::nonzero [[8]] -> 42.496us
         %6232 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4423 =  [] -> 1.312us
         %6233 = CCCL:cub::DeviceSelect::Flagged [] -> 12.416us
                 -->kernel: 0:7 %4424 =  [] -> 1.312us
                 -->kernel: 0:7 %4425 =  [] -> 2.176us
     %6234 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4426 =  [] -> 1.440us
     %6235 = :aten::index [[8], [8]] -> 43.009us
       %6236 = :aten::nonzero [[8]] -> 43.009us
         %6237 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %4427 =  [] -> 1.280us
         %6238 = CCCL:cub::DeviceSelect::Flagged [] -> 12.385us
                 -->kernel: 0:7 %4428 =  [] -> 1.344us
                 -->kernel: 0:7 %4429 =  [] -> 2.144us
     %6239 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %4430 =  [] -> 1.408us
     %6240 = :aten::index [[8], [8]] -> 42.912us
       %6241 = :aten::nonzero [[8]] -> 42.912us
         %6242 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4431 =  [] -> 1.312us
         %6243 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %4432 =  [] -> 1.344us
                 -->kernel: 0:7 %4433 =  [] -> 2.176us
     %6244 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4434 =  [] -> 1.440us
     %6245 = :aten::index [[8], [8]] -> 49.408us
       %6246 = :aten::nonzero [[8]] -> 49.408us
         %6247 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %4435 =  [] -> 1.280us
         %6248 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %4436 =  [] -> 1.344us
                 -->kernel: 0:7 %4437 =  [] -> 2.112us
     %6249 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4438 =  [] -> 1.440us
     %6250 = :aten::index [[8], [8]] -> 43.648us
       %6251 = :aten::nonzero [[8]] -> 43.648us
         %6252 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4439 =  [] -> 1.312us
         %6253 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %4440 =  [] -> 1.312us
                 -->kernel: 0:7 %4441 =  [] -> 2.176us
     %6254 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4442 =  [] -> 1.440us
     %6255 = :aten::index [[8], [8]] -> 43.168us
       %6256 = :aten::nonzero [[8]] -> 43.168us
         %6257 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %4443 =  [] -> 1.280us
         %6258 = CCCL:cub::DeviceSelect::Flagged [] -> 12.288us
                 -->kernel: 0:7 %4444 =  [] -> 1.344us
                 -->kernel: 0:7 %4445 =  [] -> 2.144us
     %6259 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4446 =  [] -> 1.440us
     %6260 = :aten::index [[8], [8]] -> 42.784us
       %6261 = :aten::nonzero [[8]] -> 42.784us
         %6262 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4447 =  [] -> 1.312us
         %6263 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %4448 =  [] -> 1.344us
                 -->kernel: 0:7 %4449 =  [] -> 2.176us
     %6264 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %4450 =  [] -> 1.408us
     %6265 = :aten::index [[8], [8]] -> 43.584us
       %6266 = :aten::nonzero [[8]] -> 43.584us
         %6267 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4451 =  [] -> 1.312us
         %6268 = CCCL:cub::DeviceSelect::Flagged [] -> 12.192us
                 -->kernel: 0:7 %4452 =  [] -> 1.344us
                 -->kernel: 0:7 %4453 =  [] -> 2.144us
     %6269 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4454 =  [] -> 1.440us
     %6270 = :aten::index [[8], [8]] -> 43.424us
       %6271 = :aten::nonzero [[8]] -> 43.424us
         %6272 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %4455 =  [] -> 1.280us
         %6273 = CCCL:cub::DeviceSelect::Flagged [] -> 12.448us
                 -->kernel: 0:7 %4456 =  [] -> 1.312us
                 -->kernel: 0:7 %4457 =  [] -> 2.176us
     %6274 = :aten::gt [[8], []] -> 1.440us
                 -->kernel: 0:7 %4458 =  [] -> 1.440us
     %6275 = :aten::index [[8], [8]] -> 42.176us
       %6276 = :aten::nonzero [[8]] -> 42.176us
         %6277 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4459 =  [] -> 1.312us
         %6278 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %4460 =  [] -> 1.376us
                 -->kernel: 0:7 %4461 =  [] -> 2.144us
     %6279 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %4462 =  [] -> 1.408us
     %6280 = :aten::index [[8], [8]] -> 42.432us
       %6281 = :aten::nonzero [[8]] -> 42.432us
         %6282 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %4463 =  [] -> 1.312us
         %6283 = CCCL:cub::DeviceSelect::Flagged [] -> 12.256us
                 -->kernel: 0:7 %4464 =  [] -> 1.280us
                 -->kernel: 0:7 %4465 =  [] -> 2.176us
     %6284 = :aten::zeros [[], [], [], [], []] -> 992.000ns
       %6285 = :aten::zero_ [[8, 24]] -> 992.000ns
         %6286 = :aten::fill_ [[8, 24], []] -> 992.000ns
                 -->kernel: 0:7 %4466 =  [] -> 992.000ns
     %6287 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.552us
       %6288 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.552us
         %6289 = :nccl:_all_gather_base [[24]] -> 7.552us
           %6290 = NCCL:ncclAllGather [] -> 7.552us
                 -->kernel: 0:7 %4467 =  [] -> 7.552us
     %6291 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4468 =  [] -> 1.824us
     %6292 = :aten::index [[8], [8]] -> 47.488us
       %6293 = :aten::nonzero [[8]] -> 47.488us
         %6294 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4469 =  [] -> 1.504us
         %6295 = CCCL:cub::DeviceSelect::Flagged [] -> 12.352us
                 -->kernel: 0:7 %4470 =  [] -> 1.056us
                 -->kernel: 0:7 %4471 =  [] -> 1.888us
     %6296 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4472 =  [] -> 1.760us
     %6297 = :aten::index [[8], [8]] -> 43.552us
       %6298 = :aten::nonzero [[8]] -> 43.552us
         %6299 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4473 =  [] -> 1.504us
         %6300 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %4474 =  [] -> 1.056us
                 -->kernel: 0:7 %4475 =  [] -> 1.856us
     %6301 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4476 =  [] -> 1.792us
     %6302 = :aten::index [[8], [8]] -> 42.752us
       %6303 = :aten::nonzero [[8]] -> 42.752us
         %6304 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4477 =  [] -> 1.472us
         %6305 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %4478 =  [] -> 1.056us
                 -->kernel: 0:7 %4479 =  [] -> 1.856us
     %6306 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4480 =  [] -> 1.792us
     %6307 = :aten::index [[8], [8]] -> 42.464us
       %6308 = :aten::nonzero [[8]] -> 42.464us
         %6309 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4481 =  [] -> 1.504us
         %6310 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %4482 =  [] -> 1.056us
                 -->kernel: 0:7 %4483 =  [] -> 1.856us
     %6311 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4484 =  [] -> 1.792us
     %6312 = :aten::index [[8], [8]] -> 43.808us
       %6313 = :aten::nonzero [[8]] -> 43.808us
         %6314 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4485 =  [] -> 1.504us
         %6315 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %4486 =  [] -> 1.056us
                 -->kernel: 0:7 %4487 =  [] -> 1.856us
     %6316 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4488 =  [] -> 1.760us
     %6317 = :aten::index [[8], [8]] -> 42.048us
       %6318 = :aten::nonzero [[8]] -> 42.048us
         %6319 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4489 =  [] -> 1.472us
         %6320 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %4490 =  [] -> 1.088us
                 -->kernel: 0:7 %4491 =  [] -> 1.856us
     %6321 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4492 =  [] -> 1.824us
     %6322 = :aten::index [[8], [8]] -> 43.296us
       %6323 = :aten::nonzero [[8]] -> 43.296us
         %6324 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4493 =  [] -> 1.504us
         %6325 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %4494 =  [] -> 1.088us
                 -->kernel: 0:7 %4495 =  [] -> 1.888us
     %6326 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4496 =  [] -> 1.824us
     %6327 = :aten::index [[8], [8]] -> 42.624us
       %6328 = :aten::nonzero [[8]] -> 42.624us
         %6329 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4497 =  [] -> 1.504us
         %6330 = CCCL:cub::DeviceSelect::Flagged [] -> 11.680us
                 -->kernel: 0:7 %4498 =  [] -> 1.056us
                 -->kernel: 0:7 %4499 =  [] -> 1.824us
     %6331 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4500 =  [] -> 1.824us
     %6332 = :aten::index [[8], [8]] -> 42.528us
       %6333 = :aten::nonzero [[8]] -> 42.528us
         %6334 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4501 =  [] -> 1.504us
         %6335 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %4502 =  [] -> 1.088us
                 -->kernel: 0:7 %4503 =  [] -> 1.888us
     %6336 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4504 =  [] -> 1.792us
     %6337 = :aten::index [[8], [8]] -> 43.136us
       %6338 = :aten::nonzero [[8]] -> 43.136us
         %6339 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %4505 =  [] -> 1.536us
         %6340 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %4506 =  [] -> 1.056us
                 -->kernel: 0:7 %4507 =  [] -> 1.856us
     %6341 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4508 =  [] -> 1.824us
     %6342 = :aten::index [[8], [8]] -> 42.464us
       %6343 = :aten::nonzero [[8]] -> 42.464us
         %6344 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4509 =  [] -> 1.504us
         %6345 = CCCL:cub::DeviceSelect::Flagged [] -> 12.224us
                 -->kernel: 0:7 %4510 =  [] -> 1.088us
                 -->kernel: 0:7 %4511 =  [] -> 1.888us
     %6346 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4512 =  [] -> 1.792us
     %6347 = :aten::index [[8], [8]] -> 42.465us
       %6348 = :aten::nonzero [[8]] -> 42.465us
         %6349 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %4513 =  [] -> 1.536us
         %6350 = CCCL:cub::DeviceSelect::Flagged [] -> 11.520us
                 -->kernel: 0:7 %4514 =  [] -> 1.056us
                 -->kernel: 0:7 %4515 =  [] -> 1.856us
     %6351 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4516 =  [] -> 1.792us
     %6352 = :aten::index [[8], [8]] -> 42.592us
       %6353 = :aten::nonzero [[8]] -> 42.592us
         %6354 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4517 =  [] -> 1.472us
         %6355 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %4518 =  [] -> 1.088us
                 -->kernel: 0:7 %4519 =  [] -> 1.888us
     %6356 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4520 =  [] -> 1.792us
     %6357 = :aten::index [[8], [8]] -> 42.208us
       %6358 = :aten::nonzero [[8]] -> 42.208us
         %6359 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %4521 =  [] -> 1.536us
         %6360 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %4522 =  [] -> 1.056us
                 -->kernel: 0:7 %4523 =  [] -> 1.856us
     %6361 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4524 =  [] -> 1.792us
     %6362 = :aten::index [[8], [8]] -> 42.657us
       %6363 = :aten::nonzero [[8]] -> 42.657us
         %6364 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4525 =  [] -> 1.472us
         %6365 = CCCL:cub::DeviceSelect::Flagged [] -> 11.841us
                 -->kernel: 0:7 %4526 =  [] -> 1.056us
                 -->kernel: 0:7 %4527 =  [] -> 1.888us
     %6366 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4528 =  [] -> 1.760us
     %6367 = :aten::index [[8], [8]] -> 42.176us
       %6368 = :aten::nonzero [[8]] -> 42.176us
         %6369 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4529 =  [] -> 1.504us
         %6370 = CCCL:cub::DeviceSelect::Flagged [] -> 11.552us
                 -->kernel: 0:7 %4530 =  [] -> 1.056us
                 -->kernel: 0:7 %4531 =  [] -> 1.824us
     %6371 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4532 =  [] -> 1.792us
     %6372 = :aten::index [[8], [8]] -> 42.816us
       %6373 = :aten::nonzero [[8]] -> 42.816us
         %6374 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4533 =  [] -> 1.504us
         %6375 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %4534 =  [] -> 1.088us
                 -->kernel: 0:7 %4535 =  [] -> 1.888us
     %6376 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4536 =  [] -> 1.792us
     %6377 = :aten::index [[8], [8]] -> 41.792us
       %6378 = :aten::nonzero [[8]] -> 41.792us
         %6379 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4537 =  [] -> 1.504us
         %6380 = CCCL:cub::DeviceSelect::Flagged [] -> 11.456us
                 -->kernel: 0:7 %4538 =  [] -> 1.056us
                 -->kernel: 0:7 %4539 =  [] -> 1.856us
     %6381 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4540 =  [] -> 1.824us
     %6382 = :aten::index [[8], [8]] -> 42.272us
       %6383 = :aten::nonzero [[8]] -> 42.272us
         %6384 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4541 =  [] -> 1.504us
         %6385 = CCCL:cub::DeviceSelect::Flagged [] -> 11.584us
                 -->kernel: 0:7 %4542 =  [] -> 1.024us
                 -->kernel: 0:7 %4543 =  [] -> 1.888us
     %6386 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %4544 =  [] -> 1.760us
     %6387 = :aten::index [[8], [8]] -> 42.752us
       %6388 = :aten::nonzero [[8]] -> 42.752us
         %6389 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4545 =  [] -> 1.504us
         %6390 = CCCL:cub::DeviceSelect::Flagged [] -> 11.456us
                 -->kernel: 0:7 %4546 =  [] -> 992.000ns
                 -->kernel: 0:7 %4547 =  [] -> 1.824us
     %6391 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4548 =  [] -> 1.824us
     %6392 = :aten::index [[8], [8]] -> 42.976us
       %6393 = :aten::nonzero [[8]] -> 42.976us
         %6394 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4549 =  [] -> 1.472us
         %6395 = CCCL:cub::DeviceSelect::Flagged [] -> 11.648us
                 -->kernel: 0:7 %4550 =  [] -> 1.024us
                 -->kernel: 0:7 %4551 =  [] -> 1.856us
     %6396 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4552 =  [] -> 1.792us
     %6397 = :aten::index [[8], [8]] -> 47.648us
       %6398 = :aten::nonzero [[8]] -> 47.648us
         %6399 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4553 =  [] -> 1.504us
         %6400 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %4554 =  [] -> 992.000ns
                 -->kernel: 0:7 %4555 =  [] -> 1.856us
     %6401 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %4556 =  [] -> 1.824us
     %6402 = :aten::index [[8], [8]] -> 43.136us
       %6403 = :aten::nonzero [[8]] -> 43.136us
         %6404 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %4557 =  [] -> 1.472us
         %6405 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %4558 =  [] -> 992.000ns
                 -->kernel: 0:7 %4559 =  [] -> 1.856us
     %6406 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %4560 =  [] -> 1.792us
     %6407 = :aten::index [[8], [8]] -> 43.648us
       %6408 = :aten::nonzero [[8]] -> 43.648us
         %6409 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %4561 =  [] -> 1.504us
         %6410 = CCCL:cub::DeviceSelect::Flagged [] -> 11.584us
                 -->kernel: 0:7 %4562 =  [] -> 992.000ns
                 -->kernel: 0:7 %4563 =  [] -> 1.824us
     %6411 = :aten::zero_ [[3002413056]] -> 1.799ms
       %6412 = :aten::fill_ [[3002413056], []] -> 1.799ms
                 -->kernel: 0:7 %4564 =  [] -> 441.409us
                 -->kernel: 0:7 %4565 =  [] -> 441.473us
                 -->kernel: 0:7 %4566 =  [] -> 441.473us
                 -->kernel: 0:7 %4567 =  [] -> 441.473us
     %6413 = :aten::zero_ [[352321536]] -> 207.873us
       %6414 = :aten::fill_ [[352321536], []] -> 207.873us
                 -->kernel: 0:7 %4568 =  [] -> 207.873us
     %6415 = :aten::zeros [[], [], [], [], []] -> 1.344us
       %6416 = :aten::zero_ [[]] -> 1.344us
         %6417 = :aten::fill_ [[], []] -> 1.344us
                 -->kernel: 0:7 %4569 =  [] -> 1.344us
     %6418 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.520us
       %6419 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.520us
         %6420 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.520us
     %6421 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.296us
       %6422 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.296us
         %6423 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.296us
     %6424 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 1.472us
       %6425 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 1.472us
         %6426 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.472us
     %6427 = :aten::to [[1, 1, 4096, 4096], [], [], [], [], [], [], []] -> 293.888us
       %6428 = :aten::_to_copy [[1, 1, 4096, 4096], [], [], [], [], [], []] -> 293.888us
         %6429 = :aten::copy_ [[1, 1, 4096, 4096], [1, 1, 4096, 4096], []] -> 293.888us
     %6430 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.040us
       %6431 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.040us
         %6432 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.040us
     %6433 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 273.632us
       %6434 = :aten::index_select [[129280, 7168], [], [4096]] -> 273.632us
                 -->kernel: 0:7 %4570 =  [] -> 273.632us
     %6435 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 127.680us
       %6436 = :nvte_rmsnorm_fwd [] -> 127.680us
                 -->kernel: 0:7 %4571 =  [] -> 127.680us
     %6437 = :TELinear forward [] -> 660.930us
       %6438 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 660.930us
         %6439 = :nvte_quantize_v2 [] -> 74.016us
           %6440 = :quantize_transpose_vector_blockwise [] -> 74.016us
                 -->kernel: 0:7 %4572 =  [] -> 74.016us
         %6441 = :nvte_quantize_v2 [] -> 19.936us
           %6442 = :quantize_transpose_square_blockwise [] -> 19.936us
                 -->kernel: 0:7 %4573 =  [] -> 19.936us
         %6443 = :nvte_cublas_gemm_scaled [] -> 338.881us
                 -->kernel: 0:7 %4574 =  [] -> 329.825us
     %6444 = :TELinear forward [] -> 409.889us
       %6445 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 409.889us
         %6446 = :nvte_quantize_v2 [] -> 73.248us
           %6447 = :quantize_transpose_vector_blockwise [] -> 73.248us
                 -->kernel: 0:7 %4575 =  [] -> 73.248us
         %6448 = :nvte_quantize_v2 [] -> 11.616us
           %6449 = :quantize_transpose_square_blockwise [] -> 11.616us
                 -->kernel: 0:7 %4576 =  [] -> 11.616us
         %6450 = :nvte_cublas_gemm_scaled [] -> 205.824us
                 -->kernel: 0:7 %4577 =  [] -> 198.144us
     %6451 = :TELayerNormColumnParallelLinear forward [] -> 1.374ms
       %6452 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.374ms
         %6453 = :nvte_rmsnorm_fwd [] -> 30.176us
                 -->kernel: 0:7 %4578 =  [] -> 30.176us
         %6454 = :nvte_quantize_v2 [] -> 17.056us
           %6455 = :quantize_transpose_vector_blockwise [] -> 17.056us
                 -->kernel: 0:7 %4579 =  [] -> 17.056us
         %6456 = :nvte_quantize_v2 [] -> 57.952us
           %6457 = :quantize_transpose_square_blockwise [] -> 57.952us
                 -->kernel: 0:7 %4580 =  [] -> 57.952us
         %6458 = :nvte_cublas_gemm_scaled [] -> 1.133ms
                 -->kernel: 0:7 %4581 =  [] -> 1.126ms
     %6459 = :TELayerNormColumnParallelLinear forward [] -> 911.106us
       %6460 = :aten::contiguous [[4096, 1, 512], []] -> 11.616us
         %6461 = :aten::clone [[4096, 1, 512], []] -> 11.616us
           %6462 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.616us
                 -->kernel: 0:7 %4582 =  [] -> 11.616us
       %6463 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 698.690us
         %6464 = :nvte_rmsnorm_fwd [] -> 4.320us
                 -->kernel: 0:7 %4583 =  [] -> 4.320us
         %6465 = :nvte_quantize_v2 [] -> 7.680us
           %6466 = :quantize_transpose_vector_blockwise [] -> 7.680us
                 -->kernel: 0:7 %4584 =  [] -> 7.680us
         %6467 = :nvte_quantize_v2 [] -> 28.640us
           %6468 = :quantize_transpose_square_blockwise [] -> 28.640us
                 -->kernel: 0:7 %4585 =  [] -> 28.640us
         %6469 = :nvte_cublas_gemm_scaled [] -> 525.761us
                 -->kernel: 0:7 %4586 =  [] -> 519.521us
     %6470 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.528us
                 -->kernel: 0:7 %4587 =  [] -> 114.528us
     %6471 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 173.792us
                 -->kernel: 0:7 %4588 =  [] -> 173.792us
     %6472 = :TEDotProductAttention forward [] -> 22.514ms
       %6473 = :aten::arange [[], [], [], [], []] -> 1.152us
         %6474 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %4589 =  [] -> 1.152us
       %6475 = :aten::arange [[], [], [], [], []] -> 1.152us
         %6476 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %4590 =  [] -> 1.152us
       %6477 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 61.312us
                 -->kernel: 0:7 %4591 =  [] -> 61.312us
       %6478 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 38.816us
                 -->kernel: 0:7 %4592 =  [] -> 38.816us
       %6479 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.145us
                 -->kernel: 0:7 %4593 =  [] -> 38.145us
       %6480 = :aten::le [[1, 1, 4096, 4096], []] -> 29.344us
                 -->kernel: 0:7 %4594 =  [] -> 29.344us
       %6481 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.704us
                 -->kernel: 0:7 %4595 =  [] -> 24.704us
       %6482 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.528us
                 -->kernel: 0:7 %4596 =  [] -> 14.528us
       %6483 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.912us
         %6484 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.912us
                 -->kernel: 0:7 %4597 =  [] -> 18.912us
       %6485 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.960us
         %6486 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.960us
                 -->kernel: 0:7 %4598 =  [] -> 12.960us
       %6487 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.304us
         %6488 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.304us
                 -->kernel: 0:7 %4599 =  [] -> 18.304us
       %6489 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.837ms
                 -->kernel: 0:7 %4600 =  [] -> 5.828ms
       %6490 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.004ms
         %6491 = :nvte_scaled_masked_softmax_forward [] -> 11.004ms
                 -->kernel: 0:7 %4601 =  [] -> 11.004ms
       %6492 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.991ms
                 -->kernel: 0:7 %4602 =  [] -> 3.978ms
       %6493 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.945us
         %6494 = :aten::clone [[4096, 1, 128, 128], []] -> 278.945us
           %6495 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.945us
                 -->kernel: 0:7 %4603 =  [] -> 278.945us
     %6496 = :TERowParallelLinear forward [] -> 3.849ms
       %6497 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.849ms
         %6498 = :nvte_quantize_v2 [] -> 97.761us
           %6499 = :quantize_transpose_vector_blockwise [] -> 97.761us
                 -->kernel: 0:7 %4604 =  [] -> 97.761us
         %6500 = :nvte_quantize_v2 [] -> 170.208us
           %6501 = :quantize_transpose_square_blockwise [] -> 170.208us
                 -->kernel: 0:7 %4605 =  [] -> 170.208us
         %6502 = :nvte_cublas_gemm_scaled [] -> 3.430ms
                 -->kernel: 0:7 %4606 =  [] -> 3.423ms
     %6503 = :Torch-Compiled Region: 1/2 None -> 43.649us
       %6504 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 43.649us
         %6505 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 43.649us
                 -->kernel: 0:7 %4607 =  [] -> 43.649us
     %6506 = :TELayerNormColumnParallelLinear forward [] -> 8.459ms
       %6507 = :_LayerNormLinear [[4096, 1, 7168], [7168], [], [36864, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 8.459ms
         %6508 = :nvte_rmsnorm_fwd [] -> 126.337us
                 -->kernel: 0:7 %4608 =  [] -> 126.337us
         %6509 = :nvte_quantize_v2 [] -> 73.120us
           %6510 = :quantize_transpose_vector_blockwise [] -> 73.120us
                 -->kernel: 0:7 %4609 =  [] -> 73.120us
         %6511 = :nvte_quantize_v2 [] -> 390.433us
           %6512 = :quantize_transpose_square_blockwise [] -> 390.433us
                 -->kernel: 0:7 %4610 =  [] -> 390.433us
         %6513 = :nvte_cublas_gemm_scaled [] -> 7.714ms
                 -->kernel: 0:7 %4611 =  [] -> 7.708ms
     %6514 = :SwiGLUFunction [[4096, 36864], [], []] -> 131.585us
       %6515 = :Torch-Compiled Region: 2/0 None -> 131.585us
         %6516 = :triton_poi_fused_mul_silu_0 [[4096, 36864], [4096, 18432], [], []] -> 131.585us
                 -->kernel: 0:7 %4612 =  [] -> 131.585us
     %6517 = :TERowParallelLinear forward [] -> 4.395ms
       %6518 = :_Linear [[7168, 18432], [4096, 1, 18432], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 4.395ms
         %6519 = :nvte_quantize_v2 [] -> 183.137us
           %6520 = :quantize_transpose_vector_blockwise [] -> 183.137us
                 -->kernel: 0:7 %4613 =  [] -> 183.137us
         %6521 = :nvte_quantize_v2 [] -> 194.720us
           %6522 = :quantize_transpose_square_blockwise [] -> 194.720us
                 -->kernel: 0:7 %4614 =  [] -> 194.720us
         %6523 = :nvte_cublas_gemm_scaled [] -> 3.871ms
                 -->kernel: 0:7 %4615 =  [] -> 3.864ms
     %6524 = :Torch-Compiled Region: 1/2 None -> 44.000us
       %6525 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.000us
         %6526 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.000us
                 -->kernel: 0:7 %4616 =  [] -> 44.000us
     %6527 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.241us
       %6528 = :nvte_rmsnorm_fwd [] -> 126.241us
                 -->kernel: 0:7 %4617 =  [] -> 126.241us
     %6529 = :TELinear forward [] -> 565.922us
       %6530 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 565.922us
         %6531 = :nvte_quantize_v2 [] -> 73.888us
           %6532 = :quantize_transpose_vector_blockwise [] -> 73.888us
                 -->kernel: 0:7 %4618 =  [] -> 73.888us
         %6533 = :nvte_quantize_v2 [] -> 20.512us
           %6534 = :quantize_transpose_square_blockwise [] -> 20.512us
                 -->kernel: 0:7 %4619 =  [] -> 20.512us
         %6535 = :nvte_cublas_gemm_scaled [] -> 337.601us
                 -->kernel: 0:7 %4620 =  [] -> 331.329us
     %6536 = :TELinear forward [] -> 403.457us
       %6537 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 403.457us
         %6538 = :nvte_quantize_v2 [] -> 72.704us
           %6539 = :quantize_transpose_vector_blockwise [] -> 72.704us
                 -->kernel: 0:7 %4621 =  [] -> 72.704us
         %6540 = :nvte_quantize_v2 [] -> 11.649us
           %6541 = :quantize_transpose_square_blockwise [] -> 11.649us
                 -->kernel: 0:7 %4622 =  [] -> 11.649us
         %6542 = :nvte_cublas_gemm_scaled [] -> 204.864us
                 -->kernel: 0:7 %4623 =  [] -> 198.080us
     %6543 = :TELayerNormColumnParallelLinear forward [] -> 1.373ms
       %6544 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.373ms
         %6545 = :nvte_rmsnorm_fwd [] -> 30.208us
                 -->kernel: 0:7 %4624 =  [] -> 30.208us
         %6546 = :nvte_quantize_v2 [] -> 17.056us
           %6547 = :quantize_transpose_vector_blockwise [] -> 17.056us
                 -->kernel: 0:7 %4625 =  [] -> 17.056us
         %6548 = :nvte_quantize_v2 [] -> 58.400us
           %6549 = :quantize_transpose_square_blockwise [] -> 58.400us
                 -->kernel: 0:7 %4626 =  [] -> 58.400us
         %6550 = :nvte_cublas_gemm_scaled [] -> 1.135ms
                 -->kernel: 0:7 %4627 =  [] -> 1.129ms
     %6551 = :TELayerNormColumnParallelLinear forward [] -> 900.514us
       %6552 = :aten::contiguous [[4096, 1, 512], []] -> 11.584us
         %6553 = :aten::clone [[4096, 1, 512], []] -> 11.584us
           %6554 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.584us
                 -->kernel: 0:7 %4628 =  [] -> 11.584us
       %6555 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 699.042us
         %6556 = :nvte_rmsnorm_fwd [] -> 4.256us
                 -->kernel: 0:7 %4629 =  [] -> 4.256us
         %6557 = :nvte_quantize_v2 [] -> 7.744us
           %6558 = :quantize_transpose_vector_blockwise [] -> 7.744us
                 -->kernel: 0:7 %4630 =  [] -> 7.744us
         %6559 = :nvte_quantize_v2 [] -> 28.576us
           %6560 = :quantize_transpose_square_blockwise [] -> 28.576us
                 -->kernel: 0:7 %4631 =  [] -> 28.576us
         %6561 = :nvte_cublas_gemm_scaled [] -> 527.009us
                 -->kernel: 0:7 %4632 =  [] -> 520.673us
     %6562 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.496us
                 -->kernel: 0:7 %4633 =  [] -> 114.496us
     %6563 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 173.089us
                 -->kernel: 0:7 %4634 =  [] -> 173.089us
     %6564 = :TEDotProductAttention forward [] -> 22.429ms
       %6565 = :aten::arange [[], [], [], [], []] -> 1.344us
         %6566 = :aten::arange [[], [], [], [0]] -> 1.344us
                 -->kernel: 0:7 %4635 =  [] -> 1.344us
       %6567 = :aten::arange [[], [], [], [], []] -> 1.152us
         %6568 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %4636 =  [] -> 1.152us
       %6569 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 61.216us
                 -->kernel: 0:7 %4637 =  [] -> 61.216us
       %6570 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 39.904us
                 -->kernel: 0:7 %4638 =  [] -> 39.904us
       %6571 = :aten::add [[1, 1, 4096, 4096], [], []] -> 37.888us
                 -->kernel: 0:7 %4639 =  [] -> 37.888us
       %6572 = :aten::le [[1, 1, 4096, 4096], []] -> 28.544us
                 -->kernel: 0:7 %4640 =  [] -> 28.544us
       %6573 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.512us
                 -->kernel: 0:7 %4641 =  [] -> 24.512us
       %6574 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.336us
                 -->kernel: 0:7 %4642 =  [] -> 14.336us
       %6575 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.976us
         %6576 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.976us
                 -->kernel: 0:7 %4643 =  [] -> 18.976us
       %6577 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.960us
         %6578 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.960us
                 -->kernel: 0:7 %4644 =  [] -> 12.960us
       %6579 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.112us
         %6580 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.112us
                 -->kernel: 0:7 %4645 =  [] -> 18.112us
       %6581 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.834ms
                 -->kernel: 0:7 %4646 =  [] -> 5.825ms
       %6582 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 11.000ms
         %6583 = :nvte_scaled_masked_softmax_forward [] -> 11.000ms
                 -->kernel: 0:7 %4647 =  [] -> 11.000ms
       %6584 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.991ms
                 -->kernel: 0:7 %4648 =  [] -> 3.977ms
       %6585 = :aten::contiguous [[4096, 1, 128, 128], []] -> 279.201us
         %6586 = :aten::clone [[4096, 1, 128, 128], []] -> 279.201us
           %6587 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 279.201us
                 -->kernel: 0:7 %4649 =  [] -> 279.201us
     %6588 = :TERowParallelLinear forward [] -> 3.847ms
       %6589 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.847ms
         %6590 = :nvte_quantize_v2 [] -> 97.696us
           %6591 = :quantize_transpose_vector_blockwise [] -> 97.696us
                 -->kernel: 0:7 %4650 =  [] -> 97.696us
         %6592 = :nvte_quantize_v2 [] -> 169.601us
           %6593 = :quantize_transpose_square_blockwise [] -> 169.601us
                 -->kernel: 0:7 %4651 =  [] -> 169.601us
         %6594 = :nvte_cublas_gemm_scaled [] -> 3.429ms
                 -->kernel: 0:7 %4652 =  [] -> 3.422ms
     %6595 = :Torch-Compiled Region: 1/2 None -> 44.992us
       %6596 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.992us
         %6597 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.992us
                 -->kernel: 0:7 %4653 =  [] -> 44.992us
     %6598 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.849us
       %6599 = :nvte_rmsnorm_fwd [] -> 126.849us
                 -->kernel: 0:7 %4654 =  [] -> 126.849us
     %6600 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 42.112us
       %6601 = :nvte_cublas_gemm_scaled [] -> 42.112us
                 -->kernel: 0:7 %4655 =  [] -> 21.984us
                 -->kernel: 0:7 %4656 =  [] -> 2.656us
     %6602 = :RandomSTE [[4096, 1, 32]] -> 45.441us
       %6603 = :aten::clone [[4096, 1, 32], []] -> 1.600us
         %6604 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.600us
       %6605 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.736us
                 -->kernel: 0:7 %4657 =  [] -> 4.736us
     %6606 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 70.368us
       %6607 = :nvte_fused_topk_with_score_function_forward [] -> 70.368us
                 -->kernel: 0:7 %4658 =  [] -> 70.368us
     %6608 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 27.200us
       %6609 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 27.200us
                 -->kernel: 0:7 %4659 =  [] -> 27.200us
     %6610 = :aten::sum [[4096, 32], [], [], []] -> 48.129us
       %6611 = :aten::to [[4096, 32], [], [], [], []] -> 4.769us
         %6612 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.769us
           %6613 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.769us
                 -->kernel: 0:7 %4660 =  [] -> 4.769us
                 -->kernel: 0:7 %4661 =  [] -> 10.112us
     %6614 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.320us
       %6615 = :nvte_fused_moe_aux_loss_forward [] -> 12.320us
                 -->kernel: 0:7 %4662 =  [] -> 12.320us
     %6616 = :aten::div [[], []] -> 1.248us
                 -->kernel: 0:7 %4663 =  [] -> 1.248us
     %6617 = :aten::div [[], []] -> 1.376us
                 -->kernel: 0:7 %4664 =  [] -> 1.376us
     %6618 = :aten::add_ [[], [], []] -> 1.344us
                 -->kernel: 0:7 %4665 =  [] -> 1.344us
     %6619 = :aten::sum [[4096, 32], [], [], []] -> 40.609us
       %6620 = :aten::to [[4096, 32], [], [], [], []] -> 4.736us
         %6621 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.736us
           %6622 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.736us
                 -->kernel: 0:7 %4666 =  [] -> 4.736us
                 -->kernel: 0:7 %4667 =  [] -> 7.744us
     %6623 = :aten::add_ [[32], [32], []] -> 4.096us
                 -->kernel: 0:7 %4668 =  [] -> 4.096us
     %6624 = :aten::topk [[4096, 32], [], [], [], []] -> 54.688us
                 -->kernel: 0:7 %4669 =  [] -> 14.464us
                 -->kernel: 0:7 %4670 =  [] -> 7.680us
     %6625 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 1.114ms
                 -->kernel: 0:26 %4671 =  [] -> 43.936us
                 -->kernel: 0:26 %4672 =  [] -> 155.392us
                 -->kernel: 0:26 %4673 =  [] -> 753.313us
     %6626 = :TEColumnParallelLinear forward [] -> 1.143ms
       %6627 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.143ms
         %6628 = :nvte_quantize_v2 [] -> 45.696us
           %6629 = :quantize_transpose_vector_blockwise [] -> 45.696us
                 -->kernel: 0:7 %4674 =  [] -> 45.696us
         %6630 = :nvte_quantize_v2 [] -> 45.248us
           %6631 = :quantize_transpose_square_blockwise [] -> 45.248us
                 -->kernel: 0:7 %4675 =  [] -> 45.248us
         %6632 = :nvte_cublas_gemm_scaled [] -> 921.506us
                 -->kernel: 0:7 %4676 =  [] -> 915.106us
     %6633 = :SwiGLUFunction [[4096, 4096], [], []] -> 27.424us
       %6634 = :Torch-Compiled Region: 2/1 None -> 27.424us
         %6635 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 27.424us
                 -->kernel: 0:7 %4677 =  [] -> 27.424us
     %6636 = :TERowParallelLinear forward [] -> 615.106us
       %6637 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 615.106us
         %6638 = :nvte_quantize_v2 [] -> 23.616us
           %6639 = :quantize_transpose_vector_blockwise [] -> 23.616us
                 -->kernel: 0:7 %4678 =  [] -> 23.616us
         %6640 = :nvte_quantize_v2 [] -> 24.768us
           %6641 = :quantize_transpose_square_blockwise [] -> 24.768us
                 -->kernel: 0:7 %4679 =  [] -> 24.768us
         %6642 = :nvte_cublas_gemm_scaled [] -> 446.977us
                 -->kernel: 0:7 %4680 =  [] -> 440.481us
     %6643 = :IndicesToMultihot [[15636, 8], [15636, 8], []] -> 10.976us
                 -->kernel: 0:7 %4681 =  [] -> 10.976us
     %6644 = :aten::contiguous [[4, 15636], []] -> 3.040us
       %6645 = :aten::clone [[4, 15636], []] -> 3.040us
         %6646 = :aten::copy_ [[4, 15636], [4, 15636], []] -> 3.040us
                 -->kernel: 0:7 %4682 =  [] -> 3.040us
     %6647 = :aten::to [[4, 15636], [], [], [], []] -> 5.024us
       %6648 = :aten::_to_copy [[4, 15636], [], [], [], [], [], []] -> 5.024us
         %6649 = :aten::copy_ [[4, 15636], [4, 15636], []] -> 5.024us
                 -->kernel: 0:7 %4683 =  [] -> 5.024us
                 -->kernel: 0:7 %4684 =  [] -> 22.496us
     %6650 = :_moe_permute_mask_map [[15636, 7168], [15636, 4], [], [15636, 4]] -> 407.073us
                 -->kernel: 0:7 %4685 =  [] -> 2.496us
                 -->kernel: 0:7 %4686 =  [] -> 2.624us
                 -->kernel: 0:7 %4687 =  [] -> 13.184us
                 -->kernel: 0:7 %4688 =  [] -> 200.129us
     %6651 = :TEColumnParallelGroupedLinear forward [] -> 8.462ms
       %6652 = :_GroupedLinear [[32640, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.462ms
         %6653 = :nvte_quantize_v2 [] -> 221.217us
           %6654 = :quantize_transpose_vector_blockwise [] -> 221.217us
                 -->kernel: 0:7 %4689 =  [] -> 221.217us
         %6655 = :nvte_quantize_v2 [] -> 220.001us
           %6656 = :quantize_transpose_vector_blockwise [] -> 220.001us
                 -->kernel: 0:7 %4690 =  [] -> 220.001us
         %6657 = :nvte_quantize_v2 [] -> 223.296us
           %6658 = :quantize_transpose_vector_blockwise [] -> 223.296us
                 -->kernel: 0:7 %4691 =  [] -> 223.296us
         %6659 = :nvte_quantize_v2 [] -> 220.225us
           %6660 = :quantize_transpose_vector_blockwise [] -> 220.225us
                 -->kernel: 0:7 %4692 =  [] -> 220.225us
         %6661 = :nvte_quantize_v2 [] -> 46.016us
           %6662 = :quantize_transpose_square_blockwise [] -> 46.016us
                 -->kernel: 0:7 %4693 =  [] -> 46.016us
         %6663 = :nvte_quantize_v2 [] -> 45.984us
           %6664 = :quantize_transpose_square_blockwise [] -> 45.984us
                 -->kernel: 0:7 %4694 =  [] -> 45.984us
         %6665 = :nvte_quantize_v2 [] -> 46.240us
           %6666 = :quantize_transpose_square_blockwise [] -> 46.240us
                 -->kernel: 0:7 %4695 =  [] -> 46.240us
         %6667 = :nvte_quantize_v2 [] -> 46.208us
           %6668 = :quantize_transpose_square_blockwise [] -> 46.208us
                 -->kernel: 0:7 %4696 =  [] -> 46.208us
         %6669 = :nvte_multi_stream_cublas_gemm [] -> 7.080ms
           %6670 = :nvte_cublas_gemm [] -> 1.757ms
                 -->kernel: 0:159 %4697 =  [] -> 1.749ms
           %6671 = :nvte_cublas_gemm [] -> 1.750ms
                 -->kernel: 0:160 %4698 =  [] -> 1.745ms
           %6672 = :nvte_cublas_gemm [] -> 1.753ms
                 -->kernel: 0:161 %4699 =  [] -> 1.748ms
           %6673 = :nvte_cublas_gemm [] -> 1.749ms
                 -->kernel: 0:162 %4700 =  [] -> 1.745ms
     %6674 = :WeightedSwiGLUFunction [[32640, 4096], [32640, 1], []] -> 119.393us
       %6675 = :Torch-Compiled Region: 3/1 None -> 119.393us
         %6676 = :triton_poi_fused__to_copy_mul_silu_0 [[32640, 4096], [32640, 1], [32640, 2048], [], []] -> 119.393us
                 -->kernel: 0:7 %4701 =  [] -> 119.393us
     %6677 = :TERowParallelGroupedLinear forward [] -> 4.239ms
       %6678 = :_GroupedLinear [[32640, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.239ms
         %6679 = :nvte_quantize_v2 [] -> 66.849us
           %6680 = :quantize_transpose_vector_blockwise [] -> 66.849us
                 -->kernel: 0:7 %4702 =  [] -> 66.849us
         %6681 = :nvte_quantize_v2 [] -> 67.680us
           %6682 = :quantize_transpose_vector_blockwise [] -> 67.680us
                 -->kernel: 0:7 %4703 =  [] -> 67.680us
         %6683 = :nvte_quantize_v2 [] -> 69.664us
           %6684 = :quantize_transpose_vector_blockwise [] -> 69.664us
                 -->kernel: 0:7 %4704 =  [] -> 69.664us
         %6685 = :nvte_quantize_v2 [] -> 69.280us
           %6686 = :quantize_transpose_vector_blockwise [] -> 69.280us
                 -->kernel: 0:7 %4705 =  [] -> 69.280us
         %6687 = :nvte_quantize_v2 [] -> 24.256us
           %6688 = :quantize_transpose_square_blockwise [] -> 24.256us
                 -->kernel: 0:7 %4706 =  [] -> 24.256us
         %6689 = :nvte_quantize_v2 [] -> 24.160us
           %6690 = :quantize_transpose_square_blockwise [] -> 24.160us
                 -->kernel: 0:7 %4707 =  [] -> 24.160us
         %6691 = :nvte_quantize_v2 [] -> 24.704us
           %6692 = :quantize_transpose_square_blockwise [] -> 24.704us
                 -->kernel: 0:7 %4708 =  [] -> 24.704us
         %6693 = :nvte_quantize_v2 [] -> 24.384us
           %6694 = :quantize_transpose_square_blockwise [] -> 24.384us
                 -->kernel: 0:7 %4709 =  [] -> 24.384us
         %6695 = :nvte_multi_stream_cublas_gemm [] -> 3.573ms
           %6696 = :nvte_cublas_gemm [] -> 877.186us
                 -->kernel: 0:159 %4710 =  [] -> 869.570us
           %6697 = :nvte_cublas_gemm [] -> 874.722us
                 -->kernel: 0:160 %4711 =  [] -> 869.730us
           %6698 = :nvte_cublas_gemm [] -> 886.850us
                 -->kernel: 0:161 %4712 =  [] -> 883.490us
           %6699 = :nvte_cublas_gemm [] -> 870.435us
                 -->kernel: 0:162 %4713 =  [] -> 866.787us
     %6700 = :_moe_unpermute_mask_map [[32640, 7168], [15636, 9], [], []] -> 225.089us
                 -->kernel: 0:7 %4714 =  [] -> 225.089us
     %6701 = :FusedCombine [[15636, 7168], [], []] -> 740.962us
                 -->kernel: 0:26 %4715 =  [] -> 14.464us
                 -->kernel: 0:26 %4716 =  [] -> 697.218us
     %6702 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 53.152us
                 -->kernel: 0:7 %4717 =  [] -> 53.152us
     %6703 = :Torch-Compiled Region: 1/2 None -> 47.072us
       %6704 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 47.072us
         %6705 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 47.072us
                 -->kernel: 0:7 %4718 =  [] -> 47.072us
     %6706 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.561us
       %6707 = :nvte_rmsnorm_fwd [] -> 126.561us
                 -->kernel: 0:7 %4719 =  [] -> 126.561us
     %6708 = :aten::roll [[1, 4096], [], []] -> 2.208us
                 -->kernel: 0:7 %4720 =  [] -> 2.208us
     %6709 = :aten::fill_ [[1], []] -> 1.216us
                 -->kernel: 0:7 %4721 =  [] -> 1.216us
     %6710 = :aten::sum [[1, 4096], []] -> 3.200us
       %6711 = :aten::sum [[1, 4096], [], [], []] -> 3.200us
                 -->kernel: 0:7 %4722 =  [] -> 3.200us
     %6712 = :aten::roll [[1, 4096], [], []] -> 2.208us
                 -->kernel: 0:7 %4723 =  [] -> 2.208us
     %6713 = :aten::fill_ [[1], []] -> 1.248us
                 -->kernel: 0:7 %4724 =  [] -> 1.248us
     %6714 = :aten::sum [[1, 4096], []] -> 3.520us
       %6715 = :aten::sum [[1, 4096], [], [], []] -> 3.520us
                 -->kernel: 0:7 %4725 =  [] -> 3.520us
     %6716 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 277.025us
       %6717 = :aten::index_select [[129280, 7168], [], [4096]] -> 277.025us
                 -->kernel: 0:7 %4726 =  [] -> 277.025us
     %6718 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 128.065us
       %6719 = :nvte_rmsnorm_fwd [] -> 128.065us
                 -->kernel: 0:7 %4727 =  [] -> 128.065us
     %6720 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.049us
       %6721 = :nvte_rmsnorm_fwd [] -> 126.049us
                 -->kernel: 0:7 %4728 =  [] -> 126.049us
     %6722 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 162.880us
                 -->kernel: 0:7 %4729 =  [] -> 162.880us
     %6723 = :TEColumnParallelLinear forward [] -> 3.413ms
       %6724 = :_Linear [[7168, 14336], [4096, 1, 14336], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.413ms
         %6725 = :nvte_quantize_v2 [] -> 144.480us
           %6726 = :quantize_transpose_vector_blockwise [] -> 144.480us
                 -->kernel: 0:7 %4730 =  [] -> 144.480us
         %6727 = :nvte_quantize_v2 [] -> 152.513us
           %6728 = :quantize_transpose_square_blockwise [] -> 152.513us
                 -->kernel: 0:7 %4731 =  [] -> 152.513us
         %6729 = :nvte_cublas_gemm_scaled [] -> 2.982ms
                 -->kernel: 0:7 %4732 =  [] -> 2.975ms
     %6730 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 121.312us
       %6731 = :nvte_rmsnorm_fwd [] -> 121.312us
                 -->kernel: 0:7 %4733 =  [] -> 121.312us
     %6732 = :TELinear forward [] -> 564.641us
       %6733 = :_Linear [[1536, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 564.641us
         %6734 = :nvte_quantize_v2 [] -> 74.432us
           %6735 = :quantize_transpose_vector_blockwise [] -> 74.432us
                 -->kernel: 0:7 %4734 =  [] -> 74.432us
         %6736 = :nvte_quantize_v2 [] -> 20.544us
           %6737 = :quantize_transpose_square_blockwise [] -> 20.544us
                 -->kernel: 0:7 %4735 =  [] -> 20.544us
         %6738 = :nvte_cublas_gemm_scaled [] -> 333.857us
                 -->kernel: 0:7 %4736 =  [] -> 327.329us
     %6739 = :TELinear forward [] -> 402.720us
       %6740 = :_Linear [[576, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 402.720us
         %6741 = :nvte_quantize_v2 [] -> 73.088us
           %6742 = :quantize_transpose_vector_blockwise [] -> 73.088us
                 -->kernel: 0:7 %4737 =  [] -> 73.088us
         %6743 = :nvte_quantize_v2 [] -> 11.488us
           %6744 = :quantize_transpose_square_blockwise [] -> 11.488us
                 -->kernel: 0:7 %4738 =  [] -> 11.488us
         %6745 = :nvte_cublas_gemm_scaled [] -> 203.360us
                 -->kernel: 0:7 %4739 =  [] -> 197.088us
     %6746 = :TELayerNormColumnParallelLinear forward [] -> 1.366ms
       %6747 = :_LayerNormLinear [[4096, 1, 1536], [1536], [], [24576, 1536], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.366ms
         %6748 = :nvte_rmsnorm_fwd [] -> 30.880us
                 -->kernel: 0:7 %4740 =  [] -> 30.880us
         %6749 = :nvte_quantize_v2 [] -> 16.992us
           %6750 = :quantize_transpose_vector_blockwise [] -> 16.992us
                 -->kernel: 0:7 %4741 =  [] -> 16.992us
         %6751 = :nvte_quantize_v2 [] -> 57.376us
           %6752 = :quantize_transpose_square_blockwise [] -> 57.376us
                 -->kernel: 0:7 %4742 =  [] -> 57.376us
         %6753 = :nvte_cublas_gemm_scaled [] -> 1.126ms
                 -->kernel: 0:7 %4743 =  [] -> 1.121ms
     %6754 = :TELayerNormColumnParallelLinear forward [] -> 888.898us
       %6755 = :aten::contiguous [[4096, 1, 512], []] -> 11.552us
         %6756 = :aten::clone [[4096, 1, 512], []] -> 11.552us
           %6757 = :aten::copy_ [[4096, 1, 512], [4096, 1, 512], []] -> 11.552us
                 -->kernel: 0:7 %4744 =  [] -> 11.552us
       %6758 = :_LayerNormLinear [[4096, 1, 512], [512], [], [32768, 512], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 693.217us
         %6759 = :nvte_rmsnorm_fwd [] -> 4.448us
                 -->kernel: 0:7 %4745 =  [] -> 4.448us
         %6760 = :nvte_quantize_v2 [] -> 7.744us
           %6761 = :quantize_transpose_vector_blockwise [] -> 7.744us
                 -->kernel: 0:7 %4746 =  [] -> 7.744us
         %6762 = :nvte_quantize_v2 [] -> 28.128us
           %6763 = :quantize_transpose_square_blockwise [] -> 28.128us
                 -->kernel: 0:7 %4747 =  [] -> 28.128us
         %6764 = :nvte_cublas_gemm_scaled [] -> 522.721us
                 -->kernel: 0:7 %4748 =  [] -> 516.577us
     %6765 = :ApplyMLARotaryEmbQ [[4096, 1, 128, 192], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], []] -> 114.272us
                 -->kernel: 0:7 %4749 =  [] -> 114.272us
     %6766 = :ApplyMLARotaryEmbKV [[4096, 1, 128, 256], [4096, 1, 1, 64], [4096, 1, 1, 64], [4096, 1, 1, 64], [], [], [], [], [], [], []] -> 173.504us
                 -->kernel: 0:7 %4750 =  [] -> 173.504us
     %6767 = :TEDotProductAttention forward [] -> 22.357ms
       %6768 = :aten::arange [[], [], [], [], []] -> 1.152us
         %6769 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %4751 =  [] -> 1.152us
       %6770 = :aten::arange [[], [], [], [], []] -> 1.344us
         %6771 = :aten::arange [[], [], [], [0]] -> 1.344us
                 -->kernel: 0:7 %4752 =  [] -> 1.344us
       %6772 = :aten::sub [[1, 1, 4096, 1], [1, 1, 1, 4096], []] -> 60.704us
                 -->kernel: 0:7 %4753 =  [] -> 60.704us
       %6773 = :aten::sub [[1, 1, 4096, 4096], [], []] -> 40.096us
                 -->kernel: 0:7 %4754 =  [] -> 40.096us
       %6774 = :aten::add [[1, 1, 4096, 4096], [], []] -> 38.112us
                 -->kernel: 0:7 %4755 =  [] -> 38.112us
       %6775 = :aten::le [[1, 1, 4096, 4096], []] -> 28.193us
                 -->kernel: 0:7 %4756 =  [] -> 28.193us
       %6776 = :aten::lt [[1, 1, 4096, 4096], []] -> 24.800us
                 -->kernel: 0:7 %4757 =  [] -> 24.800us
       %6777 = :aten::bitwise_not [[1, 1, 4096, 4096]] -> 14.240us
                 -->kernel: 0:7 %4758 =  [] -> 14.240us
       %6778 = :aten::__and__ [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.976us
         %6779 = :aten::bitwise_and [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.976us
                 -->kernel: 0:7 %4759 =  [] -> 18.976us
       %6780 = :aten::logical_not [[1, 1, 4096, 4096]] -> 12.864us
         %6781 = :aten::logical_not [[1, 1, 4096, 4096], [0]] -> 12.864us
                 -->kernel: 0:7 %4760 =  [] -> 12.864us
       %6782 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096]] -> 18.176us
         %6783 = :aten::logical_or [[1, 1, 4096, 4096], [1, 1, 4096, 4096], [0]] -> 18.176us
                 -->kernel: 0:7 %4761 =  [] -> 18.176us
       %6784 = :aten::baddbmm [[128, 4096, 4096], [128, 4096, 192], [128, 192, 4096], [], []] -> 5.805ms
                 -->kernel: 0:7 %4762 =  [] -> 5.797ms
       %6785 = :ScaledMaskedSoftmax [[1, 128, 4096, 4096], [1, 1, 4096, 4096], []] -> 10.992ms
         %6786 = :nvte_scaled_masked_softmax_forward [] -> 10.992ms
                 -->kernel: 0:7 %4763 =  [] -> 10.992ms
       %6787 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.981ms
                 -->kernel: 0:7 %4764 =  [] -> 3.966ms
       %6788 = :aten::contiguous [[4096, 1, 128, 128], []] -> 278.784us
         %6789 = :aten::clone [[4096, 1, 128, 128], []] -> 278.784us
           %6790 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 278.784us
                 -->kernel: 0:7 %4765 =  [] -> 278.784us
     %6791 = :TERowParallelLinear forward [] -> 3.821ms
       %6792 = :_Linear [[7168, 16384], [4096, 1, 16384], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 3.821ms
         %6793 = :nvte_quantize_v2 [] -> 96.576us
           %6794 = :quantize_transpose_vector_blockwise [] -> 96.576us
                 -->kernel: 0:7 %4766 =  [] -> 96.576us
         %6795 = :nvte_quantize_v2 [] -> 169.857us
           %6796 = :quantize_transpose_square_blockwise [] -> 169.857us
                 -->kernel: 0:7 %4767 =  [] -> 169.857us
         %6797 = :nvte_cublas_gemm_scaled [] -> 3.405ms
                 -->kernel: 0:7 %4768 =  [] -> 3.398ms
     %6798 = :Torch-Compiled Region: 1/2 None -> 44.032us
       %6799 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 44.032us
         %6800 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 44.032us
                 -->kernel: 0:7 %4769 =  [] -> 44.032us
     %6801 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 125.953us
       %6802 = :nvte_rmsnorm_fwd [] -> 125.953us
                 -->kernel: 0:7 %4770 =  [] -> 125.953us
     %6803 = :RouterGatingLinearFunction [[4096, 1, 7168], [32, 7168]] -> 41.728us
       %6804 = :nvte_cublas_gemm_scaled [] -> 41.728us
                 -->kernel: 0:7 %4771 =  [] -> 22.176us
                 -->kernel: 0:7 %4772 =  [] -> 2.560us
     %6805 = :RandomSTE [[4096, 1, 32]] -> 41.729us
       %6806 = :aten::clone [[4096, 1, 32], []] -> 1.536us
         %6807 = :aten::copy_ [[4096, 1, 32], [4096, 1, 32], []] -> 1.536us
       %6808 = :aten::normal_ [[4096, 1, 32], [], [], []] -> 4.833us
                 -->kernel: 0:7 %4773 =  [] -> 4.833us
     %6809 = :FusedTopkScoreFunction [[4096, 32], [], [], [], [], [], [32]] -> 69.696us
       %6810 = :nvte_fused_topk_with_score_function_forward [] -> 69.696us
                 -->kernel: 0:7 %4774 =  [] -> 69.696us
     %6811 = :FusedComputeScoresForMoEAuxLoss [[4096, 32], []] -> 26.784us
       %6812 = :nvte_fused_score_for_moe_aux_loss_forward [] -> 26.784us
                 -->kernel: 0:7 %4775 =  [] -> 26.784us
     %6813 = :aten::sum [[4096, 32], [], [], []] -> 46.497us
       %6814 = :aten::to [[4096, 32], [], [], [], []] -> 4.768us
         %6815 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.768us
           %6816 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.768us
                 -->kernel: 0:7 %4776 =  [] -> 4.768us
                 -->kernel: 0:7 %4777 =  [] -> 9.856us
     %6817 = :FusedAuxLoss [[4096, 32], [32], [], [], [], []] -> 12.096us
       %6818 = :nvte_fused_moe_aux_loss_forward [] -> 12.096us
                 -->kernel: 0:7 %4778 =  [] -> 12.096us
     %6819 = :aten::div [[], []] -> 1.344us
                 -->kernel: 0:7 %4779 =  [] -> 1.344us
     %6820 = :aten::div [[], []] -> 1.632us
                 -->kernel: 0:7 %4780 =  [] -> 1.632us
     %6821 = :aten::add_ [[], [], []] -> 1.472us
                 -->kernel: 0:7 %4781 =  [] -> 1.472us
     %6822 = :aten::sum [[4096, 32], [], [], []] -> 35.425us
       %6823 = :aten::to [[4096, 32], [], [], [], []] -> 4.672us
         %6824 = :aten::_to_copy [[4096, 32], [], [], [], [], [], []] -> 4.672us
           %6825 = :aten::copy_ [[4096, 32], [4096, 32], []] -> 4.672us
                 -->kernel: 0:7 %4782 =  [] -> 4.672us
                 -->kernel: 0:7 %4783 =  [] -> 7.745us
     %6826 = :aten::add_ [[32], [32], []] -> 4.032us
                 -->kernel: 0:7 %4784 =  [] -> 4.032us
     %6827 = :aten::topk [[4096, 32], [], [], [], []] -> 51.584us
                 -->kernel: 0:7 %4785 =  [] -> 14.464us
                 -->kernel: 0:7 %4786 =  [] -> 7.648us
     %6828 = :FusedDispatch [[4096, 7168], [4096, 8], [4096, 8], [], [], []] -> 844.354us
                 -->kernel: 0:26 %4787 =  [] -> 45.184us
                 -->kernel: 0:26 %4788 =  [] -> 12.480us
                 -->kernel: 0:26 %4789 =  [] -> 657.986us
     %6829 = :TEColumnParallelLinear forward [] -> 1.152ms
       %6830 = :_Linear [[4096, 7168], [4096, 1, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 1.152ms
         %6831 = :nvte_quantize_v2 [] -> 44.960us
           %6832 = :quantize_transpose_vector_blockwise [] -> 44.960us
                 -->kernel: 0:7 %4790 =  [] -> 44.960us
         %6833 = :nvte_quantize_v2 [] -> 44.641us
           %6834 = :quantize_transpose_square_blockwise [] -> 44.641us
                 -->kernel: 0:7 %4791 =  [] -> 44.641us
         %6835 = :nvte_cublas_gemm_scaled [] -> 912.258us
                 -->kernel: 0:7 %4792 =  [] -> 905.826us
     %6836 = :SwiGLUFunction [[4096, 4096], [], []] -> 26.944us
       %6837 = :Torch-Compiled Region: 2/1 None -> 26.944us
         %6838 = :triton_poi_fused_mul_silu_0 [[4096, 4096], [4096, 2048], [], [], [], []] -> 26.944us
                 -->kernel: 0:7 %4793 =  [] -> 26.944us
     %6839 = :TERowParallelLinear forward [] -> 607.874us
       %6840 = :_Linear [[7168, 2048], [4096, 1, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []] -> 607.874us
         %6841 = :nvte_quantize_v2 [] -> 23.008us
           %6842 = :quantize_transpose_vector_blockwise [] -> 23.008us
                 -->kernel: 0:7 %4794 =  [] -> 23.008us
         %6843 = :nvte_quantize_v2 [] -> 24.832us
           %6844 = :quantize_transpose_square_blockwise [] -> 24.832us
                 -->kernel: 0:7 %4795 =  [] -> 24.832us
         %6845 = :nvte_cublas_gemm_scaled [] -> 441.601us
                 -->kernel: 0:7 %4796 =  [] -> 435.233us
     %6846 = :IndicesToMultihot [[15871, 8], [15871, 8], []] -> 11.104us
                 -->kernel: 0:7 %4797 =  [] -> 11.104us
     %6847 = :aten::contiguous [[4, 15871], []] -> 3.040us
       %6848 = :aten::clone [[4, 15871], []] -> 3.040us
         %6849 = :aten::copy_ [[4, 15871], [4, 15871], []] -> 3.040us
                 -->kernel: 0:7 %4798 =  [] -> 3.040us
     %6850 = :aten::to [[4, 15871], [], [], [], []] -> 4.960us
       %6851 = :aten::_to_copy [[4, 15871], [], [], [], [], [], []] -> 4.960us
         %6852 = :aten::copy_ [[4, 15871], [4, 15871], []] -> 4.960us
                 -->kernel: 0:7 %4799 =  [] -> 4.960us
                 -->kernel: 0:7 %4800 =  [] -> 23.136us
     %6853 = :_moe_permute_mask_map [[15871, 7168], [15871, 4], [], [15871, 4]] -> 401.633us
                 -->kernel: 0:7 %4801 =  [] -> 2.176us
                 -->kernel: 0:7 %4802 =  [] -> 2.464us
                 -->kernel: 0:7 %4803 =  [] -> 13.312us
                 -->kernel: 0:7 %4804 =  [] -> 203.169us
     %6854 = :TEColumnParallelGroupedLinear forward [] -> 8.219ms
       %6855 = :_GroupedLinear [[33104, 7168], [], [], [], [], [], [], [], [], [], [], [], [], [4096, 7168], [4096, 7168], [4096, 7168], [4096, 7168], [0], [0], [0], [0]] -> 8.219ms
         %6856 = :nvte_quantize_v2 [] -> 147.137us
           %6857 = :quantize_transpose_vector_blockwise [] -> 147.137us
                 -->kernel: 0:7 %4805 =  [] -> 147.137us
         %6858 = :nvte_quantize_v2 [] -> 219.456us
           %6859 = :quantize_transpose_vector_blockwise [] -> 219.456us
                 -->kernel: 0:7 %4806 =  [] -> 219.456us
         %6860 = :nvte_quantize_v2 [] -> 144.001us
           %6861 = :quantize_transpose_vector_blockwise [] -> 144.001us
                 -->kernel: 0:7 %4807 =  [] -> 144.001us
         %6862 = :nvte_quantize_v2 [] -> 146.112us
           %6863 = :quantize_transpose_vector_blockwise [] -> 146.112us
                 -->kernel: 0:7 %4808 =  [] -> 146.112us
         %6864 = :nvte_quantize_v2 [] -> 45.888us
           %6865 = :quantize_transpose_square_blockwise [] -> 45.888us
                 -->kernel: 0:7 %4809 =  [] -> 45.888us
         %6866 = :nvte_quantize_v2 [] -> 45.536us
           %6867 = :quantize_transpose_square_blockwise [] -> 45.536us
                 -->kernel: 0:7 %4810 =  [] -> 45.536us
         %6868 = :nvte_quantize_v2 [] -> 45.217us
           %6869 = :quantize_transpose_square_blockwise [] -> 45.217us
                 -->kernel: 0:7 %4811 =  [] -> 45.217us
         %6870 = :nvte_quantize_v2 [] -> 45.472us
           %6871 = :quantize_transpose_square_blockwise [] -> 45.472us
                 -->kernel: 0:7 %4812 =  [] -> 45.472us
         %6872 = :nvte_multi_stream_cublas_gemm [] -> 7.079ms
           %6873 = :nvte_cublas_gemm [] -> 1.758ms
                 -->kernel: 0:159 %4813 =  [] -> 1.749ms
           %6874 = :nvte_cublas_gemm [] -> 1.751ms
                 -->kernel: 0:160 %4814 =  [] -> 1.745ms
           %6875 = :nvte_cublas_gemm [] -> 1.753ms
                 -->kernel: 0:161 %4815 =  [] -> 1.749ms
           %6876 = :nvte_cublas_gemm [] -> 1.754ms
                 -->kernel: 0:162 %4816 =  [] -> 1.749ms
     %6877 = :WeightedSwiGLUFunction [[33104, 4096], [33104, 1], []] -> 122.048us
       %6878 = :Torch-Compiled Region: 3/1 None -> 122.048us
         %6879 = :triton_poi_fused__to_copy_mul_silu_0 [[33104, 4096], [33104, 1], [33104, 2048], [], []] -> 122.048us
                 -->kernel: 0:7 %4817 =  [] -> 122.048us
     %6880 = :TERowParallelGroupedLinear forward [] -> 4.183ms
       %6881 = :_GroupedLinear [[33104, 2048], [], [], [], [], [], [], [], [], [], [], [], [], [7168, 2048], [7168, 2048], [7168, 2048], [7168, 2048], [0], [0], [0], [0]] -> 4.183ms
         %6882 = :nvte_quantize_v2 [] -> 44.960us
           %6883 = :quantize_transpose_vector_blockwise [] -> 44.960us
                 -->kernel: 0:7 %4818 =  [] -> 44.960us
         %6884 = :nvte_quantize_v2 [] -> 68.736us
           %6885 = :quantize_transpose_vector_blockwise [] -> 68.736us
                 -->kernel: 0:7 %4819 =  [] -> 68.736us
         %6886 = :nvte_quantize_v2 [] -> 45.440us
           %6887 = :quantize_transpose_vector_blockwise [] -> 45.440us
                 -->kernel: 0:7 %4820 =  [] -> 45.440us
         %6888 = :nvte_quantize_v2 [] -> 45.792us
           %6889 = :quantize_transpose_vector_blockwise [] -> 45.792us
                 -->kernel: 0:7 %4821 =  [] -> 45.792us
         %6890 = :nvte_quantize_v2 [] -> 25.056us
           %6891 = :quantize_transpose_square_blockwise [] -> 25.056us
                 -->kernel: 0:7 %4822 =  [] -> 25.056us
         %6892 = :nvte_quantize_v2 [] -> 24.321us
           %6893 = :quantize_transpose_square_blockwise [] -> 24.321us
                 -->kernel: 0:7 %4823 =  [] -> 24.321us
         %6894 = :nvte_quantize_v2 [] -> 24.384us
           %6895 = :quantize_transpose_square_blockwise [] -> 24.384us
                 -->kernel: 0:7 %4824 =  [] -> 24.384us
         %6896 = :nvte_quantize_v2 [] -> 24.640us
           %6897 = :quantize_transpose_square_blockwise [] -> 24.640us
                 -->kernel: 0:7 %4825 =  [] -> 24.640us
         %6898 = :nvte_multi_stream_cublas_gemm [] -> 3.600ms
           %6899 = :nvte_cublas_gemm [] -> 890.882us
                 -->kernel: 0:159 %4826 =  [] -> 884.098us
           %6900 = :nvte_cublas_gemm [] -> 870.562us
                 -->kernel: 0:160 %4827 =  [] -> 866.882us
           %6901 = :nvte_cublas_gemm [] -> 887.490us
                 -->kernel: 0:161 %4828 =  [] -> 884.034us
           %6902 = :nvte_cublas_gemm [] -> 887.970us
                 -->kernel: 0:162 %4829 =  [] -> 883.778us
     %6903 = :_moe_unpermute_mask_map [[33104, 7168], [15871, 9], [], []] -> 228.033us
                 -->kernel: 0:7 %4830 =  [] -> 228.033us
     %6904 = :FusedCombine [[15871, 7168], [], []] -> 788.226us
                 -->kernel: 0:26 %4831 =  [] -> 30.400us
                 -->kernel: 0:26 %4832 =  [] -> 729.186us
     %6905 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.968us
                 -->kernel: 0:7 %4833 =  [] -> 51.968us
     %6906 = :Torch-Compiled Region: 1/2 None -> 48.320us
       %6907 = :CompiledFunction [[4096, 1, 7168], [], [4096, 1, 7168]] -> 48.320us
         %6908 = :triton_poi_fused_add_0 [[4096, 1, 7168], [4096, 1, 7168], [4096, 1, 7168], [], []] -> 48.320us
                 -->kernel: 0:7 %4834 =  [] -> 48.320us
     %6909 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 126.272us
       %6910 = :nvte_rmsnorm_fwd [] -> 126.272us
                 -->kernel: 0:7 %4835 =  [] -> 126.272us
     %6911 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 163.009us
                 -->kernel: 0:7 %4836 =  [] -> 163.009us
     %6912 = :aten::clone [[1, 4096], []] -> 1.728us
       %6913 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.728us
     %6914 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.677ms
       %6915 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.677ms
         %6916 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.677ms
                 -->kernel: 0:7 %4837 =  [] -> 53.667ms
     %6917 = :aten::roll [[1, 4096], [], []] -> 2.080us
                 -->kernel: 0:7 %4838 =  [] -> 2.080us
     %6918 = :aten::fill_ [[1], []] -> 1.344us
                 -->kernel: 0:7 %4839 =  [] -> 1.344us
     %6919 = :aten::sum [[1, 4096], []] -> 3.616us
       %6920 = :aten::sum [[1, 4096], [], [], []] -> 3.616us
                 -->kernel: 0:7 %4840 =  [] -> 3.616us
     %6921 = :aten::roll [[1, 4096], [], []] -> 2.112us
                 -->kernel: 0:7 %4841 =  [] -> 2.112us
     %6922 = :aten::fill_ [[1], []] -> 1.120us
                 -->kernel: 0:7 %4842 =  [] -> 1.120us
     %6923 = :aten::sum [[1, 4096], []] -> 3.456us
       %6924 = :aten::sum [[1, 4096], [], [], []] -> 3.456us
                 -->kernel: 0:7 %4843 =  [] -> 3.456us
     %6925 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.476ms
       %6926 = :aten::zeros [[], [], [], [], []] -> 1.152us
         %6927 = :aten::zero_ [[4096]] -> 1.152us
           %6928 = :aten::fill_ [[4096], []] -> 1.152us
                 -->kernel: 0:7 %4844 =  [] -> 1.152us
       %6929 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %6930 = :aten::zero_ [[12288]] -> 1.120us
           %6931 = :aten::fill_ [[12288], []] -> 1.120us
                 -->kernel: 0:7 %4845 =  [] -> 1.120us
                 -->kernel: 0:7 %4846 =  [] -> 659.041us
                 -->kernel: 0:7 %4847 =  [] -> 600.130us
     %6932 = :aten::mul [[1, 4096], [1, 4096]] -> 1.920us
                 -->kernel: 0:7 %4848 =  [] -> 1.920us
     %6933 = :aten::sum [[1, 4096], []] -> 2.752us
       %6934 = :aten::sum [[1, 4096], [], [], []] -> 2.752us
                 -->kernel: 0:7 %4849 =  [] -> 2.752us
     %6935 = :aten::div [[], []] -> 1.728us
                 -->kernel: 0:7 %4850 =  [] -> 1.728us
     %6936 = :aten::add_ [[], [], []] -> 1.632us
                 -->kernel: 0:7 %4851 =  [] -> 1.632us
     %6937 = :aten::mul [[1, 4096], []] -> 1.312us
                 -->kernel: 0:7 %4852 =  [] -> 1.312us
     %6938 = :aten::div [[1, 4096], []] -> 2.240us
                 -->kernel: 0:7 %4853 =  [] -> 2.240us
     %6939 = :LinearWithGradAccumulationAndAsyncCommunication [[4096, 1, 7168], [129280, 7168], [], [], [], [], [], []] -> 53.695ms
       %6940 = :aten::matmul [[4096, 1, 7168], [7168, 129280]] -> 53.695ms
         %6941 = :aten::mm [[4096, 7168], [7168, 129280]] -> 53.695ms
                 -->kernel: 0:7 %4854 =  [] -> 53.686ms
     %6942 = :CrossEntropyFunction [[4096, 1, 129280], [4096, 1], [], [], [], []] -> 1.481ms
       %6943 = :aten::zeros [[], [], [], [], []] -> 1.120us
         %6944 = :aten::zero_ [[4096]] -> 1.120us
           %6945 = :aten::fill_ [[4096], []] -> 1.120us
                 -->kernel: 0:7 %4855 =  [] -> 1.120us
       %6946 = :aten::zeros [[], [], [], [], []] -> 1.248us
         %6947 = :aten::zero_ [[12288]] -> 1.248us
           %6948 = :aten::fill_ [[12288], []] -> 1.248us
                 -->kernel: 0:7 %4856 =  [] -> 1.248us
                 -->kernel: 0:7 %4857 =  [] -> 659.681us
                 -->kernel: 0:7 %4858 =  [] -> 600.898us
     %6949 = :aten::mul [[4096], [4096]] -> 1.888us
                 -->kernel: 0:7 %4859 =  [] -> 1.888us
     %6950 = :aten::sum [[4096], []] -> 3.360us
       %6951 = :aten::sum [[4096], [], [], []] -> 3.360us
                 -->kernel: 0:7 %4860 =  [] -> 3.360us
     %6952 = :aten::sum [[4096], []] -> 2.816us
       %6953 = :aten::sum [[4096], [], [], []] -> 2.816us
                 -->kernel: 0:7 %4861 =  [] -> 2.816us
     %6954 = :aten::stack [[], [], []] -> 1.920us
       %6955 = :aten::cat [[1], [1], []] -> 1.920us
                 -->kernel: 0:7 %4862 =  [] -> 1.920us
     %6956 = :aten::isnan [[2]] -> 1.600us
       %6957 = :aten::ne [[2], [2]] -> 1.600us
                 -->kernel: 0:7 %4863 =  [] -> 1.600us
     %6958 = :aten::any [[2]] -> 3.072us
                 -->kernel: 0:7 %4864 =  [] -> 3.072us
     %6959 = :aten::is_nonzero [[]] -> 2.944us
       %6960 = :aten::item [[]] -> 2.944us
         %6961 = :aten::_local_scalar_dense [[]] -> 2.944us
     %6962 = :aten::clone [[], []] -> 1.120us
       %6963 = :aten::copy_ [[], [], []] -> 1.120us
     %6964 = :aten::clone [[], []] -> 1.152us
       %6965 = :aten::copy_ [[], [], []] -> 1.152us
     %6966 = :aten::cat [[1], [1], []] -> 2.112us
                 -->kernel: 0:7 %4865 =  [] -> 2.112us
     %6967 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 113.120us
       %6968 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 113.120us
         %6969 = :nccl:all_reduce [[2]] -> 113.120us
           %6970 = NCCL:ncclAllReduce [] -> 113.120us
                 -->kernel: 0:7 %4866 =  [] -> 113.120us
     %6971 = :aten::div [[2], []] -> 1.184us
                 -->kernel: 0:7 %4867 =  [] -> 1.184us
     %6972 = :aten::div [[], []] -> 1.312us
                 -->kernel: 0:7 %4868 =  [] -> 1.312us
     %6973 = :aten::mul [[], []] -> 1.280us
                 -->kernel: 0:7 %4869 =  [] -> 1.280us
     %6974 = :aten::mul_ [[], []] -> 1.280us
                 -->kernel: 0:7 %4870 =  [] -> 1.280us
     %6975 = :aten::div_ [[], []] -> 1.056us
                 -->kernel: 0:7 %4871 =  [] -> 1.056us
     %6976 = :aten::ones [[], [], [], [], []] -> 896.000ns
       %6977 = :aten::fill_ [[1], []] -> 896.000ns
                 -->kernel: 0:7 %4872 =  [] -> 896.000ns
     %6978 = :aten::mul [[1], [1]] -> 1.536us
                 -->kernel: 0:7 %4873 =  [] -> 1.536us
     %6979 = :aten::div [[1], []] -> 1.344us
                 -->kernel: 0:7 %4874 =  [] -> 1.344us
     %6980 = :aten::copy_ [[1], [1], []] -> 992.000ns
     %6981 = :aten::ones [[], [], [], [], []] -> 928.000ns
       %6982 = :aten::fill_ [[1], []] -> 928.000ns
                 -->kernel: 0:7 %4875 =  [] -> 928.000ns
     %6983 = :aten::mul [[1], [1]] -> 1.312us
                 -->kernel: 0:7 %4876 =  [] -> 1.312us
     %6984 = :aten::div [[1], []] -> 1.568us
                 -->kernel: 0:7 %4877 =  [] -> 1.568us
     %6985 = :aten::add_ [[], [], []] -> 1.408us
                 -->kernel: 0:7 %4878 =  [] -> 1.408us
     %6986 = :aten::mul [[1], []] -> 1.088us
                 -->kernel: 0:7 %4879 =  [] -> 1.088us
     %6987 = :aten::ones_like [[1], [], [], [], [], []] -> 1.088us
       %6988 = :aten::fill_ [[1], []] -> 1.088us
                 -->kernel: 0:7 %4880 =  [] -> 1.088us
     %6989 = :autograd::engine::evaluate_function: MulBackward0 None -> 107.041us
       %6990 = :MulBackward0 [[1]] -> 1.440us
         %6991 = :aten::mul [[1], [1]] -> 1.440us
                 -->kernel: 0:7 %4881 =  [] -> 1.440us
       %6992 = :aten::sum [[1], []] -> 2.464us
         %6993 = :aten::sum [[1], [], [], []] -> 2.464us
                 -->kernel: 0:7 %4882 =  [] -> 2.464us
     %6994 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.344us
       %6995 = :DivBackward0 [[]] -> 1.344us
         %6996 = :aten::div [[], []] -> 1.344us
                 -->kernel: 0:7 %4883 =  [] -> 1.344us
     %6997 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.344us
       %6998 = :MulBackward0 [[]] -> 1.344us
         %6999 = :aten::mul [[], []] -> 1.344us
                 -->kernel: 0:7 %4884 =  [] -> 1.344us
     %7000 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.344us
       %7001 = :MulBackward0 [[]] -> 1.344us
         %7002 = :aten::mul [[], []] -> 1.344us
                 -->kernel: 0:7 %4885 =  [] -> 1.344us
     %7003 = :autograd::engine::evaluate_function: SelectBackward0 None -> 60.448us
       %7004 = :SelectBackward0 [[]] -> 60.448us
         %7005 = :aten::select_backward [[], [], [], []] -> 60.448us
           %7006 = :aten::zeros [[], [], [], [], []] -> 960.000ns
             %7007 = :aten::zero_ [[2]] -> 960.000ns
               %7008 = :aten::fill_ [[2], []] -> 960.000ns
                 -->kernel: 0:7 %4886 =  [] -> 960.000ns
           %7009 = :aten::copy_ [[], [], []] -> 992.000ns
     %7010 = :autograd::engine::evaluate_function: MulBackward0 None -> 2.048us
       %7011 = :MulBackward0 [[4096]] -> 2.048us
         %7012 = :aten::mul [[4096], [4096]] -> 2.048us
                 -->kernel: 0:7 %4887 =  [] -> 2.048us
     %7013 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 769.922us
       %7014 = :CrossEntropyFunctionBackward [[4096, 1]] -> 769.922us
         %7015 = :aten::to [[], [], [], [], [], []] -> 832.000ns
           %7016 = :aten::_to_copy [[], [], [], [], [], [], []] -> 832.000ns
             %7017 = :aten::copy_ [[], [], []] -> 832.000ns
                 -->kernel: 0:7 %4888 =  [] -> 597.826us
     %7018 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 109.152ms
       %7019 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.152ms
         %7020 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.629ms
           %7021 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.629ms
                 -->kernel: 0:7 %4889 =  [] -> 55.615ms
                 -->kernel: 0:7 %4890 =  [] -> 53.279ms
     %7022 = :autograd::engine::evaluate_function: MTPLossAutoScalerBackward None -> 75.360us
       %7023 = :MTPLossAutoScalerBackward [[4096, 1, 7168]] -> 75.360us
         %7024 = :aten::ones_like [[1, 4096], [], [], [], [], []] -> 1.120us
           %7025 = :aten::fill_ [[1, 4096], []] -> 1.120us
                 -->kernel: 0:7 %4891 =  [] -> 1.120us
         %7026 = :aten::mul [[1, 4096], [1]] -> 2.112us
                 -->kernel: 0:7 %4892 =  [] -> 2.112us
     %7027 = :autograd::engine::evaluate_function: DivBackward0 None -> 2.176us
       %7028 = :DivBackward0 [[1, 4096]] -> 2.176us
         %7029 = :aten::div [[1, 4096], []] -> 2.176us
                 -->kernel: 0:7 %4893 =  [] -> 2.176us
     %7030 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.376us
       %7031 = :MulBackward0 [[1, 4096]] -> 1.376us
         %7032 = :aten::mul [[1, 4096], []] -> 1.376us
                 -->kernel: 0:7 %4894 =  [] -> 1.376us
     %7033 = :autograd::engine::evaluate_function: MulBackward0 None -> 1.632us
       %7034 = :MulBackward0 [[1, 4096]] -> 1.632us
         %7035 = :aten::mul [[1, 4096], [1, 4096]] -> 1.632us
                 -->kernel: 0:7 %4895 =  [] -> 1.632us
     %7036 = :autograd::engine::evaluate_function: CrossEntropyFunctionBackward None -> 755.394us
       %7037 = :CrossEntropyFunctionBackward [[4096, 1]] -> 755.394us
         %7038 = :aten::to [[], [], [], [], [], []] -> 864.000ns
           %7039 = :aten::_to_copy [[], [], [], [], [], [], []] -> 864.000ns
             %7040 = :aten::copy_ [[], [], []] -> 864.000ns
                 -->kernel: 0:7 %4896 =  [] -> 594.561us
     %7041 = :autograd::engine::evaluate_function: LinearWithGradAccumulationAndAsyncCommunicationBackward None -> 110.959ms
       %7042 = :LinearWithGradAccumulationAndAsyncCommunicationBackward [[4096, 1, 129280]] -> 109.506ms
         %7043 = :aten::matmul [[4096, 1, 129280], [129280, 7168]] -> 55.803ms
           %7044 = :aten::mm [[4096, 129280], [129280, 7168]] -> 55.803ms
                 -->kernel: 0:7 %4897 =  [] -> 55.792ms
                 -->kernel: 0:7 %4898 =  [] -> 53.471ms
       %7045 = :aten::add [[129280, 7168], [129280, 7168], []] -> 1.157ms
                 -->kernel: 0:35 %4899 =  [] -> 1.157ms
     %7046 = :autograd::engine::evaluate_function: SplitBackward0 None -> 163.553us
       %7047 = :SplitBackward0 [[4096, 1, 7168], [4096, 1, 7168]] -> 163.553us
         %7048 = :aten::cat [[4096, 1, 7168], [4096, 1, 7168], []] -> 163.553us
                 -->kernel: 0:7 %4900 =  [] -> 163.553us
     %7049 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 204.896us
       %7050 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 204.896us
         %7051 = :nvte_rmsnorm_bwd [] -> 204.896us
                 -->kernel: 0:7 %4901 =  [] -> 166.656us
                 -->kernel: 0:7 %4902 =  [] -> 7.584us
     %7052 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %7053 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %4903 =  [] -> 1.568us
     %7054 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 845.986us
       %7055 = :FusedCombineBackward [[4096, 7168], []] -> 845.986us
                 -->kernel: 0:26 %4904 =  [] -> 8.000us
                 -->kernel: 0:26 %4905 =  [] -> 779.745us
     %7056 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 202.177us
       %7057 = :_moe_unpermute_mask_mapBackward [[15871, 7168]] -> 202.177us
                 -->kernel: 0:7 %4906 =  [] -> 202.177us
     %7058 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.436ms
       %7059 = :_GroupedLinearBackward [[33104, 7168]] -> 8.436ms
         %7060 = :_GroupedLinear_backward [] -> 8.436ms
           %7061 = :nvte_quantize_v2 [] -> 146.080us
             %7062 = :quantize_transpose_vector_blockwise [] -> 146.080us
                 -->kernel: 0:7 %4907 =  [] -> 146.080us
           %7063 = :nvte_quantize_v2 [] -> 220.896us
             %7064 = :quantize_transpose_vector_blockwise [] -> 220.896us
                 -->kernel: 0:7 %4908 =  [] -> 220.896us
           %7065 = :nvte_quantize_v2 [] -> 144.737us
             %7066 = :quantize_transpose_vector_blockwise [] -> 144.737us
                 -->kernel: 0:7 %4909 =  [] -> 144.737us
           %7067 = :nvte_quantize_v2 [] -> 146.240us
             %7068 = :quantize_transpose_vector_blockwise [] -> 146.240us
                 -->kernel: 0:7 %4910 =  [] -> 146.240us
           %7069 = :nvte_multi_stream_cublas_gemm [] -> 3.731ms
             %7070 = :nvte_cublas_gemm [] -> 923.746us
                 -->kernel: 0:159 %4911 =  [] -> 911.682us
             %7071 = :nvte_cublas_gemm [] -> 915.394us
                 -->kernel: 0:160 %4912 =  [] -> 908.642us
             %7072 = :nvte_cublas_gemm [] -> 913.378us
                 -->kernel: 0:161 %4913 =  [] -> 908.642us
             %7073 = :nvte_cublas_gemm [] -> 913.667us
                 -->kernel: 0:162 %4914 =  [] -> 908.099us
           %7074 = :nvte_multi_stream_cublas_gemm [] -> 3.687ms
             %7075 = :nvte_cublas_gemm [] -> 913.890us
                 -->kernel: 0:159 %4915 =  [] -> 905.282us
             %7076 = :nvte_cublas_gemm [] -> 895.426us
                 -->kernel: 0:160 %4916 =  [] -> 891.778us
             %7077 = :nvte_cublas_gemm [] -> 908.194us
                 -->kernel: 0:161 %4917 =  [] -> 904.610us
             %7078 = :nvte_cublas_gemm [] -> 908.610us
                 -->kernel: 0:162 %4918 =  [] -> 904.994us
     %7079 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 602.498us
       %7080 = :WeightedSwiGLUFunctionBackward [[33104, 2048]] -> 602.498us
         %7081 = :Torch-Compiled Region: 4/1 None -> 602.498us
           %7082 = :triton_poi_fused__to_copy_cat_0 [[33104, 2048], [33104, 1], [33104, 4096], [33104, 4096], [], []] -> 406.561us
                 -->kernel: 0:7 %4919 =  [] -> 406.561us
           %7083 = :triton_red_fused__to_copy_mul_silu_sum_1 [[33104, 4096], [33104, 2048], [33104, 1], [], [], [], []] -> 131.585us
                 -->kernel: 0:7 %4920 =  [] -> 131.585us
     %7084 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.709ms
       %7085 = :_GroupedLinearBackward [[33104, 4096]] -> 14.709ms
         %7086 = :_GroupedLinear_backward [] -> 14.709ms
           %7087 = :nvte_quantize_v2 [] -> 85.120us
             %7088 = :quantize_transpose_vector_blockwise [] -> 85.120us
                 -->kernel: 0:7 %4921 =  [] -> 85.120us
           %7089 = :nvte_quantize_v2 [] -> 130.657us
             %7090 = :quantize_transpose_vector_blockwise [] -> 130.657us
                 -->kernel: 0:7 %4922 =  [] -> 130.657us
           %7091 = :nvte_quantize_v2 [] -> 84.928us
             %7092 = :quantize_transpose_vector_blockwise [] -> 84.928us
                 -->kernel: 0:7 %4923 =  [] -> 84.928us
           %7093 = :nvte_quantize_v2 [] -> 86.144us
             %7094 = :quantize_transpose_vector_blockwise [] -> 86.144us
                 -->kernel: 0:7 %4924 =  [] -> 86.144us
           %7095 = :nvte_multi_stream_cublas_gemm [] -> 7.042ms
             %7096 = :nvte_cublas_gemm [] -> 1.755ms
                 -->kernel: 0:159 %4925 =  [] -> 1.748ms
             %7097 = :nvte_cublas_gemm [] -> 1.722ms
                 -->kernel: 0:160 %4926 =  [] -> 1.718ms
             %7098 = :nvte_cublas_gemm [] -> 1.751ms
                 -->kernel: 0:161 %4927 =  [] -> 1.747ms
             %7099 = :nvte_cublas_gemm [] -> 1.751ms
                 -->kernel: 0:162 %4928 =  [] -> 1.747ms
           %7100 = :nvte_multi_stream_cublas_gemm [] -> 7.006ms
             %7101 = :nvte_cublas_gemm [] -> 1.743ms
                 -->kernel: 0:159 %4929 =  [] -> 1.736ms
             %7102 = :nvte_cublas_gemm [] -> 1.716ms
                 -->kernel: 0:160 %4930 =  [] -> 1.712ms
             %7103 = :nvte_cublas_gemm [] -> 1.740ms
                 -->kernel: 0:161 %4931 =  [] -> 1.735ms
             %7104 = :nvte_cublas_gemm [] -> 1.739ms
                 -->kernel: 0:162 %4932 =  [] -> 1.735ms
     %7105 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 394.017us
       %7106 = :_moe_permute_mask_mapBackward [[33104, 7168], [], [33104]] -> 394.017us
         %7107 = :aten::zeros [[], [], [], [], []] -> 1.312us
           %7108 = :aten::zero_ [[15871, 9]] -> 1.312us
             %7109 = :aten::fill_ [[15871, 9], []] -> 1.312us
                 -->kernel: 0:7 %4933 =  [] -> 1.312us
                 -->kernel: 0:7 %4934 =  [] -> 214.528us
     %7110 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 99.393us
       %7111 = :IndicesToMultihotBackward [[], [15871, 4]] -> 99.393us
         %7112 = :aten::zeros [[], [], [], [], []] -> 1.472us
           %7113 = :aten::zero_ [[15871, 4]] -> 1.472us
             %7114 = :aten::fill_ [[15871, 4], []] -> 1.472us
                 -->kernel: 0:7 %4935 =  [] -> 1.472us
                 -->kernel: 0:7 %4936 =  [] -> 11.648us
     %7115 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.182ms
       %7116 = :_LinearBackward [[4096, 1, 7168]] -> 1.182ms
         %7117 = :_Linear_backward [] -> 1.182ms
           %7118 = :nvte_quantize_v2 [] -> 73.632us
             %7119 = :quantize_transpose_vector_blockwise [] -> 73.632us
                 -->kernel: 0:7 %4937 =  [] -> 73.632us
           %7120 = :nvte_cublas_gemm_scaled [] -> 468.801us
                 -->kernel: 0:7 %4938 =  [] -> 458.497us
           %7121 = :nvte_cublas_gemm_scaled [] -> 456.705us
                 -->kernel: 0:7 %4939 =  [] -> 450.977us
     %7122 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 47.328us
       %7123 = :SwiGLUFunctionBackward [[4096, 2048]] -> 47.328us
         %7124 = :Torch-Compiled Region: 5/0 None -> 47.328us
           %7125 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 47.328us
                 -->kernel: 0:7 %4940 =  [] -> 47.328us
     %7126 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.020ms
       %7127 = :_LinearBackward [[4096, 1, 4096]] -> 2.020ms
         %7128 = :_Linear_backward [] -> 2.020ms
           %7129 = :nvte_quantize_v2 [] -> 45.312us
             %7130 = :quantize_transpose_vector_blockwise [] -> 45.312us
                 -->kernel: 0:7 %4941 =  [] -> 45.312us
           %7131 = :nvte_quantize_v2 [] -> 53.120us
             %7132 = :quantize_transpose_vector_blockwise [] -> 53.120us
                 -->kernel: 0:7 %4942 =  [] -> 53.120us
           %7133 = :nvte_cublas_gemm_scaled [] -> 870.146us
                 -->kernel: 0:7 %4943 =  [] -> 864.418us
           %7134 = :nvte_cublas_gemm_scaled [] -> 868.098us
                 -->kernel: 0:7 %4944 =  [] -> 862.562us
     %7135 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 895.106us
       %7136 = :FusedDispatchBackward [[15871, 7168], [], [15871, 8], [], []] -> 895.106us
         %7137 = :aten::zeros [[], [], [], [], []] -> 1.408us
           %7138 = :aten::zero_ [[15871, 8]] -> 1.408us
             %7139 = :aten::fill_ [[15871, 8], []] -> 1.408us
                 -->kernel: 0:7 %4945 =  [] -> 1.408us
                 -->kernel: 0:26 %4946 =  [] -> 13.888us
                 -->kernel: 0:26 %4947 =  [] -> 690.274us
     %7140 = :autograd::engine::evaluate_function: TopkBackward0 None -> 61.184us
       %7141 = :TopkBackward0 [[4096, 8]] -> 61.184us
         %7142 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 61.184us
           %7143 = :aten::zeros [[], [], [], [], []] -> 992.000ns
             %7144 = :aten::zero_ [[4096, 32]] -> 992.000ns
               %7145 = :aten::fill_ [[4096, 32], []] -> 992.000ns
                 -->kernel: 0:7 %4948 =  [] -> 992.000ns
           %7146 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 8.768us
                 -->kernel: 0:7 %4949 =  [] -> 8.768us
     %7147 = :autograd::engine::evaluate_function: ViewBackward0 None -> 53.025us
       %7148 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 53.025us
                 -->kernel: 0:7 %4950 =  [] -> 53.025us
     %7149 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 90.592us
       %7150 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 38.784us
         %7151 = :aten::ones_like [[], [], [], [], [], []] -> 1.056us
           %7152 = :aten::fill_ [[], []] -> 1.056us
                 -->kernel: 0:7 %4951 =  [] -> 1.056us
         %7153 = :aten::mul [[], [1]] -> 1.504us
                 -->kernel: 0:7 %4952 =  [] -> 1.504us
       %7154 = :aten::sum [[1], []] -> 3.072us
         %7155 = :aten::sum [[1], [], [], []] -> 3.072us
                 -->kernel: 0:7 %4953 =  [] -> 3.072us
     %7156 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.504us
       %7157 = :DivBackward0 [[]] -> 1.504us
         %7158 = :aten::div [[], []] -> 1.504us
                 -->kernel: 0:7 %4954 =  [] -> 1.504us
     %7159 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.208us
       %7160 = :FusedAuxLossBackward [[]] -> 2.208us
         %7161 = :nvte_fused_moe_aux_loss_backward [] -> 2.208us
                 -->kernel: 0:7 %4955 =  [] -> 2.208us
     %7162 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 62.400us
       %7163 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 62.400us
         %7164 = :aten::zeros [[], [], [], [], []] -> 1.216us
           %7165 = :aten::zero_ [[4096, 32]] -> 1.216us
             %7166 = :aten::fill_ [[4096, 32], []] -> 1.216us
                 -->kernel: 0:7 %4956 =  [] -> 1.216us
         %7167 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.896us
                 -->kernel: 0:7 %4957 =  [] -> 12.896us
     %7168 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 100.576us
       %7169 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 56.672us
         %7170 = :aten::zeros [[], [], [], [], []] -> 1.344us
           %7171 = :aten::zero_ [[4096, 32]] -> 1.344us
             %7172 = :aten::fill_ [[4096, 32], []] -> 1.344us
                 -->kernel: 0:7 %4958 =  [] -> 1.344us
         %7173 = :nvte_fused_topk_with_score_function_backward [] -> 13.792us
                 -->kernel: 0:7 %4959 =  [] -> 13.792us
       %7174 = :aten::add [[4096, 32], [4096, 32], []] -> 1.696us
                 -->kernel: 0:7 %4960 =  [] -> 1.696us
     %7175 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 807.842us
       %7176 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 710.242us
         %7177 = :aten::to [[32, 7168], [], [], [], []] -> 6.496us
           %7178 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.496us
             %7179 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.496us
                 -->kernel: 0:7 %4961 =  [] -> 6.496us
         %7180 = :nvte_cublas_gemm_scaled [] -> 83.905us
                 -->kernel: 0:7 %4962 =  [] -> 67.681us
         %7181 = :aten::to [[4096, 7168], [], [], [], []] -> 176.256us
           %7182 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 176.256us
             %7183 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 176.256us
                 -->kernel: 0:7 %4963 =  [] -> 176.256us
         %7184 = :nvte_cublas_gemm_scaled [] -> 82.273us
                 -->kernel: 0:7 %4964 =  [] -> 82.273us
         %7185 = :aten::to [[4096, 7168], [], [], [], []] -> 43.520us
           %7186 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.520us
             %7187 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.520us
                 -->kernel: 0:7 %4965 =  [] -> 43.520us
         %7188 = :aten::to [[32, 7168], [], [], [], []] -> 2.208us
           %7189 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.208us
             %7190 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.208us
                 -->kernel: 0:7 %4966 =  [] -> 2.208us
       %7191 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.944us
                 -->kernel: 0:7 %4967 =  [] -> 50.944us
     %7192 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.048us
       %7193 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.048us
                 -->kernel: 0:35 %4968 =  [] -> 2.048us
     %7194 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 322.976us
       %7195 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 199.488us
         %7196 = :nvte_rmsnorm_bwd [] -> 199.488us
                 -->kernel: 0:7 %4969 =  [] -> 167.072us
                 -->kernel: 0:7 %4970 =  [] -> 7.968us
       %7197 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.656us
                 -->kernel: 0:7 %4971 =  [] -> 50.656us
     %7198 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %7199 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %4972 =  [] -> 1.600us
     %7200 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.281ms
       %7201 = :_LinearBackward [[4096, 1, 7168]] -> 7.281ms
         %7202 = :_Linear_backward [] -> 7.281ms
           %7203 = :nvte_quantize_v2 [] -> 73.792us
             %7204 = :quantize_transpose_vector_blockwise [] -> 73.792us
                 -->kernel: 0:7 %4973 =  [] -> 73.792us
           %7205 = :nvte_quantize_v2 [] -> 110.657us
             %7206 = :quantize_transpose_vector_blockwise [] -> 110.657us
                 -->kernel: 0:7 %4974 =  [] -> 110.657us
           %7207 = :nvte_cublas_gemm_scaled [] -> 3.439ms
                 -->kernel: 0:7 %4975 =  [] -> 3.433ms
           %7208 = :nvte_cublas_gemm_scaled [] -> 3.444ms
                 -->kernel: 0:7 %4976 =  [] -> 3.437ms
     %7209 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.913ms
       %7210 = :BmmBackward0 [[128, 4096, 128]] -> 7.913ms
         %7211 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.981ms
                 -->kernel: 0:7 %4977 =  [] -> 3.969ms
         %7212 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.881ms
                 -->kernel: 0:7 %4978 =  [] -> 3.873ms
     %7213 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.947ms
       %7214 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.947ms
         %7215 = :nvte_scaled_softmax_backward [] -> 6.947ms
                 -->kernel: 0:7 %4979 =  [] -> 6.947ms
     %7216 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.236ms
       %7217 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.236ms
         %7218 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.948ms
                 -->kernel: 0:7 %4980 =  [] -> 5.939ms
         %7219 = :aten::mul [[128, 4096, 192], []] -> 115.520us
           %7220 = :aten::mul [[128, 4096, 192], []] -> 115.520us
                 -->kernel: 0:7 %4981 =  [] -> 115.520us
         %7221 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.880ms
                 -->kernel: 0:7 %4982 =  [] -> 5.874ms
         %7222 = :aten::mul [[128, 192, 4096], []] -> 115.969us
           %7223 = :aten::mul [[128, 192, 4096], []] -> 115.969us
                 -->kernel: 0:7 %4983 =  [] -> 115.969us
     %7224 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.470ms
       %7225 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.470ms
         %7226 = :aten::contiguous [[4096, 1, 128, 192], []] -> 749.986us
           %7227 = :aten::clone [[4096, 1, 128, 192], []] -> 749.986us
             %7228 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 749.986us
                 -->kernel: 0:7 %4984 =  [] -> 749.986us
         %7229 = :aten::contiguous [[4096, 1, 128, 128], []] -> 281.249us
           %7230 = :aten::clone [[4096, 1, 128, 128], []] -> 281.249us
             %7231 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 281.249us
                 -->kernel: 0:7 %4985 =  [] -> 281.249us
                 -->kernel: 0:7 %4986 =  [] -> 171.809us
     %7232 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 644.834us
       %7233 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 644.834us
         %7234 = :aten::contiguous [[4096, 1, 128, 192], []] -> 424.577us
           %7235 = :aten::clone [[4096, 1, 128, 192], []] -> 424.577us
             %7236 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 424.577us
                 -->kernel: 0:7 %4987 =  [] -> 424.577us
                 -->kernel: 0:7 %4988 =  [] -> 119.745us
     %7237 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.753ms
       %7238 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.753ms
         %7239 = :_LayerNormLinear_backward [] -> 1.753ms
           %7240 = :nvte_quantize_v2 [] -> 324.481us
             %7241 = :quantize_transpose_vector_blockwise [] -> 324.481us
                 -->kernel: 0:7 %4989 =  [] -> 324.481us
           %7242 = :nvte_cublas_gemm_scaled [] -> 569.026us
                 -->kernel: 0:7 %4990 =  [] -> 522.401us
                 -->kernel: 0:7 %4991 =  [] -> 19.008us
           %7243 = :nvte_cublas_gemm_scaled [] -> 528.801us
                 -->kernel: 0:7 %4992 =  [] -> 522.785us
           %7244 = :nvte_rmsnorm_bwd [] -> 22.048us
                 -->kernel: 0:7 %4993 =  [] -> 6.560us
                 -->kernel: 0:7 %4994 =  [] -> 3.136us
     %7245 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.920us
       %7246 = :aten::add_ [[512], [512], []] -> 1.920us
                 -->kernel: 0:35 %4995 =  [] -> 1.920us
     %7247 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.800ms
       %7248 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.800ms
         %7249 = :_LayerNormLinear_backward [] -> 2.800ms
           %7250 = :nvte_quantize_v2 [] -> 244.001us
             %7251 = :quantize_transpose_vector_blockwise [] -> 244.001us
                 -->kernel: 0:7 %4996 =  [] -> 244.001us
           %7252 = :nvte_cublas_gemm_scaled [] -> 1.121ms
                 -->kernel: 0:7 %4997 =  [] -> 1.113ms
           %7253 = :nvte_cublas_gemm_scaled [] -> 1.120ms
                 -->kernel: 0:7 %4998 =  [] -> 1.115ms
           %7254 = :nvte_rmsnorm_bwd [] -> 56.128us
                 -->kernel: 0:7 %4999 =  [] -> 22.944us
                 -->kernel: 0:7 %5000 =  [] -> 20.608us
     %7255 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.920us
       %7256 = :aten::add_ [[1536], [1536], []] -> 1.920us
                 -->kernel: 0:35 %5001 =  [] -> 1.920us
     %7257 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.017us
       %7258 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.017us
         %7259 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.017us
                 -->kernel: 0:7 %5002 =  [] -> 10.017us
     %7260 = :autograd::engine::evaluate_function: _LinearBackward None -> 432.737us
       %7261 = :_LinearBackward [[4096, 1, 576]] -> 432.737us
         %7262 = :_Linear_backward [] -> 432.737us
           %7263 = :nvte_quantize_v2 [] -> 14.880us
             %7264 = :quantize_transpose_vector_blockwise [] -> 14.880us
                 -->kernel: 0:7 %5003 =  [] -> 14.880us
           %7265 = :nvte_cublas_gemm_scaled [] -> 147.936us
                 -->kernel: 0:7 %5004 =  [] -> 141.632us
           %7266 = :nvte_cublas_gemm_scaled [] -> 139.136us
                 -->kernel: 0:7 %5005 =  [] -> 133.472us
     %7267 = :autograd::engine::evaluate_function: _LinearBackward None -> 988.675us
       %7268 = :_LinearBackward [[4096, 1, 1536]] -> 824.610us
         %7269 = :_Linear_backward [] -> 824.610us
           %7270 = :nvte_quantize_v2 [] -> 18.336us
             %7271 = :quantize_transpose_vector_blockwise [] -> 18.336us
                 -->kernel: 0:7 %5006 =  [] -> 18.336us
           %7272 = :nvte_cublas_gemm_scaled [] -> 336.096us
                 -->kernel: 0:7 %5007 =  [] -> 329.088us
           %7273 = :nvte_cublas_gemm_scaled [] -> 342.016us
                 -->kernel: 0:7 %5008 =  [] -> 337.856us
       %7274 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.432us
                 -->kernel: 0:7 %5009 =  [] -> 50.432us
     %7275 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 322.913us
       %7276 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 194.657us
         %7277 = :nvte_rmsnorm_bwd [] -> 194.657us
                 -->kernel: 0:7 %5010 =  [] -> 164.705us
                 -->kernel: 0:7 %5011 =  [] -> 7.904us
       %7278 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.664us
                 -->kernel: 0:7 %5012 =  [] -> 49.664us
     %7279 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %7280 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %5013 =  [] -> 1.568us
     %7281 = :autograd::engine::evaluate_function: _LinearBackward None -> 6.229ms
       %7282 = :_LinearBackward [[4096, 1, 7168]] -> 6.229ms
         %7283 = :_Linear_backward [] -> 6.229ms
           %7284 = :nvte_quantize_v2 [] -> 73.153us
             %7285 = :quantize_transpose_vector_blockwise [] -> 73.153us
                 -->kernel: 0:7 %5014 =  [] -> 73.153us
           %7286 = :nvte_cublas_gemm_scaled [] -> 3.001ms
                 -->kernel: 0:7 %5015 =  [] -> 2.993ms
           %7287 = :nvte_cublas_gemm_scaled [] -> 3.012ms
                 -->kernel: 0:7 %5016 =  [] -> 3.006ms
     %7288 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 388.705us
       %7289 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 388.705us
         %7290 = :aten::contiguous [[4096, 1, 7168], []] -> 114.464us
           %7291 = :aten::clone [[4096, 1, 7168], []] -> 114.464us
             %7292 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 114.464us
                 -->kernel: 0:7 %5017 =  [] -> 114.464us
         %7293 = :nvte_rmsnorm_bwd [] -> 192.448us
                 -->kernel: 0:7 %5018 =  [] -> 165.792us
                 -->kernel: 0:7 %5019 =  [] -> 8.192us
     %7294 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %7295 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %5020 =  [] -> 1.600us
     %7296 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 373.408us
       %7297 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 373.408us
         %7298 = :aten::contiguous [[4096, 1, 7168], []] -> 115.744us
           %7299 = :aten::clone [[4096, 1, 7168], []] -> 115.744us
             %7300 = :aten::copy_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 115.744us
                 -->kernel: 0:7 %5021 =  [] -> 115.744us
         %7301 = :nvte_rmsnorm_bwd [] -> 189.792us
                 -->kernel: 0:7 %5022 =  [] -> 166.784us
                 -->kernel: 0:7 %5023 =  [] -> 7.712us
     %7302 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.728us
       %7303 = :aten::add_ [[7168], [7168], []] -> 1.728us
                 -->kernel: 0:35 %5024 =  [] -> 1.728us
     %7304 = :autograd::engine::evaluate_function: MakeViewlessTensorBackward None -> 50.592us
       %7305 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.592us
                 -->kernel: 0:7 %5025 =  [] -> 50.592us
     %7306 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 1.351ms
       %7307 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.351ms
         %7308 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.351ms
           %7309 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.351ms
             %7310 = :aten::arange [[], [], [], [], []] -> 1.184us
               %7311 = :aten::arange [[], [], [], [0]] -> 1.184us
                 -->kernel: 0:7 %5026 =  [] -> 1.184us
             %7312 = CCCL:cub::DeviceRadixSort [] -> 191.105us
                 -->kernel: 0:7 %5027 =  [] -> 3.776us
                 -->kernel: 0:7 %5028 =  [] -> 1.664us
                 -->kernel: 0:7 %5029 =  [] -> 7.777us
                 -->kernel: 0:7 %5030 =  [] -> 7.008us
                 -->kernel: 0:7 %5031 =  [] -> 7.232us
                 -->kernel: 0:7 %5032 =  [] -> 7.136us
                 -->kernel: 0:7 %5033 =  [] -> 6.816us
                 -->kernel: 0:7 %5034 =  [] -> 6.784us
                 -->kernel: 0:7 %5035 =  [] -> 7.072us
                 -->kernel: 0:7 %5036 =  [] -> 7.008us
             %7313 = :aten::zeros [[], [], [], [], []] -> 544.673us
               %7314 = :aten::zero_ [[129280, 7168]] -> 544.673us
                 %7315 = :aten::fill_ [[129280, 7168], []] -> 544.673us
                 -->kernel: 0:7 %5037 =  [] -> 544.673us
             %7316 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 17.632us
                 -->kernel: 0:7 %5038 =  [] -> 1.248us
                 -->kernel: 0:7 %5039 =  [] -> 4.096us
                 -->kernel: 0:7 %5040 =  [] -> 1.984us
             %7317 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 17.568us
                 -->kernel: 0:7 %5041 =  [] -> 1.248us
                 -->kernel: 0:7 %5042 =  [] -> 3.008us
                 -->kernel: 0:7 %5043 =  [] -> 1.600us
                 -->kernel: 0:7 %5044 =  [] -> 1.920us
                 -->kernel: 0:7 %5045 =  [] -> 213.184us
                 -->kernel: 0:7 %5046 =  [] -> 148.705us
     %7318 = :autograd::engine::evaluate_function: SplitBackward0 None -> 33.984us
       %7319 = :SplitBackward0 [[4096, 1, 7168]] -> 33.984us
         %7320 = :aten::cat [[4096, 1, 7168], []] -> 33.984us
     %7321 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 195.713us
       %7322 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 195.713us
         %7323 = :nvte_rmsnorm_bwd [] -> 195.713us
                 -->kernel: 0:7 %5047 =  [] -> 168.545us
                 -->kernel: 0:7 %5048 =  [] -> 8.032us
     %7324 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %7325 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %5049 =  [] -> 1.568us
     %7326 = :autograd::engine::evaluate_function: FusedCombineBackward None -> 822.529us
       %7327 = :FusedCombineBackward [[4096, 7168], []] -> 822.529us
                 -->kernel: 0:26 %5050 =  [] -> 8.000us
                 -->kernel: 0:26 %5051 =  [] -> 764.001us
     %7328 = :autograd::engine::evaluate_function: _moe_unpermute_mask_mapBackward None -> 198.593us
       %7329 = :_moe_unpermute_mask_mapBackward [[15636, 7168]] -> 198.593us
                 -->kernel: 0:7 %5052 =  [] -> 198.593us
     %7330 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 8.527ms
       %7331 = :_GroupedLinearBackward [[32640, 7168]] -> 8.527ms
         %7332 = :_GroupedLinear_backward [] -> 8.527ms
           %7333 = :nvte_quantize_v2 [] -> 219.489us
             %7334 = :quantize_transpose_vector_blockwise [] -> 219.489us
                 -->kernel: 0:7 %5053 =  [] -> 219.489us
           %7335 = :nvte_quantize_v2 [] -> 217.536us
             %7336 = :quantize_transpose_vector_blockwise [] -> 217.536us
                 -->kernel: 0:7 %5054 =  [] -> 217.536us
           %7337 = :nvte_quantize_v2 [] -> 221.441us
             %7338 = :quantize_transpose_vector_blockwise [] -> 221.441us
                 -->kernel: 0:7 %5055 =  [] -> 221.441us
           %7339 = :nvte_quantize_v2 [] -> 219.872us
             %7340 = :quantize_transpose_vector_blockwise [] -> 219.872us
                 -->kernel: 0:7 %5056 =  [] -> 219.872us
           %7341 = :nvte_multi_stream_cublas_gemm [] -> 3.711ms
             %7342 = :nvte_cublas_gemm [] -> 916.898us
                 -->kernel: 0:159 %5057 =  [] -> 906.562us
             %7343 = :nvte_cublas_gemm [] -> 911.522us
                 -->kernel: 0:160 %5058 =  [] -> 906.338us
             %7344 = :nvte_cublas_gemm [] -> 910.594us
                 -->kernel: 0:161 %5059 =  [] -> 906.338us
             %7345 = :nvte_cublas_gemm [] -> 910.979us
                 -->kernel: 0:162 %5060 =  [] -> 905.891us
           %7346 = :nvte_multi_stream_cublas_gemm [] -> 3.645ms
             %7347 = :nvte_cublas_gemm [] -> 896.258us
                 -->kernel: 0:159 %5061 =  [] -> 889.954us
             %7348 = :nvte_cublas_gemm [] -> 893.250us
                 -->kernel: 0:160 %5062 =  [] -> 889.762us
             %7349 = :nvte_cublas_gemm [] -> 906.594us
                 -->kernel: 0:161 %5063 =  [] -> 903.618us
             %7350 = :nvte_cublas_gemm [] -> 893.027us
                 -->kernel: 0:162 %5064 =  [] -> 889.763us
     %7351 = :autograd::engine::evaluate_function: WeightedSwiGLUFunctionBackward None -> 586.593us
       %7352 = :WeightedSwiGLUFunctionBackward [[32640, 2048]] -> 586.593us
         %7353 = :Torch-Compiled Region: 4/1 None -> 586.593us
           %7354 = :triton_poi_fused__to_copy_cat_0 [[32640, 2048], [32640, 1], [32640, 4096], [32640, 4096], [], []] -> 400.129us
                 -->kernel: 0:7 %5065 =  [] -> 400.129us
           %7355 = :triton_red_fused__to_copy_mul_silu_sum_1 [[32640, 4096], [32640, 2048], [32640, 1], [], [], [], []] -> 129.504us
                 -->kernel: 0:7 %5066 =  [] -> 129.504us
     %7356 = :autograd::engine::evaluate_function: _GroupedLinearBackward None -> 14.691ms
       %7357 = :_GroupedLinearBackward [[32640, 4096]] -> 14.691ms
         %7358 = :_GroupedLinear_backward [] -> 14.691ms
           %7359 = :nvte_quantize_v2 [] -> 125.728us
             %7360 = :quantize_transpose_vector_blockwise [] -> 125.728us
                 -->kernel: 0:7 %5067 =  [] -> 125.728us
           %7361 = :nvte_quantize_v2 [] -> 128.577us
             %7362 = :quantize_transpose_vector_blockwise [] -> 128.577us
                 -->kernel: 0:7 %5068 =  [] -> 128.577us
           %7363 = :nvte_quantize_v2 [] -> 131.584us
             %7364 = :quantize_transpose_vector_blockwise [] -> 131.584us
                 -->kernel: 0:7 %5069 =  [] -> 131.584us
           %7365 = :nvte_quantize_v2 [] -> 129.728us
             %7366 = :quantize_transpose_vector_blockwise [] -> 129.728us
                 -->kernel: 0:7 %5070 =  [] -> 129.728us
           %7367 = :nvte_multi_stream_cublas_gemm [] -> 6.971ms
             %7368 = :nvte_cublas_gemm [] -> 1.719ms
                 -->kernel: 0:159 %5071 =  [] -> 1.712ms
             %7369 = :nvte_cublas_gemm [] -> 1.716ms
                 -->kernel: 0:160 %5072 =  [] -> 1.711ms
             %7370 = :nvte_cublas_gemm [] -> 1.749ms
                 -->kernel: 0:161 %5073 =  [] -> 1.744ms
             %7371 = :nvte_cublas_gemm [] -> 1.715ms
                 -->kernel: 0:162 %5074 =  [] -> 1.711ms
           %7372 = :nvte_multi_stream_cublas_gemm [] -> 6.939ms
             %7373 = :nvte_cublas_gemm [] -> 1.712ms
                 -->kernel: 0:159 %5075 =  [] -> 1.706ms
             %7374 = :nvte_cublas_gemm [] -> 1.710ms
                 -->kernel: 0:160 %5076 =  [] -> 1.706ms
             %7375 = :nvte_cublas_gemm [] -> 1.737ms
                 -->kernel: 0:161 %5077 =  [] -> 1.732ms
             %7376 = :nvte_cublas_gemm [] -> 1.715ms
                 -->kernel: 0:162 %5078 =  [] -> 1.711ms
     %7377 = :autograd::engine::evaluate_function: _moe_permute_mask_mapBackward None -> 384.705us
       %7378 = :_moe_permute_mask_mapBackward [[32640, 7168], [], [32640]] -> 384.705us
         %7379 = :aten::zeros [[], [], [], [], []] -> 1.344us
           %7380 = :aten::zero_ [[15636, 9]] -> 1.344us
             %7381 = :aten::fill_ [[15636, 9], []] -> 1.344us
                 -->kernel: 0:7 %5079 =  [] -> 1.344us
                 -->kernel: 0:7 %5080 =  [] -> 211.585us
     %7382 = :autograd::engine::evaluate_function: IndicesToMultihotBackward None -> 97.632us
       %7383 = :IndicesToMultihotBackward [[], [15636, 4]] -> 97.632us
         %7384 = :aten::zeros [[], [], [], [], []] -> 1.312us
           %7385 = :aten::zero_ [[15636, 4]] -> 1.312us
             %7386 = :aten::fill_ [[15636, 4], []] -> 1.312us
                 -->kernel: 0:7 %5081 =  [] -> 1.312us
                 -->kernel: 0:7 %5082 =  [] -> 11.296us
     %7387 = :autograd::engine::evaluate_function: _LinearBackward None -> 1.155ms
       %7388 = :_LinearBackward [[4096, 1, 7168]] -> 1.155ms
         %7389 = :_Linear_backward [] -> 1.155ms
           %7390 = :nvte_quantize_v2 [] -> 72.864us
             %7391 = :quantize_transpose_vector_blockwise [] -> 72.864us
                 -->kernel: 0:7 %5083 =  [] -> 72.864us
           %7392 = :nvte_cublas_gemm_scaled [] -> 464.961us
                 -->kernel: 0:7 %5084 =  [] -> 456.609us
           %7393 = :nvte_cublas_gemm_scaled [] -> 454.561us
                 -->kernel: 0:7 %5085 =  [] -> 448.705us
     %7394 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 47.296us
       %7395 = :SwiGLUFunctionBackward [[4096, 2048]] -> 47.296us
         %7396 = :Torch-Compiled Region: 5/0 None -> 47.296us
           %7397 = :triton_poi_fused_cat_0 [[4096, 2048], [4096, 4096], [4096, 4096], [], []] -> 47.296us
                 -->kernel: 0:7 %5086 =  [] -> 47.296us
     %7398 = :autograd::engine::evaluate_function: _LinearBackward None -> 2.011ms
       %7399 = :_LinearBackward [[4096, 1, 4096]] -> 2.011ms
         %7400 = :_Linear_backward [] -> 2.011ms
           %7401 = :nvte_quantize_v2 [] -> 45.216us
             %7402 = :quantize_transpose_vector_blockwise [] -> 45.216us
                 -->kernel: 0:7 %5087 =  [] -> 45.216us
           %7403 = :nvte_quantize_v2 [] -> 52.672us
             %7404 = :quantize_transpose_vector_blockwise [] -> 52.672us
                 -->kernel: 0:7 %5088 =  [] -> 52.672us
           %7405 = :nvte_cublas_gemm_scaled [] -> 867.362us
                 -->kernel: 0:7 %5089 =  [] -> 861.186us
           %7406 = :nvte_cublas_gemm_scaled [] -> 865.379us
                 -->kernel: 0:7 %5090 =  [] -> 860.515us
     %7407 = :autograd::engine::evaluate_function: FusedDispatchBackward None -> 856.738us
       %7408 = :FusedDispatchBackward [[15636, 7168], [], [15636, 8], [], []] -> 856.738us
         %7409 = :aten::zeros [[], [], [], [], []] -> 1.376us
           %7410 = :aten::zero_ [[15636, 8]] -> 1.376us
             %7411 = :aten::fill_ [[15636, 8], []] -> 1.376us
                 -->kernel: 0:7 %5091 =  [] -> 1.376us
                 -->kernel: 0:26 %5092 =  [] -> 13.792us
                 -->kernel: 0:26 %5093 =  [] -> 685.506us
     %7412 = :autograd::engine::evaluate_function: TopkBackward0 None -> 57.664us
       %7413 = :TopkBackward0 [[4096, 8]] -> 57.664us
         %7414 = :aten::value_selecting_reduction_backward [[4096, 8], [], [4096, 8], [], []] -> 57.664us
           %7415 = :aten::zeros [[], [], [], [], []] -> 928.000ns
             %7416 = :aten::zero_ [[4096, 32]] -> 928.000ns
               %7417 = :aten::fill_ [[4096, 32], []] -> 928.000ns
                 -->kernel: 0:7 %5094 =  [] -> 928.000ns
           %7418 = :aten::scatter_ [[4096, 32], [], [4096, 8], [4096, 8]] -> 9.568us
                 -->kernel: 0:7 %5095 =  [] -> 9.568us
     %7419 = :autograd::engine::evaluate_function: ViewBackward0 None -> 52.416us
       %7420 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 52.416us
                 -->kernel: 0:7 %5096 =  [] -> 52.416us
     %7421 = :autograd::engine::evaluate_function: MoEAuxLossAutoScalerBackward None -> 89.696us
       %7422 = :MoEAuxLossAutoScalerBackward [[4096, 32]] -> 35.552us
         %7423 = :aten::ones_like [[], [], [], [], [], []] -> 1.152us
           %7424 = :aten::fill_ [[], []] -> 1.152us
                 -->kernel: 0:7 %5097 =  [] -> 1.152us
         %7425 = :aten::mul [[], [1]] -> 1.504us
                 -->kernel: 0:7 %5098 =  [] -> 1.504us
       %7426 = :aten::sum [[1], []] -> 3.072us
         %7427 = :aten::sum [[1], [], [], []] -> 3.072us
                 -->kernel: 0:7 %5099 =  [] -> 3.072us
     %7428 = :autograd::engine::evaluate_function: DivBackward0 None -> 1.504us
       %7429 = :DivBackward0 [[]] -> 1.504us
         %7430 = :aten::div [[], []] -> 1.504us
                 -->kernel: 0:7 %5100 =  [] -> 1.504us
     %7431 = :autograd::engine::evaluate_function: FusedAuxLossBackward None -> 2.208us
       %7432 = :FusedAuxLossBackward [[]] -> 2.208us
         %7433 = :nvte_fused_moe_aux_loss_backward [] -> 2.208us
                 -->kernel: 0:7 %5101 =  [] -> 2.208us
     %7434 = :autograd::engine::evaluate_function: FusedComputeScoresForMoEAuxLossBackward None -> 61.728us
       %7435 = :FusedComputeScoresForMoEAuxLossBackward [[], [4096, 32]] -> 61.728us
         %7436 = :aten::zeros [[], [], [], [], []] -> 1.216us
           %7437 = :aten::zero_ [[4096, 32]] -> 1.216us
             %7438 = :aten::fill_ [[4096, 32], []] -> 1.216us
                 -->kernel: 0:7 %5102 =  [] -> 1.216us
         %7439 = :nvte_fused_score_for_moe_aux_loss_backward [] -> 12.992us
                 -->kernel: 0:7 %5103 =  [] -> 12.992us
     %7440 = :autograd::engine::evaluate_function: FusedTopkScoreFunctionBackward None -> 99.872us
       %7441 = :FusedTopkScoreFunctionBackward [[4096, 32], []] -> 56.640us
         %7442 = :aten::zeros [[], [], [], [], []] -> 1.184us
           %7443 = :aten::zero_ [[4096, 32]] -> 1.184us
             %7444 = :aten::fill_ [[4096, 32], []] -> 1.184us
                 -->kernel: 0:7 %5104 =  [] -> 1.184us
         %7445 = :nvte_fused_topk_with_score_function_backward [] -> 13.792us
                 -->kernel: 0:7 %5105 =  [] -> 13.792us
       %7446 = :aten::add [[4096, 32], [4096, 32], []] -> 1.632us
                 -->kernel: 0:7 %5106 =  [] -> 1.632us
     %7447 = :autograd::engine::evaluate_function: RouterGatingLinearFunctionBackward None -> 795.810us
       %7448 = :RouterGatingLinearFunctionBackward [[4096, 1, 32]] -> 700.866us
         %7449 = :aten::to [[32, 7168], [], [], [], []] -> 6.464us
           %7450 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 6.464us
             %7451 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 6.464us
                 -->kernel: 0:7 %5107 =  [] -> 6.464us
         %7452 = :nvte_cublas_gemm_scaled [] -> 84.736us
                 -->kernel: 0:7 %5108 =  [] -> 67.776us
         %7453 = :aten::to [[4096, 7168], [], [], [], []] -> 176.736us
           %7454 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 176.736us
             %7455 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 176.736us
                 -->kernel: 0:7 %5109 =  [] -> 176.736us
         %7456 = :nvte_cublas_gemm_scaled [] -> 82.176us
                 -->kernel: 0:7 %5110 =  [] -> 82.176us
         %7457 = :aten::to [[4096, 7168], [], [], [], []] -> 43.584us
           %7458 = :aten::_to_copy [[4096, 7168], [], [], [], [], [], []] -> 43.584us
             %7459 = :aten::copy_ [[4096, 7168], [4096, 7168], []] -> 43.584us
                 -->kernel: 0:7 %5111 =  [] -> 43.584us
         %7460 = :aten::to [[32, 7168], [], [], [], []] -> 2.112us
           %7461 = :aten::_to_copy [[32, 7168], [], [], [], [], [], []] -> 2.112us
             %7462 = :aten::copy_ [[32, 7168], [32, 7168], []] -> 2.112us
                 -->kernel: 0:7 %5112 =  [] -> 2.112us
       %7463 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.400us
                 -->kernel: 0:7 %5113 =  [] -> 50.400us
     %7464 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 2.112us
       %7465 = :aten::add_ [[32, 7168], [32, 7168], []] -> 2.112us
                 -->kernel: 0:35 %5114 =  [] -> 2.112us
     %7466 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 321.953us
       %7467 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 199.200us
         %7468 = :nvte_rmsnorm_bwd [] -> 199.200us
                 -->kernel: 0:7 %5115 =  [] -> 167.520us
                 -->kernel: 0:7 %5116 =  [] -> 7.712us
       %7469 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 51.041us
                 -->kernel: 0:7 %5117 =  [] -> 51.041us
     %7470 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %7471 = :aten::add_ [[7168], [7168], []] -> 1.600us
                 -->kernel: 0:35 %5118 =  [] -> 1.600us
     %7472 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.250ms
       %7473 = :_LinearBackward [[4096, 1, 7168]] -> 7.250ms
         %7474 = :_Linear_backward [] -> 7.250ms
           %7475 = :nvte_quantize_v2 [] -> 73.856us
             %7476 = :quantize_transpose_vector_blockwise [] -> 73.856us
                 -->kernel: 0:7 %5119 =  [] -> 73.856us
           %7477 = :nvte_quantize_v2 [] -> 110.816us
             %7478 = :quantize_transpose_vector_blockwise [] -> 110.816us
                 -->kernel: 0:7 %5120 =  [] -> 110.816us
           %7479 = :nvte_cublas_gemm_scaled [] -> 3.433ms
                 -->kernel: 0:7 %5121 =  [] -> 3.427ms
           %7480 = :nvte_cublas_gemm_scaled [] -> 3.433ms
                 -->kernel: 0:7 %5122 =  [] -> 3.426ms
     %7481 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.901ms
       %7482 = :BmmBackward0 [[128, 4096, 128]] -> 7.901ms
         %7483 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.976ms
                 -->kernel: 0:7 %5123 =  [] -> 3.964ms
         %7484 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.873ms
                 -->kernel: 0:7 %5124 =  [] -> 3.865ms
     %7485 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 7.012ms
       %7486 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 7.012ms
         %7487 = :nvte_scaled_softmax_backward [] -> 7.012ms
                 -->kernel: 0:7 %5125 =  [] -> 7.012ms
     %7488 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.200ms
       %7489 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.200ms
         %7490 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.935ms
                 -->kernel: 0:7 %5126 =  [] -> 5.926ms
         %7491 = :aten::mul [[128, 4096, 192], []] -> 114.720us
           %7492 = :aten::mul [[128, 4096, 192], []] -> 114.720us
                 -->kernel: 0:7 %5127 =  [] -> 114.720us
         %7493 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.862ms
                 -->kernel: 0:7 %5128 =  [] -> 5.856ms
         %7494 = :aten::mul [[128, 192, 4096], []] -> 115.168us
           %7495 = :aten::mul [[128, 192, 4096], []] -> 115.168us
                 -->kernel: 0:7 %5129 =  [] -> 115.168us
     %7496 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.478ms
       %7497 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.478ms
         %7498 = :aten::contiguous [[4096, 1, 128, 192], []] -> 744.610us
           %7499 = :aten::clone [[4096, 1, 128, 192], []] -> 744.610us
             %7500 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 744.610us
                 -->kernel: 0:7 %5130 =  [] -> 744.610us
         %7501 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.769us
           %7502 = :aten::clone [[4096, 1, 128, 128], []] -> 280.769us
             %7503 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.769us
                 -->kernel: 0:7 %5131 =  [] -> 280.769us
                 -->kernel: 0:7 %5132 =  [] -> 173.409us
     %7504 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 640.354us
       %7505 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 640.354us
         %7506 = :aten::contiguous [[4096, 1, 128, 192], []] -> 422.401us
           %7507 = :aten::clone [[4096, 1, 128, 192], []] -> 422.401us
             %7508 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 422.401us
                 -->kernel: 0:7 %5133 =  [] -> 422.401us
                 -->kernel: 0:7 %5134 =  [] -> 118.529us
     %7509 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.739ms
       %7510 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.739ms
         %7511 = :_LayerNormLinear_backward [] -> 1.739ms
           %7512 = :nvte_quantize_v2 [] -> 323.649us
             %7513 = :quantize_transpose_vector_blockwise [] -> 323.649us
                 -->kernel: 0:7 %5135 =  [] -> 323.649us
           %7514 = :nvte_cublas_gemm_scaled [] -> 565.122us
                 -->kernel: 0:7 %5136 =  [] -> 519.074us
                 -->kernel: 0:7 %5137 =  [] -> 19.008us
           %7515 = :nvte_cublas_gemm_scaled [] -> 527.201us
                 -->kernel: 0:7 %5138 =  [] -> 521.825us
           %7516 = :nvte_rmsnorm_bwd [] -> 21.696us
                 -->kernel: 0:7 %5139 =  [] -> 6.624us
                 -->kernel: 0:7 %5140 =  [] -> 3.136us
     %7517 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.888us
       %7518 = :aten::add_ [[512], [512], []] -> 1.888us
                 -->kernel: 0:35 %5141 =  [] -> 1.888us
     %7519 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.776ms
       %7520 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.776ms
         %7521 = :_LayerNormLinear_backward [] -> 2.776ms
           %7522 = :nvte_quantize_v2 [] -> 241.057us
             %7523 = :quantize_transpose_vector_blockwise [] -> 241.057us
                 -->kernel: 0:7 %5142 =  [] -> 241.057us
           %7524 = :nvte_cublas_gemm_scaled [] -> 1.118ms
                 -->kernel: 0:7 %5143 =  [] -> 1.110ms
           %7525 = :nvte_cublas_gemm_scaled [] -> 1.121ms
                 -->kernel: 0:7 %5144 =  [] -> 1.116ms
           %7526 = :nvte_rmsnorm_bwd [] -> 54.912us
                 -->kernel: 0:7 %5145 =  [] -> 23.296us
                 -->kernel: 0:7 %5146 =  [] -> 20.448us
     %7527 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.664us
       %7528 = :aten::add_ [[1536], [1536], []] -> 1.664us
                 -->kernel: 0:35 %5147 =  [] -> 1.664us
     %7529 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.016us
       %7530 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.016us
         %7531 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.016us
                 -->kernel: 0:7 %5148 =  [] -> 10.016us
     %7532 = :autograd::engine::evaluate_function: _LinearBackward None -> 432.897us
       %7533 = :_LinearBackward [[4096, 1, 576]] -> 432.897us
         %7534 = :_Linear_backward [] -> 432.897us
           %7535 = :nvte_quantize_v2 [] -> 14.400us
             %7536 = :quantize_transpose_vector_blockwise [] -> 14.400us
                 -->kernel: 0:7 %5149 =  [] -> 14.400us
           %7537 = :nvte_cublas_gemm_scaled [] -> 147.936us
                 -->kernel: 0:7 %5150 =  [] -> 141.376us
           %7538 = :nvte_cublas_gemm_scaled [] -> 141.120us
                 -->kernel: 0:7 %5151 =  [] -> 133.312us
     %7539 = :autograd::engine::evaluate_function: _LinearBackward None -> 987.619us
       %7540 = :_LinearBackward [[4096, 1, 1536]] -> 822.402us
         %7541 = :_Linear_backward [] -> 822.402us
           %7542 = :nvte_quantize_v2 [] -> 18.400us
             %7543 = :quantize_transpose_vector_blockwise [] -> 18.400us
                 -->kernel: 0:7 %5152 =  [] -> 18.400us
           %7544 = :nvte_cublas_gemm_scaled [] -> 335.328us
                 -->kernel: 0:7 %5153 =  [] -> 329.024us
           %7545 = :nvte_cublas_gemm_scaled [] -> 342.112us
                 -->kernel: 0:7 %5154 =  [] -> 337.600us
       %7546 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.688us
                 -->kernel: 0:7 %5155 =  [] -> 50.688us
     %7547 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 321.505us
       %7548 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 196.353us
         %7549 = :nvte_rmsnorm_bwd [] -> 196.353us
                 -->kernel: 0:7 %5156 =  [] -> 165.185us
                 -->kernel: 0:7 %5157 =  [] -> 7.840us
       %7550 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 48.960us
                 -->kernel: 0:7 %5158 =  [] -> 48.960us
     %7551 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.568us
       %7552 = :aten::add_ [[7168], [7168], []] -> 1.568us
                 -->kernel: 0:35 %5159 =  [] -> 1.568us
     %7553 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.958ms
       %7554 = :_LinearBackward [[4096, 1, 7168]] -> 7.958ms
         %7555 = :_Linear_backward [] -> 7.958ms
           %7556 = :nvte_quantize_v2 [] -> 73.536us
             %7557 = :quantize_transpose_vector_blockwise [] -> 73.536us
                 -->kernel: 0:7 %5160 =  [] -> 73.536us
           %7558 = :nvte_cublas_gemm_scaled [] -> 3.876ms
                 -->kernel: 0:7 %5161 =  [] -> 3.869ms
           %7559 = :nvte_cublas_gemm_scaled [] -> 3.860ms
                 -->kernel: 0:7 %5162 =  [] -> 3.852ms
     %7560 = :autograd::engine::evaluate_function: SwiGLUFunctionBackward None -> 844.738us
       %7561 = :SwiGLUFunctionBackward [[4096, 18432]] -> 844.738us
         %7562 = :Torch-Compiled Region: 5/1 None -> 844.738us
           %7563 = :triton_poi_fused_cat_0 [[4096, 18432], [4096, 36864], [4096, 36864], [], [], [], [], []] -> 844.738us
                 -->kernel: 0:7 %5163 =  [] -> 844.738us
     %7564 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 16.379ms
       %7565 = :_LayerNormLinearBackward [[4096, 1, 36864]] -> 16.207ms
         %7566 = :_LayerNormLinear_backward [] -> 16.207ms
           %7567 = :nvte_quantize_v2 [] -> 362.017us
             %7568 = :quantize_transpose_vector_blockwise [] -> 362.017us
                 -->kernel: 0:7 %5164 =  [] -> 362.017us
           %7569 = :nvte_cublas_gemm_scaled [] -> 7.637ms
                 -->kernel: 0:7 %5165 =  [] -> 7.629ms
           %7570 = :nvte_cublas_gemm_scaled [] -> 7.695ms
                 -->kernel: 0:7 %5166 =  [] -> 7.686ms
           %7571 = :nvte_rmsnorm_bwd [] -> 195.872us
                 -->kernel: 0:7 %5167 =  [] -> 163.456us
                 -->kernel: 0:7 %5168 =  [] -> 7.776us
       %7572 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.856us
                 -->kernel: 0:7 %5169 =  [] -> 49.856us
     %7573 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.760us
       %7574 = :aten::add_ [[7168], [7168], []] -> 1.760us
                 -->kernel: 0:35 %5170 =  [] -> 1.760us
     %7575 = :autograd::engine::evaluate_function: _LinearBackward None -> 7.283ms
       %7576 = :_LinearBackward [[4096, 1, 7168]] -> 7.283ms
         %7577 = :_Linear_backward [] -> 7.283ms
           %7578 = :nvte_quantize_v2 [] -> 73.920us
             %7579 = :quantize_transpose_vector_blockwise [] -> 73.920us
                 -->kernel: 0:7 %5171 =  [] -> 73.920us
           %7580 = :nvte_quantize_v2 [] -> 111.648us
             %7581 = :quantize_transpose_vector_blockwise [] -> 111.648us
                 -->kernel: 0:7 %5172 =  [] -> 111.648us
           %7582 = :nvte_cublas_gemm_scaled [] -> 3.435ms
                 -->kernel: 0:7 %5173 =  [] -> 3.428ms
           %7583 = :nvte_cublas_gemm_scaled [] -> 3.431ms
                 -->kernel: 0:7 %5174 =  [] -> 3.424ms
     %7584 = :autograd::engine::evaluate_function: BmmBackward0 None -> 7.904ms
       %7585 = :BmmBackward0 [[128, 4096, 128]] -> 7.904ms
         %7586 = :aten::bmm [[128, 4096, 4096], [128, 4096, 128]] -> 3.978ms
                 -->kernel: 0:7 %5175 =  [] -> 3.965ms
         %7587 = :aten::bmm [[128, 4096, 128], [128, 128, 4096]] -> 3.873ms
                 -->kernel: 0:7 %5176 =  [] -> 3.865ms
     %7588 = :autograd::engine::evaluate_function: ScaledMaskedSoftmaxBackward None -> 6.964ms
       %7589 = :ScaledMaskedSoftmaxBackward [[1, 128, 4096, 4096]] -> 6.964ms
         %7590 = :nvte_scaled_softmax_backward [] -> 6.964ms
                 -->kernel: 0:7 %5177 =  [] -> 6.964ms
     %7591 = :autograd::engine::evaluate_function: BaddbmmBackward0 None -> 12.197ms
       %7592 = :BaddbmmBackward0 [[128, 4096, 4096]] -> 12.197ms
         %7593 = :aten::bmm [[128, 4096, 4096], [128, 4096, 192]] -> 5.941ms
                 -->kernel: 0:7 %5178 =  [] -> 5.928ms
         %7594 = :aten::mul [[128, 4096, 192], []] -> 115.360us
           %7595 = :aten::mul [[128, 4096, 192], []] -> 115.360us
                 -->kernel: 0:7 %5179 =  [] -> 115.360us
         %7596 = :aten::bmm [[128, 192, 4096], [128, 4096, 4096]] -> 5.864ms
                 -->kernel: 0:7 %5180 =  [] -> 5.858ms
         %7597 = :aten::mul [[128, 192, 4096], []] -> 114.624us
           %7598 = :aten::mul [[128, 192, 4096], []] -> 114.624us
                 -->kernel: 0:7 %5181 =  [] -> 114.624us
     %7599 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbKVBackward None -> 1.485ms
       %7600 = :ApplyMLARotaryEmbKVBackward [[4096, 1, 128, 192], [4096, 1, 128, 128]] -> 1.485ms
         %7601 = :aten::contiguous [[4096, 1, 128, 192], []] -> 742.946us
           %7602 = :aten::clone [[4096, 1, 128, 192], []] -> 742.946us
             %7603 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 742.946us
                 -->kernel: 0:7 %5182 =  [] -> 742.946us
         %7604 = :aten::contiguous [[4096, 1, 128, 128], []] -> 280.545us
           %7605 = :aten::clone [[4096, 1, 128, 128], []] -> 280.545us
             %7606 = :aten::copy_ [[4096, 1, 128, 128], [4096, 1, 128, 128], []] -> 280.545us
                 -->kernel: 0:7 %5183 =  [] -> 280.545us
                 -->kernel: 0:7 %5184 =  [] -> 172.960us
     %7607 = :autograd::engine::evaluate_function: ApplyMLARotaryEmbQBackward None -> 637.794us
       %7608 = :ApplyMLARotaryEmbQBackward [[4096, 1, 128, 192]] -> 637.794us
         %7609 = :aten::contiguous [[4096, 1, 128, 192], []] -> 422.913us
           %7610 = :aten::clone [[4096, 1, 128, 192], []] -> 422.913us
             %7611 = :aten::copy_ [[4096, 1, 128, 192], [4096, 1, 128, 192], []] -> 422.913us
                 -->kernel: 0:7 %5185 =  [] -> 422.913us
                 -->kernel: 0:7 %5186 =  [] -> 118.465us
     %7612 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 1.743ms
       %7613 = :_LayerNormLinearBackward [[4096, 1, 32768]] -> 1.743ms
         %7614 = :_LayerNormLinear_backward [] -> 1.743ms
           %7615 = :nvte_quantize_v2 [] -> 322.433us
             %7616 = :quantize_transpose_vector_blockwise [] -> 322.433us
                 -->kernel: 0:7 %5187 =  [] -> 322.433us
           %7617 = :nvte_cublas_gemm_scaled [] -> 565.730us
                 -->kernel: 0:7 %5188 =  [] -> 519.330us
                 -->kernel: 0:7 %5189 =  [] -> 18.848us
           %7618 = :nvte_cublas_gemm_scaled [] -> 527.041us
                 -->kernel: 0:7 %5190 =  [] -> 521.441us
           %7619 = :nvte_rmsnorm_bwd [] -> 20.672us
                 -->kernel: 0:7 %5191 =  [] -> 6.112us
                 -->kernel: 0:7 %5192 =  [] -> 3.136us
     %7620 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.824us
       %7621 = :aten::add_ [[512], [512], []] -> 1.824us
                 -->kernel: 0:35 %5193 =  [] -> 1.824us
     %7622 = :autograd::engine::evaluate_function: _LayerNormLinearBackward None -> 2.784ms
       %7623 = :_LayerNormLinearBackward [[4096, 1, 24576]] -> 2.784ms
         %7624 = :_LayerNormLinear_backward [] -> 2.784ms
           %7625 = :nvte_quantize_v2 [] -> 242.721us
             %7626 = :quantize_transpose_vector_blockwise [] -> 242.721us
                 -->kernel: 0:7 %5194 =  [] -> 242.721us
           %7627 = :nvte_cublas_gemm_scaled [] -> 1.117ms
                 -->kernel: 0:7 %5195 =  [] -> 1.110ms
           %7628 = :nvte_cublas_gemm_scaled [] -> 1.120ms
                 -->kernel: 0:7 %5196 =  [] -> 1.115ms
           %7629 = :nvte_rmsnorm_bwd [] -> 56.128us
                 -->kernel: 0:7 %5197 =  [] -> 23.232us
                 -->kernel: 0:7 %5198 =  [] -> 20.448us
     %7630 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.824us
       %7631 = :aten::add_ [[1536], [1536], []] -> 1.824us
                 -->kernel: 0:35 %5199 =  [] -> 1.824us
     %7632 = :autograd::engine::evaluate_function: SplitWithSizesBackward0 None -> 10.016us
       %7633 = :SplitWithSizesBackward0 [[4096, 1, 512], [4096, 1, 64]] -> 10.016us
         %7634 = :aten::cat [[4096, 1, 512], [4096, 1, 64], []] -> 10.016us
                 -->kernel: 0:7 %5200 =  [] -> 10.016us
     %7635 = :autograd::engine::evaluate_function: _LinearBackward None -> 431.905us
       %7636 = :_LinearBackward [[4096, 1, 576]] -> 431.905us
         %7637 = :_Linear_backward [] -> 431.905us
           %7638 = :nvte_quantize_v2 [] -> 14.624us
             %7639 = :quantize_transpose_vector_blockwise [] -> 14.624us
                 -->kernel: 0:7 %5201 =  [] -> 14.624us
           %7640 = :nvte_cublas_gemm_scaled [] -> 147.937us
                 -->kernel: 0:7 %5202 =  [] -> 141.153us
           %7641 = :nvte_cublas_gemm_scaled [] -> 139.648us
                 -->kernel: 0:7 %5203 =  [] -> 133.664us
     %7642 = :autograd::engine::evaluate_function: _LinearBackward None -> 985.634us
       %7643 = :_LinearBackward [[4096, 1, 1536]] -> 818.850us
         %7644 = :_Linear_backward [] -> 818.850us
           %7645 = :nvte_quantize_v2 [] -> 18.368us
             %7646 = :quantize_transpose_vector_blockwise [] -> 18.368us
                 -->kernel: 0:7 %5204 =  [] -> 18.368us
           %7647 = :nvte_cublas_gemm_scaled [] -> 335.329us
                 -->kernel: 0:7 %5205 =  [] -> 328.993us
           %7648 = :nvte_cublas_gemm_scaled [] -> 342.529us
                 -->kernel: 0:7 %5206 =  [] -> 338.017us
       %7649 = :aten::add [[4096, 1, 7168], [4096, 1, 7168], []] -> 50.720us
                 -->kernel: 0:7 %5207 =  [] -> 50.720us
     %7650 = :autograd::engine::evaluate_function: _OperationFuserAutogradFunctionBackward None -> 320.929us
       %7651 = :_OperationFuserAutogradFunctionBackward [[4096, 1, 7168]] -> 195.169us
         %7652 = :nvte_rmsnorm_bwd [] -> 195.169us
                 -->kernel: 0:7 %5208 =  [] -> 165.281us
                 -->kernel: 0:7 %5209 =  [] -> 7.776us
       %7653 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.856us
                 -->kernel: 0:7 %5210 =  [] -> 49.856us
     %7654 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.664us
       %7655 = :aten::add_ [[7168], [7168], []] -> 1.664us
                 -->kernel: 0:35 %5211 =  [] -> 1.664us
     %7656 = :autograd::engine::evaluate_function: EmbeddingBackward0 None -> 2.965ms
       %7657 = :EmbeddingBackward0 [[1, 4096, 7168]] -> 1.361ms
         %7658 = :aten::embedding_backward [[1, 4096, 7168], [1, 4096], [], [], [], []] -> 1.361ms
           %7659 = :aten::embedding_dense_backward [[1, 4096, 7168], [1, 4096], [], [], []] -> 1.361ms
             %7660 = :aten::arange [[], [], [], [], []] -> 1.152us
               %7661 = :aten::arange [[], [], [], [0]] -> 1.152us
                 -->kernel: 0:7 %5212 =  [] -> 1.152us
             %7662 = CCCL:cub::DeviceRadixSort [] -> 188.960us
                 -->kernel: 0:7 %5213 =  [] -> 3.520us
                 -->kernel: 0:7 %5214 =  [] -> 1.568us
                 -->kernel: 0:7 %5215 =  [] -> 7.968us
                 -->kernel: 0:7 %5216 =  [] -> 7.488us
                 -->kernel: 0:7 %5217 =  [] -> 7.168us
                 -->kernel: 0:7 %5218 =  [] -> 7.104us
                 -->kernel: 0:7 %5219 =  [] -> 7.200us
                 -->kernel: 0:7 %5220 =  [] -> 7.200us
                 -->kernel: 0:7 %5221 =  [] -> 6.912us
                 -->kernel: 0:7 %5222 =  [] -> 6.912us
             %7663 = :aten::zeros [[], [], [], [], []] -> 545.154us
               %7664 = :aten::zero_ [[129280, 7168]] -> 545.154us
                 %7665 = :aten::fill_ [[129280, 7168], []] -> 545.154us
                 -->kernel: 0:7 %5223 =  [] -> 545.154us
             %7666 = CCCL:cub::DeviceSelect::UniqueByKey [] -> 17.152us
                 -->kernel: 0:7 %5224 =  [] -> 1.440us
                 -->kernel: 0:7 %5225 =  [] -> 3.840us
                 -->kernel: 0:7 %5226 =  [] -> 1.696us
             %7667 = CCCL:cub::DeviceScan::ExclusiveScan [] -> 18.880us
                 -->kernel: 0:7 %5227 =  [] -> 1.440us
                 -->kernel: 0:7 %5228 =  [] -> 3.200us
                 -->kernel: 0:7 %5229 =  [] -> 1.344us
                 -->kernel: 0:7 %5230 =  [] -> 1.952us
                 -->kernel: 0:7 %5231 =  [] -> 212.801us
                 -->kernel: 0:7 %5232 =  [] -> 149.312us
       %7668 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.556ms
                 -->kernel: 0:35 %5233 =  [] -> 1.556ms
     %7669 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.558ms
       %7670 = :aten::add_ [[129280, 7168], [129280, 7168], []] -> 1.558ms
                 -->kernel: 0:35 %5234 =  [] -> 1.558ms
     %7671 = :aten::linalg_vector_norm [[3002413056], [], [], [], []] -> 2.546ms
                 -->kernel: 0:7 %5235 =  [] -> 616.386us
                 -->kernel: 0:7 %5236 =  [] -> 609.025us
                 -->kernel: 0:7 %5237 =  [] -> 608.738us
                 -->kernel: 0:7 %5238 =  [] -> 609.825us
     %7672 = :aten::isnan [[]] -> 1.568us
       %7673 = :aten::ne [[], []] -> 1.568us
                 -->kernel: 0:7 %5239 =  [] -> 1.568us
     %7674 = :aten::is_nonzero [[]] -> 2.208us
       %7675 = :aten::item [[]] -> 2.208us
         %7676 = :aten::_local_scalar_dense [[]] -> 2.208us
     %7677 = :aten::isinf [[]] -> 38.880us
       %7678 = :aten::abs [[]] -> 1.248us
         %7679 = :aten::abs [[], [0]] -> 1.248us
                 -->kernel: 0:7 %5240 =  [] -> 1.248us
       %7680 = :aten::eq [[], []] -> 1.536us
                 -->kernel: 0:7 %5241 =  [] -> 1.536us
     %7681 = :aten::is_nonzero [[]] -> 2.240us
       %7682 = :aten::item [[]] -> 2.240us
         %7683 = :aten::_local_scalar_dense [[]] -> 2.240us
     %7684 = :aten::mul_ [[3002413056], []] -> 3.545ms
                 -->kernel: 0:7 %5242 =  [] -> 864.514us
                 -->kernel: 0:7 %5243 =  [] -> 901.666us
                 -->kernel: 0:7 %5244 =  [] -> 873.378us
                 -->kernel: 0:7 %5245 =  [] -> 870.946us
     %7685 = :c10d::reduce_scatter_tensor_coalesced_ [[375301632], [3002413056], [], [], [], []] -> 14.664ms
       %7686 = :record_param_comms [[3002413056], [], [], [], [], [], [], [], [], []] -> 14.664ms
         %7687 = :nccl:reduce_scatter_tensor_coalesced [[3002413056]] -> 14.664ms
           %7688 = NCCL:ncclGroupEnd [] -> 14.664ms
                 -->kernel: 0:7 %5246 =  [] -> 14.664ms
     %7689 = :aten::linalg_vector_norm [[352321536], [], [], [], []] -> 305.313us
                 -->kernel: 0:7 %5247 =  [] -> 291.361us
     %7690 = :aten::isnan [[]] -> 1.632us
       %7691 = :aten::ne [[], []] -> 1.632us
                 -->kernel: 0:7 %5248 =  [] -> 1.632us
     %7692 = :aten::is_nonzero [[]] -> 2.240us
       %7693 = :aten::item [[]] -> 2.240us
         %7694 = :aten::_local_scalar_dense [[]] -> 2.240us
     %7695 = :aten::isinf [[]] -> 27.040us
       %7696 = :aten::abs [[]] -> 1.472us
         %7697 = :aten::abs [[], [0]] -> 1.472us
                 -->kernel: 0:7 %5249 =  [] -> 1.472us
       %7698 = :aten::eq [[], []] -> 1.536us
                 -->kernel: 0:7 %5250 =  [] -> 1.536us
     %7699 = :aten::is_nonzero [[]] -> 2.368us
       %7700 = :aten::item [[]] -> 2.368us
         %7701 = :aten::_local_scalar_dense [[]] -> 2.368us
     %7702 = :aten::mul_ [[352321536], []] -> 403.617us
                 -->kernel: 0:7 %5251 =  [] -> 403.617us
     %7703 = :aten::stack [[32], [32], []] -> 1.856us
       %7704 = :aten::cat [[32], [32], []] -> 1.856us
                 -->kernel: 0:7 %5252 =  [] -> 1.856us
     %7705 = :aten::stack [[32], [32], []] -> 2.336us
       %7706 = :aten::cat [[32], [32], []] -> 2.336us
                 -->kernel: 0:7 %5253 =  [] -> 2.336us
     %7707 = :c10d::allreduce_ [[2, 32], [], [], [], [], []] -> 15.328us
       %7708 = :record_param_comms [[2, 32], [], [], [], [], [], [], [], [], []] -> 15.328us
         %7709 = :nccl:all_reduce [[2, 32]] -> 15.328us
           %7710 = NCCL:ncclAllReduce [] -> 15.328us
                 -->kernel: 0:7 %5254 =  [] -> 15.328us
     %7711 = :aten::sum [[2, 32], [], [], []] -> 2.560us
                 -->kernel: 0:7 %5255 =  [] -> 2.560us
     %7712 = :aten::div [[2, 1], []] -> 1.408us
                 -->kernel: 0:7 %5256 =  [] -> 1.408us
     %7713 = :aten::sub [[2, 1], [2, 32], []] -> 2.112us
                 -->kernel: 0:7 %5257 =  [] -> 2.112us
     %7714 = :aten::sign [[2, 32]] -> 1.600us
                 -->kernel: 0:7 %5258 =  [] -> 1.600us
     %7715 = :aten::mul [[2, 32], []] -> 1.248us
                 -->kernel: 0:7 %5259 =  [] -> 1.248us
     %7716 = :aten::add [[2, 32], [2, 32], []] -> 2.848us
                 -->kernel: 0:7 %5260 =  [] -> 2.848us
     %7717 = :aten::zero_ [[32]] -> 1.184us
       %7718 = :aten::fill_ [[32], []] -> 1.184us
                 -->kernel: 0:7 %5261 =  [] -> 1.184us
     %7719 = :aten::copy_ [[32], [32], []] -> 1.184us
     %7720 = :aten::zero_ [[32]] -> 896.000ns
       %7721 = :aten::fill_ [[32], []] -> 896.000ns
                 -->kernel: 0:7 %5262 =  [] -> 896.000ns
     %7722 = :aten::copy_ [[32], [32], []] -> 896.000ns
     %7723 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7724 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7725 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7726 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 9.184us
       %7727 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 9.184us
         %7728 = :nccl:all_reduce [[1]] -> 9.184us
           %7729 = NCCL:ncclAllReduce [] -> 9.184us
                 -->kernel: 0:7 %5263 =  [] -> 9.184us
     %7730 = :aten::item [[1]] -> 2.240us
       %7731 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %7732 = :aten::to [[1], [], [], [], [], []] -> 768.000ns
       %7733 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 768.000ns
         %7734 = :aten::copy_ [[1], [1], []] -> 768.000ns
     %7735 = :aten::zeros [[], [], [], [], []] -> 1.152us
       %7736 = :aten::zero_ [[320]] -> 1.152us
         %7737 = :aten::fill_ [[320], []] -> 1.152us
                 -->kernel: 0:7 %5264 =  [] -> 1.152us
     %7738 = :nvte_multi_tensor_l2norm_cuda [] -> 1.388ms
                 -->kernel: 0:7 %5265 =  [] -> 35.616us
                 -->kernel: 0:7 %5266 =  [] -> 33.504us
                 -->kernel: 0:7 %5267 =  [] -> 29.984us
                 -->kernel: 0:7 %5268 =  [] -> 30.016us
                 -->kernel: 0:7 %5269 =  [] -> 30.048us
                 -->kernel: 0:7 %5270 =  [] -> 30.304us
                 -->kernel: 0:7 %5271 =  [] -> 30.112us
                 -->kernel: 0:7 %5272 =  [] -> 30.113us
                 -->kernel: 0:7 %5273 =  [] -> 29.952us
                 -->kernel: 0:7 %5274 =  [] -> 29.728us
                 -->kernel: 0:7 %5275 =  [] -> 29.824us
                 -->kernel: 0:7 %5276 =  [] -> 30.624us
                 -->kernel: 0:7 %5277 =  [] -> 29.952us
                 -->kernel: 0:7 %5278 =  [] -> 29.984us
                 -->kernel: 0:7 %5279 =  [] -> 30.144us
                 -->kernel: 0:7 %5280 =  [] -> 30.304us
                 -->kernel: 0:7 %5281 =  [] -> 30.240us
                 -->kernel: 0:7 %5282 =  [] -> 29.600us
                 -->kernel: 0:7 %5283 =  [] -> 29.889us
                 -->kernel: 0:7 %5284 =  [] -> 29.984us
                 -->kernel: 0:7 %5285 =  [] -> 29.792us
                 -->kernel: 0:7 %5286 =  [] -> 30.208us
                 -->kernel: 0:7 %5287 =  [] -> 29.920us
                 -->kernel: 0:7 %5288 =  [] -> 29.696us
                 -->kernel: 0:7 %5289 =  [] -> 29.984us
                 -->kernel: 0:7 %5290 =  [] -> 30.592us
                 -->kernel: 0:7 %5291 =  [] -> 30.272us
                 -->kernel: 0:7 %5292 =  [] -> 30.144us
                 -->kernel: 0:7 %5293 =  [] -> 29.920us
                 -->kernel: 0:7 %5294 =  [] -> 30.048us
                 -->kernel: 0:7 %5295 =  [] -> 29.984us
                 -->kernel: 0:7 %5296 =  [] -> 30.336us
                 -->kernel: 0:7 %5297 =  [] -> 30.272us
                 -->kernel: 0:7 %5298 =  [] -> 29.824us
                 -->kernel: 0:7 %5299 =  [] -> 17.024us
                 -->kernel: 0:7 %5300 =  [] -> 1.728us
     %7739 = :aten::pow [[1], []] -> 1.536us
                 -->kernel: 0:7 %5301 =  [] -> 1.536us
     %7740 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 33.536us
       %7741 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 33.536us
         %7742 = :nccl:all_reduce [[1]] -> 33.536us
           %7743 = NCCL:ncclAllReduce [] -> 33.536us
                 -->kernel: 0:7 %5302 =  [] -> 33.536us
     %7744 = :aten::item [[1]] -> 2.240us
       %7745 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %7746 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7747 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7748 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7749 = :nvte_multi_tensor_scale_cuda [] -> 936.738us
                 -->kernel: 0:7 %5303 =  [] -> 36.800us
                 -->kernel: 0:7 %5304 =  [] -> 43.072us
                 -->kernel: 0:7 %5305 =  [] -> 44.160us
                 -->kernel: 0:7 %5306 =  [] -> 43.072us
                 -->kernel: 0:7 %5307 =  [] -> 43.745us
                 -->kernel: 0:7 %5308 =  [] -> 42.784us
                 -->kernel: 0:7 %5309 =  [] -> 42.656us
                 -->kernel: 0:7 %5310 =  [] -> 43.168us
                 -->kernel: 0:7 %5311 =  [] -> 42.784us
                 -->kernel: 0:7 %5312 =  [] -> 43.136us
                 -->kernel: 0:7 %5313 =  [] -> 43.040us
                 -->kernel: 0:7 %5314 =  [] -> 43.488us
                 -->kernel: 0:7 %5315 =  [] -> 42.401us
                 -->kernel: 0:7 %5316 =  [] -> 43.808us
                 -->kernel: 0:7 %5317 =  [] -> 42.784us
                 -->kernel: 0:7 %5318 =  [] -> 43.552us
                 -->kernel: 0:7 %5319 =  [] -> 42.816us
                 -->kernel: 0:7 %5320 =  [] -> 30.656us
     %7750 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7751 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7752 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7753 = :nvte_multi_tensor_scale_cuda [] -> 884.482us
                 -->kernel: 0:7 %5321 =  [] -> 43.584us
                 -->kernel: 0:7 %5322 =  [] -> 43.968us
                 -->kernel: 0:7 %5323 =  [] -> 42.848us
                 -->kernel: 0:7 %5324 =  [] -> 43.712us
                 -->kernel: 0:7 %5325 =  [] -> 42.912us
                 -->kernel: 0:7 %5326 =  [] -> 43.584us
                 -->kernel: 0:7 %5327 =  [] -> 42.625us
                 -->kernel: 0:7 %5328 =  [] -> 43.648us
                 -->kernel: 0:7 %5329 =  [] -> 43.136us
                 -->kernel: 0:7 %5330 =  [] -> 43.200us
                 -->kernel: 0:7 %5331 =  [] -> 42.784us
                 -->kernel: 0:7 %5332 =  [] -> 43.008us
                 -->kernel: 0:7 %5333 =  [] -> 43.008us
                 -->kernel: 0:7 %5334 =  [] -> 43.744us
                 -->kernel: 0:7 %5335 =  [] -> 44.321us
                 -->kernel: 0:7 %5336 =  [] -> 43.552us
                 -->kernel: 0:7 %5337 =  [] -> 28.288us
     %7754 = :Optimizer.step#HybridDeviceOptimizer.step None -> 317.934ms
       %7755 = :aten::copy_ [[375301632], [375301632], []] -> 43.869ms
         %7756 = :aten::to [[375301632], [], [], [], []] -> 2.226ms
           %7757 = :aten::_to_copy [[375301632], [], [], [], [], [], []] -> 2.226ms
             %7758 = :aten::copy_ [[375301632], [375301632], []] -> 2.226ms
                 -->kernel: 0:7 %5338 =  [] -> 2.226ms
         %7759 = :aten::copy_ [[375301632], [375301632], []] -> 41.599ms
       %7760 = :Optimizer.step#AdamW.step None -> 72.103ms
         %7761 = :aten::copy_ [[375301632], [375301632], []] -> 72.103ms
           %7762 = :aten::copy_ [[375301632], [375301632], []] -> 71.392ms
           %7763 = :aten::copy_ [[375301632], [375301632], []] -> 603.777us
                 -->kernel: 0:7 %5339 =  [] -> 603.777us
     %7764 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 341.324ms
       %7765 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 341.324ms
         %7766 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 341.324ms
           %7767 = NCCL:ncclGroupEnd [] -> 341.324ms
                 -->kernel: 0:39 %5340 =  [] -> 341.324ms
     %7768 = :Optimizer.step#HybridDeviceOptimizer.step None -> 84.311ms
       %7769 = :aten::to [[14680064], [], [], [], []] -> 89.344us
         %7770 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.344us
           %7771 = :aten::copy_ [[14680064], [14680064], []] -> 89.344us
                 -->kernel: 0:7 %5341 =  [] -> 89.344us
       %7772 = :aten::to [[29360128], [], [], [], []] -> 176.193us
         %7773 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.193us
           %7774 = :aten::copy_ [[29360128], [29360128], []] -> 176.193us
                 -->kernel: 0:7 %5342 =  [] -> 176.193us
       %7775 = :aten::to [[29360128], [], [], [], []] -> 176.160us
         %7776 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.160us
           %7777 = :aten::copy_ [[29360128], [29360128], []] -> 176.160us
                 -->kernel: 0:7 %5343 =  [] -> 176.160us
       %7778 = :aten::to [[29360128], [], [], [], []] -> 176.225us
         %7779 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.225us
           %7780 = :aten::copy_ [[29360128], [29360128], []] -> 176.225us
                 -->kernel: 0:7 %5344 =  [] -> 176.225us
       %7781 = :aten::to [[29360128], [], [], [], []] -> 176.128us
         %7782 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.128us
           %7783 = :aten::copy_ [[29360128], [29360128], []] -> 176.128us
                 -->kernel: 0:7 %5345 =  [] -> 176.128us
       %7784 = :aten::to [[14680064], [], [], [], []] -> 89.536us
         %7785 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.536us
           %7786 = :aten::copy_ [[14680064], [14680064], []] -> 89.536us
                 -->kernel: 0:7 %5346 =  [] -> 89.536us
       %7787 = :aten::to [[14680064], [], [], [], []] -> 89.569us
         %7788 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.569us
           %7789 = :aten::copy_ [[14680064], [14680064], []] -> 89.569us
                 -->kernel: 0:7 %5347 =  [] -> 89.569us
       %7790 = :aten::to [[14680064], [], [], [], []] -> 89.312us
         %7791 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.312us
           %7792 = :aten::copy_ [[14680064], [14680064], []] -> 89.312us
                 -->kernel: 0:7 %5348 =  [] -> 89.312us
       %7793 = :aten::to [[14680064], [], [], [], []] -> 89.440us
         %7794 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.440us
           %7795 = :aten::copy_ [[14680064], [14680064], []] -> 89.440us
                 -->kernel: 0:7 %5349 =  [] -> 89.440us
       %7796 = :aten::to [[29360128], [], [], [], []] -> 176.705us
         %7797 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.705us
           %7798 = :aten::copy_ [[29360128], [29360128], []] -> 176.705us
                 -->kernel: 0:7 %5350 =  [] -> 176.705us
       %7799 = :aten::to [[29360128], [], [], [], []] -> 176.640us
         %7800 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.640us
           %7801 = :aten::copy_ [[29360128], [29360128], []] -> 176.640us
                 -->kernel: 0:7 %5351 =  [] -> 176.640us
       %7802 = :aten::to [[29360128], [], [], [], []] -> 176.033us
         %7803 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.033us
           %7804 = :aten::copy_ [[29360128], [29360128], []] -> 176.033us
                 -->kernel: 0:7 %5352 =  [] -> 176.033us
       %7805 = :aten::to [[29360128], [], [], [], []] -> 176.384us
         %7806 = :aten::_to_copy [[29360128], [], [], [], [], [], []] -> 176.384us
           %7807 = :aten::copy_ [[29360128], [29360128], []] -> 176.384us
                 -->kernel: 0:7 %5353 =  [] -> 176.384us
       %7808 = :aten::copy_ [[14680064], [14680064], []] -> 1.993ms
         %7809 = :aten::to [[14680064], [], [], [], []] -> 89.409us
           %7810 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 89.409us
             %7811 = :aten::copy_ [[14680064], [14680064], []] -> 89.409us
                 -->kernel: 0:7 %5354 =  [] -> 89.409us
         %7812 = :aten::copy_ [[14680064], [14680064], []] -> 1.843ms
       %7813 = :aten::copy_ [[14680064], [14680064], []] -> 1.849ms
         %7814 = :aten::to [[14680064], [], [], [], []] -> 87.936us
           %7815 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 87.936us
             %7816 = :aten::copy_ [[14680064], [14680064], []] -> 87.936us
                 -->kernel: 0:7 %5355 =  [] -> 87.936us
         %7817 = :aten::copy_ [[14680064], [14680064], []] -> 1.731ms
       %7818 = :aten::copy_ [[14680064], [14680064], []] -> 1.802ms
         %7819 = :aten::to [[14680064], [], [], [], []] -> 87.648us
           %7820 = :aten::_to_copy [[14680064], [], [], [], [], [], []] -> 87.648us
             %7821 = :aten::copy_ [[14680064], [14680064], []] -> 87.648us
                 -->kernel: 0:7 %5356 =  [] -> 87.648us
         %7822 = :aten::copy_ [[14680064], [14680064], []] -> 1.689ms
       %7823 = :Optimizer.step#FusedAdam.step None -> 3.873ms
         %7824 = :nvte_multi_tensor_adam_cuda [] -> 3.086ms
                 -->kernel: 0:7 %5357 =  [] -> 198.784us
                 -->kernel: 0:7 %5358 =  [] -> 200.801us
                 -->kernel: 0:7 %5359 =  [] -> 199.808us
                 -->kernel: 0:7 %5360 =  [] -> 199.137us
                 -->kernel: 0:7 %5361 =  [] -> 199.360us
                 -->kernel: 0:7 %5362 =  [] -> 199.201us
                 -->kernel: 0:7 %5363 =  [] -> 199.104us
                 -->kernel: 0:7 %5364 =  [] -> 199.169us
                 -->kernel: 0:7 %5365 =  [] -> 197.632us
                 -->kernel: 0:7 %5366 =  [] -> 199.201us
                 -->kernel: 0:7 %5367 =  [] -> 199.104us
                 -->kernel: 0:7 %5368 =  [] -> 198.273us
                 -->kernel: 0:7 %5369 =  [] -> 199.840us
                 -->kernel: 0:7 %5370 =  [] -> 200.001us
                 -->kernel: 0:7 %5371 =  [] -> 141.120us
         %7825 = :aten::copy_ [[14680064], [14680064], []] -> 27.200us
                 -->kernel: 0:7 %5372 =  [] -> 27.200us
         %7826 = :aten::copy_ [[29360128], [29360128], []] -> 49.601us
                 -->kernel: 0:7 %5373 =  [] -> 49.601us
         %7827 = :aten::copy_ [[29360128], [29360128], []] -> 49.728us
                 -->kernel: 0:7 %5374 =  [] -> 49.728us
         %7828 = :aten::copy_ [[29360128], [29360128], []] -> 48.256us
                 -->kernel: 0:7 %5375 =  [] -> 48.256us
         %7829 = :aten::copy_ [[29360128], [29360128], []] -> 49.344us
                 -->kernel: 0:7 %5376 =  [] -> 49.344us
         %7830 = :aten::copy_ [[14680064], [14680064], []] -> 25.280us
                 -->kernel: 0:7 %5377 =  [] -> 25.280us
         %7831 = :aten::copy_ [[14680064], [14680064], []] -> 24.960us
                 -->kernel: 0:7 %5378 =  [] -> 24.960us
         %7832 = :aten::copy_ [[14680064], [14680064], []] -> 25.120us
                 -->kernel: 0:7 %5379 =  [] -> 25.120us
         %7833 = :aten::copy_ [[14680064], [14680064], []] -> 26.304us
                 -->kernel: 0:7 %5380 =  [] -> 26.304us
         %7834 = :aten::copy_ [[29360128], [29360128], []] -> 48.128us
                 -->kernel: 0:7 %5381 =  [] -> 48.128us
         %7835 = :aten::copy_ [[29360128], [29360128], []] -> 49.280us
                 -->kernel: 0:7 %5382 =  [] -> 49.280us
         %7836 = :aten::copy_ [[29360128], [29360128], []] -> 49.792us
                 -->kernel: 0:7 %5383 =  [] -> 49.792us
         %7837 = :aten::copy_ [[29360128], [29360128], []] -> 47.904us
                 -->kernel: 0:7 %5384 =  [] -> 47.904us
       %7838 = :Optimizer.step#AdamW.step None -> 8.762ms
         %7839 = :aten::copy_ [[14680064], [14680064], []] -> 2.931ms
           %7840 = :aten::copy_ [[14680064], [14680064], []] -> 2.851ms
           %7841 = :aten::copy_ [[14680064], [14680064], []] -> 24.256us
                 -->kernel: 0:7 %5385 =  [] -> 24.256us
         %7842 = :aten::copy_ [[14680064], [14680064], []] -> 2.781ms
           %7843 = :aten::copy_ [[14680064], [14680064], []] -> 2.746ms
           %7844 = :aten::copy_ [[14680064], [14680064], []] -> 24.032us
                 -->kernel: 0:7 %5386 =  [] -> 24.032us
         %7845 = :aten::copy_ [[14680064], [14680064], []] -> 2.776ms
           %7846 = :aten::copy_ [[14680064], [14680064], []] -> 2.734ms
           %7847 = :aten::copy_ [[14680064], [14680064], []] -> 25.120us
                 -->kernel: 0:7 %5387 =  [] -> 25.120us
     %7848 = :c10d::allgather_into_tensor_coalesced_ [[3002413056], [375301632], [], []] -> 53.545ms
       %7849 = :record_param_comms [[375301632], [], [], [], [], [], [], [], [], []] -> 53.545ms
         %7850 = :nccl:all_gather_into_tensor_coalesced [[375301632]] -> 53.545ms
           %7851 = NCCL:ncclGroupEnd [] -> 53.545ms
                 -->kernel: 0:39 %5388 =  [] -> 53.545ms
     %7852 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7853 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7854 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7855 = :aten::item [[1]] -> 3.040us
       %7856 = :aten::_local_scalar_dense [[1]] -> 3.040us
     %7857 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7858 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7859 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7860 = :aten::item [[1]] -> 2.240us
       %7861 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %7862 = :aten::item [[1]] -> 2.240us
       %7863 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %7864 = :aten::cat [[1], []] -> 1.632us
     %7865 = :aten::mean [[1], []] -> 2.848us
       %7866 = :aten::mean [[1], [], [], []] -> 2.848us
                 -->kernel: 0:7 %5389 =  [] -> 2.848us
     %7867 = :aten::item [[1]] -> 2.624us
       %7868 = :aten::_local_scalar_dense [[1]] -> 2.624us
     %7869 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7870 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7871 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7872 = :aten::add [[1], [], []] -> 1.536us
                 -->kernel: 0:7 %5390 =  [] -> 1.536us
     %7873 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7874 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7875 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7876 = :aten::item [[1]] -> 2.368us
       %7877 = :aten::_local_scalar_dense [[1]] -> 2.368us
     %7878 = :aten::item [[1]] -> 2.240us
       %7879 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %7880 = :c10d::allreduce_ [[2], [], [], [], [], []] -> 1.708ms
       %7881 = :record_param_comms [[2], [], [], [], [], [], [], [], [], []] -> 1.708ms
         %7882 = :nccl:all_reduce [[2]] -> 1.708ms
           %7883 = NCCL:ncclAllReduce [] -> 1.708ms
                 -->kernel: 0:7 %5391 =  [] -> 1.708ms
     %7884 = :c10d::allreduce_ [[3], [], [], [], [], []] -> 11.296us
       %7885 = :record_param_comms [[3], [], [], [], [], [], [], [], [], []] -> 11.296us
         %7886 = :nccl:all_reduce [[3]] -> 11.296us
           %7887 = NCCL:ncclAllReduce [] -> 11.296us
                 -->kernel: 0:7 %5392 =  [] -> 11.296us
     %7888 = :aten::mul [[3], []] -> 1.472us
                 -->kernel: 0:7 %5393 =  [] -> 1.472us
     %7889 = :aten::mul [[2], []] -> 1.280us
                 -->kernel: 0:7 %5394 =  [] -> 1.280us
     %7890 = :aten::sum [[3], []] -> 2.624us
       %7891 = :aten::sum [[3], [], [], []] -> 2.624us
                 -->kernel: 0:7 %5395 =  [] -> 2.624us
     %7892 = :aten::div [[], []] -> 1.472us
                 -->kernel: 0:7 %5396 =  [] -> 1.472us
     %7893 = :aten::add_ [[1], [], []] -> 1.472us
                 -->kernel: 0:7 %5397 =  [] -> 1.472us
     %7894 = :aten::sum [[2], []] -> 2.304us
       %7895 = :aten::sum [[2], [], [], []] -> 2.304us
                 -->kernel: 0:7 %5398 =  [] -> 2.304us
     %7896 = :aten::div [[], []] -> 1.120us
                 -->kernel: 0:7 %5399 =  [] -> 1.120us
     %7897 = :aten::add_ [[1], [], []] -> 1.440us
                 -->kernel: 0:7 %5400 =  [] -> 1.440us
     %7898 = :aten::zero_ [[3]] -> 1.184us
       %7899 = :aten::fill_ [[3], []] -> 1.184us
                 -->kernel: 0:7 %5401 =  [] -> 1.184us
     %7900 = :aten::zero_ [[2]] -> 992.000ns
       %7901 = :aten::fill_ [[2], []] -> 992.000ns
                 -->kernel: 0:7 %5402 =  [] -> 992.000ns
     %7902 = :c10d::allreduce_ [[1], [], [], [], [], []] -> 331.873us
       %7903 = :record_param_comms [[1], [], [], [], [], [], [], [], [], []] -> 331.873us
         %7904 = :nccl:all_reduce [[1]] -> 331.873us
           %7905 = NCCL:ncclAllReduce [] -> 331.873us
                 -->kernel: 0:7 %5403 =  [] -> 331.873us
     %7906 = :aten::mul [[1], []] -> 1.312us
                 -->kernel: 0:7 %5404 =  [] -> 1.312us
     %7907 = :aten::add_ [[1], [], []] -> 1.472us
                 -->kernel: 0:7 %5405 =  [] -> 1.472us
     %7908 = :aten::zero_ [[1]] -> 992.000ns
       %7909 = :aten::fill_ [[1], []] -> 992.000ns
                 -->kernel: 0:7 %5406 =  [] -> 992.000ns
     %7910 = :c10d::barrier [[1], [], [], [], []] -> 190.336us
       %7911 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 190.336us
         %7912 = :aten::zeros [[], [], [], [], []] -> 928.000ns
           %7913 = :aten::zero_ [[1]] -> 928.000ns
             %7914 = :aten::fill_ [[1], []] -> 928.000ns
                 -->kernel: 0:7 %5407 =  [] -> 928.000ns
         %7915 = :nccl:all_reduce_barrier [[1]] -> 155.872us
           %7916 = NCCL:ncclAllReduce [] -> 155.872us
                 -->kernel: 0:7 %5408 =  [] -> 155.872us
     %7917 = :c10d::barrier [[1], [], [], [], []] -> 37.345us
       %7918 = :record_param_comms [[], [], [], [], [], [], [], [], []] -> 37.345us
         %7919 = :aten::zeros [[], [], [], [], []] -> 1.152us
           %7920 = :aten::zero_ [[1]] -> 1.152us
             %7921 = :aten::fill_ [[1], []] -> 1.152us
                 -->kernel: 0:7 %5409 =  [] -> 1.152us
         %7922 = :nccl:all_reduce_barrier [[1]] -> 7.808us
           %7923 = NCCL:ncclAllReduce [] -> 7.808us
                 -->kernel: 0:7 %5410 =  [] -> 7.808us
     %7924 = :aten::item [[1]] -> 2.240us
       %7925 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %7926 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7927 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7928 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7929 = :aten::item [[1]] -> 2.208us
       %7930 = :aten::_local_scalar_dense [[1]] -> 2.208us
     %7931 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7932 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7933 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7934 = :aten::item [[1]] -> 2.240us
       %7935 = :aten::_local_scalar_dense [[1]] -> 2.240us
     %7936 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7937 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7938 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7939 = :aten::item [[1]] -> 2.272us
       %7940 = :aten::_local_scalar_dense [[1]] -> 2.272us
     %7941 = :aten::to [[1], [], [], [], [], []] -> 800.000ns
       %7942 = :aten::_to_copy [[1], [], [], [], [], [], []] -> 800.000ns
         %7943 = :aten::copy_ [[1], [1], []] -> 800.000ns
     %7944 = :aten::zeros [[], [], [], [], []] -> 992.000ns
       %7945 = :aten::zero_ [[8, 24]] -> 992.000ns
         %7946 = :aten::fill_ [[8, 24], []] -> 992.000ns
                 -->kernel: 0:7 %5411 =  [] -> 992.000ns
     %7947 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 85.600us
       %7948 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 85.600us
         %7949 = :nccl:_all_gather_base [[24]] -> 85.600us
           %7950 = NCCL:ncclAllGather [] -> 85.600us
                 -->kernel: 0:7 %5412 =  [] -> 85.600us
     %7951 = :aten::gt [[8], []] -> 1.856us
                 -->kernel: 0:7 %5413 =  [] -> 1.856us
     %7952 = :aten::index [[8], [8]] -> 61.600us
       %7953 = :aten::nonzero [[8]] -> 61.600us
         %7954 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5414 =  [] -> 1.408us
         %7955 = CCCL:cub::DeviceSelect::Flagged [] -> 15.072us
                 -->kernel: 0:7 %5415 =  [] -> 1.056us
                 -->kernel: 0:7 %5416 =  [] -> 2.240us
     %7956 = :aten::gt [[8], []] -> 1.952us
                 -->kernel: 0:7 %5417 =  [] -> 1.952us
     %7957 = :aten::index [[8], [8]] -> 45.632us
       %7958 = :aten::nonzero [[8]] -> 45.632us
         %7959 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5418 =  [] -> 1.280us
         %7960 = CCCL:cub::DeviceSelect::Flagged [] -> 12.416us
                 -->kernel: 0:7 %5419 =  [] -> 1.056us
                 -->kernel: 0:7 %5420 =  [] -> 2.144us
     %7961 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %5421 =  [] -> 1.824us
     %7962 = :aten::index [[8], [8]] -> 52.320us
       %7963 = :aten::nonzero [[8]] -> 52.320us
         %7964 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5422 =  [] -> 1.312us
         %7965 = CCCL:cub::DeviceSelect::Flagged [] -> 12.448us
                 -->kernel: 0:7 %5423 =  [] -> 1.056us
                 -->kernel: 0:7 %5424 =  [] -> 2.176us
     %7966 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5425 =  [] -> 1.792us
     %7967 = :aten::index [[8], [8]] -> 44.096us
       %7968 = :aten::nonzero [[8]] -> 44.096us
         %7969 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5426 =  [] -> 1.312us
         %7970 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %5427 =  [] -> 1.088us
                 -->kernel: 0:7 %5428 =  [] -> 2.144us
     %7971 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5429 =  [] -> 1.792us
     %7972 = :aten::index [[8], [8]] -> 42.688us
       %7973 = :aten::nonzero [[8]] -> 42.688us
         %7974 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5430 =  [] -> 1.312us
         %7975 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %5431 =  [] -> 1.024us
                 -->kernel: 0:7 %5432 =  [] -> 2.176us
     %7976 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5433 =  [] -> 1.792us
     %7977 = :aten::index [[8], [8]] -> 43.968us
       %7978 = :aten::nonzero [[8]] -> 43.968us
         %7979 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5434 =  [] -> 1.280us
         %7980 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %5435 =  [] -> 1.088us
                 -->kernel: 0:7 %5436 =  [] -> 2.144us
     %7981 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %5437 =  [] -> 1.824us
     %7982 = :aten::index [[8], [8]] -> 42.688us
       %7983 = :aten::nonzero [[8]] -> 42.688us
         %7984 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5438 =  [] -> 1.312us
         %7985 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %5439 =  [] -> 1.056us
                 -->kernel: 0:7 %5440 =  [] -> 2.176us
     %7986 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5441 =  [] -> 1.792us
     %7987 = :aten::index [[8], [8]] -> 43.072us
       %7988 = :aten::nonzero [[8]] -> 43.072us
         %7989 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5442 =  [] -> 1.312us
         %7990 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5443 =  [] -> 1.056us
                 -->kernel: 0:7 %5444 =  [] -> 2.112us
     %7991 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5445 =  [] -> 1.792us
     %7992 = :aten::index [[8], [8]] -> 42.080us
       %7993 = :aten::nonzero [[8]] -> 42.080us
         %7994 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5446 =  [] -> 1.312us
         %7995 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %5447 =  [] -> 992.000ns
                 -->kernel: 0:7 %5448 =  [] -> 2.144us
     %7996 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %5449 =  [] -> 1.760us
     %7997 = :aten::index [[8], [8]] -> 42.112us
       %7998 = :aten::nonzero [[8]] -> 42.112us
         %7999 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5450 =  [] -> 1.280us
         %8000 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %5451 =  [] -> 1.056us
                 -->kernel: 0:7 %5452 =  [] -> 2.112us
     %8001 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5453 =  [] -> 1.792us
     %8002 = :aten::index [[8], [8]] -> 44.128us
       %8003 = :aten::nonzero [[8]] -> 44.128us
         %8004 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5454 =  [] -> 1.280us
         %8005 = CCCL:cub::DeviceSelect::Flagged [] -> 13.024us
                 -->kernel: 0:7 %5455 =  [] -> 1.024us
                 -->kernel: 0:7 %5456 =  [] -> 2.144us
     %8006 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %5457 =  [] -> 1.760us
     %8007 = :aten::index [[8], [8]] -> 42.592us
       %8008 = :aten::nonzero [[8]] -> 42.592us
         %8009 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5458 =  [] -> 1.312us
         %8010 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %5459 =  [] -> 1.056us
                 -->kernel: 0:7 %5460 =  [] -> 2.112us
     %8011 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5461 =  [] -> 1.792us
     %8012 = :aten::index [[8], [8]] -> 42.336us
       %8013 = :aten::nonzero [[8]] -> 42.336us
         %8014 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5462 =  [] -> 1.280us
         %8015 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %5463 =  [] -> 1.024us
                 -->kernel: 0:7 %5464 =  [] -> 2.144us
     %8016 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %5465 =  [] -> 1.760us
     %8017 = :aten::index [[8], [8]] -> 42.848us
       %8018 = :aten::nonzero [[8]] -> 42.848us
         %8019 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5466 =  [] -> 1.280us
         %8020 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %5467 =  [] -> 1.024us
                 -->kernel: 0:7 %5468 =  [] -> 2.144us
     %8021 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5469 =  [] -> 1.792us
     %8022 = :aten::index [[8], [8]] -> 42.496us
       %8023 = :aten::nonzero [[8]] -> 42.496us
         %8024 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5470 =  [] -> 1.312us
         %8025 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %5471 =  [] -> 1.024us
                 -->kernel: 0:7 %5472 =  [] -> 2.144us
     %8026 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5473 =  [] -> 1.792us
     %8027 = :aten::index [[8], [8]] -> 42.785us
       %8028 = :aten::nonzero [[8]] -> 42.785us
         %8029 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5474 =  [] -> 1.312us
         %8030 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %5475 =  [] -> 1.056us
                 -->kernel: 0:7 %5476 =  [] -> 2.112us
     %8031 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5477 =  [] -> 1.792us
     %8032 = :aten::index [[8], [8]] -> 41.760us
       %8033 = :aten::nonzero [[8]] -> 41.760us
         %8034 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5478 =  [] -> 1.280us
         %8035 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5479 =  [] -> 1.024us
                 -->kernel: 0:7 %5480 =  [] -> 2.144us
     %8036 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %5481 =  [] -> 1.760us
     %8037 = :aten::index [[8], [8]] -> 45.888us
       %8038 = :aten::nonzero [[8]] -> 45.888us
         %8039 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5482 =  [] -> 1.280us
         %8040 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %5483 =  [] -> 1.024us
                 -->kernel: 0:7 %5484 =  [] -> 2.112us
     %8041 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5485 =  [] -> 1.792us
     %8042 = :aten::index [[8], [8]] -> 42.273us
       %8043 = :aten::nonzero [[8]] -> 42.273us
         %8044 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5486 =  [] -> 1.280us
         %8045 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %5487 =  [] -> 1.024us
                 -->kernel: 0:7 %5488 =  [] -> 2.144us
     %8046 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %5489 =  [] -> 1.760us
     %8047 = :aten::index [[8], [8]] -> 42.880us
       %8048 = :aten::nonzero [[8]] -> 42.880us
         %8049 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5490 =  [] -> 1.280us
         %8050 = CCCL:cub::DeviceSelect::Flagged [] -> 11.648us
                 -->kernel: 0:7 %5491 =  [] -> 1.024us
                 -->kernel: 0:7 %5492 =  [] -> 2.112us
     %8051 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5493 =  [] -> 1.792us
     %8052 = :aten::index [[8], [8]] -> 43.328us
       %8053 = :aten::nonzero [[8]] -> 43.328us
         %8054 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %5494 =  [] -> 1.248us
         %8055 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %5495 =  [] -> 1.024us
                 -->kernel: 0:7 %5496 =  [] -> 2.144us
     %8056 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5497 =  [] -> 1.792us
     %8057 = :aten::index [[8], [8]] -> 42.656us
       %8058 = :aten::nonzero [[8]] -> 42.656us
         %8059 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5498 =  [] -> 1.312us
         %8060 = CCCL:cub::DeviceSelect::Flagged [] -> 12.096us
                 -->kernel: 0:7 %5499 =  [] -> 1.056us
                 -->kernel: 0:7 %5500 =  [] -> 2.144us
     %8061 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5501 =  [] -> 1.792us
     %8062 = :aten::index [[8], [8]] -> 42.272us
       %8063 = :aten::nonzero [[8]] -> 42.272us
         %8064 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5502 =  [] -> 1.312us
         %8065 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %5503 =  [] -> 1.056us
                 -->kernel: 0:7 %5504 =  [] -> 2.144us
     %8066 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5505 =  [] -> 1.792us
     %8067 = :aten::index [[8], [8]] -> 42.144us
       %8068 = :aten::nonzero [[8]] -> 42.144us
         %8069 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5506 =  [] -> 1.312us
         %8070 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5507 =  [] -> 1.056us
                 -->kernel: 0:7 %5508 =  [] -> 2.144us
     %8071 = :aten::zeros [[], [], [], [], []] -> 1.216us
       %8072 = :aten::zero_ [[8, 24]] -> 1.216us
         %8073 = :aten::fill_ [[8, 24], []] -> 1.216us
                 -->kernel: 0:7 %5509 =  [] -> 1.216us
     %8074 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.584us
       %8075 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.584us
         %8076 = :nccl:_all_gather_base [[24]] -> 7.584us
           %8077 = NCCL:ncclAllGather [] -> 7.584us
                 -->kernel: 0:7 %5510 =  [] -> 7.584us
     %8078 = :aten::gt [[8], []] -> 1.600us
                 -->kernel: 0:7 %5511 =  [] -> 1.600us
     %8079 = :aten::index [[8], [8]] -> 47.616us
       %8080 = :aten::nonzero [[8]] -> 47.616us
         %8081 = CCCL:cub::DeviceReduce::Sum [] -> 1.536us
                 -->kernel: 0:7 %5512 =  [] -> 1.536us
         %8082 = CCCL:cub::DeviceSelect::Flagged [] -> 12.608us
                 -->kernel: 0:7 %5513 =  [] -> 1.344us
                 -->kernel: 0:7 %5514 =  [] -> 1.888us
     %8083 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5515 =  [] -> 1.408us
     %8084 = :aten::index [[8], [8]] -> 43.392us
       %8085 = :aten::nonzero [[8]] -> 43.392us
         %8086 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %5516 =  [] -> 1.504us
         %8087 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %5517 =  [] -> 1.376us
                 -->kernel: 0:7 %5518 =  [] -> 1.856us
     %8088 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5519 =  [] -> 1.408us
     %8089 = :aten::index [[8], [8]] -> 43.553us
       %8090 = :aten::nonzero [[8]] -> 43.553us
         %8091 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %5520 =  [] -> 1.504us
         %8092 = CCCL:cub::DeviceSelect::Flagged [] -> 12.032us
                 -->kernel: 0:7 %5521 =  [] -> 1.312us
                 -->kernel: 0:7 %5522 =  [] -> 1.888us
     %8093 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5523 =  [] -> 1.408us
     %8094 = :aten::index [[8], [8]] -> 42.880us
       %8095 = :aten::nonzero [[8]] -> 42.880us
         %8096 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %5524 =  [] -> 1.472us
         %8097 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %5525 =  [] -> 1.376us
                 -->kernel: 0:7 %5526 =  [] -> 1.856us
     %8098 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5527 =  [] -> 1.408us
     %8099 = :aten::index [[8], [8]] -> 42.784us
       %8100 = :aten::nonzero [[8]] -> 42.784us
         %8101 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %5528 =  [] -> 1.472us
         %8102 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %5529 =  [] -> 1.312us
                 -->kernel: 0:7 %5530 =  [] -> 1.856us
     %8103 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5531 =  [] -> 1.408us
     %8104 = :aten::index [[8], [8]] -> 42.081us
       %8105 = :aten::nonzero [[8]] -> 42.081us
         %8106 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %5532 =  [] -> 1.472us
         %8107 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %5533 =  [] -> 1.376us
                 -->kernel: 0:7 %5534 =  [] -> 1.856us
     %8108 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %5535 =  [] -> 1.376us
     %8109 = :aten::index [[8], [8]] -> 42.400us
       %8110 = :aten::nonzero [[8]] -> 42.400us
         %8111 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %5536 =  [] -> 1.504us
         %8112 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %5537 =  [] -> 1.344us
                 -->kernel: 0:7 %5538 =  [] -> 1.888us
     %8113 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5539 =  [] -> 1.408us
     %8114 = :aten::index [[8], [8]] -> 43.392us
       %8115 = :aten::nonzero [[8]] -> 43.392us
         %8116 = CCCL:cub::DeviceReduce::Sum [] -> 1.504us
                 -->kernel: 0:7 %5540 =  [] -> 1.504us
         %8117 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %5541 =  [] -> 1.344us
                 -->kernel: 0:7 %5542 =  [] -> 1.856us
     %8118 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5543 =  [] -> 1.408us
     %8119 = :aten::index [[8], [8]] -> 42.112us
       %8120 = :aten::nonzero [[8]] -> 42.112us
         %8121 = CCCL:cub::DeviceReduce::Sum [] -> 1.472us
                 -->kernel: 0:7 %5544 =  [] -> 1.472us
         %8122 = CCCL:cub::DeviceSelect::Flagged [] -> 11.904us
                 -->kernel: 0:7 %5545 =  [] -> 1.312us
                 -->kernel: 0:7 %5546 =  [] -> 1.888us
     %8123 = :aten::gt [[8], []] -> 1.408us
                 -->kernel: 0:7 %5547 =  [] -> 1.408us
     %8124 = :aten::index [[8], [8]] -> 43.456us
       %8125 = :aten::nonzero [[8]] -> 43.456us
         %8126 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %5548 =  [] -> 1.440us
         %8127 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %5549 =  [] -> 1.312us
                 -->kernel: 0:7 %5550 =  [] -> 1.760us
     %8128 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5551 =  [] -> 1.344us
     %8129 = :aten::index [[8], [8]] -> 42.560us
       %8130 = :aten::nonzero [[8]] -> 42.560us
         %8131 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5552 =  [] -> 1.408us
         %8132 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %5553 =  [] -> 1.248us
                 -->kernel: 0:7 %5554 =  [] -> 1.760us
     %8133 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5555 =  [] -> 1.344us
     %8134 = :aten::index [[8], [8]] -> 43.137us
       %8135 = :aten::nonzero [[8]] -> 43.137us
         %8136 = CCCL:cub::DeviceReduce::Sum [] -> 1.376us
                 -->kernel: 0:7 %5556 =  [] -> 1.376us
         %8137 = CCCL:cub::DeviceSelect::Flagged [] -> 12.065us
                 -->kernel: 0:7 %5557 =  [] -> 1.312us
                 -->kernel: 0:7 %5558 =  [] -> 1.792us
     %8138 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5559 =  [] -> 1.344us
     %8139 = :aten::index [[8], [8]] -> 42.816us
       %8140 = :aten::nonzero [[8]] -> 42.816us
         %8141 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5560 =  [] -> 1.408us
         %8142 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %5561 =  [] -> 1.248us
                 -->kernel: 0:7 %5562 =  [] -> 1.792us
     %8143 = :aten::gt [[8], []] -> 1.312us
                 -->kernel: 0:7 %5563 =  [] -> 1.312us
     %8144 = :aten::index [[8], [8]] -> 43.008us
       %8145 = :aten::nonzero [[8]] -> 43.008us
         %8146 = CCCL:cub::DeviceReduce::Sum [] -> 1.376us
                 -->kernel: 0:7 %5564 =  [] -> 1.376us
         %8147 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %5565 =  [] -> 1.280us
                 -->kernel: 0:7 %5566 =  [] -> 1.760us
     %8148 = :aten::gt [[8], []] -> 1.312us
                 -->kernel: 0:7 %5567 =  [] -> 1.312us
     %8149 = :aten::index [[8], [8]] -> 43.328us
       %8150 = :aten::nonzero [[8]] -> 43.328us
         %8151 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5568 =  [] -> 1.408us
         %8152 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5569 =  [] -> 1.280us
                 -->kernel: 0:7 %5570 =  [] -> 1.792us
     %8153 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5571 =  [] -> 1.344us
     %8154 = :aten::index [[8], [8]] -> 44.032us
       %8155 = :aten::nonzero [[8]] -> 44.032us
         %8156 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5572 =  [] -> 1.408us
         %8157 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %5573 =  [] -> 1.312us
                 -->kernel: 0:7 %5574 =  [] -> 1.792us
     %8158 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5575 =  [] -> 1.344us
     %8159 = :aten::index [[8], [8]] -> 41.664us
       %8160 = :aten::nonzero [[8]] -> 41.664us
         %8161 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5576 =  [] -> 1.408us
         %8162 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %5577 =  [] -> 1.248us
                 -->kernel: 0:7 %5578 =  [] -> 1.760us
     %8163 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5579 =  [] -> 1.344us
     %8164 = :aten::index [[8], [8]] -> 42.976us
       %8165 = :aten::nonzero [[8]] -> 42.976us
         %8166 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5580 =  [] -> 1.408us
         %8167 = CCCL:cub::DeviceSelect::Flagged [] -> 11.776us
                 -->kernel: 0:7 %5581 =  [] -> 1.280us
                 -->kernel: 0:7 %5582 =  [] -> 1.792us
     %8168 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5583 =  [] -> 1.344us
     %8169 = :aten::index [[8], [8]] -> 41.952us
       %8170 = :aten::nonzero [[8]] -> 41.952us
         %8171 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %5584 =  [] -> 1.440us
         %8172 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %5585 =  [] -> 1.248us
                 -->kernel: 0:7 %5586 =  [] -> 1.792us
     %8173 = :aten::gt [[8], []] -> 1.312us
                 -->kernel: 0:7 %5587 =  [] -> 1.312us
     %8174 = :aten::index [[8], [8]] -> 42.816us
       %8175 = :aten::nonzero [[8]] -> 42.816us
         %8176 = CCCL:cub::DeviceReduce::Sum [] -> 1.376us
                 -->kernel: 0:7 %5588 =  [] -> 1.376us
         %8177 = CCCL:cub::DeviceSelect::Flagged [] -> 12.576us
                 -->kernel: 0:7 %5589 =  [] -> 1.312us
                 -->kernel: 0:7 %5590 =  [] -> 1.792us
     %8178 = :aten::gt [[8], []] -> 1.312us
                 -->kernel: 0:7 %5591 =  [] -> 1.312us
     %8179 = :aten::index [[8], [8]] -> 42.176us
       %8180 = :aten::nonzero [[8]] -> 42.176us
         %8181 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5592 =  [] -> 1.408us
         %8182 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5593 =  [] -> 1.248us
                 -->kernel: 0:7 %5594 =  [] -> 1.792us
     %8183 = :aten::gt [[8], []] -> 1.376us
                 -->kernel: 0:7 %5595 =  [] -> 1.376us
     %8184 = :aten::index [[8], [8]] -> 42.336us
       %8185 = :aten::nonzero [[8]] -> 42.336us
         %8186 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5596 =  [] -> 1.408us
         %8187 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %5597 =  [] -> 1.312us
                 -->kernel: 0:7 %5598 =  [] -> 1.792us
     %8188 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5599 =  [] -> 1.344us
     %8189 = :aten::index [[8], [8]] -> 43.136us
       %8190 = :aten::nonzero [[8]] -> 43.136us
         %8191 = CCCL:cub::DeviceReduce::Sum [] -> 1.440us
                 -->kernel: 0:7 %5600 =  [] -> 1.440us
         %8192 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %5601 =  [] -> 1.248us
                 -->kernel: 0:7 %5602 =  [] -> 1.792us
     %8193 = :aten::gt [[8], []] -> 1.344us
                 -->kernel: 0:7 %5603 =  [] -> 1.344us
     %8194 = :aten::index [[8], [8]] -> 45.056us
       %8195 = :aten::nonzero [[8]] -> 45.056us
         %8196 = CCCL:cub::DeviceReduce::Sum [] -> 1.408us
                 -->kernel: 0:7 %5604 =  [] -> 1.408us
         %8197 = CCCL:cub::DeviceSelect::Flagged [] -> 12.160us
                 -->kernel: 0:7 %5605 =  [] -> 1.312us
                 -->kernel: 0:7 %5606 =  [] -> 1.760us
     %8198 = :aten::zeros [[], [], [], [], []] -> 928.000ns
       %8199 = :aten::zero_ [[8, 24]] -> 928.000ns
         %8200 = :aten::fill_ [[8, 24], []] -> 928.000ns
                 -->kernel: 0:7 %5607 =  [] -> 928.000ns
     %8201 = :c10d::_allgather_base_ [[192], [24], [], [], []] -> 7.776us
       %8202 = :record_param_comms [[24], [], [], [], [], [], [], [], [], []] -> 7.776us
         %8203 = :nccl:_all_gather_base [[24]] -> 7.776us
           %8204 = NCCL:ncclAllGather [] -> 7.776us
                 -->kernel: 0:7 %5608 =  [] -> 7.776us
     %8205 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %5609 =  [] -> 1.728us
     %8206 = :aten::index [[8], [8]] -> 47.712us
       %8207 = :aten::nonzero [[8]] -> 47.712us
         %8208 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5610 =  [] -> 1.216us
         %8209 = CCCL:cub::DeviceSelect::Flagged [] -> 12.320us
                 -->kernel: 0:7 %5611 =  [] -> 992.000ns
                 -->kernel: 0:7 %5612 =  [] -> 2.080us
     %8210 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %5613 =  [] -> 1.728us
     %8211 = :aten::index [[8], [8]] -> 43.232us
       %8212 = :aten::nonzero [[8]] -> 43.232us
         %8213 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5614 =  [] -> 1.216us
         %8214 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %5615 =  [] -> 960.000ns
                 -->kernel: 0:7 %5616 =  [] -> 2.080us
     %8215 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %5617 =  [] -> 1.696us
     %8216 = :aten::index [[8], [8]] -> 43.136us
       %8217 = :aten::nonzero [[8]] -> 43.136us
         %8218 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5618 =  [] -> 1.216us
         %8219 = CCCL:cub::DeviceSelect::Flagged [] -> 11.840us
                 -->kernel: 0:7 %5619 =  [] -> 992.000ns
                 -->kernel: 0:7 %5620 =  [] -> 2.048us
     %8220 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %5621 =  [] -> 1.728us
     %8221 = :aten::index [[8], [8]] -> 42.112us
       %8222 = :aten::nonzero [[8]] -> 42.112us
         %8223 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5622 =  [] -> 1.216us
         %8224 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5623 =  [] -> 992.000ns
                 -->kernel: 0:7 %5624 =  [] -> 2.080us
     %8225 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %5625 =  [] -> 1.696us
     %8226 = :aten::index [[8], [8]] -> 42.977us
       %8227 = :aten::nonzero [[8]] -> 42.977us
         %8228 = CCCL:cub::DeviceReduce::Sum [] -> 1.248us
                 -->kernel: 0:7 %5626 =  [] -> 1.248us
         %8229 = CCCL:cub::DeviceSelect::Flagged [] -> 12.128us
                 -->kernel: 0:7 %5627 =  [] -> 992.000ns
                 -->kernel: 0:7 %5628 =  [] -> 2.048us
     %8230 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %5629 =  [] -> 1.728us
     %8231 = :aten::index [[8], [8]] -> 41.728us
       %8232 = :aten::nonzero [[8]] -> 41.728us
         %8233 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5630 =  [] -> 1.216us
         %8234 = CCCL:cub::DeviceSelect::Flagged [] -> 11.616us
                 -->kernel: 0:7 %5631 =  [] -> 960.000ns
                 -->kernel: 0:7 %5632 =  [] -> 2.080us
     %8235 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %5633 =  [] -> 1.696us
     %8236 = :aten::index [[8], [8]] -> 42.784us
       %8237 = :aten::nonzero [[8]] -> 42.784us
         %8238 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5634 =  [] -> 1.216us
         %8239 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %5635 =  [] -> 992.000ns
                 -->kernel: 0:7 %5636 =  [] -> 2.048us
     %8240 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %5637 =  [] -> 1.728us
     %8241 = :aten::index [[8], [8]] -> 41.921us
       %8242 = :aten::nonzero [[8]] -> 41.921us
         %8243 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5638 =  [] -> 1.216us
         %8244 = CCCL:cub::DeviceSelect::Flagged [] -> 11.649us
                 -->kernel: 0:7 %5639 =  [] -> 992.000ns
                 -->kernel: 0:7 %5640 =  [] -> 2.080us
     %8245 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %5641 =  [] -> 1.696us
     %8246 = :aten::index [[8], [8]] -> 43.968us
       %8247 = :aten::nonzero [[8]] -> 43.968us
         %8248 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5642 =  [] -> 1.216us
         %8249 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %5643 =  [] -> 992.000ns
                 -->kernel: 0:7 %5644 =  [] -> 2.016us
     %8250 = :aten::gt [[8], []] -> 1.728us
                 -->kernel: 0:7 %5645 =  [] -> 1.728us
     %8251 = :aten::index [[8], [8]] -> 41.952us
       %8252 = :aten::nonzero [[8]] -> 41.952us
         %8253 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5646 =  [] -> 1.216us
         %8254 = CCCL:cub::DeviceSelect::Flagged [] -> 11.616us
                 -->kernel: 0:7 %5647 =  [] -> 960.000ns
                 -->kernel: 0:7 %5648 =  [] -> 2.080us
     %8255 = :aten::gt [[8], []] -> 1.696us
                 -->kernel: 0:7 %5649 =  [] -> 1.696us
     %8256 = :aten::index [[8], [8]] -> 43.104us
       %8257 = :aten::nonzero [[8]] -> 43.104us
         %8258 = CCCL:cub::DeviceReduce::Sum [] -> 1.216us
                 -->kernel: 0:7 %5650 =  [] -> 1.216us
         %8259 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5651 =  [] -> 1.088us
                 -->kernel: 0:7 %5652 =  [] -> 2.112us
     %8260 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5653 =  [] -> 1.792us
     %8261 = :aten::index [[8], [8]] -> 42.816us
       %8262 = :aten::nonzero [[8]] -> 42.816us
         %8263 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5654 =  [] -> 1.280us
         %8264 = CCCL:cub::DeviceSelect::Flagged [] -> 12.064us
                 -->kernel: 0:7 %5655 =  [] -> 1.024us
                 -->kernel: 0:7 %5656 =  [] -> 2.144us
     %8265 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5657 =  [] -> 1.792us
     %8266 = :aten::index [[8], [8]] -> 46.368us
       %8267 = :aten::nonzero [[8]] -> 46.368us
         %8268 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5658 =  [] -> 1.280us
         %8269 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %5659 =  [] -> 1.056us
                 -->kernel: 0:7 %5660 =  [] -> 2.112us
     %8270 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5661 =  [] -> 1.792us
     %8271 = :aten::index [[8], [8]] -> 43.424us
       %8272 = :aten::nonzero [[8]] -> 43.424us
         %8273 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5662 =  [] -> 1.312us
         %8274 = CCCL:cub::DeviceSelect::Flagged [] -> 11.744us
                 -->kernel: 0:7 %5663 =  [] -> 1.024us
                 -->kernel: 0:7 %5664 =  [] -> 2.176us
     %8275 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5665 =  [] -> 1.792us
     %8276 = :aten::index [[8], [8]] -> 42.240us
       %8277 = :aten::nonzero [[8]] -> 42.240us
         %8278 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5666 =  [] -> 1.312us
         %8279 = CCCL:cub::DeviceSelect::Flagged [] -> 12.000us
                 -->kernel: 0:7 %5667 =  [] -> 1.056us
                 -->kernel: 0:7 %5668 =  [] -> 2.112us
     %8280 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5669 =  [] -> 1.792us
     %8281 = :aten::index [[8], [8]] -> 41.920us
       %8282 = :aten::nonzero [[8]] -> 41.920us
         %8283 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5670 =  [] -> 1.312us
         %8284 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5671 =  [] -> 1.024us
                 -->kernel: 0:7 %5672 =  [] -> 2.176us
     %8285 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5673 =  [] -> 1.792us
     %8286 = :aten::index [[8], [8]] -> 42.272us
       %8287 = :aten::nonzero [[8]] -> 42.272us
         %8288 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5674 =  [] -> 1.312us
         %8289 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %5675 =  [] -> 1.024us
                 -->kernel: 0:7 %5676 =  [] -> 2.112us
     %8290 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %5677 =  [] -> 1.824us
     %8291 = :aten::index [[8], [8]] -> 42.304us
       %8292 = :aten::nonzero [[8]] -> 42.304us
         %8293 = CCCL:cub::DeviceReduce::Sum [] -> 1.280us
                 -->kernel: 0:7 %5678 =  [] -> 1.280us
         %8294 = CCCL:cub::DeviceSelect::Flagged [] -> 11.968us
                 -->kernel: 0:7 %5679 =  [] -> 1.024us
                 -->kernel: 0:7 %5680 =  [] -> 2.176us
     %8295 = :aten::gt [[8], []] -> 1.760us
                 -->kernel: 0:7 %5681 =  [] -> 1.760us
     %8296 = :aten::index [[8], [8]] -> 44.736us
       %8297 = :aten::nonzero [[8]] -> 44.736us
         %8298 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5682 =  [] -> 1.312us
         %8299 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %5683 =  [] -> 1.056us
                 -->kernel: 0:7 %5684 =  [] -> 2.112us
     %8300 = :aten::gt [[8], []] -> 1.824us
                 -->kernel: 0:7 %5685 =  [] -> 1.824us
     %8301 = :aten::index [[8], [8]] -> 43.936us
       %8302 = :aten::nonzero [[8]] -> 43.936us
         %8303 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5686 =  [] -> 1.312us
         %8304 = CCCL:cub::DeviceSelect::Flagged [] -> 11.808us
                 -->kernel: 0:7 %5687 =  [] -> 1.056us
                 -->kernel: 0:7 %5688 =  [] -> 2.176us
     %8305 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5689 =  [] -> 1.792us
     %8306 = :aten::index [[8], [8]] -> 42.689us
       %8307 = :aten::nonzero [[8]] -> 42.689us
         %8308 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5690 =  [] -> 1.312us
         %8309 = CCCL:cub::DeviceSelect::Flagged [] -> 11.936us
                 -->kernel: 0:7 %5691 =  [] -> 1.056us
                 -->kernel: 0:7 %5692 =  [] -> 2.144us
     %8310 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5693 =  [] -> 1.792us
     %8311 = :aten::index [[8], [8]] -> 41.504us
       %8312 = :aten::nonzero [[8]] -> 41.504us
         %8313 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5694 =  [] -> 1.312us
         %8314 = CCCL:cub::DeviceSelect::Flagged [] -> 11.712us
                 -->kernel: 0:7 %5695 =  [] -> 1.024us
                 -->kernel: 0:7 %5696 =  [] -> 2.144us
     %8315 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5697 =  [] -> 1.792us
     %8316 = :aten::index [[8], [8]] -> 41.760us
       %8317 = :aten::nonzero [[8]] -> 41.760us
         %8318 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5698 =  [] -> 1.312us
         %8319 = CCCL:cub::DeviceSelect::Flagged [] -> 11.872us
                 -->kernel: 0:7 %5699 =  [] -> 1.056us
                 -->kernel: 0:7 %5700 =  [] -> 2.144us
     %8320 = :aten::gt [[8], []] -> 1.792us
                 -->kernel: 0:7 %5701 =  [] -> 1.792us
     %8321 = :aten::index [[8], [8]] -> 41.697us
       %8322 = :aten::nonzero [[8]] -> 41.697us
         %8323 = CCCL:cub::DeviceReduce::Sum [] -> 1.312us
                 -->kernel: 0:7 %5702 =  [] -> 1.312us
         %8324 = CCCL:cub::DeviceSelect::Flagged [] -> 11.841us
(1, '0:emb_fwd <0, 25, 25>-> 4.931ms')
     %0 = :aten::zero_ [[3002413056]] -> 1.807ms
       %1 = :aten::fill_ [[3002413056], []] -> 1.807ms
                 -->kernel: 0:7 %1 =  [] -> 441.473us
                 -->kernel: 0:7 %2 =  [] -> 441.473us
                 -->kernel: 0:7 %3 =  [] -> 441.537us
     %2 = :aten::zero_ [[352321536]] -> 207.872us
       %3 = :aten::fill_ [[352321536], []] -> 207.872us
                 -->kernel: 0:7 %4 =  [] -> 207.872us
     %4 = :aten::zeros [[], [], [], [], []] -> 1.312us
       %5 = :aten::zero_ [[]] -> 1.312us
         %6 = :aten::fill_ [[], []] -> 1.312us
                 -->kernel: 0:7 %5 =  [] -> 1.312us
     %7 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.200us
       %8 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.200us
         %9 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.200us
     %10 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.008us
       %11 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.008us
         %12 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.008us
     %13 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 1.504us
       %14 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 1.504us
         %15 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 1.504us
     %16 = :aten::to [[1, 1, 4096, 4096], [], [], [], [], [], [], []] -> 293.856us
       %17 = :aten::_to_copy [[1, 1, 4096, 4096], [], [], [], [], [], []] -> 293.856us
         %18 = :aten::copy_ [[1, 1, 4096, 4096], [1, 1, 4096, 4096], []] -> 293.856us
     %19 = :aten::to [[1, 4096], [], [], [], [], [], [], []] -> 3.136us
       %20 = :aten::_to_copy [[1, 4096], [], [], [], [], [], []] -> 3.136us
         %21 = :aten::copy_ [[1, 4096], [1, 4096], []] -> 3.136us
     %22 = :aten::embedding [[129280, 7168], [1, 4096], [], [], []] -> 270.209us
       %23 = :aten::index_select [[129280, 7168], [], [4096]] -> 270.209us
                 -->kernel: 0:7 %6 =  [] -> 270.209us
     %24 = :_OperationFuserAutogradFunction [[4096, 1, 7168], [7168]] -> 128.385us
(2, '0:emb_bwd <1242, 1245, 3>-> 113.249us')
       %0 = :aten::add_ [[4096, 1, 7168], [4096, 1, 7168], []] -> 49.088us
     %1 = :autograd::engine::evaluate_function: torch::autograd::AccumulateGrad None -> 1.600us
       %2 = :aten::add_ [[7168], [7168], []] -> 1.600us
======================= deepseek_v3_te2.8 Done =======================<